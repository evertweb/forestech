(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}})();var vp={exports:{}},Nc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sb;function Wj(){if(sb)return Nc;sb=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(a,o,c){var d=null;if(c!==void 0&&(d=""+c),o.key!==void 0&&(d=""+o.key),"key"in o){c={};for(var f in o)f!=="key"&&(c[f]=o[f])}else c=o;return o=c.ref,{$$typeof:n,type:a,key:d,ref:o!==void 0?o:null,props:c}}return Nc.Fragment=e,Nc.jsx=t,Nc.jsxs=t,Nc}var ab;function Zj(){return ab||(ab=1,vp.exports=Wj()),vp.exports}var r=Zj(),yp={exports:{}},ke={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ib;function Jj(){if(ib)return ke;ib=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),N=Symbol.iterator;function C(q){return q===null||typeof q!="object"?null:(q=N&&q[N]||q["@@iterator"],typeof q=="function"?q:null)}var j={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,M={};function x(q,ne,he){this.props=q,this.context=ne,this.refs=M,this.updater=he||j}x.prototype.isReactComponent={},x.prototype.setState=function(q,ne){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,ne,"setState")},x.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function L(){}L.prototype=x.prototype;function $(q,ne,he){this.props=q,this.context=ne,this.refs=M,this.updater=he||j}var O=$.prototype=new L;O.constructor=$,b(O,x.prototype),O.isPureReactComponent=!0;var U=Array.isArray,F={H:null,A:null,T:null,S:null,V:null},X=Object.prototype.hasOwnProperty;function w(q,ne,he,ue,xe,Fe){return he=Fe.ref,{$$typeof:n,type:q,key:ne,ref:he!==void 0?he:null,props:Fe}}function A(q,ne){return w(q.type,ne,void 0,void 0,void 0,q.props)}function R(q){return typeof q=="object"&&q!==null&&q.$$typeof===n}function I(q){var ne={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(he){return ne[he]})}var P=/\/+/g;function V(q,ne){return typeof q=="object"&&q!==null&&q.key!=null?I(""+q.key):ne.toString(36)}function k(){}function Le(q){switch(q.status){case"fulfilled":return q.value;case"rejected":throw q.reason;default:switch(typeof q.status=="string"?q.then(k,k):(q.status="pending",q.then(function(ne){q.status==="pending"&&(q.status="fulfilled",q.value=ne)},function(ne){q.status==="pending"&&(q.status="rejected",q.reason=ne)})),q.status){case"fulfilled":return q.value;case"rejected":throw q.reason}}throw q}function ae(q,ne,he,ue,xe){var Fe=typeof q;(Fe==="undefined"||Fe==="boolean")&&(q=null);var De=!1;if(q===null)De=!0;else switch(Fe){case"bigint":case"string":case"number":De=!0;break;case"object":switch(q.$$typeof){case n:case e:De=!0;break;case _:return De=q._init,ae(De(q._payload),ne,he,ue,xe)}}if(De)return xe=xe(q),De=ue===""?"."+V(q,0):ue,U(xe)?(he="",De!=null&&(he=De.replace(P,"$&/")+"/"),ae(xe,ne,he,"",function(As){return As})):xe!=null&&(R(xe)&&(xe=A(xe,he+(xe.key==null||q&&q.key===xe.key?"":(""+xe.key).replace(P,"$&/")+"/")+De)),ne.push(xe)),1;De=0;var Gt=ue===""?".":ue+":";if(U(q))for(var mt=0;mt<q.length;mt++)ue=q[mt],Fe=Gt+V(ue,mt),De+=ae(ue,ne,he,Fe,xe);else if(mt=C(q),typeof mt=="function")for(q=mt.call(q),mt=0;!(ue=q.next()).done;)ue=ue.value,Fe=Gt+V(ue,mt++),De+=ae(ue,ne,he,Fe,xe);else if(Fe==="object"){if(typeof q.then=="function")return ae(Le(q),ne,he,ue,xe);throw ne=String(q),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.")}return De}function B(q,ne,he){if(q==null)return q;var ue=[],xe=0;return ae(q,ue,"","",function(Fe){return ne.call(he,Fe,xe++)}),ue}function J(q){if(q._status===-1){var ne=q._result;ne=ne(),ne.then(function(he){(q._status===0||q._status===-1)&&(q._status=1,q._result=he)},function(he){(q._status===0||q._status===-1)&&(q._status=2,q._result=he)}),q._status===-1&&(q._status=0,q._result=ne)}if(q._status===1)return q._result.default;throw q._result}var ce=typeof reportError=="function"?reportError:function(q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ne=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof q=="object"&&q!==null&&typeof q.message=="string"?String(q.message):String(q),error:q});if(!window.dispatchEvent(ne))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",q);return}console.error(q)};function ye(){}return ke.Children={map:B,forEach:function(q,ne,he){B(q,function(){ne.apply(this,arguments)},he)},count:function(q){var ne=0;return B(q,function(){ne++}),ne},toArray:function(q){return B(q,function(ne){return ne})||[]},only:function(q){if(!R(q))throw Error("React.Children.only expected to receive a single React element child.");return q}},ke.Component=x,ke.Fragment=t,ke.Profiler=o,ke.PureComponent=$,ke.StrictMode=a,ke.Suspense=p,ke.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,ke.__COMPILER_RUNTIME={__proto__:null,c:function(q){return F.H.useMemoCache(q)}},ke.cache=function(q){return function(){return q.apply(null,arguments)}},ke.cloneElement=function(q,ne,he){if(q==null)throw Error("The argument must be a React element, but you passed "+q+".");var ue=b({},q.props),xe=q.key,Fe=void 0;if(ne!=null)for(De in ne.ref!==void 0&&(Fe=void 0),ne.key!==void 0&&(xe=""+ne.key),ne)!X.call(ne,De)||De==="key"||De==="__self"||De==="__source"||De==="ref"&&ne.ref===void 0||(ue[De]=ne[De]);var De=arguments.length-2;if(De===1)ue.children=he;else if(1<De){for(var Gt=Array(De),mt=0;mt<De;mt++)Gt[mt]=arguments[mt+2];ue.children=Gt}return w(q.type,xe,void 0,void 0,Fe,ue)},ke.createContext=function(q){return q={$$typeof:d,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null},q.Provider=q,q.Consumer={$$typeof:c,_context:q},q},ke.createElement=function(q,ne,he){var ue,xe={},Fe=null;if(ne!=null)for(ue in ne.key!==void 0&&(Fe=""+ne.key),ne)X.call(ne,ue)&&ue!=="key"&&ue!=="__self"&&ue!=="__source"&&(xe[ue]=ne[ue]);var De=arguments.length-2;if(De===1)xe.children=he;else if(1<De){for(var Gt=Array(De),mt=0;mt<De;mt++)Gt[mt]=arguments[mt+2];xe.children=Gt}if(q&&q.defaultProps)for(ue in De=q.defaultProps,De)xe[ue]===void 0&&(xe[ue]=De[ue]);return w(q,Fe,void 0,void 0,null,xe)},ke.createRef=function(){return{current:null}},ke.forwardRef=function(q){return{$$typeof:f,render:q}},ke.isValidElement=R,ke.lazy=function(q){return{$$typeof:_,_payload:{_status:-1,_result:q},_init:J}},ke.memo=function(q,ne){return{$$typeof:v,type:q,compare:ne===void 0?null:ne}},ke.startTransition=function(q){var ne=F.T,he={};F.T=he;try{var ue=q(),xe=F.S;xe!==null&&xe(he,ue),typeof ue=="object"&&ue!==null&&typeof ue.then=="function"&&ue.then(ye,ce)}catch(Fe){ce(Fe)}finally{F.T=ne}},ke.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},ke.use=function(q){return F.H.use(q)},ke.useActionState=function(q,ne,he){return F.H.useActionState(q,ne,he)},ke.useCallback=function(q,ne){return F.H.useCallback(q,ne)},ke.useContext=function(q){return F.H.useContext(q)},ke.useDebugValue=function(){},ke.useDeferredValue=function(q,ne){return F.H.useDeferredValue(q,ne)},ke.useEffect=function(q,ne,he){var ue=F.H;if(typeof he=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ue.useEffect(q,ne)},ke.useId=function(){return F.H.useId()},ke.useImperativeHandle=function(q,ne,he){return F.H.useImperativeHandle(q,ne,he)},ke.useInsertionEffect=function(q,ne){return F.H.useInsertionEffect(q,ne)},ke.useLayoutEffect=function(q,ne){return F.H.useLayoutEffect(q,ne)},ke.useMemo=function(q,ne){return F.H.useMemo(q,ne)},ke.useOptimistic=function(q,ne){return F.H.useOptimistic(q,ne)},ke.useReducer=function(q,ne,he){return F.H.useReducer(q,ne,he)},ke.useRef=function(q){return F.H.useRef(q)},ke.useState=function(q){return F.H.useState(q)},ke.useSyncExternalStore=function(q,ne,he){return F.H.useSyncExternalStore(q,ne,he)},ke.useTransition=function(){return F.H.useTransition()},ke.version="19.1.0",ke}var rb;function Ng(){return rb||(rb=1,yp.exports=Jj()),yp.exports}var Y=Ng(),_p={exports:{}},Tc={},Ep={exports:{}},bp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ob;function eS(){return ob||(ob=1,function(n){function e(B,J){var ce=B.length;B.push(J);e:for(;0<ce;){var ye=ce-1>>>1,q=B[ye];if(0<o(q,J))B[ye]=J,B[ce]=q,ce=ye;else break e}}function t(B){return B.length===0?null:B[0]}function a(B){if(B.length===0)return null;var J=B[0],ce=B.pop();if(ce!==J){B[0]=ce;e:for(var ye=0,q=B.length,ne=q>>>1;ye<ne;){var he=2*(ye+1)-1,ue=B[he],xe=he+1,Fe=B[xe];if(0>o(ue,ce))xe<q&&0>o(Fe,ue)?(B[ye]=Fe,B[xe]=ce,ye=xe):(B[ye]=ue,B[he]=ce,ye=he);else if(xe<q&&0>o(Fe,ce))B[ye]=Fe,B[xe]=ce,ye=xe;else break e}}return J}function o(B,J){var ce=B.sortIndex-J.sortIndex;return ce!==0?ce:B.id-J.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var p=[],v=[],_=1,N=null,C=3,j=!1,b=!1,M=!1,x=!1,L=typeof setTimeout=="function"?setTimeout:null,$=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;function U(B){for(var J=t(v);J!==null;){if(J.callback===null)a(v);else if(J.startTime<=B)a(v),J.sortIndex=J.expirationTime,e(p,J);else break;J=t(v)}}function F(B){if(M=!1,U(B),!b)if(t(p)!==null)b=!0,X||(X=!0,V());else{var J=t(v);J!==null&&ae(F,J.startTime-B)}}var X=!1,w=-1,A=5,R=-1;function I(){return x?!0:!(n.unstable_now()-R<A)}function P(){if(x=!1,X){var B=n.unstable_now();R=B;var J=!0;try{e:{b=!1,M&&(M=!1,$(w),w=-1),j=!0;var ce=C;try{t:{for(U(B),N=t(p);N!==null&&!(N.expirationTime>B&&I());){var ye=N.callback;if(typeof ye=="function"){N.callback=null,C=N.priorityLevel;var q=ye(N.expirationTime<=B);if(B=n.unstable_now(),typeof q=="function"){N.callback=q,U(B),J=!0;break t}N===t(p)&&a(p),U(B)}else a(p);N=t(p)}if(N!==null)J=!0;else{var ne=t(v);ne!==null&&ae(F,ne.startTime-B),J=!1}}break e}finally{N=null,C=ce,j=!1}J=void 0}}finally{J?V():X=!1}}}var V;if(typeof O=="function")V=function(){O(P)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,Le=k.port2;k.port1.onmessage=P,V=function(){Le.postMessage(null)}}else V=function(){L(P,0)};function ae(B,J){w=L(function(){B(n.unstable_now())},J)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(B){B.callback=null},n.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<B?Math.floor(1e3/B):5},n.unstable_getCurrentPriorityLevel=function(){return C},n.unstable_next=function(B){switch(C){case 1:case 2:case 3:var J=3;break;default:J=C}var ce=C;C=J;try{return B()}finally{C=ce}},n.unstable_requestPaint=function(){x=!0},n.unstable_runWithPriority=function(B,J){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var ce=C;C=B;try{return J()}finally{C=ce}},n.unstable_scheduleCallback=function(B,J,ce){var ye=n.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?ye+ce:ye):ce=ye,B){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=ce+q,B={id:_++,callback:J,priorityLevel:B,startTime:ce,expirationTime:q,sortIndex:-1},ce>ye?(B.sortIndex=ce,e(v,B),t(p)===null&&B===t(v)&&(M?($(w),w=-1):M=!0,ae(F,ce-ye))):(B.sortIndex=q,e(p,B),b||j||(b=!0,X||(X=!0,V()))),B},n.unstable_shouldYield=I,n.unstable_wrapCallback=function(B){var J=C;return function(){var ce=C;C=J;try{return B.apply(this,arguments)}finally{C=ce}}}}(bp)),bp}var lb;function tS(){return lb||(lb=1,Ep.exports=eS()),Ep.exports}var Np={exports:{}},mn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cb;function nS(){if(cb)return mn;cb=1;var n=Ng();function e(p){var v="https://react.dev/errors/"+p;if(1<arguments.length){v+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)v+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+p+"; visit "+v+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var a={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(p,v,_){var N=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:N==null?null:""+N,children:p,containerInfo:v,implementation:_}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(p,v){if(p==="font")return"";if(typeof v=="string")return v==="use-credentials"?v:""}return mn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,mn.createPortal=function(p,v){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!v||v.nodeType!==1&&v.nodeType!==9&&v.nodeType!==11)throw Error(e(299));return c(p,v,null,_)},mn.flushSync=function(p){var v=d.T,_=a.p;try{if(d.T=null,a.p=2,p)return p()}finally{d.T=v,a.p=_,a.d.f()}},mn.preconnect=function(p,v){typeof p=="string"&&(v?(v=v.crossOrigin,v=typeof v=="string"?v==="use-credentials"?v:"":void 0):v=null,a.d.C(p,v))},mn.prefetchDNS=function(p){typeof p=="string"&&a.d.D(p)},mn.preinit=function(p,v){if(typeof p=="string"&&v&&typeof v.as=="string"){var _=v.as,N=f(_,v.crossOrigin),C=typeof v.integrity=="string"?v.integrity:void 0,j=typeof v.fetchPriority=="string"?v.fetchPriority:void 0;_==="style"?a.d.S(p,typeof v.precedence=="string"?v.precedence:void 0,{crossOrigin:N,integrity:C,fetchPriority:j}):_==="script"&&a.d.X(p,{crossOrigin:N,integrity:C,fetchPriority:j,nonce:typeof v.nonce=="string"?v.nonce:void 0})}},mn.preinitModule=function(p,v){if(typeof p=="string")if(typeof v=="object"&&v!==null){if(v.as==null||v.as==="script"){var _=f(v.as,v.crossOrigin);a.d.M(p,{crossOrigin:_,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0})}}else v==null&&a.d.M(p)},mn.preload=function(p,v){if(typeof p=="string"&&typeof v=="object"&&v!==null&&typeof v.as=="string"){var _=v.as,N=f(_,v.crossOrigin);a.d.L(p,_,{crossOrigin:N,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0,type:typeof v.type=="string"?v.type:void 0,fetchPriority:typeof v.fetchPriority=="string"?v.fetchPriority:void 0,referrerPolicy:typeof v.referrerPolicy=="string"?v.referrerPolicy:void 0,imageSrcSet:typeof v.imageSrcSet=="string"?v.imageSrcSet:void 0,imageSizes:typeof v.imageSizes=="string"?v.imageSizes:void 0,media:typeof v.media=="string"?v.media:void 0})}},mn.preloadModule=function(p,v){if(typeof p=="string")if(v){var _=f(v.as,v.crossOrigin);a.d.m(p,{as:typeof v.as=="string"&&v.as!=="script"?v.as:void 0,crossOrigin:_,integrity:typeof v.integrity=="string"?v.integrity:void 0})}else a.d.m(p)},mn.requestFormReset=function(p){a.d.r(p)},mn.unstable_batchedUpdates=function(p,v){return p(v)},mn.useFormState=function(p,v,_){return d.H.useFormState(p,v,_)},mn.useFormStatus=function(){return d.H.useHostTransitionStatus()},mn.version="19.1.0",mn}var ub;function sS(){if(ub)return Np.exports;ub=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Np.exports=nS(),Np.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var db;function aS(){if(db)return Tc;db=1;var n=tS(),e=Ng(),t=sS();function a(s){var i="https://react.dev/errors/"+s;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)i+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function c(s){var i=s,l=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(l=i.return),s=i.return;while(s)}return i.tag===3?l:null}function d(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function f(s){if(c(s)!==s)throw Error(a(188))}function p(s){var i=s.alternate;if(!i){if(i=c(s),i===null)throw Error(a(188));return i!==s?null:s}for(var l=s,u=i;;){var m=l.return;if(m===null)break;var g=m.alternate;if(g===null){if(u=m.return,u!==null){l=u;continue}break}if(m.child===g.child){for(g=m.child;g;){if(g===l)return f(m),s;if(g===u)return f(m),i;g=g.sibling}throw Error(a(188))}if(l.return!==u.return)l=m,u=g;else{for(var T=!1,S=m.child;S;){if(S===l){T=!0,l=m,u=g;break}if(S===u){T=!0,u=m,l=g;break}S=S.sibling}if(!T){for(S=g.child;S;){if(S===l){T=!0,l=g,u=m;break}if(S===u){T=!0,u=g,l=m;break}S=S.sibling}if(!T)throw Error(a(189))}}if(l.alternate!==u)throw Error(a(190))}if(l.tag!==3)throw Error(a(188));return l.stateNode.current===l?s:i}function v(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s;for(s=s.child;s!==null;){if(i=v(s),i!==null)return i;s=s.sibling}return null}var _=Object.assign,N=Symbol.for("react.element"),C=Symbol.for("react.transitional.element"),j=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),L=Symbol.for("react.provider"),$=Symbol.for("react.consumer"),O=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),X=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function V(s){return s===null||typeof s!="object"?null:(s=P&&s[P]||s["@@iterator"],typeof s=="function"?s:null)}var k=Symbol.for("react.client.reference");function Le(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===k?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case b:return"Fragment";case x:return"Profiler";case M:return"StrictMode";case F:return"Suspense";case X:return"SuspenseList";case R:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case j:return"Portal";case O:return(s.displayName||"Context")+".Provider";case $:return(s._context.displayName||"Context")+".Consumer";case U:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case w:return i=s.displayName||null,i!==null?i:Le(s.type)||"Memo";case A:i=s._payload,s=s._init;try{return Le(s(i))}catch{}}return null}var ae=Array.isArray,B=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce={pending:!1,data:null,method:null,action:null},ye=[],q=-1;function ne(s){return{current:s}}function he(s){0>q||(s.current=ye[q],ye[q]=null,q--)}function ue(s,i){q++,ye[q]=s.current,s.current=i}var xe=ne(null),Fe=ne(null),De=ne(null),Gt=ne(null);function mt(s,i){switch(ue(De,i),ue(Fe,s),ue(xe,null),i.nodeType){case 9:case 11:s=(s=i.documentElement)&&(s=s.namespaceURI)?RE(s):0;break;default:if(s=i.tagName,i=i.namespaceURI)i=RE(i),s=DE(i,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}he(xe),ue(xe,s)}function As(){he(xe),he(Fe),he(De)}function La(s){s.memoizedState!==null&&ue(Gt,s);var i=xe.current,l=DE(i,s.type);i!==l&&(ue(Fe,s),ue(xe,l))}function Js(s){Fe.current===s&&(he(xe),he(Fe)),Gt.current===s&&(he(Gt),vc._currentValue=ce)}var Ui=Object.prototype.hasOwnProperty,Fi=n.unstable_scheduleCallback,Hi=n.unstable_cancelCallback,ml=n.unstable_shouldYield,Eu=n.unstable_requestPaint,Xn=n.unstable_now,vf=n.unstable_getCurrentPriorityLevel,pl=n.unstable_ImmediatePriority,Fr=n.unstable_UserBlockingPriority,qi=n.unstable_NormalPriority,yf=n.unstable_LowPriority,Hr=n.unstable_IdlePriority,gl=n.log,bu=n.unstable_setDisableYieldValue,bt=null,at=null;function Pn(s){if(typeof gl=="function"&&bu(s),at&&typeof at.setStrictMode=="function")try{at.setStrictMode(bt,s)}catch{}}var hn=Math.clz32?Math.clz32:Bi,Nu=Math.log,_f=Math.LN2;function Bi(s){return s>>>=0,s===0?32:31-(Nu(s)/_f|0)|0}var zi=256,Gi=4194304;function hs(s){var i=s&42;if(i!==0)return i;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function qr(s,i,l){var u=s.pendingLanes;if(u===0)return 0;var m=0,g=s.suspendedLanes,T=s.pingedLanes;s=s.warmLanes;var S=u&134217727;return S!==0?(u=S&~g,u!==0?m=hs(u):(T&=S,T!==0?m=hs(T):l||(l=S&~s,l!==0&&(m=hs(l))))):(S=u&~g,S!==0?m=hs(S):T!==0?m=hs(T):l||(l=u&~s,l!==0&&(m=hs(l)))),m===0?0:i!==0&&i!==m&&(i&g)===0&&(g=m&-m,l=i&-i,g>=l||g===32&&(l&4194048)!==0)?i:m}function $i(s,i){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&i)===0}function vl(s,i){switch(s){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yl(){var s=zi;return zi<<=1,(zi&4194048)===0&&(zi=256),s}function _l(){var s=Gi;return Gi<<=1,(Gi&62914560)===0&&(Gi=4194304),s}function ea(s){for(var i=[],l=0;31>l;l++)i.push(s);return i}function ta(s,i){s.pendingLanes|=i,i!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function El(s,i,l,u,m,g){var T=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var S=s.entanglements,H=s.expirationTimes,W=s.hiddenUpdates;for(l=T&~l;0<l;){var se=31-hn(l),oe=1<<se;S[se]=0,H[se]=-1;var Z=W[se];if(Z!==null)for(W[se]=null,se=0;se<Z.length;se++){var ee=Z[se];ee!==null&&(ee.lane&=-536870913)}l&=~oe}u!==0&&Cs(s,u,0),g!==0&&m===0&&s.tag!==0&&(s.suspendedLanes|=g&~(T&~i))}function Cs(s,i,l){s.pendingLanes|=i,s.suspendedLanes&=~i;var u=31-hn(i);s.entangledLanes|=i,s.entanglements[u]=s.entanglements[u]|1073741824|l&4194090}function bl(s,i){var l=s.entangledLanes|=i;for(s=s.entanglements;l;){var u=31-hn(l),m=1<<u;m&i|s[u]&i&&(s[u]|=i),l&=~m}}function Va(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Br(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ua(){var s=J.p;return s!==0?s:(s=window.event,s===void 0?32:WE(s.type))}function Tu(s,i){var l=J.p;try{return J.p=s,i()}finally{J.p=l}}var vt=Math.random().toString(36).slice(2),Lt="__reactFiber$"+vt,It="__reactProps$"+vt,Wn="__reactContainer$"+vt,Nl="__reactEvents$"+vt,Ef="__reactListeners$"+vt,Fa="__reactHandles$"+vt,xu="__reactResources$"+vt,Yi="__reactMarker$"+vt;function Ha(s){delete s[Lt],delete s[It],delete s[Nl],delete s[Ef],delete s[Fa]}function na(s){var i=s[Lt];if(i)return i;for(var l=s.parentNode;l;){if(i=l[Wn]||l[Lt]){if(l=i.alternate,i.child!==null||l!==null&&l.child!==null)for(s=kE(s);s!==null;){if(l=s[Lt])return l;s=kE(s)}return i}s=l,l=s.parentNode}return null}function js(s){if(s=s[Lt]||s[Wn]){var i=s.tag;if(i===5||i===6||i===13||i===26||i===27||i===3)return s}return null}function Ss(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s.stateNode;throw Error(a(33))}function En(s){var i=s[xu];return i||(i=s[xu]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function At(s){s[Yi]=!0}var Tl=new Set,zr={};function fs(s,i){sa(s,i),sa(s+"Capture",i)}function sa(s,i){for(zr[s]=i,s=0;s<i.length;s++)Tl.add(i[s])}var Au=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Cu={},Ki={};function ju(s){return Ui.call(Ki,s)?!0:Ui.call(Cu,s)?!1:Au.test(s)?Ki[s]=!0:(Cu[s]=!0,!1)}function qa(s,i,l){if(ju(i))if(l===null)s.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(i);return;case"boolean":var u=i.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){s.removeAttribute(i);return}}s.setAttribute(i,""+l)}}function ws(s,i,l){if(l===null)s.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(i);return}s.setAttribute(i,""+l)}}function Jt(s,i,l,u){if(u===null)s.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(i,l,""+u)}}var Qi,Su;function aa(s){if(Qi===void 0)try{throw Error()}catch(l){var i=l.stack.trim().match(/\n( *(at )?)/);Qi=i&&i[1]||"",Su=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Qi+s+Su}var Gr=!1;function $r(s,i){if(!s||Gr)return"";Gr=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(i){var oe=function(){throw Error()};if(Object.defineProperty(oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(oe,[])}catch(ee){var Z=ee}Reflect.construct(s,[],oe)}else{try{oe.call()}catch(ee){Z=ee}s.call(oe.prototype)}}else{try{throw Error()}catch(ee){Z=ee}(oe=s())&&typeof oe.catch=="function"&&oe.catch(function(){})}}catch(ee){if(ee&&Z&&typeof ee.stack=="string")return[ee.stack,Z.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=u.DetermineComponentFrameRoot(),T=g[0],S=g[1];if(T&&S){var H=T.split(`
`),W=S.split(`
`);for(m=u=0;u<H.length&&!H[u].includes("DetermineComponentFrameRoot");)u++;for(;m<W.length&&!W[m].includes("DetermineComponentFrameRoot");)m++;if(u===H.length||m===W.length)for(u=H.length-1,m=W.length-1;1<=u&&0<=m&&H[u]!==W[m];)m--;for(;1<=u&&0<=m;u--,m--)if(H[u]!==W[m]){if(u!==1||m!==1)do if(u--,m--,0>m||H[u]!==W[m]){var se=`
`+H[u].replace(" at new "," at ");return s.displayName&&se.includes("<anonymous>")&&(se=se.replace("<anonymous>",s.displayName)),se}while(1<=u&&0<=m);break}}}finally{Gr=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?aa(l):""}function xl(s){switch(s.tag){case 26:case 27:case 5:return aa(s.type);case 16:return aa("Lazy");case 13:return aa("Suspense");case 19:return aa("SuspenseList");case 0:case 15:return $r(s.type,!1);case 11:return $r(s.type.render,!1);case 1:return $r(s.type,!0);case 31:return aa("Activity");default:return""}}function Yr(s){try{var i="";do i+=xl(s),s=s.return;while(s);return i}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function bn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Al(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function bf(s){var i=Al(s)?"checked":"value",l=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),u=""+s[i];if(!s.hasOwnProperty(i)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var m=l.get,g=l.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return m.call(this)},set:function(T){u=""+T,g.call(this,T)}}),Object.defineProperty(s,i,{enumerable:l.enumerable}),{getValue:function(){return u},setValue:function(T){u=""+T},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function Kr(s){s._valueTracker||(s._valueTracker=bf(s))}function Cl(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var l=i.getValue(),u="";return s&&(u=Al(s)?s.checked?"true":"false":s.value),s=u,s!==l?(i.setValue(s),!0):!1}function Xi(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Nf=/[\n"\\]/g;function Rt(s){return s.replace(Nf,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function kn(s,i,l,u,m,g,T,S){s.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?s.type=T:s.removeAttribute("type"),i!=null?T==="number"?(i===0&&s.value===""||s.value!=i)&&(s.value=""+bn(i)):s.value!==""+bn(i)&&(s.value=""+bn(i)):T!=="submit"&&T!=="reset"||s.removeAttribute("value"),i!=null?Ba(s,T,bn(i)):l!=null?Ba(s,T,bn(l)):u!=null&&s.removeAttribute("value"),m==null&&g!=null&&(s.defaultChecked=!!g),m!=null&&(s.checked=m&&typeof m!="function"&&typeof m!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?s.name=""+bn(S):s.removeAttribute("name")}function Wi(s,i,l,u,m,g,T,S){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(s.type=g),i!=null||l!=null){if(!(g!=="submit"&&g!=="reset"||i!=null))return;l=l!=null?""+bn(l):"",i=i!=null?""+bn(i):l,S||i===s.value||(s.value=i),s.defaultValue=i}u=u??m,u=typeof u!="function"&&typeof u!="symbol"&&!!u,s.checked=S?s.checked:!!u,s.defaultChecked=!!u,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(s.name=T)}function Ba(s,i,l){i==="number"&&Xi(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function ia(s,i,l,u){if(s=s.options,i){i={};for(var m=0;m<l.length;m++)i["$"+l[m]]=!0;for(l=0;l<s.length;l++)m=i.hasOwnProperty("$"+s[l].value),s[l].selected!==m&&(s[l].selected=m),m&&u&&(s[l].defaultSelected=!0)}else{for(l=""+bn(l),i=null,m=0;m<s.length;m++){if(s[m].value===l){s[m].selected=!0,u&&(s[m].defaultSelected=!0);return}i!==null||s[m].disabled||(i=s[m])}i!==null&&(i.selected=!0)}}function ot(s,i,l){if(i!=null&&(i=""+bn(i),i!==s.value&&(s.value=i),l==null)){s.defaultValue!==i&&(s.defaultValue=i);return}s.defaultValue=l!=null?""+bn(l):""}function Zi(s,i,l,u){if(i==null){if(u!=null){if(l!=null)throw Error(a(92));if(ae(u)){if(1<u.length)throw Error(a(93));u=u[0]}l=u}l==null&&(l=""),i=l}l=bn(i),s.defaultValue=l,u=s.textContent,u===l&&u!==""&&u!==null&&(s.value=u)}function Zn(s,i){if(i){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=i;return}}s.textContent=i}var Ji=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function wu(s,i,l){var u=i.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?s.setProperty(i,""):i==="float"?s.cssFloat="":s[i]="":u?s.setProperty(i,l):typeof l!="number"||l===0||Ji.has(i)?i==="float"?s.cssFloat=l:s[i]=(""+l).trim():s[i]=l+"px"}function jl(s,i,l){if(i!=null&&typeof i!="object")throw Error(a(62));if(s=s.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||i!=null&&i.hasOwnProperty(u)||(u.indexOf("--")===0?s.setProperty(u,""):u==="float"?s.cssFloat="":s[u]="");for(var m in i)u=i[m],i.hasOwnProperty(m)&&l[m]!==u&&wu(s,m,u)}else for(var g in i)i.hasOwnProperty(g)&&wu(s,g,i[g])}function Sl(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),xf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Qr(s){return xf.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var ra=null;function Jn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var oa=null,la=null;function wl(s){var i=js(s);if(i&&(s=i.stateNode)){var l=s[It]||null;e:switch(s=i.stateNode,i.type){case"input":if(kn(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),i=l.name,l.type==="radio"&&i!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Rt(""+i)+'"][type="radio"]'),i=0;i<l.length;i++){var u=l[i];if(u!==s&&u.form===s.form){var m=u[It]||null;if(!m)throw Error(a(90));kn(u,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(i=0;i<l.length;i++)u=l[i],u.form===s.form&&Cl(u)}break e;case"textarea":ot(s,l.value,l.defaultValue);break e;case"select":i=l.value,i!=null&&ia(s,!!l.multiple,i,!1)}}}var Is=!1;function Iu(s,i,l){if(Is)return s(i,l);Is=!0;try{var u=s(i);return u}finally{if(Is=!1,(oa!==null||la!==null)&&(Td(),oa&&(i=oa,s=la,la=oa=null,wl(i),s)))for(i=0;i<s.length;i++)wl(s[i])}}function er(s,i){var l=s.stateNode;if(l===null)return null;var u=l[It]||null;if(u===null)return null;l=u[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(s=s.type,u=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!u;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(a(231,i,typeof l));return l}var ms=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),es=!1;if(ms)try{var tr={};Object.defineProperty(tr,"passive",{get:function(){es=!0}}),window.addEventListener("test",tr,tr),window.removeEventListener("test",tr,tr)}catch{es=!1}var Rs=null,za=null,ca=null;function Il(){if(ca)return ca;var s,i=za,l=i.length,u,m="value"in Rs?Rs.value:Rs.textContent,g=m.length;for(s=0;s<l&&i[s]===m[s];s++);var T=l-s;for(u=1;u<=T&&i[l-u]===m[g-u];u++);return ca=m.slice(s,1<u?1-u:void 0)}function Ds(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function Os(){return!0}function Rl(){return!1}function $t(s){function i(l,u,m,g,T){this._reactName=l,this._targetInst=m,this.type=u,this.nativeEvent=g,this.target=T,this.currentTarget=null;for(var S in s)s.hasOwnProperty(S)&&(l=s[S],this[S]=l?l(g):g[S]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Os:Rl,this.isPropagationStopped=Rl,this}return _(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Os)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Os)},persist:function(){},isPersistent:Os}),i}var st={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xr=$t(st),nr=_({},st,{view:0,detail:0}),Ru=$t(nr),Wr,Zr,Ms,sr=_({},nr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rr,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ms&&(Ms&&s.type==="mousemove"?(Wr=s.screenX-Ms.screenX,Zr=s.screenY-Ms.screenY):Zr=Wr=0,Ms=s),Wr)},movementY:function(s){return"movementY"in s?s.movementY:Zr}}),ts=$t(sr),Du=_({},sr,{dataTransfer:0}),Af=$t(Du),ar=_({},nr,{relatedTarget:0}),Jr=$t(ar),Dl=_({},st,{animationName:0,elapsedTime:0,pseudoElement:0}),eo=$t(Dl),Ou=_({},st,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),to=$t(Ou),Cf=_({},st,{data:0}),Ol=$t(Cf),ir={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Pu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ml(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=Pu[s])?!!i[s]:!1}function rr(){return Ml}var ku=_({},nr,{key:function(s){if(s.key){var i=ir[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Ds(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Mu[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rr,charCode:function(s){return s.type==="keypress"?Ds(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ds(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),no=$t(ku),Lu=_({},sr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Pl=$t(Lu),ua=_({},nr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rr}),Vu=$t(ua),Uu=_({},st,{propertyName:0,elapsedTime:0,pseudoElement:0}),Fu=$t(Uu),Hu=_({},sr,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),so=$t(Hu),Nn=_({},st,{newState:0,oldState:0}),qu=$t(Nn),Bu=[9,13,27,32],Ps=ms&&"CompositionEvent"in window,h=null;ms&&"documentMode"in document&&(h=document.documentMode);var y=ms&&"TextEvent"in window&&!h,E=ms&&(!Ps||h&&8<h&&11>=h),D=" ",K=!1;function te(s,i){switch(s){case"keyup":return Bu.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function de(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Qe=!1;function Vt(s,i){switch(s){case"compositionend":return de(i);case"keypress":return i.which!==32?null:(K=!0,D);case"textInput":return s=i.data,s===D&&K?null:s;default:return null}}function Xe(s,i){if(Qe)return s==="compositionend"||!Ps&&te(s,i)?(s=Il(),ca=za=Rs=null,Qe=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return E&&i.locale!=="ko"?null:i.data;default:return null}}var Yt={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ut(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!Yt[s.type]:i==="textarea"}function da(s,i,l,u){oa?la?la.push(u):la=[u]:oa=u,i=wd(i,"onChange"),0<i.length&&(l=new Xr("onChange","change",null,l,u),s.push({event:l,listeners:i}))}var en=null,ks=null;function kl(s){CE(s,0)}function zu(s){var i=Ss(s);if(Cl(i))return s}function Yv(s,i){if(s==="change")return i}var Kv=!1;if(ms){var jf;if(ms){var Sf="oninput"in document;if(!Sf){var Qv=document.createElement("div");Qv.setAttribute("oninput","return;"),Sf=typeof Qv.oninput=="function"}jf=Sf}else jf=!1;Kv=jf&&(!document.documentMode||9<document.documentMode)}function Xv(){en&&(en.detachEvent("onpropertychange",Wv),ks=en=null)}function Wv(s){if(s.propertyName==="value"&&zu(ks)){var i=[];da(i,ks,s,Jn(s)),Iu(kl,i)}}function jC(s,i,l){s==="focusin"?(Xv(),en=i,ks=l,en.attachEvent("onpropertychange",Wv)):s==="focusout"&&Xv()}function SC(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return zu(ks)}function wC(s,i){if(s==="click")return zu(i)}function IC(s,i){if(s==="input"||s==="change")return zu(i)}function RC(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var Ln=typeof Object.is=="function"?Object.is:RC;function Ll(s,i){if(Ln(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var l=Object.keys(s),u=Object.keys(i);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var m=l[u];if(!Ui.call(i,m)||!Ln(s[m],i[m]))return!1}return!0}function Zv(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Jv(s,i){var l=Zv(s);s=0;for(var u;l;){if(l.nodeType===3){if(u=s+l.textContent.length,s<=i&&u>=i)return{node:l,offset:i-s};s=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Zv(l)}}function ey(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?ey(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function ty(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var i=Xi(s.document);i instanceof s.HTMLIFrameElement;){try{var l=typeof i.contentWindow.location.href=="string"}catch{l=!1}if(l)s=i.contentWindow;else break;i=Xi(s.document)}return i}function wf(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}var DC=ms&&"documentMode"in document&&11>=document.documentMode,ao=null,If=null,Vl=null,Rf=!1;function ny(s,i,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Rf||ao==null||ao!==Xi(u)||(u=ao,"selectionStart"in u&&wf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Vl&&Ll(Vl,u)||(Vl=u,u=wd(If,"onSelect"),0<u.length&&(i=new Xr("onSelect","select",null,i,l),s.push({event:i,listeners:u}),i.target=ao)))}function or(s,i){var l={};return l[s.toLowerCase()]=i.toLowerCase(),l["Webkit"+s]="webkit"+i,l["Moz"+s]="moz"+i,l}var io={animationend:or("Animation","AnimationEnd"),animationiteration:or("Animation","AnimationIteration"),animationstart:or("Animation","AnimationStart"),transitionrun:or("Transition","TransitionRun"),transitionstart:or("Transition","TransitionStart"),transitioncancel:or("Transition","TransitionCancel"),transitionend:or("Transition","TransitionEnd")},Df={},sy={};ms&&(sy=document.createElement("div").style,"AnimationEvent"in window||(delete io.animationend.animation,delete io.animationiteration.animation,delete io.animationstart.animation),"TransitionEvent"in window||delete io.transitionend.transition);function lr(s){if(Df[s])return Df[s];if(!io[s])return s;var i=io[s],l;for(l in i)if(i.hasOwnProperty(l)&&l in sy)return Df[s]=i[l];return s}var ay=lr("animationend"),iy=lr("animationiteration"),ry=lr("animationstart"),OC=lr("transitionrun"),MC=lr("transitionstart"),PC=lr("transitioncancel"),oy=lr("transitionend"),ly=new Map,Of="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Of.push("scrollEnd");function ps(s,i){ly.set(s,i),fs(i,[s])}var cy=new WeakMap;function ns(s,i){if(typeof s=="object"&&s!==null){var l=cy.get(s);return l!==void 0?l:(i={value:s,source:i,stack:Yr(i)},cy.set(s,i),i)}return{value:s,source:i,stack:Yr(i)}}var ss=[],ro=0,Mf=0;function Gu(){for(var s=ro,i=Mf=ro=0;i<s;){var l=ss[i];ss[i++]=null;var u=ss[i];ss[i++]=null;var m=ss[i];ss[i++]=null;var g=ss[i];if(ss[i++]=null,u!==null&&m!==null){var T=u.pending;T===null?m.next=m:(m.next=T.next,T.next=m),u.pending=m}g!==0&&uy(l,m,g)}}function $u(s,i,l,u){ss[ro++]=s,ss[ro++]=i,ss[ro++]=l,ss[ro++]=u,Mf|=u,s.lanes|=u,s=s.alternate,s!==null&&(s.lanes|=u)}function Pf(s,i,l,u){return $u(s,i,l,u),Yu(s)}function oo(s,i){return $u(s,null,null,i),Yu(s)}function uy(s,i,l){s.lanes|=l;var u=s.alternate;u!==null&&(u.lanes|=l);for(var m=!1,g=s.return;g!==null;)g.childLanes|=l,u=g.alternate,u!==null&&(u.childLanes|=l),g.tag===22&&(s=g.stateNode,s===null||s._visibility&1||(m=!0)),s=g,g=g.return;return s.tag===3?(g=s.stateNode,m&&i!==null&&(m=31-hn(l),s=g.hiddenUpdates,u=s[m],u===null?s[m]=[i]:u.push(i),i.lane=l|536870912),g):null}function Yu(s){if(50<cc)throw cc=0,Hm=null,Error(a(185));for(var i=s.return;i!==null;)s=i,i=s.return;return s.tag===3?s.stateNode:null}var lo={};function kC(s,i,l,u){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vn(s,i,l,u){return new kC(s,i,l,u)}function kf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ha(s,i){var l=s.alternate;return l===null?(l=Vn(s.tag,i,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=i,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,i=s.dependencies,l.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function dy(s,i){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,i=l.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),s}function Ku(s,i,l,u,m,g){var T=0;if(u=s,typeof s=="function")kf(s)&&(T=1);else if(typeof s=="string")T=Vj(s,l,xe.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case R:return s=Vn(31,l,i,m),s.elementType=R,s.lanes=g,s;case b:return cr(l.children,m,g,i);case M:T=8,m|=24;break;case x:return s=Vn(12,l,i,m|2),s.elementType=x,s.lanes=g,s;case F:return s=Vn(13,l,i,m),s.elementType=F,s.lanes=g,s;case X:return s=Vn(19,l,i,m),s.elementType=X,s.lanes=g,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case L:case O:T=10;break e;case $:T=9;break e;case U:T=11;break e;case w:T=14;break e;case A:T=16,u=null;break e}T=29,l=Error(a(130,s===null?"null":typeof s,"")),u=null}return i=Vn(T,l,i,m),i.elementType=s,i.type=u,i.lanes=g,i}function cr(s,i,l,u){return s=Vn(7,s,u,i),s.lanes=l,s}function Lf(s,i,l){return s=Vn(6,s,null,i),s.lanes=l,s}function Vf(s,i,l){return i=Vn(4,s.children!==null?s.children:[],s.key,i),i.lanes=l,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}var co=[],uo=0,Qu=null,Xu=0,as=[],is=0,ur=null,fa=1,ma="";function dr(s,i){co[uo++]=Xu,co[uo++]=Qu,Qu=s,Xu=i}function hy(s,i,l){as[is++]=fa,as[is++]=ma,as[is++]=ur,ur=s;var u=fa;s=ma;var m=32-hn(u)-1;u&=~(1<<m),l+=1;var g=32-hn(i)+m;if(30<g){var T=m-m%5;g=(u&(1<<T)-1).toString(32),u>>=T,m-=T,fa=1<<32-hn(i)+m|l<<m|u,ma=g+s}else fa=1<<g|l<<m|u,ma=s}function Uf(s){s.return!==null&&(dr(s,1),hy(s,1,0))}function Ff(s){for(;s===Qu;)Qu=co[--uo],co[uo]=null,Xu=co[--uo],co[uo]=null;for(;s===ur;)ur=as[--is],as[is]=null,ma=as[--is],as[is]=null,fa=as[--is],as[is]=null}var Tn=null,Nt=null,nt=!1,hr=null,Ls=!1,Hf=Error(a(519));function fr(s){var i=Error(a(418,""));throw Hl(ns(i,s)),Hf}function fy(s){var i=s.stateNode,l=s.type,u=s.memoizedProps;switch(i[Lt]=s,i[It]=u,l){case"dialog":Be("cancel",i),Be("close",i);break;case"iframe":case"object":case"embed":Be("load",i);break;case"video":case"audio":for(l=0;l<dc.length;l++)Be(dc[l],i);break;case"source":Be("error",i);break;case"img":case"image":case"link":Be("error",i),Be("load",i);break;case"details":Be("toggle",i);break;case"input":Be("invalid",i),Wi(i,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),Kr(i);break;case"select":Be("invalid",i);break;case"textarea":Be("invalid",i),Zi(i,u.value,u.defaultValue,u.children),Kr(i)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||i.textContent===""+l||u.suppressHydrationWarning===!0||IE(i.textContent,l)?(u.popover!=null&&(Be("beforetoggle",i),Be("toggle",i)),u.onScroll!=null&&Be("scroll",i),u.onScrollEnd!=null&&Be("scrollend",i),u.onClick!=null&&(i.onclick=Id),i=!0):i=!1,i||fr(s)}function my(s){for(Tn=s.return;Tn;)switch(Tn.tag){case 5:case 13:Ls=!1;return;case 27:case 3:Ls=!0;return;default:Tn=Tn.return}}function Ul(s){if(s!==Tn)return!1;if(!nt)return my(s),nt=!0,!1;var i=s.tag,l;if((l=i!==3&&i!==27)&&((l=i===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||sp(s.type,s.memoizedProps)),l=!l),l&&Nt&&fr(s),my(s),i===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(a(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8)if(l=s.data,l==="/$"){if(i===0){Nt=vs(s.nextSibling);break e}i--}else l!=="$"&&l!=="$!"&&l!=="$?"||i++;s=s.nextSibling}Nt=null}}else i===27?(i=Nt,ri(s.type)?(s=op,op=null,Nt=s):Nt=i):Nt=Tn?vs(s.stateNode.nextSibling):null;return!0}function Fl(){Nt=Tn=null,nt=!1}function py(){var s=hr;return s!==null&&(In===null?In=s:In.push.apply(In,s),hr=null),s}function Hl(s){hr===null?hr=[s]:hr.push(s)}var qf=ne(null),mr=null,pa=null;function Ga(s,i,l){ue(qf,i._currentValue),i._currentValue=l}function ga(s){s._currentValue=qf.current,he(qf)}function Bf(s,i,l){for(;s!==null;){var u=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,u!==null&&(u.childLanes|=i)):u!==null&&(u.childLanes&i)!==i&&(u.childLanes|=i),s===l)break;s=s.return}}function zf(s,i,l,u){var m=s.child;for(m!==null&&(m.return=s);m!==null;){var g=m.dependencies;if(g!==null){var T=m.child;g=g.firstContext;e:for(;g!==null;){var S=g;g=m;for(var H=0;H<i.length;H++)if(S.context===i[H]){g.lanes|=l,S=g.alternate,S!==null&&(S.lanes|=l),Bf(g.return,l,s),u||(T=null);break e}g=S.next}}else if(m.tag===18){if(T=m.return,T===null)throw Error(a(341));T.lanes|=l,g=T.alternate,g!==null&&(g.lanes|=l),Bf(T,l,s),T=null}else T=m.child;if(T!==null)T.return=m;else for(T=m;T!==null;){if(T===s){T=null;break}if(m=T.sibling,m!==null){m.return=T.return,T=m;break}T=T.return}m=T}}function ql(s,i,l,u){s=null;for(var m=i,g=!1;m!==null;){if(!g){if((m.flags&524288)!==0)g=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var T=m.alternate;if(T===null)throw Error(a(387));if(T=T.memoizedProps,T!==null){var S=m.type;Ln(m.pendingProps.value,T.value)||(s!==null?s.push(S):s=[S])}}else if(m===Gt.current){if(T=m.alternate,T===null)throw Error(a(387));T.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(s!==null?s.push(vc):s=[vc])}m=m.return}s!==null&&zf(i,s,l,u),i.flags|=262144}function Wu(s){for(s=s.firstContext;s!==null;){if(!Ln(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function pr(s){mr=s,pa=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function fn(s){return gy(mr,s)}function Zu(s,i){return mr===null&&pr(s),gy(s,i)}function gy(s,i){var l=i._currentValue;if(i={context:i,memoizedValue:l,next:null},pa===null){if(s===null)throw Error(a(308));pa=i,s.dependencies={lanes:0,firstContext:i},s.flags|=524288}else pa=pa.next=i;return l}var LC=typeof AbortController<"u"?AbortController:function(){var s=[],i=this.signal={aborted:!1,addEventListener:function(l,u){s.push(u)}};this.abort=function(){i.aborted=!0,s.forEach(function(l){return l()})}},VC=n.unstable_scheduleCallback,UC=n.unstable_NormalPriority,Ft={$$typeof:O,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Gf(){return{controller:new LC,data:new Map,refCount:0}}function Bl(s){s.refCount--,s.refCount===0&&VC(UC,function(){s.controller.abort()})}var zl=null,$f=0,ho=0,fo=null;function FC(s,i){if(zl===null){var l=zl=[];$f=0,ho=Km(),fo={status:"pending",value:void 0,then:function(u){l.push(u)}}}return $f++,i.then(vy,vy),i}function vy(){if(--$f===0&&zl!==null){fo!==null&&(fo.status="fulfilled");var s=zl;zl=null,ho=0,fo=null;for(var i=0;i<s.length;i++)(0,s[i])()}}function HC(s,i){var l=[],u={status:"pending",value:null,reason:null,then:function(m){l.push(m)}};return s.then(function(){u.status="fulfilled",u.value=i;for(var m=0;m<l.length;m++)(0,l[m])(i)},function(m){for(u.status="rejected",u.reason=m,m=0;m<l.length;m++)(0,l[m])(void 0)}),u}var yy=B.S;B.S=function(s,i){typeof i=="object"&&i!==null&&typeof i.then=="function"&&FC(s,i),yy!==null&&yy(s,i)};var gr=ne(null);function Yf(){var s=gr.current;return s!==null?s:pt.pooledCache}function Ju(s,i){i===null?ue(gr,gr.current):ue(gr,i.pool)}function _y(){var s=Yf();return s===null?null:{parent:Ft._currentValue,pool:s}}var Gl=Error(a(460)),Ey=Error(a(474)),ed=Error(a(542)),Kf={then:function(){}};function by(s){return s=s.status,s==="fulfilled"||s==="rejected"}function td(){}function Ny(s,i,l){switch(l=s[l],l===void 0?s.push(i):l!==i&&(i.then(td,td),i=l),i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,xy(s),s;default:if(typeof i.status=="string")i.then(td,td);else{if(s=pt,s!==null&&100<s.shellSuspendCounter)throw Error(a(482));s=i,s.status="pending",s.then(function(u){if(i.status==="pending"){var m=i;m.status="fulfilled",m.value=u}},function(u){if(i.status==="pending"){var m=i;m.status="rejected",m.reason=u}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,xy(s),s}throw $l=i,Gl}}var $l=null;function Ty(){if($l===null)throw Error(a(459));var s=$l;return $l=null,s}function xy(s){if(s===Gl||s===ed)throw Error(a(483))}var $a=!1;function Qf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Xf(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ya(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ka(s,i,l){var u=s.updateQueue;if(u===null)return null;if(u=u.shared,(it&2)!==0){var m=u.pending;return m===null?i.next=i:(i.next=m.next,m.next=i),u.pending=i,i=Yu(s),uy(s,null,l),i}return $u(s,u,i,l),Yu(s)}function Yl(s,i,l){if(i=i.updateQueue,i!==null&&(i=i.shared,(l&4194048)!==0)){var u=i.lanes;u&=s.pendingLanes,l|=u,i.lanes=l,bl(s,l)}}function Wf(s,i){var l=s.updateQueue,u=s.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var m=null,g=null;if(l=l.firstBaseUpdate,l!==null){do{var T={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};g===null?m=g=T:g=g.next=T,l=l.next}while(l!==null);g===null?m=g=i:g=g.next=i}else m=g=i;l={baseState:u.baseState,firstBaseUpdate:m,lastBaseUpdate:g,shared:u.shared,callbacks:u.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=i:s.next=i,l.lastBaseUpdate=i}var Zf=!1;function Kl(){if(Zf){var s=fo;if(s!==null)throw s}}function Ql(s,i,l,u){Zf=!1;var m=s.updateQueue;$a=!1;var g=m.firstBaseUpdate,T=m.lastBaseUpdate,S=m.shared.pending;if(S!==null){m.shared.pending=null;var H=S,W=H.next;H.next=null,T===null?g=W:T.next=W,T=H;var se=s.alternate;se!==null&&(se=se.updateQueue,S=se.lastBaseUpdate,S!==T&&(S===null?se.firstBaseUpdate=W:S.next=W,se.lastBaseUpdate=H))}if(g!==null){var oe=m.baseState;T=0,se=W=H=null,S=g;do{var Z=S.lane&-536870913,ee=Z!==S.lane;if(ee?(We&Z)===Z:(u&Z)===Z){Z!==0&&Z===ho&&(Zf=!0),se!==null&&(se=se.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var Ie=s,Ce=S;Z=i;var ut=l;switch(Ce.tag){case 1:if(Ie=Ce.payload,typeof Ie=="function"){oe=Ie.call(ut,oe,Z);break e}oe=Ie;break e;case 3:Ie.flags=Ie.flags&-65537|128;case 0:if(Ie=Ce.payload,Z=typeof Ie=="function"?Ie.call(ut,oe,Z):Ie,Z==null)break e;oe=_({},oe,Z);break e;case 2:$a=!0}}Z=S.callback,Z!==null&&(s.flags|=64,ee&&(s.flags|=8192),ee=m.callbacks,ee===null?m.callbacks=[Z]:ee.push(Z))}else ee={lane:Z,tag:S.tag,payload:S.payload,callback:S.callback,next:null},se===null?(W=se=ee,H=oe):se=se.next=ee,T|=Z;if(S=S.next,S===null){if(S=m.shared.pending,S===null)break;ee=S,S=ee.next,ee.next=null,m.lastBaseUpdate=ee,m.shared.pending=null}}while(!0);se===null&&(H=oe),m.baseState=H,m.firstBaseUpdate=W,m.lastBaseUpdate=se,g===null&&(m.shared.lanes=0),ni|=T,s.lanes=T,s.memoizedState=oe}}function Ay(s,i){if(typeof s!="function")throw Error(a(191,s));s.call(i)}function Cy(s,i){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)Ay(l[s],i)}var mo=ne(null),nd=ne(0);function jy(s,i){s=Ta,ue(nd,s),ue(mo,i),Ta=s|i.baseLanes}function Jf(){ue(nd,Ta),ue(mo,mo.current)}function em(){Ta=nd.current,he(mo),he(nd)}var Qa=0,Ve=null,lt=null,Dt=null,sd=!1,po=!1,vr=!1,ad=0,Xl=0,go=null,qC=0;function Ct(){throw Error(a(321))}function tm(s,i){if(i===null)return!1;for(var l=0;l<i.length&&l<s.length;l++)if(!Ln(s[l],i[l]))return!1;return!0}function nm(s,i,l,u,m,g){return Qa=g,Ve=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,B.H=s===null||s.memoizedState===null?u_:d_,vr=!1,g=l(u,m),vr=!1,po&&(g=wy(i,l,u,m)),Sy(s),g}function Sy(s){B.H=ud;var i=lt!==null&&lt.next!==null;if(Qa=0,Dt=lt=Ve=null,sd=!1,Xl=0,go=null,i)throw Error(a(300));s===null||Kt||(s=s.dependencies,s!==null&&Wu(s)&&(Kt=!0))}function wy(s,i,l,u){Ve=s;var m=0;do{if(po&&(go=null),Xl=0,po=!1,25<=m)throw Error(a(301));if(m+=1,Dt=lt=null,s.updateQueue!=null){var g=s.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}B.H=QC,g=i(l,u)}while(po);return g}function BC(){var s=B.H,i=s.useState()[0];return i=typeof i.then=="function"?Wl(i):i,s=s.useState()[0],(lt!==null?lt.memoizedState:null)!==s&&(Ve.flags|=1024),i}function sm(){var s=ad!==0;return ad=0,s}function am(s,i,l){i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~l}function im(s){if(sd){for(s=s.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}sd=!1}Qa=0,Dt=lt=Ve=null,po=!1,Xl=ad=0,go=null}function Sn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dt===null?Ve.memoizedState=Dt=s:Dt=Dt.next=s,Dt}function Ot(){if(lt===null){var s=Ve.alternate;s=s!==null?s.memoizedState:null}else s=lt.next;var i=Dt===null?Ve.memoizedState:Dt.next;if(i!==null)Dt=i,lt=s;else{if(s===null)throw Ve.alternate===null?Error(a(467)):Error(a(310));lt=s,s={memoizedState:lt.memoizedState,baseState:lt.baseState,baseQueue:lt.baseQueue,queue:lt.queue,next:null},Dt===null?Ve.memoizedState=Dt=s:Dt=Dt.next=s}return Dt}function rm(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Wl(s){var i=Xl;return Xl+=1,go===null&&(go=[]),s=Ny(go,s,i),i=Ve,(Dt===null?i.memoizedState:Dt.next)===null&&(i=i.alternate,B.H=i===null||i.memoizedState===null?u_:d_),s}function id(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Wl(s);if(s.$$typeof===O)return fn(s)}throw Error(a(438,String(s)))}function om(s){var i=null,l=Ve.updateQueue;if(l!==null&&(i=l.memoCache),i==null){var u=Ve.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(i={data:u.data.map(function(m){return m.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),l===null&&(l=rm(),Ve.updateQueue=l),l.memoCache=i,l=i.data[i.index],l===void 0)for(l=i.data[i.index]=Array(s),u=0;u<s;u++)l[u]=I;return i.index++,l}function va(s,i){return typeof i=="function"?i(s):i}function rd(s){var i=Ot();return lm(i,lt,s)}function lm(s,i,l){var u=s.queue;if(u===null)throw Error(a(311));u.lastRenderedReducer=l;var m=s.baseQueue,g=u.pending;if(g!==null){if(m!==null){var T=m.next;m.next=g.next,g.next=T}i.baseQueue=m=g,u.pending=null}if(g=s.baseState,m===null)s.memoizedState=g;else{i=m.next;var S=T=null,H=null,W=i,se=!1;do{var oe=W.lane&-536870913;if(oe!==W.lane?(We&oe)===oe:(Qa&oe)===oe){var Z=W.revertLane;if(Z===0)H!==null&&(H=H.next={lane:0,revertLane:0,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null}),oe===ho&&(se=!0);else if((Qa&Z)===Z){W=W.next,Z===ho&&(se=!0);continue}else oe={lane:0,revertLane:W.revertLane,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},H===null?(S=H=oe,T=g):H=H.next=oe,Ve.lanes|=Z,ni|=Z;oe=W.action,vr&&l(g,oe),g=W.hasEagerState?W.eagerState:l(g,oe)}else Z={lane:oe,revertLane:W.revertLane,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},H===null?(S=H=Z,T=g):H=H.next=Z,Ve.lanes|=oe,ni|=oe;W=W.next}while(W!==null&&W!==i);if(H===null?T=g:H.next=S,!Ln(g,s.memoizedState)&&(Kt=!0,se&&(l=fo,l!==null)))throw l;s.memoizedState=g,s.baseState=T,s.baseQueue=H,u.lastRenderedState=g}return m===null&&(u.lanes=0),[s.memoizedState,u.dispatch]}function cm(s){var i=Ot(),l=i.queue;if(l===null)throw Error(a(311));l.lastRenderedReducer=s;var u=l.dispatch,m=l.pending,g=i.memoizedState;if(m!==null){l.pending=null;var T=m=m.next;do g=s(g,T.action),T=T.next;while(T!==m);Ln(g,i.memoizedState)||(Kt=!0),i.memoizedState=g,i.baseQueue===null&&(i.baseState=g),l.lastRenderedState=g}return[g,u]}function Iy(s,i,l){var u=Ve,m=Ot(),g=nt;if(g){if(l===void 0)throw Error(a(407));l=l()}else l=i();var T=!Ln((lt||m).memoizedState,l);T&&(m.memoizedState=l,Kt=!0),m=m.queue;var S=Oy.bind(null,u,m,s);if(Zl(2048,8,S,[s]),m.getSnapshot!==i||T||Dt!==null&&Dt.memoizedState.tag&1){if(u.flags|=2048,vo(9,od(),Dy.bind(null,u,m,l,i),null),pt===null)throw Error(a(349));g||(Qa&124)!==0||Ry(u,i,l)}return l}function Ry(s,i,l){s.flags|=16384,s={getSnapshot:i,value:l},i=Ve.updateQueue,i===null?(i=rm(),Ve.updateQueue=i,i.stores=[s]):(l=i.stores,l===null?i.stores=[s]:l.push(s))}function Dy(s,i,l,u){i.value=l,i.getSnapshot=u,My(i)&&Py(s)}function Oy(s,i,l){return l(function(){My(i)&&Py(s)})}function My(s){var i=s.getSnapshot;s=s.value;try{var l=i();return!Ln(s,l)}catch{return!0}}function Py(s){var i=oo(s,2);i!==null&&Bn(i,s,2)}function um(s){var i=Sn();if(typeof s=="function"){var l=s;if(s=l(),vr){Pn(!0);try{l()}finally{Pn(!1)}}}return i.memoizedState=i.baseState=s,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:va,lastRenderedState:s},i}function ky(s,i,l,u){return s.baseState=l,lm(s,lt,typeof u=="function"?u:va)}function zC(s,i,l,u,m){if(cd(s))throw Error(a(485));if(s=i.action,s!==null){var g={payload:m,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){g.listeners.push(T)}};B.T!==null?l(!0):g.isTransition=!1,u(g),l=i.pending,l===null?(g.next=i.pending=g,Ly(i,g)):(g.next=l.next,i.pending=l.next=g)}}function Ly(s,i){var l=i.action,u=i.payload,m=s.state;if(i.isTransition){var g=B.T,T={};B.T=T;try{var S=l(m,u),H=B.S;H!==null&&H(T,S),Vy(s,i,S)}catch(W){dm(s,i,W)}finally{B.T=g}}else try{g=l(m,u),Vy(s,i,g)}catch(W){dm(s,i,W)}}function Vy(s,i,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){Uy(s,i,u)},function(u){return dm(s,i,u)}):Uy(s,i,l)}function Uy(s,i,l){i.status="fulfilled",i.value=l,Fy(i),s.state=l,i=s.pending,i!==null&&(l=i.next,l===i?s.pending=null:(l=l.next,i.next=l,Ly(s,l)))}function dm(s,i,l){var u=s.pending;if(s.pending=null,u!==null){u=u.next;do i.status="rejected",i.reason=l,Fy(i),i=i.next;while(i!==u)}s.action=null}function Fy(s){s=s.listeners;for(var i=0;i<s.length;i++)(0,s[i])()}function Hy(s,i){return i}function qy(s,i){if(nt){var l=pt.formState;if(l!==null){e:{var u=Ve;if(nt){if(Nt){t:{for(var m=Nt,g=Ls;m.nodeType!==8;){if(!g){m=null;break t}if(m=vs(m.nextSibling),m===null){m=null;break t}}g=m.data,m=g==="F!"||g==="F"?m:null}if(m){Nt=vs(m.nextSibling),u=m.data==="F!";break e}}fr(u)}u=!1}u&&(i=l[0])}}return l=Sn(),l.memoizedState=l.baseState=i,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hy,lastRenderedState:i},l.queue=u,l=o_.bind(null,Ve,u),u.dispatch=l,u=um(!1),g=gm.bind(null,Ve,!1,u.queue),u=Sn(),m={state:i,dispatch:null,action:s,pending:null},u.queue=m,l=zC.bind(null,Ve,m,g,l),m.dispatch=l,u.memoizedState=s,[i,l,!1]}function By(s){var i=Ot();return zy(i,lt,s)}function zy(s,i,l){if(i=lm(s,i,Hy)[0],s=rd(va)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var u=Wl(i)}catch(T){throw T===Gl?ed:T}else u=i;i=Ot();var m=i.queue,g=m.dispatch;return l!==i.memoizedState&&(Ve.flags|=2048,vo(9,od(),GC.bind(null,m,l),null)),[u,g,s]}function GC(s,i){s.action=i}function Gy(s){var i=Ot(),l=lt;if(l!==null)return zy(i,l,s);Ot(),i=i.memoizedState,l=Ot();var u=l.queue.dispatch;return l.memoizedState=s,[i,u,!1]}function vo(s,i,l,u){return s={tag:s,create:l,deps:u,inst:i,next:null},i=Ve.updateQueue,i===null&&(i=rm(),Ve.updateQueue=i),l=i.lastEffect,l===null?i.lastEffect=s.next=s:(u=l.next,l.next=s,s.next=u,i.lastEffect=s),s}function od(){return{destroy:void 0,resource:void 0}}function $y(){return Ot().memoizedState}function ld(s,i,l,u){var m=Sn();u=u===void 0?null:u,Ve.flags|=s,m.memoizedState=vo(1|i,od(),l,u)}function Zl(s,i,l,u){var m=Ot();u=u===void 0?null:u;var g=m.memoizedState.inst;lt!==null&&u!==null&&tm(u,lt.memoizedState.deps)?m.memoizedState=vo(i,g,l,u):(Ve.flags|=s,m.memoizedState=vo(1|i,g,l,u))}function Yy(s,i){ld(8390656,8,s,i)}function Ky(s,i){Zl(2048,8,s,i)}function Qy(s,i){return Zl(4,2,s,i)}function Xy(s,i){return Zl(4,4,s,i)}function Wy(s,i){if(typeof i=="function"){s=s();var l=i(s);return function(){typeof l=="function"?l():i(null)}}if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function Zy(s,i,l){l=l!=null?l.concat([s]):null,Zl(4,4,Wy.bind(null,i,s),l)}function hm(){}function Jy(s,i){var l=Ot();i=i===void 0?null:i;var u=l.memoizedState;return i!==null&&tm(i,u[1])?u[0]:(l.memoizedState=[s,i],s)}function e_(s,i){var l=Ot();i=i===void 0?null:i;var u=l.memoizedState;if(i!==null&&tm(i,u[1]))return u[0];if(u=s(),vr){Pn(!0);try{s()}finally{Pn(!1)}}return l.memoizedState=[u,i],u}function fm(s,i,l){return l===void 0||(Qa&1073741824)!==0?s.memoizedState=i:(s.memoizedState=l,s=sE(),Ve.lanes|=s,ni|=s,l)}function t_(s,i,l,u){return Ln(l,i)?l:mo.current!==null?(s=fm(s,l,u),Ln(s,i)||(Kt=!0),s):(Qa&42)===0?(Kt=!0,s.memoizedState=l):(s=sE(),Ve.lanes|=s,ni|=s,i)}function n_(s,i,l,u,m){var g=J.p;J.p=g!==0&&8>g?g:8;var T=B.T,S={};B.T=S,gm(s,!1,i,l);try{var H=m(),W=B.S;if(W!==null&&W(S,H),H!==null&&typeof H=="object"&&typeof H.then=="function"){var se=HC(H,u);Jl(s,i,se,qn(s))}else Jl(s,i,u,qn(s))}catch(oe){Jl(s,i,{then:function(){},status:"rejected",reason:oe},qn())}finally{J.p=g,B.T=T}}function $C(){}function mm(s,i,l,u){if(s.tag!==5)throw Error(a(476));var m=s_(s).queue;n_(s,m,i,ce,l===null?$C:function(){return a_(s),l(u)})}function s_(s){var i=s.memoizedState;if(i!==null)return i;i={memoizedState:ce,baseState:ce,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:va,lastRenderedState:ce},next:null};var l={};return i.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:va,lastRenderedState:l},next:null},s.memoizedState=i,s=s.alternate,s!==null&&(s.memoizedState=i),i}function a_(s){var i=s_(s).next.queue;Jl(s,i,{},qn())}function pm(){return fn(vc)}function i_(){return Ot().memoizedState}function r_(){return Ot().memoizedState}function YC(s){for(var i=s.return;i!==null;){switch(i.tag){case 24:case 3:var l=qn();s=Ya(l);var u=Ka(i,s,l);u!==null&&(Bn(u,i,l),Yl(u,i,l)),i={cache:Gf()},s.payload=i;return}i=i.return}}function KC(s,i,l){var u=qn();l={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},cd(s)?l_(i,l):(l=Pf(s,i,l,u),l!==null&&(Bn(l,s,u),c_(l,i,u)))}function o_(s,i,l){var u=qn();Jl(s,i,l,u)}function Jl(s,i,l,u){var m={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(cd(s))l_(i,m);else{var g=s.alternate;if(s.lanes===0&&(g===null||g.lanes===0)&&(g=i.lastRenderedReducer,g!==null))try{var T=i.lastRenderedState,S=g(T,l);if(m.hasEagerState=!0,m.eagerState=S,Ln(S,T))return $u(s,i,m,0),pt===null&&Gu(),!1}catch{}finally{}if(l=Pf(s,i,m,u),l!==null)return Bn(l,s,u),c_(l,i,u),!0}return!1}function gm(s,i,l,u){if(u={lane:2,revertLane:Km(),action:u,hasEagerState:!1,eagerState:null,next:null},cd(s)){if(i)throw Error(a(479))}else i=Pf(s,l,u,2),i!==null&&Bn(i,s,2)}function cd(s){var i=s.alternate;return s===Ve||i!==null&&i===Ve}function l_(s,i){po=sd=!0;var l=s.pending;l===null?i.next=i:(i.next=l.next,l.next=i),s.pending=i}function c_(s,i,l){if((l&4194048)!==0){var u=i.lanes;u&=s.pendingLanes,l|=u,i.lanes=l,bl(s,l)}}var ud={readContext:fn,use:id,useCallback:Ct,useContext:Ct,useEffect:Ct,useImperativeHandle:Ct,useLayoutEffect:Ct,useInsertionEffect:Ct,useMemo:Ct,useReducer:Ct,useRef:Ct,useState:Ct,useDebugValue:Ct,useDeferredValue:Ct,useTransition:Ct,useSyncExternalStore:Ct,useId:Ct,useHostTransitionStatus:Ct,useFormState:Ct,useActionState:Ct,useOptimistic:Ct,useMemoCache:Ct,useCacheRefresh:Ct},u_={readContext:fn,use:id,useCallback:function(s,i){return Sn().memoizedState=[s,i===void 0?null:i],s},useContext:fn,useEffect:Yy,useImperativeHandle:function(s,i,l){l=l!=null?l.concat([s]):null,ld(4194308,4,Wy.bind(null,i,s),l)},useLayoutEffect:function(s,i){return ld(4194308,4,s,i)},useInsertionEffect:function(s,i){ld(4,2,s,i)},useMemo:function(s,i){var l=Sn();i=i===void 0?null:i;var u=s();if(vr){Pn(!0);try{s()}finally{Pn(!1)}}return l.memoizedState=[u,i],u},useReducer:function(s,i,l){var u=Sn();if(l!==void 0){var m=l(i);if(vr){Pn(!0);try{l(i)}finally{Pn(!1)}}}else m=i;return u.memoizedState=u.baseState=m,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:m},u.queue=s,s=s.dispatch=KC.bind(null,Ve,s),[u.memoizedState,s]},useRef:function(s){var i=Sn();return s={current:s},i.memoizedState=s},useState:function(s){s=um(s);var i=s.queue,l=o_.bind(null,Ve,i);return i.dispatch=l,[s.memoizedState,l]},useDebugValue:hm,useDeferredValue:function(s,i){var l=Sn();return fm(l,s,i)},useTransition:function(){var s=um(!1);return s=n_.bind(null,Ve,s.queue,!0,!1),Sn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,i,l){var u=Ve,m=Sn();if(nt){if(l===void 0)throw Error(a(407));l=l()}else{if(l=i(),pt===null)throw Error(a(349));(We&124)!==0||Ry(u,i,l)}m.memoizedState=l;var g={value:l,getSnapshot:i};return m.queue=g,Yy(Oy.bind(null,u,g,s),[s]),u.flags|=2048,vo(9,od(),Dy.bind(null,u,g,l,i),null),l},useId:function(){var s=Sn(),i=pt.identifierPrefix;if(nt){var l=ma,u=fa;l=(u&~(1<<32-hn(u)-1)).toString(32)+l,i="«"+i+"R"+l,l=ad++,0<l&&(i+="H"+l.toString(32)),i+="»"}else l=qC++,i="«"+i+"r"+l.toString(32)+"»";return s.memoizedState=i},useHostTransitionStatus:pm,useFormState:qy,useActionState:qy,useOptimistic:function(s){var i=Sn();i.memoizedState=i.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=l,i=gm.bind(null,Ve,!0,l),l.dispatch=i,[s,i]},useMemoCache:om,useCacheRefresh:function(){return Sn().memoizedState=YC.bind(null,Ve)}},d_={readContext:fn,use:id,useCallback:Jy,useContext:fn,useEffect:Ky,useImperativeHandle:Zy,useInsertionEffect:Qy,useLayoutEffect:Xy,useMemo:e_,useReducer:rd,useRef:$y,useState:function(){return rd(va)},useDebugValue:hm,useDeferredValue:function(s,i){var l=Ot();return t_(l,lt.memoizedState,s,i)},useTransition:function(){var s=rd(va)[0],i=Ot().memoizedState;return[typeof s=="boolean"?s:Wl(s),i]},useSyncExternalStore:Iy,useId:i_,useHostTransitionStatus:pm,useFormState:By,useActionState:By,useOptimistic:function(s,i){var l=Ot();return ky(l,lt,s,i)},useMemoCache:om,useCacheRefresh:r_},QC={readContext:fn,use:id,useCallback:Jy,useContext:fn,useEffect:Ky,useImperativeHandle:Zy,useInsertionEffect:Qy,useLayoutEffect:Xy,useMemo:e_,useReducer:cm,useRef:$y,useState:function(){return cm(va)},useDebugValue:hm,useDeferredValue:function(s,i){var l=Ot();return lt===null?fm(l,s,i):t_(l,lt.memoizedState,s,i)},useTransition:function(){var s=cm(va)[0],i=Ot().memoizedState;return[typeof s=="boolean"?s:Wl(s),i]},useSyncExternalStore:Iy,useId:i_,useHostTransitionStatus:pm,useFormState:Gy,useActionState:Gy,useOptimistic:function(s,i){var l=Ot();return lt!==null?ky(l,lt,s,i):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:om,useCacheRefresh:r_},yo=null,ec=0;function dd(s){var i=ec;return ec+=1,yo===null&&(yo=[]),Ny(yo,s,i)}function tc(s,i){i=i.props.ref,s.ref=i!==void 0?i:null}function hd(s,i){throw i.$$typeof===N?Error(a(525)):(s=Object.prototype.toString.call(i),Error(a(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s)))}function h_(s){var i=s._init;return i(s._payload)}function f_(s){function i(G,z){if(s){var Q=G.deletions;Q===null?(G.deletions=[z],G.flags|=16):Q.push(z)}}function l(G,z){if(!s)return null;for(;z!==null;)i(G,z),z=z.sibling;return null}function u(G){for(var z=new Map;G!==null;)G.key!==null?z.set(G.key,G):z.set(G.index,G),G=G.sibling;return z}function m(G,z){return G=ha(G,z),G.index=0,G.sibling=null,G}function g(G,z,Q){return G.index=Q,s?(Q=G.alternate,Q!==null?(Q=Q.index,Q<z?(G.flags|=67108866,z):Q):(G.flags|=67108866,z)):(G.flags|=1048576,z)}function T(G){return s&&G.alternate===null&&(G.flags|=67108866),G}function S(G,z,Q,ie){return z===null||z.tag!==6?(z=Lf(Q,G.mode,ie),z.return=G,z):(z=m(z,Q),z.return=G,z)}function H(G,z,Q,ie){var _e=Q.type;return _e===b?se(G,z,Q.props.children,ie,Q.key):z!==null&&(z.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===A&&h_(_e)===z.type)?(z=m(z,Q.props),tc(z,Q),z.return=G,z):(z=Ku(Q.type,Q.key,Q.props,null,G.mode,ie),tc(z,Q),z.return=G,z)}function W(G,z,Q,ie){return z===null||z.tag!==4||z.stateNode.containerInfo!==Q.containerInfo||z.stateNode.implementation!==Q.implementation?(z=Vf(Q,G.mode,ie),z.return=G,z):(z=m(z,Q.children||[]),z.return=G,z)}function se(G,z,Q,ie,_e){return z===null||z.tag!==7?(z=cr(Q,G.mode,ie,_e),z.return=G,z):(z=m(z,Q),z.return=G,z)}function oe(G,z,Q){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return z=Lf(""+z,G.mode,Q),z.return=G,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case C:return Q=Ku(z.type,z.key,z.props,null,G.mode,Q),tc(Q,z),Q.return=G,Q;case j:return z=Vf(z,G.mode,Q),z.return=G,z;case A:var ie=z._init;return z=ie(z._payload),oe(G,z,Q)}if(ae(z)||V(z))return z=cr(z,G.mode,Q,null),z.return=G,z;if(typeof z.then=="function")return oe(G,dd(z),Q);if(z.$$typeof===O)return oe(G,Zu(G,z),Q);hd(G,z)}return null}function Z(G,z,Q,ie){var _e=z!==null?z.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return _e!==null?null:S(G,z,""+Q,ie);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case C:return Q.key===_e?H(G,z,Q,ie):null;case j:return Q.key===_e?W(G,z,Q,ie):null;case A:return _e=Q._init,Q=_e(Q._payload),Z(G,z,Q,ie)}if(ae(Q)||V(Q))return _e!==null?null:se(G,z,Q,ie,null);if(typeof Q.then=="function")return Z(G,z,dd(Q),ie);if(Q.$$typeof===O)return Z(G,z,Zu(G,Q),ie);hd(G,Q)}return null}function ee(G,z,Q,ie,_e){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return G=G.get(Q)||null,S(z,G,""+ie,_e);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case C:return G=G.get(ie.key===null?Q:ie.key)||null,H(z,G,ie,_e);case j:return G=G.get(ie.key===null?Q:ie.key)||null,W(z,G,ie,_e);case A:var He=ie._init;return ie=He(ie._payload),ee(G,z,Q,ie,_e)}if(ae(ie)||V(ie))return G=G.get(Q)||null,se(z,G,ie,_e,null);if(typeof ie.then=="function")return ee(G,z,Q,dd(ie),_e);if(ie.$$typeof===O)return ee(G,z,Q,Zu(z,ie),_e);hd(z,ie)}return null}function Ie(G,z,Q,ie){for(var _e=null,He=null,Ee=z,je=z=0,Xt=null;Ee!==null&&je<Q.length;je++){Ee.index>je?(Xt=Ee,Ee=null):Xt=Ee.sibling;var tt=Z(G,Ee,Q[je],ie);if(tt===null){Ee===null&&(Ee=Xt);break}s&&Ee&&tt.alternate===null&&i(G,Ee),z=g(tt,z,je),He===null?_e=tt:He.sibling=tt,He=tt,Ee=Xt}if(je===Q.length)return l(G,Ee),nt&&dr(G,je),_e;if(Ee===null){for(;je<Q.length;je++)Ee=oe(G,Q[je],ie),Ee!==null&&(z=g(Ee,z,je),He===null?_e=Ee:He.sibling=Ee,He=Ee);return nt&&dr(G,je),_e}for(Ee=u(Ee);je<Q.length;je++)Xt=ee(Ee,G,je,Q[je],ie),Xt!==null&&(s&&Xt.alternate!==null&&Ee.delete(Xt.key===null?je:Xt.key),z=g(Xt,z,je),He===null?_e=Xt:He.sibling=Xt,He=Xt);return s&&Ee.forEach(function(di){return i(G,di)}),nt&&dr(G,je),_e}function Ce(G,z,Q,ie){if(Q==null)throw Error(a(151));for(var _e=null,He=null,Ee=z,je=z=0,Xt=null,tt=Q.next();Ee!==null&&!tt.done;je++,tt=Q.next()){Ee.index>je?(Xt=Ee,Ee=null):Xt=Ee.sibling;var di=Z(G,Ee,tt.value,ie);if(di===null){Ee===null&&(Ee=Xt);break}s&&Ee&&di.alternate===null&&i(G,Ee),z=g(di,z,je),He===null?_e=di:He.sibling=di,He=di,Ee=Xt}if(tt.done)return l(G,Ee),nt&&dr(G,je),_e;if(Ee===null){for(;!tt.done;je++,tt=Q.next())tt=oe(G,tt.value,ie),tt!==null&&(z=g(tt,z,je),He===null?_e=tt:He.sibling=tt,He=tt);return nt&&dr(G,je),_e}for(Ee=u(Ee);!tt.done;je++,tt=Q.next())tt=ee(Ee,G,je,tt.value,ie),tt!==null&&(s&&tt.alternate!==null&&Ee.delete(tt.key===null?je:tt.key),z=g(tt,z,je),He===null?_e=tt:He.sibling=tt,He=tt);return s&&Ee.forEach(function(Xj){return i(G,Xj)}),nt&&dr(G,je),_e}function ut(G,z,Q,ie){if(typeof Q=="object"&&Q!==null&&Q.type===b&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case C:e:{for(var _e=Q.key;z!==null;){if(z.key===_e){if(_e=Q.type,_e===b){if(z.tag===7){l(G,z.sibling),ie=m(z,Q.props.children),ie.return=G,G=ie;break e}}else if(z.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===A&&h_(_e)===z.type){l(G,z.sibling),ie=m(z,Q.props),tc(ie,Q),ie.return=G,G=ie;break e}l(G,z);break}else i(G,z);z=z.sibling}Q.type===b?(ie=cr(Q.props.children,G.mode,ie,Q.key),ie.return=G,G=ie):(ie=Ku(Q.type,Q.key,Q.props,null,G.mode,ie),tc(ie,Q),ie.return=G,G=ie)}return T(G);case j:e:{for(_e=Q.key;z!==null;){if(z.key===_e)if(z.tag===4&&z.stateNode.containerInfo===Q.containerInfo&&z.stateNode.implementation===Q.implementation){l(G,z.sibling),ie=m(z,Q.children||[]),ie.return=G,G=ie;break e}else{l(G,z);break}else i(G,z);z=z.sibling}ie=Vf(Q,G.mode,ie),ie.return=G,G=ie}return T(G);case A:return _e=Q._init,Q=_e(Q._payload),ut(G,z,Q,ie)}if(ae(Q))return Ie(G,z,Q,ie);if(V(Q)){if(_e=V(Q),typeof _e!="function")throw Error(a(150));return Q=_e.call(Q),Ce(G,z,Q,ie)}if(typeof Q.then=="function")return ut(G,z,dd(Q),ie);if(Q.$$typeof===O)return ut(G,z,Zu(G,Q),ie);hd(G,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint"?(Q=""+Q,z!==null&&z.tag===6?(l(G,z.sibling),ie=m(z,Q),ie.return=G,G=ie):(l(G,z),ie=Lf(Q,G.mode,ie),ie.return=G,G=ie),T(G)):l(G,z)}return function(G,z,Q,ie){try{ec=0;var _e=ut(G,z,Q,ie);return yo=null,_e}catch(Ee){if(Ee===Gl||Ee===ed)throw Ee;var He=Vn(29,Ee,null,G.mode);return He.lanes=ie,He.return=G,He}finally{}}}var _o=f_(!0),m_=f_(!1),rs=ne(null),Vs=null;function Xa(s){var i=s.alternate;ue(Ht,Ht.current&1),ue(rs,s),Vs===null&&(i===null||mo.current!==null||i.memoizedState!==null)&&(Vs=s)}function p_(s){if(s.tag===22){if(ue(Ht,Ht.current),ue(rs,s),Vs===null){var i=s.alternate;i!==null&&i.memoizedState!==null&&(Vs=s)}}else Wa()}function Wa(){ue(Ht,Ht.current),ue(rs,rs.current)}function ya(s){he(rs),Vs===s&&(Vs=null),he(Ht)}var Ht=ne(0);function fd(s){for(var i=s;i!==null;){if(i.tag===13){var l=i.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||rp(l)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}function vm(s,i,l,u){i=s.memoizedState,l=l(u,i),l=l==null?i:_({},i,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var ym={enqueueSetState:function(s,i,l){s=s._reactInternals;var u=qn(),m=Ya(u);m.payload=i,l!=null&&(m.callback=l),i=Ka(s,m,u),i!==null&&(Bn(i,s,u),Yl(i,s,u))},enqueueReplaceState:function(s,i,l){s=s._reactInternals;var u=qn(),m=Ya(u);m.tag=1,m.payload=i,l!=null&&(m.callback=l),i=Ka(s,m,u),i!==null&&(Bn(i,s,u),Yl(i,s,u))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var l=qn(),u=Ya(l);u.tag=2,i!=null&&(u.callback=i),i=Ka(s,u,l),i!==null&&(Bn(i,s,l),Yl(i,s,l))}};function g_(s,i,l,u,m,g,T){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(u,g,T):i.prototype&&i.prototype.isPureReactComponent?!Ll(l,u)||!Ll(m,g):!0}function v_(s,i,l,u){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(l,u),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(l,u),i.state!==s&&ym.enqueueReplaceState(i,i.state,null)}function yr(s,i){var l=i;if("ref"in i){l={};for(var u in i)u!=="ref"&&(l[u]=i[u])}if(s=s.defaultProps){l===i&&(l=_({},l));for(var m in s)l[m]===void 0&&(l[m]=s[m])}return l}var md=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function y_(s){md(s)}function __(s){console.error(s)}function E_(s){md(s)}function pd(s,i){try{var l=s.onUncaughtError;l(i.value,{componentStack:i.stack})}catch(u){setTimeout(function(){throw u})}}function b_(s,i,l){try{var u=s.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function _m(s,i,l){return l=Ya(l),l.tag=3,l.payload={element:null},l.callback=function(){pd(s,i)},l}function N_(s){return s=Ya(s),s.tag=3,s}function T_(s,i,l,u){var m=l.type.getDerivedStateFromError;if(typeof m=="function"){var g=u.value;s.payload=function(){return m(g)},s.callback=function(){b_(i,l,u)}}var T=l.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(s.callback=function(){b_(i,l,u),typeof m!="function"&&(si===null?si=new Set([this]):si.add(this));var S=u.stack;this.componentDidCatch(u.value,{componentStack:S!==null?S:""})})}function XC(s,i,l,u,m){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(i=l.alternate,i!==null&&ql(i,l,m,!0),l=rs.current,l!==null){switch(l.tag){case 13:return Vs===null?Bm():l.alternate===null&&Tt===0&&(Tt=3),l.flags&=-257,l.flags|=65536,l.lanes=m,u===Kf?l.flags|=16384:(i=l.updateQueue,i===null?l.updateQueue=new Set([u]):i.add(u),Gm(s,u,m)),!1;case 22:return l.flags|=65536,u===Kf?l.flags|=16384:(i=l.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=i):(l=i.retryQueue,l===null?i.retryQueue=new Set([u]):l.add(u)),Gm(s,u,m)),!1}throw Error(a(435,l.tag))}return Gm(s,u,m),Bm(),!1}if(nt)return i=rs.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=m,u!==Hf&&(s=Error(a(422),{cause:u}),Hl(ns(s,l)))):(u!==Hf&&(i=Error(a(423),{cause:u}),Hl(ns(i,l))),s=s.current.alternate,s.flags|=65536,m&=-m,s.lanes|=m,u=ns(u,l),m=_m(s.stateNode,u,m),Wf(s,m),Tt!==4&&(Tt=2)),!1;var g=Error(a(520),{cause:u});if(g=ns(g,l),lc===null?lc=[g]:lc.push(g),Tt!==4&&(Tt=2),i===null)return!0;u=ns(u,l),l=i;do{switch(l.tag){case 3:return l.flags|=65536,s=m&-m,l.lanes|=s,s=_m(l.stateNode,u,s),Wf(l,s),!1;case 1:if(i=l.type,g=l.stateNode,(l.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(si===null||!si.has(g))))return l.flags|=65536,m&=-m,l.lanes|=m,m=N_(m),T_(m,s,l,u),Wf(l,m),!1}l=l.return}while(l!==null);return!1}var x_=Error(a(461)),Kt=!1;function tn(s,i,l,u){i.child=s===null?m_(i,null,l,u):_o(i,s.child,l,u)}function A_(s,i,l,u,m){l=l.render;var g=i.ref;if("ref"in u){var T={};for(var S in u)S!=="ref"&&(T[S]=u[S])}else T=u;return pr(i),u=nm(s,i,l,T,g,m),S=sm(),s!==null&&!Kt?(am(s,i,m),_a(s,i,m)):(nt&&S&&Uf(i),i.flags|=1,tn(s,i,u,m),i.child)}function C_(s,i,l,u,m){if(s===null){var g=l.type;return typeof g=="function"&&!kf(g)&&g.defaultProps===void 0&&l.compare===null?(i.tag=15,i.type=g,j_(s,i,g,u,m)):(s=Ku(l.type,null,u,i,i.mode,m),s.ref=i.ref,s.return=i,i.child=s)}if(g=s.child,!jm(s,m)){var T=g.memoizedProps;if(l=l.compare,l=l!==null?l:Ll,l(T,u)&&s.ref===i.ref)return _a(s,i,m)}return i.flags|=1,s=ha(g,u),s.ref=i.ref,s.return=i,i.child=s}function j_(s,i,l,u,m){if(s!==null){var g=s.memoizedProps;if(Ll(g,u)&&s.ref===i.ref)if(Kt=!1,i.pendingProps=u=g,jm(s,m))(s.flags&131072)!==0&&(Kt=!0);else return i.lanes=s.lanes,_a(s,i,m)}return Em(s,i,l,u,m)}function S_(s,i,l){var u=i.pendingProps,m=u.children,g=s!==null?s.memoizedState:null;if(u.mode==="hidden"){if((i.flags&128)!==0){if(u=g!==null?g.baseLanes|l:l,s!==null){for(m=i.child=s.child,g=0;m!==null;)g=g|m.lanes|m.childLanes,m=m.sibling;i.childLanes=g&~u}else i.childLanes=0,i.child=null;return w_(s,i,u,l)}if((l&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},s!==null&&Ju(i,g!==null?g.cachePool:null),g!==null?jy(i,g):Jf(),p_(i);else return i.lanes=i.childLanes=536870912,w_(s,i,g!==null?g.baseLanes|l:l,l)}else g!==null?(Ju(i,g.cachePool),jy(i,g),Wa(),i.memoizedState=null):(s!==null&&Ju(i,null),Jf(),Wa());return tn(s,i,m,l),i.child}function w_(s,i,l,u){var m=Yf();return m=m===null?null:{parent:Ft._currentValue,pool:m},i.memoizedState={baseLanes:l,cachePool:m},s!==null&&Ju(i,null),Jf(),p_(i),s!==null&&ql(s,i,u,!0),null}function gd(s,i){var l=i.ref;if(l===null)s!==null&&s.ref!==null&&(i.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(a(284));(s===null||s.ref!==l)&&(i.flags|=4194816)}}function Em(s,i,l,u,m){return pr(i),l=nm(s,i,l,u,void 0,m),u=sm(),s!==null&&!Kt?(am(s,i,m),_a(s,i,m)):(nt&&u&&Uf(i),i.flags|=1,tn(s,i,l,m),i.child)}function I_(s,i,l,u,m,g){return pr(i),i.updateQueue=null,l=wy(i,u,l,m),Sy(s),u=sm(),s!==null&&!Kt?(am(s,i,g),_a(s,i,g)):(nt&&u&&Uf(i),i.flags|=1,tn(s,i,l,g),i.child)}function R_(s,i,l,u,m){if(pr(i),i.stateNode===null){var g=lo,T=l.contextType;typeof T=="object"&&T!==null&&(g=fn(T)),g=new l(u,g),i.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=ym,i.stateNode=g,g._reactInternals=i,g=i.stateNode,g.props=u,g.state=i.memoizedState,g.refs={},Qf(i),T=l.contextType,g.context=typeof T=="object"&&T!==null?fn(T):lo,g.state=i.memoizedState,T=l.getDerivedStateFromProps,typeof T=="function"&&(vm(i,l,T,u),g.state=i.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(T=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),T!==g.state&&ym.enqueueReplaceState(g,g.state,null),Ql(i,u,g,m),Kl(),g.state=i.memoizedState),typeof g.componentDidMount=="function"&&(i.flags|=4194308),u=!0}else if(s===null){g=i.stateNode;var S=i.memoizedProps,H=yr(l,S);g.props=H;var W=g.context,se=l.contextType;T=lo,typeof se=="object"&&se!==null&&(T=fn(se));var oe=l.getDerivedStateFromProps;se=typeof oe=="function"||typeof g.getSnapshotBeforeUpdate=="function",S=i.pendingProps!==S,se||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(S||W!==T)&&v_(i,g,u,T),$a=!1;var Z=i.memoizedState;g.state=Z,Ql(i,u,g,m),Kl(),W=i.memoizedState,S||Z!==W||$a?(typeof oe=="function"&&(vm(i,l,oe,u),W=i.memoizedState),(H=$a||g_(i,l,H,u,Z,W,T))?(se||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(i.flags|=4194308)):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=u,i.memoizedState=W),g.props=u,g.state=W,g.context=T,u=H):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),u=!1)}else{g=i.stateNode,Xf(s,i),T=i.memoizedProps,se=yr(l,T),g.props=se,oe=i.pendingProps,Z=g.context,W=l.contextType,H=lo,typeof W=="object"&&W!==null&&(H=fn(W)),S=l.getDerivedStateFromProps,(W=typeof S=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(T!==oe||Z!==H)&&v_(i,g,u,H),$a=!1,Z=i.memoizedState,g.state=Z,Ql(i,u,g,m),Kl();var ee=i.memoizedState;T!==oe||Z!==ee||$a||s!==null&&s.dependencies!==null&&Wu(s.dependencies)?(typeof S=="function"&&(vm(i,l,S,u),ee=i.memoizedState),(se=$a||g_(i,l,se,u,Z,ee,H)||s!==null&&s.dependencies!==null&&Wu(s.dependencies))?(W||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(u,ee,H),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(u,ee,H)),typeof g.componentDidUpdate=="function"&&(i.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof g.componentDidUpdate!="function"||T===s.memoizedProps&&Z===s.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||T===s.memoizedProps&&Z===s.memoizedState||(i.flags|=1024),i.memoizedProps=u,i.memoizedState=ee),g.props=u,g.state=ee,g.context=H,u=se):(typeof g.componentDidUpdate!="function"||T===s.memoizedProps&&Z===s.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||T===s.memoizedProps&&Z===s.memoizedState||(i.flags|=1024),u=!1)}return g=u,gd(s,i),u=(i.flags&128)!==0,g||u?(g=i.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:g.render(),i.flags|=1,s!==null&&u?(i.child=_o(i,s.child,null,m),i.child=_o(i,null,l,m)):tn(s,i,l,m),i.memoizedState=g.state,s=i.child):s=_a(s,i,m),s}function D_(s,i,l,u){return Fl(),i.flags|=256,tn(s,i,l,u),i.child}var bm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Nm(s){return{baseLanes:s,cachePool:_y()}}function Tm(s,i,l){return s=s!==null?s.childLanes&~l:0,i&&(s|=os),s}function O_(s,i,l){var u=i.pendingProps,m=!1,g=(i.flags&128)!==0,T;if((T=g)||(T=s!==null&&s.memoizedState===null?!1:(Ht.current&2)!==0),T&&(m=!0,i.flags&=-129),T=(i.flags&32)!==0,i.flags&=-33,s===null){if(nt){if(m?Xa(i):Wa(),nt){var S=Nt,H;if(H=S){e:{for(H=S,S=Ls;H.nodeType!==8;){if(!S){S=null;break e}if(H=vs(H.nextSibling),H===null){S=null;break e}}S=H}S!==null?(i.memoizedState={dehydrated:S,treeContext:ur!==null?{id:fa,overflow:ma}:null,retryLane:536870912,hydrationErrors:null},H=Vn(18,null,null,0),H.stateNode=S,H.return=i,i.child=H,Tn=i,Nt=null,H=!0):H=!1}H||fr(i)}if(S=i.memoizedState,S!==null&&(S=S.dehydrated,S!==null))return rp(S)?i.lanes=32:i.lanes=536870912,null;ya(i)}return S=u.children,u=u.fallback,m?(Wa(),m=i.mode,S=vd({mode:"hidden",children:S},m),u=cr(u,m,l,null),S.return=i,u.return=i,S.sibling=u,i.child=S,m=i.child,m.memoizedState=Nm(l),m.childLanes=Tm(s,T,l),i.memoizedState=bm,u):(Xa(i),xm(i,S))}if(H=s.memoizedState,H!==null&&(S=H.dehydrated,S!==null)){if(g)i.flags&256?(Xa(i),i.flags&=-257,i=Am(s,i,l)):i.memoizedState!==null?(Wa(),i.child=s.child,i.flags|=128,i=null):(Wa(),m=u.fallback,S=i.mode,u=vd({mode:"visible",children:u.children},S),m=cr(m,S,l,null),m.flags|=2,u.return=i,m.return=i,u.sibling=m,i.child=u,_o(i,s.child,null,l),u=i.child,u.memoizedState=Nm(l),u.childLanes=Tm(s,T,l),i.memoizedState=bm,i=m);else if(Xa(i),rp(S)){if(T=S.nextSibling&&S.nextSibling.dataset,T)var W=T.dgst;T=W,u=Error(a(419)),u.stack="",u.digest=T,Hl({value:u,source:null,stack:null}),i=Am(s,i,l)}else if(Kt||ql(s,i,l,!1),T=(l&s.childLanes)!==0,Kt||T){if(T=pt,T!==null&&(u=l&-l,u=(u&42)!==0?1:Va(u),u=(u&(T.suspendedLanes|l))!==0?0:u,u!==0&&u!==H.retryLane))throw H.retryLane=u,oo(s,u),Bn(T,s,u),x_;S.data==="$?"||Bm(),i=Am(s,i,l)}else S.data==="$?"?(i.flags|=192,i.child=s.child,i=null):(s=H.treeContext,Nt=vs(S.nextSibling),Tn=i,nt=!0,hr=null,Ls=!1,s!==null&&(as[is++]=fa,as[is++]=ma,as[is++]=ur,fa=s.id,ma=s.overflow,ur=i),i=xm(i,u.children),i.flags|=4096);return i}return m?(Wa(),m=u.fallback,S=i.mode,H=s.child,W=H.sibling,u=ha(H,{mode:"hidden",children:u.children}),u.subtreeFlags=H.subtreeFlags&65011712,W!==null?m=ha(W,m):(m=cr(m,S,l,null),m.flags|=2),m.return=i,u.return=i,u.sibling=m,i.child=u,u=m,m=i.child,S=s.child.memoizedState,S===null?S=Nm(l):(H=S.cachePool,H!==null?(W=Ft._currentValue,H=H.parent!==W?{parent:W,pool:W}:H):H=_y(),S={baseLanes:S.baseLanes|l,cachePool:H}),m.memoizedState=S,m.childLanes=Tm(s,T,l),i.memoizedState=bm,u):(Xa(i),l=s.child,s=l.sibling,l=ha(l,{mode:"visible",children:u.children}),l.return=i,l.sibling=null,s!==null&&(T=i.deletions,T===null?(i.deletions=[s],i.flags|=16):T.push(s)),i.child=l,i.memoizedState=null,l)}function xm(s,i){return i=vd({mode:"visible",children:i},s.mode),i.return=s,s.child=i}function vd(s,i){return s=Vn(22,s,null,i),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Am(s,i,l){return _o(i,s.child,null,l),s=xm(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function M_(s,i,l){s.lanes|=i;var u=s.alternate;u!==null&&(u.lanes|=i),Bf(s.return,i,l)}function Cm(s,i,l,u,m){var g=s.memoizedState;g===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:m}:(g.isBackwards=i,g.rendering=null,g.renderingStartTime=0,g.last=u,g.tail=l,g.tailMode=m)}function P_(s,i,l){var u=i.pendingProps,m=u.revealOrder,g=u.tail;if(tn(s,i,u.children,l),u=Ht.current,(u&2)!==0)u=u&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&M_(s,l,i);else if(s.tag===19)M_(s,l,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}u&=1}switch(ue(Ht,u),m){case"forwards":for(l=i.child,m=null;l!==null;)s=l.alternate,s!==null&&fd(s)===null&&(m=l),l=l.sibling;l=m,l===null?(m=i.child,i.child=null):(m=l.sibling,l.sibling=null),Cm(i,!1,m,l,g);break;case"backwards":for(l=null,m=i.child,i.child=null;m!==null;){if(s=m.alternate,s!==null&&fd(s)===null){i.child=m;break}s=m.sibling,m.sibling=l,l=m,m=s}Cm(i,!0,l,null,g);break;case"together":Cm(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function _a(s,i,l){if(s!==null&&(i.dependencies=s.dependencies),ni|=i.lanes,(l&i.childLanes)===0)if(s!==null){if(ql(s,i,l,!1),(l&i.childLanes)===0)return null}else return null;if(s!==null&&i.child!==s.child)throw Error(a(153));if(i.child!==null){for(s=i.child,l=ha(s,s.pendingProps),i.child=l,l.return=i;s.sibling!==null;)s=s.sibling,l=l.sibling=ha(s,s.pendingProps),l.return=i;l.sibling=null}return i.child}function jm(s,i){return(s.lanes&i)!==0?!0:(s=s.dependencies,!!(s!==null&&Wu(s)))}function WC(s,i,l){switch(i.tag){case 3:mt(i,i.stateNode.containerInfo),Ga(i,Ft,s.memoizedState.cache),Fl();break;case 27:case 5:La(i);break;case 4:mt(i,i.stateNode.containerInfo);break;case 10:Ga(i,i.type,i.memoizedProps.value);break;case 13:var u=i.memoizedState;if(u!==null)return u.dehydrated!==null?(Xa(i),i.flags|=128,null):(l&i.child.childLanes)!==0?O_(s,i,l):(Xa(i),s=_a(s,i,l),s!==null?s.sibling:null);Xa(i);break;case 19:var m=(s.flags&128)!==0;if(u=(l&i.childLanes)!==0,u||(ql(s,i,l,!1),u=(l&i.childLanes)!==0),m){if(u)return P_(s,i,l);i.flags|=128}if(m=i.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),ue(Ht,Ht.current),u)break;return null;case 22:case 23:return i.lanes=0,S_(s,i,l);case 24:Ga(i,Ft,s.memoizedState.cache)}return _a(s,i,l)}function k_(s,i,l){if(s!==null)if(s.memoizedProps!==i.pendingProps)Kt=!0;else{if(!jm(s,l)&&(i.flags&128)===0)return Kt=!1,WC(s,i,l);Kt=(s.flags&131072)!==0}else Kt=!1,nt&&(i.flags&1048576)!==0&&hy(i,Xu,i.index);switch(i.lanes=0,i.tag){case 16:e:{s=i.pendingProps;var u=i.elementType,m=u._init;if(u=m(u._payload),i.type=u,typeof u=="function")kf(u)?(s=yr(u,s),i.tag=1,i=R_(null,i,u,s,l)):(i.tag=0,i=Em(null,i,u,s,l));else{if(u!=null){if(m=u.$$typeof,m===U){i.tag=11,i=A_(null,i,u,s,l);break e}else if(m===w){i.tag=14,i=C_(null,i,u,s,l);break e}}throw i=Le(u)||u,Error(a(306,i,""))}}return i;case 0:return Em(s,i,i.type,i.pendingProps,l);case 1:return u=i.type,m=yr(u,i.pendingProps),R_(s,i,u,m,l);case 3:e:{if(mt(i,i.stateNode.containerInfo),s===null)throw Error(a(387));u=i.pendingProps;var g=i.memoizedState;m=g.element,Xf(s,i),Ql(i,u,null,l);var T=i.memoizedState;if(u=T.cache,Ga(i,Ft,u),u!==g.cache&&zf(i,[Ft],l,!0),Kl(),u=T.element,g.isDehydrated)if(g={element:u,isDehydrated:!1,cache:T.cache},i.updateQueue.baseState=g,i.memoizedState=g,i.flags&256){i=D_(s,i,u,l);break e}else if(u!==m){m=ns(Error(a(424)),i),Hl(m),i=D_(s,i,u,l);break e}else{switch(s=i.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Nt=vs(s.firstChild),Tn=i,nt=!0,hr=null,Ls=!0,l=m_(i,null,u,l),i.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Fl(),u===m){i=_a(s,i,l);break e}tn(s,i,u,l)}i=i.child}return i;case 26:return gd(s,i),s===null?(l=FE(i.type,null,i.pendingProps,null))?i.memoizedState=l:nt||(l=i.type,s=i.pendingProps,u=Rd(De.current).createElement(l),u[Lt]=i,u[It]=s,sn(u,l,s),At(u),i.stateNode=u):i.memoizedState=FE(i.type,s.memoizedProps,i.pendingProps,s.memoizedState),null;case 27:return La(i),s===null&&nt&&(u=i.stateNode=LE(i.type,i.pendingProps,De.current),Tn=i,Ls=!0,m=Nt,ri(i.type)?(op=m,Nt=vs(u.firstChild)):Nt=m),tn(s,i,i.pendingProps.children,l),gd(s,i),s===null&&(i.flags|=4194304),i.child;case 5:return s===null&&nt&&((m=u=Nt)&&(u=Aj(u,i.type,i.pendingProps,Ls),u!==null?(i.stateNode=u,Tn=i,Nt=vs(u.firstChild),Ls=!1,m=!0):m=!1),m||fr(i)),La(i),m=i.type,g=i.pendingProps,T=s!==null?s.memoizedProps:null,u=g.children,sp(m,g)?u=null:T!==null&&sp(m,T)&&(i.flags|=32),i.memoizedState!==null&&(m=nm(s,i,BC,null,null,l),vc._currentValue=m),gd(s,i),tn(s,i,u,l),i.child;case 6:return s===null&&nt&&((s=l=Nt)&&(l=Cj(l,i.pendingProps,Ls),l!==null?(i.stateNode=l,Tn=i,Nt=null,s=!0):s=!1),s||fr(i)),null;case 13:return O_(s,i,l);case 4:return mt(i,i.stateNode.containerInfo),u=i.pendingProps,s===null?i.child=_o(i,null,u,l):tn(s,i,u,l),i.child;case 11:return A_(s,i,i.type,i.pendingProps,l);case 7:return tn(s,i,i.pendingProps,l),i.child;case 8:return tn(s,i,i.pendingProps.children,l),i.child;case 12:return tn(s,i,i.pendingProps.children,l),i.child;case 10:return u=i.pendingProps,Ga(i,i.type,u.value),tn(s,i,u.children,l),i.child;case 9:return m=i.type._context,u=i.pendingProps.children,pr(i),m=fn(m),u=u(m),i.flags|=1,tn(s,i,u,l),i.child;case 14:return C_(s,i,i.type,i.pendingProps,l);case 15:return j_(s,i,i.type,i.pendingProps,l);case 19:return P_(s,i,l);case 31:return u=i.pendingProps,l=i.mode,u={mode:u.mode,children:u.children},s===null?(l=vd(u,l),l.ref=i.ref,i.child=l,l.return=i,i=l):(l=ha(s.child,u),l.ref=i.ref,i.child=l,l.return=i,i=l),i;case 22:return S_(s,i,l);case 24:return pr(i),u=fn(Ft),s===null?(m=Yf(),m===null&&(m=pt,g=Gf(),m.pooledCache=g,g.refCount++,g!==null&&(m.pooledCacheLanes|=l),m=g),i.memoizedState={parent:u,cache:m},Qf(i),Ga(i,Ft,m)):((s.lanes&l)!==0&&(Xf(s,i),Ql(i,null,null,l),Kl()),m=s.memoizedState,g=i.memoizedState,m.parent!==u?(m={parent:u,cache:u},i.memoizedState=m,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=m),Ga(i,Ft,u)):(u=g.cache,Ga(i,Ft,u),u!==m.cache&&zf(i,[Ft],l,!0))),tn(s,i,i.pendingProps.children,l),i.child;case 29:throw i.pendingProps}throw Error(a(156,i.tag))}function Ea(s){s.flags|=4}function L_(s,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!GE(i)){if(i=rs.current,i!==null&&((We&4194048)===We?Vs!==null:(We&62914560)!==We&&(We&536870912)===0||i!==Vs))throw $l=Kf,Ey;s.flags|=8192}}function yd(s,i){i!==null&&(s.flags|=4),s.flags&16384&&(i=s.tag!==22?_l():536870912,s.lanes|=i,To|=i)}function nc(s,i){if(!nt)switch(s.tailMode){case"hidden":i=s.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:u.sibling=null}}function _t(s){var i=s.alternate!==null&&s.alternate.child===s.child,l=0,u=0;if(i)for(var m=s.child;m!==null;)l|=m.lanes|m.childLanes,u|=m.subtreeFlags&65011712,u|=m.flags&65011712,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)l|=m.lanes|m.childLanes,u|=m.subtreeFlags,u|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=u,s.childLanes=l,i}function ZC(s,i,l){var u=i.pendingProps;switch(Ff(i),i.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _t(i),null;case 1:return _t(i),null;case 3:return l=i.stateNode,u=null,s!==null&&(u=s.memoizedState.cache),i.memoizedState.cache!==u&&(i.flags|=2048),ga(Ft),As(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(Ul(i)?Ea(i):s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,py())),_t(i),null;case 26:return l=i.memoizedState,s===null?(Ea(i),l!==null?(_t(i),L_(i,l)):(_t(i),i.flags&=-16777217)):l?l!==s.memoizedState?(Ea(i),_t(i),L_(i,l)):(_t(i),i.flags&=-16777217):(s.memoizedProps!==u&&Ea(i),_t(i),i.flags&=-16777217),null;case 27:Js(i),l=De.current;var m=i.type;if(s!==null&&i.stateNode!=null)s.memoizedProps!==u&&Ea(i);else{if(!u){if(i.stateNode===null)throw Error(a(166));return _t(i),null}s=xe.current,Ul(i)?fy(i):(s=LE(m,u,l),i.stateNode=s,Ea(i))}return _t(i),null;case 5:if(Js(i),l=i.type,s!==null&&i.stateNode!=null)s.memoizedProps!==u&&Ea(i);else{if(!u){if(i.stateNode===null)throw Error(a(166));return _t(i),null}if(s=xe.current,Ul(i))fy(i);else{switch(m=Rd(De.current),s){case 1:s=m.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:s=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":s=m.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":s=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":s=m.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof u.is=="string"?m.createElement("select",{is:u.is}):m.createElement("select"),u.multiple?s.multiple=!0:u.size&&(s.size=u.size);break;default:s=typeof u.is=="string"?m.createElement(l,{is:u.is}):m.createElement(l)}}s[Lt]=i,s[It]=u;e:for(m=i.child;m!==null;){if(m.tag===5||m.tag===6)s.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===i)break e;for(;m.sibling===null;){if(m.return===null||m.return===i)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}i.stateNode=s;e:switch(sn(s,l,u),l){case"button":case"input":case"select":case"textarea":s=!!u.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Ea(i)}}return _t(i),i.flags&=-16777217,null;case 6:if(s&&i.stateNode!=null)s.memoizedProps!==u&&Ea(i);else{if(typeof u!="string"&&i.stateNode===null)throw Error(a(166));if(s=De.current,Ul(i)){if(s=i.stateNode,l=i.memoizedProps,u=null,m=Tn,m!==null)switch(m.tag){case 27:case 5:u=m.memoizedProps}s[Lt]=i,s=!!(s.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||IE(s.nodeValue,l)),s||fr(i)}else s=Rd(s).createTextNode(u),s[Lt]=i,i.stateNode=s}return _t(i),null;case 13:if(u=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(m=Ul(i),u!==null&&u.dehydrated!==null){if(s===null){if(!m)throw Error(a(318));if(m=i.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(a(317));m[Lt]=i}else Fl(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;_t(i),m=!1}else m=py(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),m=!0;if(!m)return i.flags&256?(ya(i),i):(ya(i),null)}if(ya(i),(i.flags&128)!==0)return i.lanes=l,i;if(l=u!==null,s=s!==null&&s.memoizedState!==null,l){u=i.child,m=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(m=u.alternate.memoizedState.cachePool.pool);var g=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(g=u.memoizedState.cachePool.pool),g!==m&&(u.flags|=2048)}return l!==s&&l&&(i.child.flags|=8192),yd(i,i.updateQueue),_t(i),null;case 4:return As(),s===null&&Zm(i.stateNode.containerInfo),_t(i),null;case 10:return ga(i.type),_t(i),null;case 19:if(he(Ht),m=i.memoizedState,m===null)return _t(i),null;if(u=(i.flags&128)!==0,g=m.rendering,g===null)if(u)nc(m,!1);else{if(Tt!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(g=fd(s),g!==null){for(i.flags|=128,nc(m,!1),s=g.updateQueue,i.updateQueue=s,yd(i,s),i.subtreeFlags=0,s=l,l=i.child;l!==null;)dy(l,s),l=l.sibling;return ue(Ht,Ht.current&1|2),i.child}s=s.sibling}m.tail!==null&&Xn()>bd&&(i.flags|=128,u=!0,nc(m,!1),i.lanes=4194304)}else{if(!u)if(s=fd(g),s!==null){if(i.flags|=128,u=!0,s=s.updateQueue,i.updateQueue=s,yd(i,s),nc(m,!0),m.tail===null&&m.tailMode==="hidden"&&!g.alternate&&!nt)return _t(i),null}else 2*Xn()-m.renderingStartTime>bd&&l!==536870912&&(i.flags|=128,u=!0,nc(m,!1),i.lanes=4194304);m.isBackwards?(g.sibling=i.child,i.child=g):(s=m.last,s!==null?s.sibling=g:i.child=g,m.last=g)}return m.tail!==null?(i=m.tail,m.rendering=i,m.tail=i.sibling,m.renderingStartTime=Xn(),i.sibling=null,s=Ht.current,ue(Ht,u?s&1|2:s&1),i):(_t(i),null);case 22:case 23:return ya(i),em(),u=i.memoizedState!==null,s!==null?s.memoizedState!==null!==u&&(i.flags|=8192):u&&(i.flags|=8192),u?(l&536870912)!==0&&(i.flags&128)===0&&(_t(i),i.subtreeFlags&6&&(i.flags|=8192)):_t(i),l=i.updateQueue,l!==null&&yd(i,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),u=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),u!==l&&(i.flags|=2048),s!==null&&he(gr),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),i.memoizedState.cache!==l&&(i.flags|=2048),ga(Ft),_t(i),null;case 25:return null;case 30:return null}throw Error(a(156,i.tag))}function JC(s,i){switch(Ff(i),i.tag){case 1:return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return ga(Ft),As(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 26:case 27:case 5:return Js(i),null;case 13:if(ya(i),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(a(340));Fl()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return he(Ht),null;case 4:return As(),null;case 10:return ga(i.type),null;case 22:case 23:return ya(i),em(),s!==null&&he(gr),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 24:return ga(Ft),null;case 25:return null;default:return null}}function V_(s,i){switch(Ff(i),i.tag){case 3:ga(Ft),As();break;case 26:case 27:case 5:Js(i);break;case 4:As();break;case 13:ya(i);break;case 19:he(Ht);break;case 10:ga(i.type);break;case 22:case 23:ya(i),em(),s!==null&&he(gr);break;case 24:ga(Ft)}}function sc(s,i){try{var l=i.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var m=u.next;l=m;do{if((l.tag&s)===s){u=void 0;var g=l.create,T=l.inst;u=g(),T.destroy=u}l=l.next}while(l!==m)}}catch(S){dt(i,i.return,S)}}function Za(s,i,l){try{var u=i.updateQueue,m=u!==null?u.lastEffect:null;if(m!==null){var g=m.next;u=g;do{if((u.tag&s)===s){var T=u.inst,S=T.destroy;if(S!==void 0){T.destroy=void 0,m=i;var H=l,W=S;try{W()}catch(se){dt(m,H,se)}}}u=u.next}while(u!==g)}}catch(se){dt(i,i.return,se)}}function U_(s){var i=s.updateQueue;if(i!==null){var l=s.stateNode;try{Cy(i,l)}catch(u){dt(s,s.return,u)}}}function F_(s,i,l){l.props=yr(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(u){dt(s,i,u)}}function ac(s,i){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var u=s.stateNode;break;case 30:u=s.stateNode;break;default:u=s.stateNode}typeof l=="function"?s.refCleanup=l(u):l.current=u}}catch(m){dt(s,i,m)}}function Us(s,i){var l=s.ref,u=s.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(m){dt(s,i,m)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(m){dt(s,i,m)}else l.current=null}function H_(s){var i=s.type,l=s.memoizedProps,u=s.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(m){dt(s,s.return,m)}}function Sm(s,i,l){try{var u=s.stateNode;Ej(u,s.type,l,i),u[It]=i}catch(m){dt(s,s.return,m)}}function q_(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&ri(s.type)||s.tag===4}function wm(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||q_(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&ri(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Im(s,i,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,i?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,i):(i=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,i.appendChild(s),l=l._reactRootContainer,l!=null||i.onclick!==null||(i.onclick=Id));else if(u!==4&&(u===27&&ri(s.type)&&(l=s.stateNode,i=null),s=s.child,s!==null))for(Im(s,i,l),s=s.sibling;s!==null;)Im(s,i,l),s=s.sibling}function _d(s,i,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,i?l.insertBefore(s,i):l.appendChild(s);else if(u!==4&&(u===27&&ri(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(_d(s,i,l),s=s.sibling;s!==null;)_d(s,i,l),s=s.sibling}function B_(s){var i=s.stateNode,l=s.memoizedProps;try{for(var u=s.type,m=i.attributes;m.length;)i.removeAttributeNode(m[0]);sn(i,u,l),i[Lt]=s,i[It]=l}catch(g){dt(s,s.return,g)}}var ba=!1,jt=!1,Rm=!1,z_=typeof WeakSet=="function"?WeakSet:Set,Qt=null;function ej(s,i){if(s=s.containerInfo,tp=Ld,s=ty(s),wf(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var m=u.anchorOffset,g=u.focusNode;u=u.focusOffset;try{l.nodeType,g.nodeType}catch{l=null;break e}var T=0,S=-1,H=-1,W=0,se=0,oe=s,Z=null;t:for(;;){for(var ee;oe!==l||m!==0&&oe.nodeType!==3||(S=T+m),oe!==g||u!==0&&oe.nodeType!==3||(H=T+u),oe.nodeType===3&&(T+=oe.nodeValue.length),(ee=oe.firstChild)!==null;)Z=oe,oe=ee;for(;;){if(oe===s)break t;if(Z===l&&++W===m&&(S=T),Z===g&&++se===u&&(H=T),(ee=oe.nextSibling)!==null)break;oe=Z,Z=oe.parentNode}oe=ee}l=S===-1||H===-1?null:{start:S,end:H}}else l=null}l=l||{start:0,end:0}}else l=null;for(np={focusedElem:s,selectionRange:l},Ld=!1,Qt=i;Qt!==null;)if(i=Qt,s=i.child,(i.subtreeFlags&1024)!==0&&s!==null)s.return=i,Qt=s;else for(;Qt!==null;){switch(i=Qt,g=i.alternate,s=i.flags,i.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&g!==null){s=void 0,l=i,m=g.memoizedProps,g=g.memoizedState,u=l.stateNode;try{var Ie=yr(l.type,m,l.elementType===l.type);s=u.getSnapshotBeforeUpdate(Ie,g),u.__reactInternalSnapshotBeforeUpdate=s}catch(Ce){dt(l,l.return,Ce)}}break;case 3:if((s&1024)!==0){if(s=i.stateNode.containerInfo,l=s.nodeType,l===9)ip(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":ip(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(a(163))}if(s=i.sibling,s!==null){s.return=i.return,Qt=s;break}Qt=i.return}}function G_(s,i,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:Ja(s,l),u&4&&sc(5,l);break;case 1:if(Ja(s,l),u&4)if(s=l.stateNode,i===null)try{s.componentDidMount()}catch(T){dt(l,l.return,T)}else{var m=yr(l.type,i.memoizedProps);i=i.memoizedState;try{s.componentDidUpdate(m,i,s.__reactInternalSnapshotBeforeUpdate)}catch(T){dt(l,l.return,T)}}u&64&&U_(l),u&512&&ac(l,l.return);break;case 3:if(Ja(s,l),u&64&&(s=l.updateQueue,s!==null)){if(i=null,l.child!==null)switch(l.child.tag){case 27:case 5:i=l.child.stateNode;break;case 1:i=l.child.stateNode}try{Cy(s,i)}catch(T){dt(l,l.return,T)}}break;case 27:i===null&&u&4&&B_(l);case 26:case 5:Ja(s,l),i===null&&u&4&&H_(l),u&512&&ac(l,l.return);break;case 12:Ja(s,l);break;case 13:Ja(s,l),u&4&&K_(s,l),u&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=cj.bind(null,l),jj(s,l))));break;case 22:if(u=l.memoizedState!==null||ba,!u){i=i!==null&&i.memoizedState!==null||jt,m=ba;var g=jt;ba=u,(jt=i)&&!g?ei(s,l,(l.subtreeFlags&8772)!==0):Ja(s,l),ba=m,jt=g}break;case 30:break;default:Ja(s,l)}}function $_(s){var i=s.alternate;i!==null&&(s.alternate=null,$_(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&Ha(i)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var yt=null,wn=!1;function Na(s,i,l){for(l=l.child;l!==null;)Y_(s,i,l),l=l.sibling}function Y_(s,i,l){if(at&&typeof at.onCommitFiberUnmount=="function")try{at.onCommitFiberUnmount(bt,l)}catch{}switch(l.tag){case 26:jt||Us(l,i),Na(s,i,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:jt||Us(l,i);var u=yt,m=wn;ri(l.type)&&(yt=l.stateNode,wn=!1),Na(s,i,l),fc(l.stateNode),yt=u,wn=m;break;case 5:jt||Us(l,i);case 6:if(u=yt,m=wn,yt=null,Na(s,i,l),yt=u,wn=m,yt!==null)if(wn)try{(yt.nodeType===9?yt.body:yt.nodeName==="HTML"?yt.ownerDocument.body:yt).removeChild(l.stateNode)}catch(g){dt(l,i,g)}else try{yt.removeChild(l.stateNode)}catch(g){dt(l,i,g)}break;case 18:yt!==null&&(wn?(s=yt,PE(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),bc(s)):PE(yt,l.stateNode));break;case 4:u=yt,m=wn,yt=l.stateNode.containerInfo,wn=!0,Na(s,i,l),yt=u,wn=m;break;case 0:case 11:case 14:case 15:jt||Za(2,l,i),jt||Za(4,l,i),Na(s,i,l);break;case 1:jt||(Us(l,i),u=l.stateNode,typeof u.componentWillUnmount=="function"&&F_(l,i,u)),Na(s,i,l);break;case 21:Na(s,i,l);break;case 22:jt=(u=jt)||l.memoizedState!==null,Na(s,i,l),jt=u;break;default:Na(s,i,l)}}function K_(s,i){if(i.memoizedState===null&&(s=i.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{bc(s)}catch(l){dt(i,i.return,l)}}function tj(s){switch(s.tag){case 13:case 19:var i=s.stateNode;return i===null&&(i=s.stateNode=new z_),i;case 22:return s=s.stateNode,i=s._retryCache,i===null&&(i=s._retryCache=new z_),i;default:throw Error(a(435,s.tag))}}function Dm(s,i){var l=tj(s);i.forEach(function(u){var m=uj.bind(null,s,u);l.has(u)||(l.add(u),u.then(m,m))})}function Un(s,i){var l=i.deletions;if(l!==null)for(var u=0;u<l.length;u++){var m=l[u],g=s,T=i,S=T;e:for(;S!==null;){switch(S.tag){case 27:if(ri(S.type)){yt=S.stateNode,wn=!1;break e}break;case 5:yt=S.stateNode,wn=!1;break e;case 3:case 4:yt=S.stateNode.containerInfo,wn=!0;break e}S=S.return}if(yt===null)throw Error(a(160));Y_(g,T,m),yt=null,wn=!1,g=m.alternate,g!==null&&(g.return=null),m.return=null}if(i.subtreeFlags&13878)for(i=i.child;i!==null;)Q_(i,s),i=i.sibling}var gs=null;function Q_(s,i){var l=s.alternate,u=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Un(i,s),Fn(s),u&4&&(Za(3,s,s.return),sc(3,s),Za(5,s,s.return));break;case 1:Un(i,s),Fn(s),u&512&&(jt||l===null||Us(l,l.return)),u&64&&ba&&(s=s.updateQueue,s!==null&&(u=s.callbacks,u!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var m=gs;if(Un(i,s),Fn(s),u&512&&(jt||l===null||Us(l,l.return)),u&4){var g=l!==null?l.memoizedState:null;if(u=s.memoizedState,l===null)if(u===null)if(s.stateNode===null){e:{u=s.type,l=s.memoizedProps,m=m.ownerDocument||m;t:switch(u){case"title":g=m.getElementsByTagName("title")[0],(!g||g[Yi]||g[Lt]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=m.createElement(u),m.head.insertBefore(g,m.querySelector("head > title"))),sn(g,u,l),g[Lt]=s,At(g),u=g;break e;case"link":var T=BE("link","href",m).get(u+(l.href||""));if(T){for(var S=0;S<T.length;S++)if(g=T[S],g.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&g.getAttribute("rel")===(l.rel==null?null:l.rel)&&g.getAttribute("title")===(l.title==null?null:l.title)&&g.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){T.splice(S,1);break t}}g=m.createElement(u),sn(g,u,l),m.head.appendChild(g);break;case"meta":if(T=BE("meta","content",m).get(u+(l.content||""))){for(S=0;S<T.length;S++)if(g=T[S],g.getAttribute("content")===(l.content==null?null:""+l.content)&&g.getAttribute("name")===(l.name==null?null:l.name)&&g.getAttribute("property")===(l.property==null?null:l.property)&&g.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&g.getAttribute("charset")===(l.charSet==null?null:l.charSet)){T.splice(S,1);break t}}g=m.createElement(u),sn(g,u,l),m.head.appendChild(g);break;default:throw Error(a(468,u))}g[Lt]=s,At(g),u=g}s.stateNode=u}else zE(m,s.type,s.stateNode);else s.stateNode=qE(m,u,s.memoizedProps);else g!==u?(g===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):g.count--,u===null?zE(m,s.type,s.stateNode):qE(m,u,s.memoizedProps)):u===null&&s.stateNode!==null&&Sm(s,s.memoizedProps,l.memoizedProps)}break;case 27:Un(i,s),Fn(s),u&512&&(jt||l===null||Us(l,l.return)),l!==null&&u&4&&Sm(s,s.memoizedProps,l.memoizedProps);break;case 5:if(Un(i,s),Fn(s),u&512&&(jt||l===null||Us(l,l.return)),s.flags&32){m=s.stateNode;try{Zn(m,"")}catch(ee){dt(s,s.return,ee)}}u&4&&s.stateNode!=null&&(m=s.memoizedProps,Sm(s,m,l!==null?l.memoizedProps:m)),u&1024&&(Rm=!0);break;case 6:if(Un(i,s),Fn(s),u&4){if(s.stateNode===null)throw Error(a(162));u=s.memoizedProps,l=s.stateNode;try{l.nodeValue=u}catch(ee){dt(s,s.return,ee)}}break;case 3:if(Md=null,m=gs,gs=Dd(i.containerInfo),Un(i,s),gs=m,Fn(s),u&4&&l!==null&&l.memoizedState.isDehydrated)try{bc(i.containerInfo)}catch(ee){dt(s,s.return,ee)}Rm&&(Rm=!1,X_(s));break;case 4:u=gs,gs=Dd(s.stateNode.containerInfo),Un(i,s),Fn(s),gs=u;break;case 12:Un(i,s),Fn(s);break;case 13:Un(i,s),Fn(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Vm=Xn()),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Dm(s,u)));break;case 22:m=s.memoizedState!==null;var H=l!==null&&l.memoizedState!==null,W=ba,se=jt;if(ba=W||m,jt=se||H,Un(i,s),jt=se,ba=W,Fn(s),u&8192)e:for(i=s.stateNode,i._visibility=m?i._visibility&-2:i._visibility|1,m&&(l===null||H||ba||jt||_r(s)),l=null,i=s;;){if(i.tag===5||i.tag===26){if(l===null){H=l=i;try{if(g=H.stateNode,m)T=g.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{S=H.stateNode;var oe=H.memoizedProps.style,Z=oe!=null&&oe.hasOwnProperty("display")?oe.display:null;S.style.display=Z==null||typeof Z=="boolean"?"":(""+Z).trim()}}catch(ee){dt(H,H.return,ee)}}}else if(i.tag===6){if(l===null){H=i;try{H.stateNode.nodeValue=m?"":H.memoizedProps}catch(ee){dt(H,H.return,ee)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===s)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;l===i&&(l=null),i=i.return}l===i&&(l=null),i.sibling.return=i.return,i=i.sibling}u&4&&(u=s.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,Dm(s,l))));break;case 19:Un(i,s),Fn(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Dm(s,u)));break;case 30:break;case 21:break;default:Un(i,s),Fn(s)}}function Fn(s){var i=s.flags;if(i&2){try{for(var l,u=s.return;u!==null;){if(q_(u)){l=u;break}u=u.return}if(l==null)throw Error(a(160));switch(l.tag){case 27:var m=l.stateNode,g=wm(s);_d(s,g,m);break;case 5:var T=l.stateNode;l.flags&32&&(Zn(T,""),l.flags&=-33);var S=wm(s);_d(s,S,T);break;case 3:case 4:var H=l.stateNode.containerInfo,W=wm(s);Im(s,W,H);break;default:throw Error(a(161))}}catch(se){dt(s,s.return,se)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function X_(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var i=s;X_(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),s=s.sibling}}function Ja(s,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)G_(s,i.alternate,i),i=i.sibling}function _r(s){for(s=s.child;s!==null;){var i=s;switch(i.tag){case 0:case 11:case 14:case 15:Za(4,i,i.return),_r(i);break;case 1:Us(i,i.return);var l=i.stateNode;typeof l.componentWillUnmount=="function"&&F_(i,i.return,l),_r(i);break;case 27:fc(i.stateNode);case 26:case 5:Us(i,i.return),_r(i);break;case 22:i.memoizedState===null&&_r(i);break;case 30:_r(i);break;default:_r(i)}s=s.sibling}}function ei(s,i,l){for(l=l&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var u=i.alternate,m=s,g=i,T=g.flags;switch(g.tag){case 0:case 11:case 15:ei(m,g,l),sc(4,g);break;case 1:if(ei(m,g,l),u=g,m=u.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(W){dt(u,u.return,W)}if(u=g,m=u.updateQueue,m!==null){var S=u.stateNode;try{var H=m.shared.hiddenCallbacks;if(H!==null)for(m.shared.hiddenCallbacks=null,m=0;m<H.length;m++)Ay(H[m],S)}catch(W){dt(u,u.return,W)}}l&&T&64&&U_(g),ac(g,g.return);break;case 27:B_(g);case 26:case 5:ei(m,g,l),l&&u===null&&T&4&&H_(g),ac(g,g.return);break;case 12:ei(m,g,l);break;case 13:ei(m,g,l),l&&T&4&&K_(m,g);break;case 22:g.memoizedState===null&&ei(m,g,l),ac(g,g.return);break;case 30:break;default:ei(m,g,l)}i=i.sibling}}function Om(s,i){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(s=i.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&Bl(l))}function Mm(s,i){s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&Bl(s))}function Fs(s,i,l,u){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)W_(s,i,l,u),i=i.sibling}function W_(s,i,l,u){var m=i.flags;switch(i.tag){case 0:case 11:case 15:Fs(s,i,l,u),m&2048&&sc(9,i);break;case 1:Fs(s,i,l,u);break;case 3:Fs(s,i,l,u),m&2048&&(s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&Bl(s)));break;case 12:if(m&2048){Fs(s,i,l,u),s=i.stateNode;try{var g=i.memoizedProps,T=g.id,S=g.onPostCommit;typeof S=="function"&&S(T,i.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(H){dt(i,i.return,H)}}else Fs(s,i,l,u);break;case 13:Fs(s,i,l,u);break;case 23:break;case 22:g=i.stateNode,T=i.alternate,i.memoizedState!==null?g._visibility&2?Fs(s,i,l,u):ic(s,i):g._visibility&2?Fs(s,i,l,u):(g._visibility|=2,Eo(s,i,l,u,(i.subtreeFlags&10256)!==0)),m&2048&&Om(T,i);break;case 24:Fs(s,i,l,u),m&2048&&Mm(i.alternate,i);break;default:Fs(s,i,l,u)}}function Eo(s,i,l,u,m){for(m=m&&(i.subtreeFlags&10256)!==0,i=i.child;i!==null;){var g=s,T=i,S=l,H=u,W=T.flags;switch(T.tag){case 0:case 11:case 15:Eo(g,T,S,H,m),sc(8,T);break;case 23:break;case 22:var se=T.stateNode;T.memoizedState!==null?se._visibility&2?Eo(g,T,S,H,m):ic(g,T):(se._visibility|=2,Eo(g,T,S,H,m)),m&&W&2048&&Om(T.alternate,T);break;case 24:Eo(g,T,S,H,m),m&&W&2048&&Mm(T.alternate,T);break;default:Eo(g,T,S,H,m)}i=i.sibling}}function ic(s,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var l=s,u=i,m=u.flags;switch(u.tag){case 22:ic(l,u),m&2048&&Om(u.alternate,u);break;case 24:ic(l,u),m&2048&&Mm(u.alternate,u);break;default:ic(l,u)}i=i.sibling}}var rc=8192;function bo(s){if(s.subtreeFlags&rc)for(s=s.child;s!==null;)Z_(s),s=s.sibling}function Z_(s){switch(s.tag){case 26:bo(s),s.flags&rc&&s.memoizedState!==null&&Fj(gs,s.memoizedState,s.memoizedProps);break;case 5:bo(s);break;case 3:case 4:var i=gs;gs=Dd(s.stateNode.containerInfo),bo(s),gs=i;break;case 22:s.memoizedState===null&&(i=s.alternate,i!==null&&i.memoizedState!==null?(i=rc,rc=16777216,bo(s),rc=i):bo(s));break;default:bo(s)}}function J_(s){var i=s.alternate;if(i!==null&&(s=i.child,s!==null)){i.child=null;do i=s.sibling,s.sibling=null,s=i;while(s!==null)}}function oc(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var u=i[l];Qt=u,tE(u,s)}J_(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)eE(s),s=s.sibling}function eE(s){switch(s.tag){case 0:case 11:case 15:oc(s),s.flags&2048&&Za(9,s,s.return);break;case 3:oc(s);break;case 12:oc(s);break;case 22:var i=s.stateNode;s.memoizedState!==null&&i._visibility&2&&(s.return===null||s.return.tag!==13)?(i._visibility&=-3,Ed(s)):oc(s);break;default:oc(s)}}function Ed(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var u=i[l];Qt=u,tE(u,s)}J_(s)}for(s=s.child;s!==null;){switch(i=s,i.tag){case 0:case 11:case 15:Za(8,i,i.return),Ed(i);break;case 22:l=i.stateNode,l._visibility&2&&(l._visibility&=-3,Ed(i));break;default:Ed(i)}s=s.sibling}}function tE(s,i){for(;Qt!==null;){var l=Qt;switch(l.tag){case 0:case 11:case 15:Za(8,l,i);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Bl(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,Qt=u;else e:for(l=s;Qt!==null;){u=Qt;var m=u.sibling,g=u.return;if($_(u),u===l){Qt=null;break e}if(m!==null){m.return=g,Qt=m;break e}Qt=g}}}var nj={getCacheForType:function(s){var i=fn(Ft),l=i.data.get(s);return l===void 0&&(l=s(),i.data.set(s,l)),l}},sj=typeof WeakMap=="function"?WeakMap:Map,it=0,pt=null,qe=null,We=0,rt=0,Hn=null,ti=!1,No=!1,Pm=!1,Ta=0,Tt=0,ni=0,Er=0,km=0,os=0,To=0,lc=null,In=null,Lm=!1,Vm=0,bd=1/0,Nd=null,si=null,nn=0,ai=null,xo=null,Ao=0,Um=0,Fm=null,nE=null,cc=0,Hm=null;function qn(){if((it&2)!==0&&We!==0)return We&-We;if(B.T!==null){var s=ho;return s!==0?s:Km()}return Ua()}function sE(){os===0&&(os=(We&536870912)===0||nt?yl():536870912);var s=rs.current;return s!==null&&(s.flags|=32),os}function Bn(s,i,l){(s===pt&&(rt===2||rt===9)||s.cancelPendingCommit!==null)&&(Co(s,0),ii(s,We,os,!1)),ta(s,l),((it&2)===0||s!==pt)&&(s===pt&&((it&2)===0&&(Er|=l),Tt===4&&ii(s,We,os,!1)),Hs(s))}function aE(s,i,l){if((it&6)!==0)throw Error(a(327));var u=!l&&(i&124)===0&&(i&s.expiredLanes)===0||$i(s,i),m=u?rj(s,i):zm(s,i,!0),g=u;do{if(m===0){No&&!u&&ii(s,i,0,!1);break}else{if(l=s.current.alternate,g&&!aj(l)){m=zm(s,i,!1),g=!1;continue}if(m===2){if(g=i,s.errorRecoveryDisabledLanes&g)var T=0;else T=s.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){i=T;e:{var S=s;m=lc;var H=S.current.memoizedState.isDehydrated;if(H&&(Co(S,T).flags|=256),T=zm(S,T,!1),T!==2){if(Pm&&!H){S.errorRecoveryDisabledLanes|=g,Er|=g,m=4;break e}g=In,In=m,g!==null&&(In===null?In=g:In.push.apply(In,g))}m=T}if(g=!1,m!==2)continue}}if(m===1){Co(s,0),ii(s,i,0,!0);break}e:{switch(u=s,g=m,g){case 0:case 1:throw Error(a(345));case 4:if((i&4194048)!==i)break;case 6:ii(u,i,os,!ti);break e;case 2:In=null;break;case 3:case 5:break;default:throw Error(a(329))}if((i&62914560)===i&&(m=Vm+300-Xn(),10<m)){if(ii(u,i,os,!ti),qr(u,0,!0)!==0)break e;u.timeoutHandle=OE(iE.bind(null,u,l,In,Nd,Lm,i,os,Er,To,ti,g,2,-0,0),m);break e}iE(u,l,In,Nd,Lm,i,os,Er,To,ti,g,0,-0,0)}}break}while(!0);Hs(s)}function iE(s,i,l,u,m,g,T,S,H,W,se,oe,Z,ee){if(s.timeoutHandle=-1,oe=i.subtreeFlags,(oe&8192||(oe&16785408)===16785408)&&(gc={stylesheets:null,count:0,unsuspend:Uj},Z_(i),oe=Hj(),oe!==null)){s.cancelPendingCommit=oe(hE.bind(null,s,i,g,l,u,m,T,S,H,se,1,Z,ee)),ii(s,g,T,!W);return}hE(s,i,g,l,u,m,T,S,H)}function aj(s){for(var i=s;;){var l=i.tag;if((l===0||l===11||l===15)&&i.flags&16384&&(l=i.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var m=l[u],g=m.getSnapshot;m=m.value;try{if(!Ln(g(),m))return!1}catch{return!1}}if(l=i.child,i.subtreeFlags&16384&&l!==null)l.return=i,i=l;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function ii(s,i,l,u){i&=~km,i&=~Er,s.suspendedLanes|=i,s.pingedLanes&=~i,u&&(s.warmLanes|=i),u=s.expirationTimes;for(var m=i;0<m;){var g=31-hn(m),T=1<<g;u[g]=-1,m&=~T}l!==0&&Cs(s,l,i)}function Td(){return(it&6)===0?(uc(0),!1):!0}function qm(){if(qe!==null){if(rt===0)var s=qe.return;else s=qe,pa=mr=null,im(s),yo=null,ec=0,s=qe;for(;s!==null;)V_(s.alternate,s),s=s.return;qe=null}}function Co(s,i){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,Nj(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),qm(),pt=s,qe=l=ha(s.current,null),We=i,rt=0,Hn=null,ti=!1,No=$i(s,i),Pm=!1,To=os=km=Er=ni=Tt=0,In=lc=null,Lm=!1,(i&8)!==0&&(i|=i&32);var u=s.entangledLanes;if(u!==0)for(s=s.entanglements,u&=i;0<u;){var m=31-hn(u),g=1<<m;i|=s[m],u&=~g}return Ta=i,Gu(),l}function rE(s,i){Ve=null,B.H=ud,i===Gl||i===ed?(i=Ty(),rt=3):i===Ey?(i=Ty(),rt=4):rt=i===x_?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Hn=i,qe===null&&(Tt=1,pd(s,ns(i,s.current)))}function oE(){var s=B.H;return B.H=ud,s===null?ud:s}function lE(){var s=B.A;return B.A=nj,s}function Bm(){Tt=4,ti||(We&4194048)!==We&&rs.current!==null||(No=!0),(ni&134217727)===0&&(Er&134217727)===0||pt===null||ii(pt,We,os,!1)}function zm(s,i,l){var u=it;it|=2;var m=oE(),g=lE();(pt!==s||We!==i)&&(Nd=null,Co(s,i)),i=!1;var T=Tt;e:do try{if(rt!==0&&qe!==null){var S=qe,H=Hn;switch(rt){case 8:qm(),T=6;break e;case 3:case 2:case 9:case 6:rs.current===null&&(i=!0);var W=rt;if(rt=0,Hn=null,jo(s,S,H,W),l&&No){T=0;break e}break;default:W=rt,rt=0,Hn=null,jo(s,S,H,W)}}ij(),T=Tt;break}catch(se){rE(s,se)}while(!0);return i&&s.shellSuspendCounter++,pa=mr=null,it=u,B.H=m,B.A=g,qe===null&&(pt=null,We=0,Gu()),T}function ij(){for(;qe!==null;)cE(qe)}function rj(s,i){var l=it;it|=2;var u=oE(),m=lE();pt!==s||We!==i?(Nd=null,bd=Xn()+500,Co(s,i)):No=$i(s,i);e:do try{if(rt!==0&&qe!==null){i=qe;var g=Hn;t:switch(rt){case 1:rt=0,Hn=null,jo(s,i,g,1);break;case 2:case 9:if(by(g)){rt=0,Hn=null,uE(i);break}i=function(){rt!==2&&rt!==9||pt!==s||(rt=7),Hs(s)},g.then(i,i);break e;case 3:rt=7;break e;case 4:rt=5;break e;case 7:by(g)?(rt=0,Hn=null,uE(i)):(rt=0,Hn=null,jo(s,i,g,7));break;case 5:var T=null;switch(qe.tag){case 26:T=qe.memoizedState;case 5:case 27:var S=qe;if(!T||GE(T)){rt=0,Hn=null;var H=S.sibling;if(H!==null)qe=H;else{var W=S.return;W!==null?(qe=W,xd(W)):qe=null}break t}}rt=0,Hn=null,jo(s,i,g,5);break;case 6:rt=0,Hn=null,jo(s,i,g,6);break;case 8:qm(),Tt=6;break e;default:throw Error(a(462))}}oj();break}catch(se){rE(s,se)}while(!0);return pa=mr=null,B.H=u,B.A=m,it=l,qe!==null?0:(pt=null,We=0,Gu(),Tt)}function oj(){for(;qe!==null&&!ml();)cE(qe)}function cE(s){var i=k_(s.alternate,s,Ta);s.memoizedProps=s.pendingProps,i===null?xd(s):qe=i}function uE(s){var i=s,l=i.alternate;switch(i.tag){case 15:case 0:i=I_(l,i,i.pendingProps,i.type,void 0,We);break;case 11:i=I_(l,i,i.pendingProps,i.type.render,i.ref,We);break;case 5:im(i);default:V_(l,i),i=qe=dy(i,Ta),i=k_(l,i,Ta)}s.memoizedProps=s.pendingProps,i===null?xd(s):qe=i}function jo(s,i,l,u){pa=mr=null,im(i),yo=null,ec=0;var m=i.return;try{if(XC(s,m,i,l,We)){Tt=1,pd(s,ns(l,s.current)),qe=null;return}}catch(g){if(m!==null)throw qe=m,g;Tt=1,pd(s,ns(l,s.current)),qe=null;return}i.flags&32768?(nt||u===1?s=!0:No||(We&536870912)!==0?s=!1:(ti=s=!0,(u===2||u===9||u===3||u===6)&&(u=rs.current,u!==null&&u.tag===13&&(u.flags|=16384))),dE(i,s)):xd(i)}function xd(s){var i=s;do{if((i.flags&32768)!==0){dE(i,ti);return}s=i.return;var l=ZC(i.alternate,i,Ta);if(l!==null){qe=l;return}if(i=i.sibling,i!==null){qe=i;return}qe=i=s}while(i!==null);Tt===0&&(Tt=5)}function dE(s,i){do{var l=JC(s.alternate,s);if(l!==null){l.flags&=32767,qe=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!i&&(s=s.sibling,s!==null)){qe=s;return}qe=s=l}while(s!==null);Tt=6,qe=null}function hE(s,i,l,u,m,g,T,S,H){s.cancelPendingCommit=null;do Ad();while(nn!==0);if((it&6)!==0)throw Error(a(327));if(i!==null){if(i===s.current)throw Error(a(177));if(g=i.lanes|i.childLanes,g|=Mf,El(s,l,g,T,S,H),s===pt&&(qe=pt=null,We=0),xo=i,ai=s,Ao=l,Um=g,Fm=m,nE=u,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,dj(qi,function(){return vE(),null})):(s.callbackNode=null,s.callbackPriority=0),u=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||u){u=B.T,B.T=null,m=J.p,J.p=2,T=it,it|=4;try{ej(s,i,l)}finally{it=T,J.p=m,B.T=u}}nn=1,fE(),mE(),pE()}}function fE(){if(nn===1){nn=0;var s=ai,i=xo,l=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||l){l=B.T,B.T=null;var u=J.p;J.p=2;var m=it;it|=4;try{Q_(i,s);var g=np,T=ty(s.containerInfo),S=g.focusedElem,H=g.selectionRange;if(T!==S&&S&&S.ownerDocument&&ey(S.ownerDocument.documentElement,S)){if(H!==null&&wf(S)){var W=H.start,se=H.end;if(se===void 0&&(se=W),"selectionStart"in S)S.selectionStart=W,S.selectionEnd=Math.min(se,S.value.length);else{var oe=S.ownerDocument||document,Z=oe&&oe.defaultView||window;if(Z.getSelection){var ee=Z.getSelection(),Ie=S.textContent.length,Ce=Math.min(H.start,Ie),ut=H.end===void 0?Ce:Math.min(H.end,Ie);!ee.extend&&Ce>ut&&(T=ut,ut=Ce,Ce=T);var G=Jv(S,Ce),z=Jv(S,ut);if(G&&z&&(ee.rangeCount!==1||ee.anchorNode!==G.node||ee.anchorOffset!==G.offset||ee.focusNode!==z.node||ee.focusOffset!==z.offset)){var Q=oe.createRange();Q.setStart(G.node,G.offset),ee.removeAllRanges(),Ce>ut?(ee.addRange(Q),ee.extend(z.node,z.offset)):(Q.setEnd(z.node,z.offset),ee.addRange(Q))}}}}for(oe=[],ee=S;ee=ee.parentNode;)ee.nodeType===1&&oe.push({element:ee,left:ee.scrollLeft,top:ee.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<oe.length;S++){var ie=oe[S];ie.element.scrollLeft=ie.left,ie.element.scrollTop=ie.top}}Ld=!!tp,np=tp=null}finally{it=m,J.p=u,B.T=l}}s.current=i,nn=2}}function mE(){if(nn===2){nn=0;var s=ai,i=xo,l=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||l){l=B.T,B.T=null;var u=J.p;J.p=2;var m=it;it|=4;try{G_(s,i.alternate,i)}finally{it=m,J.p=u,B.T=l}}nn=3}}function pE(){if(nn===4||nn===3){nn=0,Eu();var s=ai,i=xo,l=Ao,u=nE;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?nn=5:(nn=0,xo=ai=null,gE(s,s.pendingLanes));var m=s.pendingLanes;if(m===0&&(si=null),Br(l),i=i.stateNode,at&&typeof at.onCommitFiberRoot=="function")try{at.onCommitFiberRoot(bt,i,void 0,(i.current.flags&128)===128)}catch{}if(u!==null){i=B.T,m=J.p,J.p=2,B.T=null;try{for(var g=s.onRecoverableError,T=0;T<u.length;T++){var S=u[T];g(S.value,{componentStack:S.stack})}}finally{B.T=i,J.p=m}}(Ao&3)!==0&&Ad(),Hs(s),m=s.pendingLanes,(l&4194090)!==0&&(m&42)!==0?s===Hm?cc++:(cc=0,Hm=s):cc=0,uc(0)}}function gE(s,i){(s.pooledCacheLanes&=i)===0&&(i=s.pooledCache,i!=null&&(s.pooledCache=null,Bl(i)))}function Ad(s){return fE(),mE(),pE(),vE()}function vE(){if(nn!==5)return!1;var s=ai,i=Um;Um=0;var l=Br(Ao),u=B.T,m=J.p;try{J.p=32>l?32:l,B.T=null,l=Fm,Fm=null;var g=ai,T=Ao;if(nn=0,xo=ai=null,Ao=0,(it&6)!==0)throw Error(a(331));var S=it;if(it|=4,eE(g.current),W_(g,g.current,T,l),it=S,uc(0,!1),at&&typeof at.onPostCommitFiberRoot=="function")try{at.onPostCommitFiberRoot(bt,g)}catch{}return!0}finally{J.p=m,B.T=u,gE(s,i)}}function yE(s,i,l){i=ns(l,i),i=_m(s.stateNode,i,2),s=Ka(s,i,2),s!==null&&(ta(s,2),Hs(s))}function dt(s,i,l){if(s.tag===3)yE(s,s,l);else for(;i!==null;){if(i.tag===3){yE(i,s,l);break}else if(i.tag===1){var u=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(si===null||!si.has(u))){s=ns(l,s),l=N_(2),u=Ka(i,l,2),u!==null&&(T_(l,u,i,s),ta(u,2),Hs(u));break}}i=i.return}}function Gm(s,i,l){var u=s.pingCache;if(u===null){u=s.pingCache=new sj;var m=new Set;u.set(i,m)}else m=u.get(i),m===void 0&&(m=new Set,u.set(i,m));m.has(l)||(Pm=!0,m.add(l),s=lj.bind(null,s,i,l),i.then(s,s))}function lj(s,i,l){var u=s.pingCache;u!==null&&u.delete(i),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,pt===s&&(We&l)===l&&(Tt===4||Tt===3&&(We&62914560)===We&&300>Xn()-Vm?(it&2)===0&&Co(s,0):km|=l,To===We&&(To=0)),Hs(s)}function _E(s,i){i===0&&(i=_l()),s=oo(s,i),s!==null&&(ta(s,i),Hs(s))}function cj(s){var i=s.memoizedState,l=0;i!==null&&(l=i.retryLane),_E(s,l)}function uj(s,i){var l=0;switch(s.tag){case 13:var u=s.stateNode,m=s.memoizedState;m!==null&&(l=m.retryLane);break;case 19:u=s.stateNode;break;case 22:u=s.stateNode._retryCache;break;default:throw Error(a(314))}u!==null&&u.delete(i),_E(s,l)}function dj(s,i){return Fi(s,i)}var Cd=null,So=null,$m=!1,jd=!1,Ym=!1,br=0;function Hs(s){s!==So&&s.next===null&&(So===null?Cd=So=s:So=So.next=s),jd=!0,$m||($m=!0,fj())}function uc(s,i){if(!Ym&&jd){Ym=!0;do for(var l=!1,u=Cd;u!==null;){if(s!==0){var m=u.pendingLanes;if(m===0)var g=0;else{var T=u.suspendedLanes,S=u.pingedLanes;g=(1<<31-hn(42|s)+1)-1,g&=m&~(T&~S),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(l=!0,TE(u,g))}else g=We,g=qr(u,u===pt?g:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(g&3)===0||$i(u,g)||(l=!0,TE(u,g));u=u.next}while(l);Ym=!1}}function hj(){EE()}function EE(){jd=$m=!1;var s=0;br!==0&&(bj()&&(s=br),br=0);for(var i=Xn(),l=null,u=Cd;u!==null;){var m=u.next,g=bE(u,i);g===0?(u.next=null,l===null?Cd=m:l.next=m,m===null&&(So=l)):(l=u,(s!==0||(g&3)!==0)&&(jd=!0)),u=m}uc(s)}function bE(s,i){for(var l=s.suspendedLanes,u=s.pingedLanes,m=s.expirationTimes,g=s.pendingLanes&-62914561;0<g;){var T=31-hn(g),S=1<<T,H=m[T];H===-1?((S&l)===0||(S&u)!==0)&&(m[T]=vl(S,i)):H<=i&&(s.expiredLanes|=S),g&=~S}if(i=pt,l=We,l=qr(s,s===i?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u=s.callbackNode,l===0||s===i&&(rt===2||rt===9)||s.cancelPendingCommit!==null)return u!==null&&u!==null&&Hi(u),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||$i(s,l)){if(i=l&-l,i===s.callbackPriority)return i;switch(u!==null&&Hi(u),Br(l)){case 2:case 8:l=Fr;break;case 32:l=qi;break;case 268435456:l=Hr;break;default:l=qi}return u=NE.bind(null,s),l=Fi(l,u),s.callbackPriority=i,s.callbackNode=l,i}return u!==null&&u!==null&&Hi(u),s.callbackPriority=2,s.callbackNode=null,2}function NE(s,i){if(nn!==0&&nn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(Ad()&&s.callbackNode!==l)return null;var u=We;return u=qr(s,s===pt?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u===0?null:(aE(s,u,i),bE(s,Xn()),s.callbackNode!=null&&s.callbackNode===l?NE.bind(null,s):null)}function TE(s,i){if(Ad())return null;aE(s,i,!0)}function fj(){Tj(function(){(it&6)!==0?Fi(pl,hj):EE()})}function Km(){return br===0&&(br=yl()),br}function xE(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Qr(""+s)}function AE(s,i){var l=i.ownerDocument.createElement("input");return l.name=i.name,l.value=i.value,s.id&&l.setAttribute("form",s.id),i.parentNode.insertBefore(l,i),s=new FormData(s),l.parentNode.removeChild(l),s}function mj(s,i,l,u,m){if(i==="submit"&&l&&l.stateNode===m){var g=xE((m[It]||null).action),T=u.submitter;T&&(i=(i=T[It]||null)?xE(i.formAction):T.getAttribute("formAction"),i!==null&&(g=i,T=null));var S=new Xr("action","action",null,u,m);s.push({event:S,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(br!==0){var H=T?AE(m,T):new FormData(m);mm(l,{pending:!0,data:H,method:m.method,action:g},null,H)}}else typeof g=="function"&&(S.preventDefault(),H=T?AE(m,T):new FormData(m),mm(l,{pending:!0,data:H,method:m.method,action:g},g,H))},currentTarget:m}]})}}for(var Qm=0;Qm<Of.length;Qm++){var Xm=Of[Qm],pj=Xm.toLowerCase(),gj=Xm[0].toUpperCase()+Xm.slice(1);ps(pj,"on"+gj)}ps(ay,"onAnimationEnd"),ps(iy,"onAnimationIteration"),ps(ry,"onAnimationStart"),ps("dblclick","onDoubleClick"),ps("focusin","onFocus"),ps("focusout","onBlur"),ps(OC,"onTransitionRun"),ps(MC,"onTransitionStart"),ps(PC,"onTransitionCancel"),ps(oy,"onTransitionEnd"),sa("onMouseEnter",["mouseout","mouseover"]),sa("onMouseLeave",["mouseout","mouseover"]),sa("onPointerEnter",["pointerout","pointerover"]),sa("onPointerLeave",["pointerout","pointerover"]),fs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),fs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),fs("onBeforeInput",["compositionend","keypress","textInput","paste"]),fs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),fs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),fs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var dc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),vj=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(dc));function CE(s,i){i=(i&4)!==0;for(var l=0;l<s.length;l++){var u=s[l],m=u.event;u=u.listeners;e:{var g=void 0;if(i)for(var T=u.length-1;0<=T;T--){var S=u[T],H=S.instance,W=S.currentTarget;if(S=S.listener,H!==g&&m.isPropagationStopped())break e;g=S,m.currentTarget=W;try{g(m)}catch(se){md(se)}m.currentTarget=null,g=H}else for(T=0;T<u.length;T++){if(S=u[T],H=S.instance,W=S.currentTarget,S=S.listener,H!==g&&m.isPropagationStopped())break e;g=S,m.currentTarget=W;try{g(m)}catch(se){md(se)}m.currentTarget=null,g=H}}}}function Be(s,i){var l=i[Nl];l===void 0&&(l=i[Nl]=new Set);var u=s+"__bubble";l.has(u)||(jE(i,s,2,!1),l.add(u))}function Wm(s,i,l){var u=0;i&&(u|=4),jE(l,s,u,i)}var Sd="_reactListening"+Math.random().toString(36).slice(2);function Zm(s){if(!s[Sd]){s[Sd]=!0,Tl.forEach(function(l){l!=="selectionchange"&&(vj.has(l)||Wm(l,!1,s),Wm(l,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[Sd]||(i[Sd]=!0,Wm("selectionchange",!1,i))}}function jE(s,i,l,u){switch(WE(i)){case 2:var m=zj;break;case 8:m=Gj;break;default:m=hp}l=m.bind(null,i,l,s),m=void 0,!es||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(m=!0),u?m!==void 0?s.addEventListener(i,l,{capture:!0,passive:m}):s.addEventListener(i,l,!0):m!==void 0?s.addEventListener(i,l,{passive:m}):s.addEventListener(i,l,!1)}function Jm(s,i,l,u,m){var g=u;if((i&1)===0&&(i&2)===0&&u!==null)e:for(;;){if(u===null)return;var T=u.tag;if(T===3||T===4){var S=u.stateNode.containerInfo;if(S===m)break;if(T===4)for(T=u.return;T!==null;){var H=T.tag;if((H===3||H===4)&&T.stateNode.containerInfo===m)return;T=T.return}for(;S!==null;){if(T=na(S),T===null)return;if(H=T.tag,H===5||H===6||H===26||H===27){u=g=T;continue e}S=S.parentNode}}u=u.return}Iu(function(){var W=g,se=Jn(l),oe=[];e:{var Z=ly.get(s);if(Z!==void 0){var ee=Xr,Ie=s;switch(s){case"keypress":if(Ds(l)===0)break e;case"keydown":case"keyup":ee=no;break;case"focusin":Ie="focus",ee=Jr;break;case"focusout":Ie="blur",ee=Jr;break;case"beforeblur":case"afterblur":ee=Jr;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ee=ts;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ee=Af;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ee=Vu;break;case ay:case iy:case ry:ee=eo;break;case oy:ee=Fu;break;case"scroll":case"scrollend":ee=Ru;break;case"wheel":ee=so;break;case"copy":case"cut":case"paste":ee=to;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ee=Pl;break;case"toggle":case"beforetoggle":ee=qu}var Ce=(i&4)!==0,ut=!Ce&&(s==="scroll"||s==="scrollend"),G=Ce?Z!==null?Z+"Capture":null:Z;Ce=[];for(var z=W,Q;z!==null;){var ie=z;if(Q=ie.stateNode,ie=ie.tag,ie!==5&&ie!==26&&ie!==27||Q===null||G===null||(ie=er(z,G),ie!=null&&Ce.push(hc(z,ie,Q))),ut)break;z=z.return}0<Ce.length&&(Z=new ee(Z,Ie,null,l,se),oe.push({event:Z,listeners:Ce}))}}if((i&7)===0){e:{if(Z=s==="mouseover"||s==="pointerover",ee=s==="mouseout"||s==="pointerout",Z&&l!==ra&&(Ie=l.relatedTarget||l.fromElement)&&(na(Ie)||Ie[Wn]))break e;if((ee||Z)&&(Z=se.window===se?se:(Z=se.ownerDocument)?Z.defaultView||Z.parentWindow:window,ee?(Ie=l.relatedTarget||l.toElement,ee=W,Ie=Ie?na(Ie):null,Ie!==null&&(ut=c(Ie),Ce=Ie.tag,Ie!==ut||Ce!==5&&Ce!==27&&Ce!==6)&&(Ie=null)):(ee=null,Ie=W),ee!==Ie)){if(Ce=ts,ie="onMouseLeave",G="onMouseEnter",z="mouse",(s==="pointerout"||s==="pointerover")&&(Ce=Pl,ie="onPointerLeave",G="onPointerEnter",z="pointer"),ut=ee==null?Z:Ss(ee),Q=Ie==null?Z:Ss(Ie),Z=new Ce(ie,z+"leave",ee,l,se),Z.target=ut,Z.relatedTarget=Q,ie=null,na(se)===W&&(Ce=new Ce(G,z+"enter",Ie,l,se),Ce.target=Q,Ce.relatedTarget=ut,ie=Ce),ut=ie,ee&&Ie)t:{for(Ce=ee,G=Ie,z=0,Q=Ce;Q;Q=wo(Q))z++;for(Q=0,ie=G;ie;ie=wo(ie))Q++;for(;0<z-Q;)Ce=wo(Ce),z--;for(;0<Q-z;)G=wo(G),Q--;for(;z--;){if(Ce===G||G!==null&&Ce===G.alternate)break t;Ce=wo(Ce),G=wo(G)}Ce=null}else Ce=null;ee!==null&&SE(oe,Z,ee,Ce,!1),Ie!==null&&ut!==null&&SE(oe,ut,Ie,Ce,!0)}}e:{if(Z=W?Ss(W):window,ee=Z.nodeName&&Z.nodeName.toLowerCase(),ee==="select"||ee==="input"&&Z.type==="file")var _e=Yv;else if(Ut(Z))if(Kv)_e=IC;else{_e=SC;var He=jC}else ee=Z.nodeName,!ee||ee.toLowerCase()!=="input"||Z.type!=="checkbox"&&Z.type!=="radio"?W&&Sl(W.elementType)&&(_e=Yv):_e=wC;if(_e&&(_e=_e(s,W))){da(oe,_e,l,se);break e}He&&He(s,Z,W),s==="focusout"&&W&&Z.type==="number"&&W.memoizedProps.value!=null&&Ba(Z,"number",Z.value)}switch(He=W?Ss(W):window,s){case"focusin":(Ut(He)||He.contentEditable==="true")&&(ao=He,If=W,Vl=null);break;case"focusout":Vl=If=ao=null;break;case"mousedown":Rf=!0;break;case"contextmenu":case"mouseup":case"dragend":Rf=!1,ny(oe,l,se);break;case"selectionchange":if(DC)break;case"keydown":case"keyup":ny(oe,l,se)}var Ee;if(Ps)e:{switch(s){case"compositionstart":var je="onCompositionStart";break e;case"compositionend":je="onCompositionEnd";break e;case"compositionupdate":je="onCompositionUpdate";break e}je=void 0}else Qe?te(s,l)&&(je="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(je="onCompositionStart");je&&(E&&l.locale!=="ko"&&(Qe||je!=="onCompositionStart"?je==="onCompositionEnd"&&Qe&&(Ee=Il()):(Rs=se,za="value"in Rs?Rs.value:Rs.textContent,Qe=!0)),He=wd(W,je),0<He.length&&(je=new Ol(je,s,null,l,se),oe.push({event:je,listeners:He}),Ee?je.data=Ee:(Ee=de(l),Ee!==null&&(je.data=Ee)))),(Ee=y?Vt(s,l):Xe(s,l))&&(je=wd(W,"onBeforeInput"),0<je.length&&(He=new Ol("onBeforeInput","beforeinput",null,l,se),oe.push({event:He,listeners:je}),He.data=Ee)),mj(oe,s,W,l,se)}CE(oe,i)})}function hc(s,i,l){return{instance:s,listener:i,currentTarget:l}}function wd(s,i){for(var l=i+"Capture",u=[];s!==null;){var m=s,g=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||g===null||(m=er(s,l),m!=null&&u.unshift(hc(s,m,g)),m=er(s,i),m!=null&&u.push(hc(s,m,g))),s.tag===3)return u;s=s.return}return[]}function wo(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function SE(s,i,l,u,m){for(var g=i._reactName,T=[];l!==null&&l!==u;){var S=l,H=S.alternate,W=S.stateNode;if(S=S.tag,H!==null&&H===u)break;S!==5&&S!==26&&S!==27||W===null||(H=W,m?(W=er(l,g),W!=null&&T.unshift(hc(l,W,H))):m||(W=er(l,g),W!=null&&T.push(hc(l,W,H)))),l=l.return}T.length!==0&&s.push({event:i,listeners:T})}var yj=/\r\n?/g,_j=/\u0000|\uFFFD/g;function wE(s){return(typeof s=="string"?s:""+s).replace(yj,`
`).replace(_j,"")}function IE(s,i){return i=wE(i),wE(s)===i}function Id(){}function ct(s,i,l,u,m,g){switch(l){case"children":typeof u=="string"?i==="body"||i==="textarea"&&u===""||Zn(s,u):(typeof u=="number"||typeof u=="bigint")&&i!=="body"&&Zn(s,""+u);break;case"className":ws(s,"class",u);break;case"tabIndex":ws(s,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":ws(s,l,u);break;case"style":jl(s,u,g);break;case"data":if(i!=="object"){ws(s,"data",u);break}case"src":case"href":if(u===""&&(i!=="a"||l!=="href")){s.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Qr(""+u),s.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(l==="formAction"?(i!=="input"&&ct(s,i,"name",m.name,m,null),ct(s,i,"formEncType",m.formEncType,m,null),ct(s,i,"formMethod",m.formMethod,m,null),ct(s,i,"formTarget",m.formTarget,m,null)):(ct(s,i,"encType",m.encType,m,null),ct(s,i,"method",m.method,m,null),ct(s,i,"target",m.target,m,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=Qr(""+u),s.setAttribute(l,u);break;case"onClick":u!=null&&(s.onclick=Id);break;case"onScroll":u!=null&&Be("scroll",s);break;case"onScrollEnd":u!=null&&Be("scrollend",s);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(l=u.__html,l!=null){if(m.children!=null)throw Error(a(60));s.innerHTML=l}}break;case"multiple":s.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":s.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){s.removeAttribute("xlink:href");break}l=Qr(""+u),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""+u):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":u===!0?s.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,u):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?s.setAttribute(l,u):s.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?s.removeAttribute(l):s.setAttribute(l,u);break;case"popover":Be("beforetoggle",s),Be("toggle",s),qa(s,"popover",u);break;case"xlinkActuate":Jt(s,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Jt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Jt(s,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Jt(s,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Jt(s,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Jt(s,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Jt(s,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Jt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Jt(s,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":qa(s,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Tf.get(l)||l,qa(s,l,u))}}function ep(s,i,l,u,m,g){switch(l){case"style":jl(s,u,g);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(l=u.__html,l!=null){if(m.children!=null)throw Error(a(60));s.innerHTML=l}}break;case"children":typeof u=="string"?Zn(s,u):(typeof u=="number"||typeof u=="bigint")&&Zn(s,""+u);break;case"onScroll":u!=null&&Be("scroll",s);break;case"onScrollEnd":u!=null&&Be("scrollend",s);break;case"onClick":u!=null&&(s.onclick=Id);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!zr.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(m=l.endsWith("Capture"),i=l.slice(2,m?l.length-7:void 0),g=s[It]||null,g=g!=null?g[l]:null,typeof g=="function"&&s.removeEventListener(i,g,m),typeof u=="function")){typeof g!="function"&&g!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(i,u,m);break e}l in s?s[l]=u:u===!0?s.setAttribute(l,""):qa(s,l,u)}}}function sn(s,i,l){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Be("error",s),Be("load",s);var u=!1,m=!1,g;for(g in l)if(l.hasOwnProperty(g)){var T=l[g];if(T!=null)switch(g){case"src":u=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:ct(s,i,g,T,l,null)}}m&&ct(s,i,"srcSet",l.srcSet,l,null),u&&ct(s,i,"src",l.src,l,null);return;case"input":Be("invalid",s);var S=g=T=m=null,H=null,W=null;for(u in l)if(l.hasOwnProperty(u)){var se=l[u];if(se!=null)switch(u){case"name":m=se;break;case"type":T=se;break;case"checked":H=se;break;case"defaultChecked":W=se;break;case"value":g=se;break;case"defaultValue":S=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(a(137,i));break;default:ct(s,i,u,se,l,null)}}Wi(s,g,S,H,W,T,m,!1),Kr(s);return;case"select":Be("invalid",s),u=T=g=null;for(m in l)if(l.hasOwnProperty(m)&&(S=l[m],S!=null))switch(m){case"value":g=S;break;case"defaultValue":T=S;break;case"multiple":u=S;default:ct(s,i,m,S,l,null)}i=g,l=T,s.multiple=!!u,i!=null?ia(s,!!u,i,!1):l!=null&&ia(s,!!u,l,!0);return;case"textarea":Be("invalid",s),g=m=u=null;for(T in l)if(l.hasOwnProperty(T)&&(S=l[T],S!=null))switch(T){case"value":u=S;break;case"defaultValue":m=S;break;case"children":g=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(a(91));break;default:ct(s,i,T,S,l,null)}Zi(s,u,m,g),Kr(s);return;case"option":for(H in l)if(l.hasOwnProperty(H)&&(u=l[H],u!=null))switch(H){case"selected":s.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:ct(s,i,H,u,l,null)}return;case"dialog":Be("beforetoggle",s),Be("toggle",s),Be("cancel",s),Be("close",s);break;case"iframe":case"object":Be("load",s);break;case"video":case"audio":for(u=0;u<dc.length;u++)Be(dc[u],s);break;case"image":Be("error",s),Be("load",s);break;case"details":Be("toggle",s);break;case"embed":case"source":case"link":Be("error",s),Be("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(W in l)if(l.hasOwnProperty(W)&&(u=l[W],u!=null))switch(W){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:ct(s,i,W,u,l,null)}return;default:if(Sl(i)){for(se in l)l.hasOwnProperty(se)&&(u=l[se],u!==void 0&&ep(s,i,se,u,l,void 0));return}}for(S in l)l.hasOwnProperty(S)&&(u=l[S],u!=null&&ct(s,i,S,u,l,null))}function Ej(s,i,l,u){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,g=null,T=null,S=null,H=null,W=null,se=null;for(ee in l){var oe=l[ee];if(l.hasOwnProperty(ee)&&oe!=null)switch(ee){case"checked":break;case"value":break;case"defaultValue":H=oe;default:u.hasOwnProperty(ee)||ct(s,i,ee,null,u,oe)}}for(var Z in u){var ee=u[Z];if(oe=l[Z],u.hasOwnProperty(Z)&&(ee!=null||oe!=null))switch(Z){case"type":g=ee;break;case"name":m=ee;break;case"checked":W=ee;break;case"defaultChecked":se=ee;break;case"value":T=ee;break;case"defaultValue":S=ee;break;case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(a(137,i));break;default:ee!==oe&&ct(s,i,Z,ee,u,oe)}}kn(s,T,S,H,W,se,g,m);return;case"select":ee=T=S=Z=null;for(g in l)if(H=l[g],l.hasOwnProperty(g)&&H!=null)switch(g){case"value":break;case"multiple":ee=H;default:u.hasOwnProperty(g)||ct(s,i,g,null,u,H)}for(m in u)if(g=u[m],H=l[m],u.hasOwnProperty(m)&&(g!=null||H!=null))switch(m){case"value":Z=g;break;case"defaultValue":S=g;break;case"multiple":T=g;default:g!==H&&ct(s,i,m,g,u,H)}i=S,l=T,u=ee,Z!=null?ia(s,!!l,Z,!1):!!u!=!!l&&(i!=null?ia(s,!!l,i,!0):ia(s,!!l,l?[]:"",!1));return;case"textarea":ee=Z=null;for(S in l)if(m=l[S],l.hasOwnProperty(S)&&m!=null&&!u.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:ct(s,i,S,null,u,m)}for(T in u)if(m=u[T],g=l[T],u.hasOwnProperty(T)&&(m!=null||g!=null))switch(T){case"value":Z=m;break;case"defaultValue":ee=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(a(91));break;default:m!==g&&ct(s,i,T,m,u,g)}ot(s,Z,ee);return;case"option":for(var Ie in l)if(Z=l[Ie],l.hasOwnProperty(Ie)&&Z!=null&&!u.hasOwnProperty(Ie))switch(Ie){case"selected":s.selected=!1;break;default:ct(s,i,Ie,null,u,Z)}for(H in u)if(Z=u[H],ee=l[H],u.hasOwnProperty(H)&&Z!==ee&&(Z!=null||ee!=null))switch(H){case"selected":s.selected=Z&&typeof Z!="function"&&typeof Z!="symbol";break;default:ct(s,i,H,Z,u,ee)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ce in l)Z=l[Ce],l.hasOwnProperty(Ce)&&Z!=null&&!u.hasOwnProperty(Ce)&&ct(s,i,Ce,null,u,Z);for(W in u)if(Z=u[W],ee=l[W],u.hasOwnProperty(W)&&Z!==ee&&(Z!=null||ee!=null))switch(W){case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(a(137,i));break;default:ct(s,i,W,Z,u,ee)}return;default:if(Sl(i)){for(var ut in l)Z=l[ut],l.hasOwnProperty(ut)&&Z!==void 0&&!u.hasOwnProperty(ut)&&ep(s,i,ut,void 0,u,Z);for(se in u)Z=u[se],ee=l[se],!u.hasOwnProperty(se)||Z===ee||Z===void 0&&ee===void 0||ep(s,i,se,Z,u,ee);return}}for(var G in l)Z=l[G],l.hasOwnProperty(G)&&Z!=null&&!u.hasOwnProperty(G)&&ct(s,i,G,null,u,Z);for(oe in u)Z=u[oe],ee=l[oe],!u.hasOwnProperty(oe)||Z===ee||Z==null&&ee==null||ct(s,i,oe,Z,u,ee)}var tp=null,np=null;function Rd(s){return s.nodeType===9?s:s.ownerDocument}function RE(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function DE(s,i){if(s===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&i==="foreignObject"?0:s}function sp(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var ap=null;function bj(){var s=window.event;return s&&s.type==="popstate"?s===ap?!1:(ap=s,!0):(ap=null,!1)}var OE=typeof setTimeout=="function"?setTimeout:void 0,Nj=typeof clearTimeout=="function"?clearTimeout:void 0,ME=typeof Promise=="function"?Promise:void 0,Tj=typeof queueMicrotask=="function"?queueMicrotask:typeof ME<"u"?function(s){return ME.resolve(null).then(s).catch(xj)}:OE;function xj(s){setTimeout(function(){throw s})}function ri(s){return s==="head"}function PE(s,i){var l=i,u=0,m=0;do{var g=l.nextSibling;if(s.removeChild(l),g&&g.nodeType===8)if(l=g.data,l==="/$"){if(0<u&&8>u){l=u;var T=s.ownerDocument;if(l&1&&fc(T.documentElement),l&2&&fc(T.body),l&4)for(l=T.head,fc(l),T=l.firstChild;T;){var S=T.nextSibling,H=T.nodeName;T[Yi]||H==="SCRIPT"||H==="STYLE"||H==="LINK"&&T.rel.toLowerCase()==="stylesheet"||l.removeChild(T),T=S}}if(m===0){s.removeChild(g),bc(i);return}m--}else l==="$"||l==="$?"||l==="$!"?m++:u=l.charCodeAt(0)-48;else u=0;l=g}while(l);bc(i)}function ip(s){var i=s.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var l=i;switch(i=i.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":ip(l),Ha(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function Aj(s,i,l,u){for(;s.nodeType===1;){var m=l;if(s.nodeName.toLowerCase()!==i.toLowerCase()){if(!u&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(u){if(!s[Yi])switch(i){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(g=s.getAttribute("rel"),g==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(g!==m.rel||s.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||s.getAttribute("title")!==(m.title==null?null:m.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(g=s.getAttribute("src"),(g!==(m.src==null?null:m.src)||s.getAttribute("type")!==(m.type==null?null:m.type)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&g&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(i==="input"&&s.type==="hidden"){var g=m.name==null?null:""+m.name;if(m.type==="hidden"&&s.getAttribute("name")===g)return s}else return s;if(s=vs(s.nextSibling),s===null)break}return null}function Cj(s,i,l){if(i==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=vs(s.nextSibling),s===null))return null;return s}function rp(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function jj(s,i){var l=s.ownerDocument;if(s.data!=="$?"||l.readyState==="complete")i();else{var u=function(){i(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),s._reactRetry=u}}function vs(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?"||i==="F!"||i==="F")break;if(i==="/$")return null}}return s}var op=null;function kE(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"){if(i===0)return s;i--}else l==="/$"&&i++}s=s.previousSibling}return null}function LE(s,i,l){switch(i=Rd(l),s){case"html":if(s=i.documentElement,!s)throw Error(a(452));return s;case"head":if(s=i.head,!s)throw Error(a(453));return s;case"body":if(s=i.body,!s)throw Error(a(454));return s;default:throw Error(a(451))}}function fc(s){for(var i=s.attributes;i.length;)s.removeAttributeNode(i[0]);Ha(s)}var ls=new Map,VE=new Set;function Dd(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var xa=J.d;J.d={f:Sj,r:wj,D:Ij,C:Rj,L:Dj,m:Oj,X:Pj,S:Mj,M:kj};function Sj(){var s=xa.f(),i=Td();return s||i}function wj(s){var i=js(s);i!==null&&i.tag===5&&i.type==="form"?a_(i):xa.r(s)}var Io=typeof document>"u"?null:document;function UE(s,i,l){var u=Io;if(u&&typeof i=="string"&&i){var m=Rt(i);m='link[rel="'+s+'"][href="'+m+'"]',typeof l=="string"&&(m+='[crossorigin="'+l+'"]'),VE.has(m)||(VE.add(m),s={rel:s,crossOrigin:l,href:i},u.querySelector(m)===null&&(i=u.createElement("link"),sn(i,"link",s),At(i),u.head.appendChild(i)))}}function Ij(s){xa.D(s),UE("dns-prefetch",s,null)}function Rj(s,i){xa.C(s,i),UE("preconnect",s,i)}function Dj(s,i,l){xa.L(s,i,l);var u=Io;if(u&&s&&i){var m='link[rel="preload"][as="'+Rt(i)+'"]';i==="image"&&l&&l.imageSrcSet?(m+='[imagesrcset="'+Rt(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(m+='[imagesizes="'+Rt(l.imageSizes)+'"]')):m+='[href="'+Rt(s)+'"]';var g=m;switch(i){case"style":g=Ro(s);break;case"script":g=Do(s)}ls.has(g)||(s=_({rel:"preload",href:i==="image"&&l&&l.imageSrcSet?void 0:s,as:i},l),ls.set(g,s),u.querySelector(m)!==null||i==="style"&&u.querySelector(mc(g))||i==="script"&&u.querySelector(pc(g))||(i=u.createElement("link"),sn(i,"link",s),At(i),u.head.appendChild(i)))}}function Oj(s,i){xa.m(s,i);var l=Io;if(l&&s){var u=i&&typeof i.as=="string"?i.as:"script",m='link[rel="modulepreload"][as="'+Rt(u)+'"][href="'+Rt(s)+'"]',g=m;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=Do(s)}if(!ls.has(g)&&(s=_({rel:"modulepreload",href:s},i),ls.set(g,s),l.querySelector(m)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(pc(g)))return}u=l.createElement("link"),sn(u,"link",s),At(u),l.head.appendChild(u)}}}function Mj(s,i,l){xa.S(s,i,l);var u=Io;if(u&&s){var m=En(u).hoistableStyles,g=Ro(s);i=i||"default";var T=m.get(g);if(!T){var S={loading:0,preload:null};if(T=u.querySelector(mc(g)))S.loading=5;else{s=_({rel:"stylesheet",href:s,"data-precedence":i},l),(l=ls.get(g))&&lp(s,l);var H=T=u.createElement("link");At(H),sn(H,"link",s),H._p=new Promise(function(W,se){H.onload=W,H.onerror=se}),H.addEventListener("load",function(){S.loading|=1}),H.addEventListener("error",function(){S.loading|=2}),S.loading|=4,Od(T,i,u)}T={type:"stylesheet",instance:T,count:1,state:S},m.set(g,T)}}}function Pj(s,i){xa.X(s,i);var l=Io;if(l&&s){var u=En(l).hoistableScripts,m=Do(s),g=u.get(m);g||(g=l.querySelector(pc(m)),g||(s=_({src:s,async:!0},i),(i=ls.get(m))&&cp(s,i),g=l.createElement("script"),At(g),sn(g,"link",s),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(m,g))}}function kj(s,i){xa.M(s,i);var l=Io;if(l&&s){var u=En(l).hoistableScripts,m=Do(s),g=u.get(m);g||(g=l.querySelector(pc(m)),g||(s=_({src:s,async:!0,type:"module"},i),(i=ls.get(m))&&cp(s,i),g=l.createElement("script"),At(g),sn(g,"link",s),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(m,g))}}function FE(s,i,l,u){var m=(m=De.current)?Dd(m):null;if(!m)throw Error(a(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(i=Ro(l.href),l=En(m).hoistableStyles,u=l.get(i),u||(u={type:"style",instance:null,count:0,state:null},l.set(i,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=Ro(l.href);var g=En(m).hoistableStyles,T=g.get(s);if(T||(m=m.ownerDocument||m,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(s,T),(g=m.querySelector(mc(s)))&&!g._p&&(T.instance=g,T.state.loading=5),ls.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},ls.set(s,l),g||Lj(m,s,l,T.state))),i&&u===null)throw Error(a(528,""));return T}if(i&&u!==null)throw Error(a(529,""));return null;case"script":return i=l.async,l=l.src,typeof l=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Do(l),l=En(m).hoistableScripts,u=l.get(i),u||(u={type:"script",instance:null,count:0,state:null},l.set(i,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,s))}}function Ro(s){return'href="'+Rt(s)+'"'}function mc(s){return'link[rel="stylesheet"]['+s+"]"}function HE(s){return _({},s,{"data-precedence":s.precedence,precedence:null})}function Lj(s,i,l,u){s.querySelector('link[rel="preload"][as="style"]['+i+"]")?u.loading=1:(i=s.createElement("link"),u.preload=i,i.addEventListener("load",function(){return u.loading|=1}),i.addEventListener("error",function(){return u.loading|=2}),sn(i,"link",l),At(i),s.head.appendChild(i))}function Do(s){return'[src="'+Rt(s)+'"]'}function pc(s){return"script[async]"+s}function qE(s,i,l){if(i.count++,i.instance===null)switch(i.type){case"style":var u=s.querySelector('style[data-href~="'+Rt(l.href)+'"]');if(u)return i.instance=u,At(u),u;var m=_({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(s.ownerDocument||s).createElement("style"),At(u),sn(u,"style",m),Od(u,l.precedence,s),i.instance=u;case"stylesheet":m=Ro(l.href);var g=s.querySelector(mc(m));if(g)return i.state.loading|=4,i.instance=g,At(g),g;u=HE(l),(m=ls.get(m))&&lp(u,m),g=(s.ownerDocument||s).createElement("link"),At(g);var T=g;return T._p=new Promise(function(S,H){T.onload=S,T.onerror=H}),sn(g,"link",u),i.state.loading|=4,Od(g,l.precedence,s),i.instance=g;case"script":return g=Do(l.src),(m=s.querySelector(pc(g)))?(i.instance=m,At(m),m):(u=l,(m=ls.get(g))&&(u=_({},l),cp(u,m)),s=s.ownerDocument||s,m=s.createElement("script"),At(m),sn(m,"link",u),s.head.appendChild(m),i.instance=m);case"void":return null;default:throw Error(a(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(u=i.instance,i.state.loading|=4,Od(u,l.precedence,s));return i.instance}function Od(s,i,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=u.length?u[u.length-1]:null,g=m,T=0;T<u.length;T++){var S=u[T];if(S.dataset.precedence===i)g=S;else if(g!==m)break}g?g.parentNode.insertBefore(s,g.nextSibling):(i=l.nodeType===9?l.head:l,i.insertBefore(s,i.firstChild))}function lp(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.title==null&&(s.title=i.title)}function cp(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.integrity==null&&(s.integrity=i.integrity)}var Md=null;function BE(s,i,l){if(Md===null){var u=new Map,m=Md=new Map;m.set(l,u)}else m=Md,u=m.get(l),u||(u=new Map,m.set(l,u));if(u.has(s))return u;for(u.set(s,null),l=l.getElementsByTagName(s),m=0;m<l.length;m++){var g=l[m];if(!(g[Yi]||g[Lt]||s==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var T=g.getAttribute(i)||"";T=s+T;var S=u.get(T);S?S.push(g):u.set(T,[g])}}return u}function zE(s,i,l){s=s.ownerDocument||s,s.head.insertBefore(l,i==="title"?s.querySelector("head > title"):null)}function Vj(s,i,l){if(l===1||i.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return s=i.disabled,typeof i.precedence=="string"&&s==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function GE(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var gc=null;function Uj(){}function Fj(s,i,l){if(gc===null)throw Error(a(475));var u=gc;if(i.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var m=Ro(l.href),g=s.querySelector(mc(m));if(g){s=g._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(u.count++,u=Pd.bind(u),s.then(u,u)),i.state.loading|=4,i.instance=g,At(g);return}g=s.ownerDocument||s,l=HE(l),(m=ls.get(m))&&lp(l,m),g=g.createElement("link"),At(g);var T=g;T._p=new Promise(function(S,H){T.onload=S,T.onerror=H}),sn(g,"link",l),i.instance=g}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(i,s),(s=i.state.preload)&&(i.state.loading&3)===0&&(u.count++,i=Pd.bind(u),s.addEventListener("load",i),s.addEventListener("error",i))}}function Hj(){if(gc===null)throw Error(a(475));var s=gc;return s.stylesheets&&s.count===0&&up(s,s.stylesheets),0<s.count?function(i){var l=setTimeout(function(){if(s.stylesheets&&up(s,s.stylesheets),s.unsuspend){var u=s.unsuspend;s.unsuspend=null,u()}},6e4);return s.unsuspend=i,function(){s.unsuspend=null,clearTimeout(l)}}:null}function Pd(){if(this.count--,this.count===0){if(this.stylesheets)up(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var kd=null;function up(s,i){s.stylesheets=null,s.unsuspend!==null&&(s.count++,kd=new Map,i.forEach(qj,s),kd=null,Pd.call(s))}function qj(s,i){if(!(i.state.loading&4)){var l=kd.get(s);if(l)var u=l.get(null);else{l=new Map,kd.set(s,l);for(var m=s.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<m.length;g++){var T=m[g];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(l.set(T.dataset.precedence,T),u=T)}u&&l.set(null,u)}m=i.instance,T=m.getAttribute("data-precedence"),g=l.get(T)||u,g===u&&l.set(null,m),l.set(T,m),this.count++,u=Pd.bind(this),m.addEventListener("load",u),m.addEventListener("error",u),g?g.parentNode.insertBefore(m,g.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(m,s.firstChild)),i.state.loading|=4}}var vc={$$typeof:O,Provider:null,Consumer:null,_currentValue:ce,_currentValue2:ce,_threadCount:0};function Bj(s,i,l,u,m,g,T,S){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ea(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ea(0),this.hiddenUpdates=ea(null),this.identifierPrefix=u,this.onUncaughtError=m,this.onCaughtError=g,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=S,this.incompleteTransitions=new Map}function $E(s,i,l,u,m,g,T,S,H,W,se,oe){return s=new Bj(s,i,l,T,S,H,W,oe),i=1,g===!0&&(i|=24),g=Vn(3,null,null,i),s.current=g,g.stateNode=s,i=Gf(),i.refCount++,s.pooledCache=i,i.refCount++,g.memoizedState={element:u,isDehydrated:l,cache:i},Qf(g),s}function YE(s){return s?(s=lo,s):lo}function KE(s,i,l,u,m,g){m=YE(m),u.context===null?u.context=m:u.pendingContext=m,u=Ya(i),u.payload={element:l},g=g===void 0?null:g,g!==null&&(u.callback=g),l=Ka(s,u,i),l!==null&&(Bn(l,s,i),Yl(l,s,i))}function QE(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<i?l:i}}function dp(s,i){QE(s,i),(s=s.alternate)&&QE(s,i)}function XE(s){if(s.tag===13){var i=oo(s,67108864);i!==null&&Bn(i,s,67108864),dp(s,67108864)}}var Ld=!0;function zj(s,i,l,u){var m=B.T;B.T=null;var g=J.p;try{J.p=2,hp(s,i,l,u)}finally{J.p=g,B.T=m}}function Gj(s,i,l,u){var m=B.T;B.T=null;var g=J.p;try{J.p=8,hp(s,i,l,u)}finally{J.p=g,B.T=m}}function hp(s,i,l,u){if(Ld){var m=fp(u);if(m===null)Jm(s,i,u,Vd,l),ZE(s,u);else if(Yj(m,s,i,l,u))u.stopPropagation();else if(ZE(s,u),i&4&&-1<$j.indexOf(s)){for(;m!==null;){var g=js(m);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var T=hs(g.pendingLanes);if(T!==0){var S=g;for(S.pendingLanes|=2,S.entangledLanes|=2;T;){var H=1<<31-hn(T);S.entanglements[1]|=H,T&=~H}Hs(g),(it&6)===0&&(bd=Xn()+500,uc(0))}}break;case 13:S=oo(g,2),S!==null&&Bn(S,g,2),Td(),dp(g,2)}if(g=fp(u),g===null&&Jm(s,i,u,Vd,l),g===m)break;m=g}m!==null&&u.stopPropagation()}else Jm(s,i,u,null,l)}}function fp(s){return s=Jn(s),mp(s)}var Vd=null;function mp(s){if(Vd=null,s=na(s),s!==null){var i=c(s);if(i===null)s=null;else{var l=i.tag;if(l===13){if(s=d(i),s!==null)return s;s=null}else if(l===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null)}}return Vd=s,null}function WE(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(vf()){case pl:return 2;case Fr:return 8;case qi:case yf:return 32;case Hr:return 268435456;default:return 32}default:return 32}}var pp=!1,oi=null,li=null,ci=null,yc=new Map,_c=new Map,ui=[],$j="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ZE(s,i){switch(s){case"focusin":case"focusout":oi=null;break;case"dragenter":case"dragleave":li=null;break;case"mouseover":case"mouseout":ci=null;break;case"pointerover":case"pointerout":yc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":_c.delete(i.pointerId)}}function Ec(s,i,l,u,m,g){return s===null||s.nativeEvent!==g?(s={blockedOn:i,domEventName:l,eventSystemFlags:u,nativeEvent:g,targetContainers:[m]},i!==null&&(i=js(i),i!==null&&XE(i)),s):(s.eventSystemFlags|=u,i=s.targetContainers,m!==null&&i.indexOf(m)===-1&&i.push(m),s)}function Yj(s,i,l,u,m){switch(i){case"focusin":return oi=Ec(oi,s,i,l,u,m),!0;case"dragenter":return li=Ec(li,s,i,l,u,m),!0;case"mouseover":return ci=Ec(ci,s,i,l,u,m),!0;case"pointerover":var g=m.pointerId;return yc.set(g,Ec(yc.get(g)||null,s,i,l,u,m)),!0;case"gotpointercapture":return g=m.pointerId,_c.set(g,Ec(_c.get(g)||null,s,i,l,u,m)),!0}return!1}function JE(s){var i=na(s.target);if(i!==null){var l=c(i);if(l!==null){if(i=l.tag,i===13){if(i=d(l),i!==null){s.blockedOn=i,Tu(s.priority,function(){if(l.tag===13){var u=qn();u=Va(u);var m=oo(l,u);m!==null&&Bn(m,l,u),dp(l,u)}});return}}else if(i===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Ud(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var l=fp(s.nativeEvent);if(l===null){l=s.nativeEvent;var u=new l.constructor(l.type,l);ra=u,l.target.dispatchEvent(u),ra=null}else return i=js(l),i!==null&&XE(i),s.blockedOn=l,!1;i.shift()}return!0}function eb(s,i,l){Ud(s)&&l.delete(i)}function Kj(){pp=!1,oi!==null&&Ud(oi)&&(oi=null),li!==null&&Ud(li)&&(li=null),ci!==null&&Ud(ci)&&(ci=null),yc.forEach(eb),_c.forEach(eb)}function Fd(s,i){s.blockedOn===i&&(s.blockedOn=null,pp||(pp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Kj)))}var Hd=null;function tb(s){Hd!==s&&(Hd=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Hd===s&&(Hd=null);for(var i=0;i<s.length;i+=3){var l=s[i],u=s[i+1],m=s[i+2];if(typeof u!="function"){if(mp(u||l)===null)continue;break}var g=js(l);g!==null&&(s.splice(i,3),i-=3,mm(g,{pending:!0,data:m,method:l.method,action:u},u,m))}}))}function bc(s){function i(H){return Fd(H,s)}oi!==null&&Fd(oi,s),li!==null&&Fd(li,s),ci!==null&&Fd(ci,s),yc.forEach(i),_c.forEach(i);for(var l=0;l<ui.length;l++){var u=ui[l];u.blockedOn===s&&(u.blockedOn=null)}for(;0<ui.length&&(l=ui[0],l.blockedOn===null);)JE(l),l.blockedOn===null&&ui.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var m=l[u],g=l[u+1],T=m[It]||null;if(typeof g=="function")T||tb(l);else if(T){var S=null;if(g&&g.hasAttribute("formAction")){if(m=g,T=g[It]||null)S=T.formAction;else if(mp(m)!==null)continue}else S=T.action;typeof S=="function"?l[u+1]=S:(l.splice(u,3),u-=3),tb(l)}}}function gp(s){this._internalRoot=s}qd.prototype.render=gp.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(a(409));var l=i.current,u=qn();KE(l,u,s,i,null,null)},qd.prototype.unmount=gp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;KE(s.current,2,null,s,null,null),Td(),i[Wn]=null}};function qd(s){this._internalRoot=s}qd.prototype.unstable_scheduleHydration=function(s){if(s){var i=Ua();s={blockedOn:null,target:s,priority:i};for(var l=0;l<ui.length&&i!==0&&i<ui[l].priority;l++);ui.splice(l,0,s),l===0&&JE(s)}};var nb=e.version;if(nb!=="19.1.0")throw Error(a(527,nb,"19.1.0"));J.findDOMNode=function(s){var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(a(188)):(s=Object.keys(s).join(","),Error(a(268,s)));return s=p(i),s=s!==null?v(s):null,s=s===null?null:s.stateNode,s};var Qj={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bd.isDisabled&&Bd.supportsFiber)try{bt=Bd.inject(Qj),at=Bd}catch{}}return Tc.createRoot=function(s,i){if(!o(s))throw Error(a(299));var l=!1,u="",m=y_,g=__,T=E_,S=null;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(u=i.identifierPrefix),i.onUncaughtError!==void 0&&(m=i.onUncaughtError),i.onCaughtError!==void 0&&(g=i.onCaughtError),i.onRecoverableError!==void 0&&(T=i.onRecoverableError),i.unstable_transitionCallbacks!==void 0&&(S=i.unstable_transitionCallbacks)),i=$E(s,1,!1,null,null,l,u,m,g,T,S,null),s[Wn]=i.current,Zm(s),new gp(i)},Tc.hydrateRoot=function(s,i,l){if(!o(s))throw Error(a(299));var u=!1,m="",g=y_,T=__,S=E_,H=null,W=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(g=l.onUncaughtError),l.onCaughtError!==void 0&&(T=l.onCaughtError),l.onRecoverableError!==void 0&&(S=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(H=l.unstable_transitionCallbacks),l.formState!==void 0&&(W=l.formState)),i=$E(s,1,!0,i,l??null,u,m,g,T,S,H,W),i.context=YE(null),l=i.current,u=qn(),u=Va(u),m=Ya(u),m.callback=null,Ka(l,m,u),l=u,i.current.lanes=l,ta(i,l),Hs(i),s[Wn]=i.current,Zm(s),new qd(i)},Tc.version="19.1.0",Tc}var hb;function iS(){if(hb)return _p.exports;hb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),_p.exports=aS(),_p.exports}var rS=iS();const oS=()=>{};var fb={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ST=function(n){const e=[];let t=0;for(let a=0;a<n.length;a++){let o=n.charCodeAt(a);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&a+1<n.length&&(n.charCodeAt(a+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++a)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},lS=function(n){const e=[];let t=0,a=0;for(;t<n.length;){const o=n[t++];if(o<128)e[a++]=String.fromCharCode(o);else if(o>191&&o<224){const c=n[t++];e[a++]=String.fromCharCode((o&31)<<6|c&63)}else if(o>239&&o<365){const c=n[t++],d=n[t++],f=n[t++],p=((o&7)<<18|(c&63)<<12|(d&63)<<6|f&63)-65536;e[a++]=String.fromCharCode(55296+(p>>10)),e[a++]=String.fromCharCode(56320+(p&1023))}else{const c=n[t++],d=n[t++];e[a++]=String.fromCharCode((o&15)<<12|(c&63)<<6|d&63)}}return e.join("")},wT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,a=[];for(let o=0;o<n.length;o+=3){const c=n[o],d=o+1<n.length,f=d?n[o+1]:0,p=o+2<n.length,v=p?n[o+2]:0,_=c>>2,N=(c&3)<<4|f>>4;let C=(f&15)<<2|v>>6,j=v&63;p||(j=64,d||(C=64)),a.push(t[_],t[N],t[C],t[j])}return a.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(ST(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):lS(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,a=[];for(let o=0;o<n.length;){const c=t[n.charAt(o++)],f=o<n.length?t[n.charAt(o)]:0;++o;const v=o<n.length?t[n.charAt(o)]:64;++o;const N=o<n.length?t[n.charAt(o)]:64;if(++o,c==null||f==null||v==null||N==null)throw new cS;const C=c<<2|f>>4;if(a.push(C),v!==64){const j=f<<4&240|v>>2;if(a.push(j),N!==64){const b=v<<6&192|N;a.push(b)}}}return a},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class cS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const uS=function(n){const e=ST(n);return wT.encodeByteArray(e,!0)},dh=function(n){return uS(n).replace(/\./g,"")},IT=function(n){try{return wT.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hS=()=>dS().__FIREBASE_DEFAULTS__,fS=()=>{if(typeof process>"u"||typeof fb>"u")return;const n=fb.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},mS=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&IT(n[1]);return e&&JSON.parse(e)},Uh=()=>{try{return oS()||hS()||fS()||mS()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},RT=n=>{var e,t;return(t=(e=Uh())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},DT=n=>{const e=RT(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const a=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),a]:[e.substring(0,t),a]},OT=()=>{var n;return(n=Uh())===null||n===void 0?void 0:n.config},MT=n=>{var e;return(e=Uh())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,a)=>{t?this.reject(t):this.resolve(a),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,a))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pr(n){return n.endsWith(".cloudworkstations.dev")}async function Tg(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PT(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},a=e||"demo-project",o=n.iat||0,c=n.sub||n.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${a}`,aud:a,iat:o,exp:o+3600,auth_time:o,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}}},n);return[dh(JSON.stringify(t)),dh(JSON.stringify(d)),""].join(".")}const Ic={};function gS(){const n={prod:[],emulator:[]};for(const e of Object.keys(Ic))Ic[e]?n.emulator.push(e):n.prod.push(e);return n}function vS(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let mb=!1;function xg(n,e){if(typeof window>"u"||typeof document>"u"||!Pr(window.location.host)||Ic[n]===e||Ic[n]||mb)return;Ic[n]=e;function t(C){return`__firebase__banner__${C}`}const a="__firebase__banner",c=gS().prod.length>0;function d(){const C=document.getElementById(a);C&&C.remove()}function f(C){C.style.display="flex",C.style.background="#7faaf0",C.style.position="fixed",C.style.bottom="5px",C.style.left="5px",C.style.padding=".5em",C.style.borderRadius="5px",C.style.alignItems="center"}function p(C,j){C.setAttribute("width","24"),C.setAttribute("id",j),C.setAttribute("height","24"),C.setAttribute("viewBox","0 0 24 24"),C.setAttribute("fill","none"),C.style.marginLeft="-6px"}function v(){const C=document.createElement("span");return C.style.cursor="pointer",C.style.marginLeft="16px",C.style.fontSize="24px",C.innerHTML=" &times;",C.onclick=()=>{mb=!0,d()},C}function _(C,j){C.setAttribute("id",j),C.innerText="Learn more",C.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",C.setAttribute("target","__blank"),C.style.paddingLeft="5px",C.style.textDecoration="underline"}function N(){const C=vS(a),j=t("text"),b=document.getElementById(j)||document.createElement("span"),M=t("learnmore"),x=document.getElementById(M)||document.createElement("a"),L=t("preprendIcon"),$=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(C.created){const O=C.element;f(O),_(x,M);const U=v();p($,L),O.append($,b,x,U),document.body.appendChild(O)}c?(b.innerText="Preview backend disconnected.",$.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):($.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,b.innerText="Preview backend running in this workspace."),b.setAttribute("id",j)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",N):N()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _n(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function yS(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_n())}function _S(){var n;const e=(n=Uh())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ES(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function kT(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function bS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function NS(){const n=_n();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function TS(){return!_S()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Ag(){try{return typeof indexedDB=="object"}catch{return!1}}function Cg(){return new Promise((n,e)=>{try{let t=!0;const a="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(a);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(a),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var c;e(((c=o.error)===null||c===void 0?void 0:c.message)||"")}}catch(t){e(t)}})}function LT(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xS="FirebaseError";class ds extends Error{constructor(e,t,a){super(t),this.code=e,this.customData=a,this.name=xS,Object.setPrototypeOf(this,ds.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Oi.prototype.create)}}class Oi{constructor(e,t,a){this.service=e,this.serviceName=t,this.errors=a}create(e,...t){const a=t[0]||{},o=`${this.service}/${e}`,c=this.errors[e],d=c?AS(c,a):"Error",f=`${this.serviceName}: ${d} (${o}).`;return new ds(o,f,a)}}function AS(n,e){return n.replace(CS,(t,a)=>{const o=e[a];return o!=null?String(o):`<${a}?>`})}const CS=/\{\$([^}]+)}/g;function jS(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ti(n,e){if(n===e)return!0;const t=Object.keys(n),a=Object.keys(e);for(const o of t){if(!a.includes(o))return!1;const c=n[o],d=e[o];if(pb(c)&&pb(d)){if(!Ti(c,d))return!1}else if(c!==d)return!1}for(const o of a)if(!t.includes(o))return!1;return!0}function pb(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eu(n){const e=[];for(const[t,a]of Object.entries(n))Array.isArray(a)?a.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(a));return e.length?"&"+e.join("&"):""}function xc(n){const e={};return n.replace(/^\?/,"").split("&").forEach(a=>{if(a){const[o,c]=a.split("=");e[decodeURIComponent(o)]=decodeURIComponent(c)}}),e}function Ac(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function SS(n,e){const t=new wS(n,e);return t.subscribe.bind(t)}class wS{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(a=>{this.error(a)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,a){let o;if(e===void 0&&t===void 0&&a===void 0)throw new Error("Missing Observer.");IS(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:a},o.next===void 0&&(o.next=Tp),o.error===void 0&&(o.error=Tp),o.complete===void 0&&(o.complete=Tp);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(a){typeof console<"u"&&console.error&&console.error(a)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function IS(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Tp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RS=1e3,DS=2,OS=4*60*60*1e3,MS=.5;function gb(n,e=RS,t=DS){const a=e*Math.pow(t,n),o=Math.round(MS*a*(Math.random()-.5)*2);return Math.min(OS,a+o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gt(n){return n&&n._delegate?n._delegate:n}class Kn{constructor(e,t,a){this.name=e,this.instanceFactory=t,this.type=a,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PS{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const a=new pS;if(this.instancesDeferred.set(t,a),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&a.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const a=this.normalizeInstanceIdentifier(e?.identifier),o=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(a)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:a})}catch(c){if(o)return null;throw c}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(LS(e))try{this.getOrInitializeService({instanceIdentifier:Tr})}catch{}for(const[t,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:o});a.resolve(c)}catch{}}}}clearInstance(e=Tr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Tr){return this.instances.has(e)}getOptions(e=Tr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,a=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(a))throw Error(`${this.name}(${a}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:a,options:t});for(const[c,d]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(c);a===f&&d.resolve(o)}return o}onInit(e,t){var a;const o=this.normalizeInstanceIdentifier(t),c=(a=this.onInitCallbacks.get(o))!==null&&a!==void 0?a:new Set;c.add(e),this.onInitCallbacks.set(o,c);const d=this.instances.get(o);return d&&e(d,o),()=>{c.delete(e)}}invokeOnInitCallbacks(e,t){const a=this.onInitCallbacks.get(t);if(a)for(const o of a)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let a=this.instances.get(e);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:kS(e),options:t}),this.instances.set(e,a),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(a,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,a)}catch{}return a||null}normalizeInstanceIdentifier(e=Tr){return this.component?this.component.multipleInstances?e:Tr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function kS(n){return n===Tr?void 0:n}function LS(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new PS(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ze;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ze||(ze={}));const US={debug:ze.DEBUG,verbose:ze.VERBOSE,info:ze.INFO,warn:ze.WARN,error:ze.ERROR,silent:ze.SILENT},FS=ze.INFO,HS={[ze.DEBUG]:"log",[ze.VERBOSE]:"log",[ze.INFO]:"info",[ze.WARN]:"warn",[ze.ERROR]:"error"},qS=(n,e,...t)=>{if(e<n.logLevel)return;const a=new Date().toISOString(),o=HS[e];if(o)console[o](`[${a}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class tu{constructor(e){this.name=e,this._logLevel=FS,this._logHandler=qS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ze))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?US[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ze.DEBUG,...e),this._logHandler(this,ze.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ze.VERBOSE,...e),this._logHandler(this,ze.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ze.INFO,...e),this._logHandler(this,ze.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ze.WARN,...e),this._logHandler(this,ze.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ze.ERROR,...e),this._logHandler(this,ze.ERROR,...e)}}const BS=(n,e)=>e.some(t=>n instanceof t);let vb,yb;function zS(){return vb||(vb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function GS(){return yb||(yb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const VT=new WeakMap,Gp=new WeakMap,UT=new WeakMap,xp=new WeakMap,jg=new WeakMap;function $S(n){const e=new Promise((t,a)=>{const o=()=>{n.removeEventListener("success",c),n.removeEventListener("error",d)},c=()=>{t(_i(n.result)),o()},d=()=>{a(n.error),o()};n.addEventListener("success",c),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&VT.set(t,n)}).catch(()=>{}),jg.set(e,n),e}function YS(n){if(Gp.has(n))return;const e=new Promise((t,a)=>{const o=()=>{n.removeEventListener("complete",c),n.removeEventListener("error",d),n.removeEventListener("abort",d)},c=()=>{t(),o()},d=()=>{a(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",c),n.addEventListener("error",d),n.addEventListener("abort",d)});Gp.set(n,e)}let $p={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Gp.get(n);if(e==="objectStoreNames")return n.objectStoreNames||UT.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return _i(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function KS(n){$p=n($p)}function QS(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const a=n.call(Ap(this),e,...t);return UT.set(a,e.sort?e.sort():[e]),_i(a)}:GS().includes(n)?function(...e){return n.apply(Ap(this),e),_i(VT.get(this))}:function(...e){return _i(n.apply(Ap(this),e))}}function XS(n){return typeof n=="function"?QS(n):(n instanceof IDBTransaction&&YS(n),BS(n,zS())?new Proxy(n,$p):n)}function _i(n){if(n instanceof IDBRequest)return $S(n);if(xp.has(n))return xp.get(n);const e=XS(n);return e!==n&&(xp.set(n,e),jg.set(e,n)),e}const Ap=n=>jg.get(n);function FT(n,e,{blocked:t,upgrade:a,blocking:o,terminated:c}={}){const d=indexedDB.open(n,e),f=_i(d);return a&&d.addEventListener("upgradeneeded",p=>{a(_i(d.result),p.oldVersion,p.newVersion,_i(d.transaction),p)}),t&&d.addEventListener("blocked",p=>t(p.oldVersion,p.newVersion,p)),f.then(p=>{c&&p.addEventListener("close",()=>c()),o&&p.addEventListener("versionchange",v=>o(v.oldVersion,v.newVersion,v))}).catch(()=>{}),f}const WS=["get","getKey","getAll","getAllKeys","count"],ZS=["put","add","delete","clear"],Cp=new Map;function _b(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Cp.get(e))return Cp.get(e);const t=e.replace(/FromIndex$/,""),a=e!==t,o=ZS.includes(t);if(!(t in(a?IDBIndex:IDBObjectStore).prototype)||!(o||WS.includes(t)))return;const c=async function(d,...f){const p=this.transaction(d,o?"readwrite":"readonly");let v=p.store;return a&&(v=v.index(f.shift())),(await Promise.all([v[t](...f),o&&p.done]))[0]};return Cp.set(e,c),c}KS(n=>({...n,get:(e,t,a)=>_b(e,t)||n.get(e,t,a),has:(e,t)=>!!_b(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(ew(t)){const a=t.getImmediate();return`${a.library}/${a.version}`}else return null}).filter(t=>t).join(" ")}}function ew(n){const e=n.getComponent();return e?.type==="VERSION"}const Yp="@firebase/app",Eb="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ia=new tu("@firebase/app"),tw="@firebase/app-compat",nw="@firebase/analytics-compat",sw="@firebase/analytics",aw="@firebase/app-check-compat",iw="@firebase/app-check",rw="@firebase/auth",ow="@firebase/auth-compat",lw="@firebase/database",cw="@firebase/data-connect",uw="@firebase/database-compat",dw="@firebase/functions",hw="@firebase/functions-compat",fw="@firebase/installations",mw="@firebase/installations-compat",pw="@firebase/messaging",gw="@firebase/messaging-compat",vw="@firebase/performance",yw="@firebase/performance-compat",_w="@firebase/remote-config",Ew="@firebase/remote-config-compat",bw="@firebase/storage",Nw="@firebase/storage-compat",Tw="@firebase/firestore",xw="@firebase/ai",Aw="@firebase/firestore-compat",Cw="firebase",jw="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kp="[DEFAULT]",Sw={[Yp]:"fire-core",[tw]:"fire-core-compat",[sw]:"fire-analytics",[nw]:"fire-analytics-compat",[iw]:"fire-app-check",[aw]:"fire-app-check-compat",[rw]:"fire-auth",[ow]:"fire-auth-compat",[lw]:"fire-rtdb",[cw]:"fire-data-connect",[uw]:"fire-rtdb-compat",[dw]:"fire-fn",[hw]:"fire-fn-compat",[fw]:"fire-iid",[mw]:"fire-iid-compat",[pw]:"fire-fcm",[gw]:"fire-fcm-compat",[vw]:"fire-perf",[yw]:"fire-perf-compat",[_w]:"fire-rc",[Ew]:"fire-rc-compat",[bw]:"fire-gcs",[Nw]:"fire-gcs-compat",[Tw]:"fire-fst",[Aw]:"fire-fst-compat",[xw]:"fire-vertex","fire-js":"fire-js",[Cw]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hh=new Map,ww=new Map,Qp=new Map;function bb(n,e){try{n.container.addComponent(e)}catch(t){Ia.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function cs(n){const e=n.name;if(Qp.has(e))return Ia.debug(`There were multiple attempts to register component ${e}.`),!1;Qp.set(e,n);for(const t of hh.values())bb(t,n);for(const t of ww.values())bb(t,n);return!0}function Ma(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Dn(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iw={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ei=new Oi("app","Firebase",Iw);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rw{constructor(e,t,a){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=a,this.container.addComponent(new Kn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ei.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kr=jw;function HT(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const a=Object.assign({name:Kp,automaticDataCollectionEnabled:!0},e),o=a.name;if(typeof o!="string"||!o)throw Ei.create("bad-app-name",{appName:String(o)});if(t||(t=OT()),!t)throw Ei.create("no-options");const c=hh.get(o);if(c){if(Ti(t,c.options)&&Ti(a,c.config))return c;throw Ei.create("duplicate-app",{appName:o})}const d=new VS(o);for(const p of Qp.values())d.addComponent(p);const f=new Rw(t,a,d);return hh.set(o,f),f}function nu(n=Kp){const e=hh.get(n);if(!e&&n===Kp&&OT())return HT();if(!e)throw Ei.create("no-app",{appName:n});return e}function yn(n,e,t){var a;let o=(a=Sw[n])!==null&&a!==void 0?a:n;t&&(o+=`-${t}`);const c=o.match(/\s|\//),d=e.match(/\s|\//);if(c||d){const f=[`Unable to register library "${o}" with version "${e}":`];c&&f.push(`library name "${o}" contains illegal characters (whitespace or "/")`),c&&d&&f.push("and"),d&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ia.warn(f.join(" "));return}cs(new Kn(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dw="firebase-heartbeat-database",Ow=1,qc="firebase-heartbeat-store";let jp=null;function qT(){return jp||(jp=FT(Dw,Ow,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(qc)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ei.create("idb-open",{originalErrorMessage:n.message})})),jp}async function Mw(n){try{const t=(await qT()).transaction(qc),a=await t.objectStore(qc).get(BT(n));return await t.done,a}catch(e){if(e instanceof ds)Ia.warn(e.message);else{const t=Ei.create("idb-get",{originalErrorMessage:e?.message});Ia.warn(t.message)}}}async function Nb(n,e){try{const a=(await qT()).transaction(qc,"readwrite");await a.objectStore(qc).put(e,BT(n)),await a.done}catch(t){if(t instanceof ds)Ia.warn(t.message);else{const a=Ei.create("idb-set",{originalErrorMessage:t?.message});Ia.warn(a.message)}}}function BT(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pw=1024,kw=30;class Lw{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Uw(t),this._heartbeatsCachePromise=this._storage.read().then(a=>(this._heartbeatsCache=a,a))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),c=Tb();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===c||this._heartbeatsCache.heartbeats.some(d=>d.date===c))return;if(this._heartbeatsCache.heartbeats.push({date:c,agent:o}),this._heartbeatsCache.heartbeats.length>kw){const d=Fw(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(a){Ia.warn(a)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Tb(),{heartbeatsToSend:a,unsentEntries:o}=Vw(this._heartbeatsCache.heartbeats),c=dh(JSON.stringify({version:2,heartbeats:a}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),c}catch(t){return Ia.warn(t),""}}}function Tb(){return new Date().toISOString().substring(0,10)}function Vw(n,e=Pw){const t=[];let a=n.slice();for(const o of n){const c=t.find(d=>d.agent===o.agent);if(c){if(c.dates.push(o.date),xb(t)>e){c.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),xb(t)>e){t.pop();break}a=a.slice(1)}return{heartbeatsToSend:t,unsentEntries:a}}class Uw{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Ag()?Cg().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Mw(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return Nb(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return Nb(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function xb(n){return dh(JSON.stringify({version:2,heartbeats:n})).length}function Fw(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let a=1;a<n.length;a++)n[a].date<t&&(t=n[a].date,e=a);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hw(n){cs(new Kn("platform-logger",e=>new JS(e),"PRIVATE")),cs(new Kn("heartbeat",e=>new Lw(e),"PRIVATE")),yn(Yp,Eb,n),yn(Yp,Eb,"esm2017"),yn("fire-js","")}Hw("");function Sg(n,e){var t={};for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&e.indexOf(a)<0&&(t[a]=n[a]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(n);o<a.length;o++)e.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(n,a[o])&&(t[a[o]]=n[a[o]]);return t}function zT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const qw=zT,GT=new Oi("auth","Firebase",zT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fh=new tu("@firebase/auth");function Bw(n,...e){fh.logLevel<=ze.WARN&&fh.warn(`Auth (${kr}): ${n}`,...e)}function Jd(n,...e){fh.logLevel<=ze.ERROR&&fh.error(`Auth (${kr}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function us(n,...e){throw Ig(n,...e)}function Ts(n,...e){return Ig(n,...e)}function wg(n,e,t){const a=Object.assign(Object.assign({},qw()),{[e]:t});return new Oi("auth","Firebase",a).create(e,{appName:n.name})}function wa(n){return wg(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function zw(n,e,t){const a=t;if(!(e instanceof a))throw a.name!==e.constructor.name&&us(n,"argument-error"),wg(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Ig(n,...e){if(typeof n!="string"){const t=e[0],a=[...e.slice(1)];return a[0]&&(a[0].appName=n.name),n._errorFactory.create(t,...a)}return GT.create(n,...e)}function we(n,e,...t){if(!n)throw Ig(e,...t)}function ja(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Jd(e),new Error(e)}function Ra(n,e){n||ja(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xp(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function Gw(){return Ab()==="http:"||Ab()==="https:"}function Ab(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $w(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Gw()||kT()||"connection"in navigator)?navigator.onLine:!0}function Yw(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ra(t>e,"Short delay should be less than long delay!"),this.isMobile=yS()||bS()}get(){return $w()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rg(n,e){Ra(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $T{static initialize(e,t,a){this.fetchImpl=e,t&&(this.headersImpl=t),a&&(this.responseImpl=a)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ja("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ja("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ja("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kw={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qw=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Xw=new su(3e4,6e4);function Mi(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Pi(n,e,t,a,o={}){return YT(n,o,async()=>{let c={},d={};a&&(e==="GET"?d=a:c={body:JSON.stringify(a)});const f=eu(Object.assign({key:n.config.apiKey},d)).slice(1),p=await n._getAdditionalHeaders();p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode);const v=Object.assign({method:e,headers:p},c);return ES()||(v.referrerPolicy="no-referrer"),n.emulatorConfig&&Pr(n.emulatorConfig.host)&&(v.credentials="include"),$T.fetch()(await KT(n,n.config.apiHost,t,f),v)})}async function YT(n,e,t){n._canInitEmulator=!1;const a=Object.assign(Object.assign({},Kw),e);try{const o=new Zw(n),c=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const d=await c.json();if("needConfirmation"in d)throw zd(n,"account-exists-with-different-credential",d);if(c.ok&&!("errorMessage"in d))return d;{const f=c.ok?d.errorMessage:d.error.message,[p,v]=f.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw zd(n,"credential-already-in-use",d);if(p==="EMAIL_EXISTS")throw zd(n,"email-already-in-use",d);if(p==="USER_DISABLED")throw zd(n,"user-disabled",d);const _=a[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(v)throw wg(n,_,v);us(n,_)}}catch(o){if(o instanceof ds)throw o;us(n,"network-request-failed",{message:String(o)})}}async function au(n,e,t,a,o={}){const c=await Pi(n,e,t,a,o);return"mfaPendingCredential"in c&&us(n,"multi-factor-auth-required",{_serverResponse:c}),c}async function KT(n,e,t,a){const o=`${e}${t}?${a}`,c=n,d=c.config.emulator?Rg(n.config,o):`${n.config.apiScheme}://${o}`;return Qw.includes(t)&&(await c._persistenceManagerAvailable,c._getPersistenceType()==="COOKIE")?c._getPersistence()._getFinalTarget(d).toString():d}function Ww(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Zw{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,a)=>{this.timer=setTimeout(()=>a(Ts(this.auth,"network-request-failed")),Xw.get())})}}function zd(n,e,t){const a={appName:n.name};t.email&&(a.email=t.email),t.phoneNumber&&(a.phoneNumber=t.phoneNumber);const o=Ts(n,e,a);return o.customData._tokenResponse=t,o}function Cb(n){return n!==void 0&&n.enterprise!==void 0}class Jw{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Ww(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function eI(n,e){return Pi(n,"GET","/v2/recaptchaConfig",Mi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tI(n,e){return Pi(n,"POST","/v1/accounts:delete",e)}async function mh(n,e){return Pi(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function nI(n,e=!1){const t=gt(n),a=await t.getIdToken(e),o=Dg(a);we(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const c=typeof o.firebase=="object"?o.firebase:void 0,d=c?.sign_in_provider;return{claims:o,token:a,authTime:Rc(Sp(o.auth_time)),issuedAtTime:Rc(Sp(o.iat)),expirationTime:Rc(Sp(o.exp)),signInProvider:d||null,signInSecondFactor:c?.sign_in_second_factor||null}}function Sp(n){return Number(n)*1e3}function Dg(n){const[e,t,a]=n.split(".");if(e===void 0||t===void 0||a===void 0)return Jd("JWT malformed, contained fewer than 3 sections"),null;try{const o=IT(t);return o?JSON.parse(o):(Jd("Failed to decode base64 JWT payload"),null)}catch(o){return Jd("Caught error parsing JWT payload as JSON",o?.toString()),null}}function jb(n){const e=Dg(n);return we(e,"internal-error"),we(typeof e.exp<"u","internal-error"),we(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bc(n,e,t=!1){if(t)return e;try{return await e}catch(a){throw a instanceof ds&&sI(a)&&n.auth.currentUser===n&&await n.auth.signOut(),a}}function sI({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const a=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),a}else{this.errorBackoff=3e4;const o=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,o)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Rc(this.lastLoginAt),this.creationTime=Rc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ph(n){var e;const t=n.auth,a=await n.getIdToken(),o=await Bc(n,mh(t,{idToken:a}));we(o?.users.length,t,"internal-error");const c=o.users[0];n._notifyReloadListener(c);const d=!((e=c.providerUserInfo)===null||e===void 0)&&e.length?QT(c.providerUserInfo):[],f=rI(n.providerData,d),p=n.isAnonymous,v=!(n.email&&c.passwordHash)&&!f?.length,_=p?v:!1,N={uid:c.localId,displayName:c.displayName||null,photoURL:c.photoUrl||null,email:c.email||null,emailVerified:c.emailVerified||!1,phoneNumber:c.phoneNumber||null,tenantId:c.tenantId||null,providerData:f,metadata:new Wp(c.createdAt,c.lastLoginAt),isAnonymous:_};Object.assign(n,N)}async function iI(n){const e=gt(n);await ph(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function rI(n,e){return[...n.filter(a=>!e.some(o=>o.providerId===a.providerId)),...e]}function QT(n){return n.map(e=>{var{providerId:t}=e,a=Sg(e,["providerId"]);return{providerId:t,uid:a.rawId||"",displayName:a.displayName||null,email:a.email||null,phoneNumber:a.phoneNumber||null,photoURL:a.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oI(n,e){const t=await YT(n,{},async()=>{const a=eu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:c}=n.config,d=await KT(n,o,"/v1/token",`key=${c}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:f,body:a};return n.emulatorConfig&&Pr(n.emulatorConfig.host)&&(p.credentials="include"),$T.fetch()(d,p)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function lI(n,e){return Pi(n,"POST","/v2/accounts:revokeToken",Mi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){we(e.idToken,"internal-error"),we(typeof e.idToken<"u","internal-error"),we(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):jb(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){we(e.length!==0,"internal-error");const t=jb(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(we(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:a,refreshToken:o,expiresIn:c}=await oI(e,t);this.updateTokensAndExpiration(a,o,Number(c))}updateTokensAndExpiration(e,t,a){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+a*1e3}static fromJSON(e,t){const{refreshToken:a,accessToken:o,expirationTime:c}=t,d=new Bo;return a&&(we(typeof a=="string","internal-error",{appName:e}),d.refreshToken=a),o&&(we(typeof o=="string","internal-error",{appName:e}),d.accessToken=o),c&&(we(typeof c=="number","internal-error",{appName:e}),d.expirationTime=c),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Bo,this.toJSON())}_performRefresh(){return ja("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hi(n,e){we(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class bs{constructor(e){var{uid:t,auth:a,stsTokenManager:o}=e,c=Sg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new aI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=a,this.stsTokenManager=o,this.accessToken=o.accessToken,this.displayName=c.displayName||null,this.email=c.email||null,this.emailVerified=c.emailVerified||!1,this.phoneNumber=c.phoneNumber||null,this.photoURL=c.photoURL||null,this.isAnonymous=c.isAnonymous||!1,this.tenantId=c.tenantId||null,this.providerData=c.providerData?[...c.providerData]:[],this.metadata=new Wp(c.createdAt||void 0,c.lastLoginAt||void 0)}async getIdToken(e){const t=await Bc(this,this.stsTokenManager.getToken(this.auth,e));return we(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return nI(this,e)}reload(){return iI(this)}_assign(e){this!==e&&(we(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new bs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){we(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let a=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),a=!0),t&&await ph(this),await this.auth._persistUserIfCurrent(this),a&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Dn(this.auth.app))return Promise.reject(wa(this.auth));const e=await this.getIdToken();return await Bc(this,tI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var a,o,c,d,f,p,v,_;const N=(a=t.displayName)!==null&&a!==void 0?a:void 0,C=(o=t.email)!==null&&o!==void 0?o:void 0,j=(c=t.phoneNumber)!==null&&c!==void 0?c:void 0,b=(d=t.photoURL)!==null&&d!==void 0?d:void 0,M=(f=t.tenantId)!==null&&f!==void 0?f:void 0,x=(p=t._redirectEventId)!==null&&p!==void 0?p:void 0,L=(v=t.createdAt)!==null&&v!==void 0?v:void 0,$=(_=t.lastLoginAt)!==null&&_!==void 0?_:void 0,{uid:O,emailVerified:U,isAnonymous:F,providerData:X,stsTokenManager:w}=t;we(O&&w,e,"internal-error");const A=Bo.fromJSON(this.name,w);we(typeof O=="string",e,"internal-error"),hi(N,e.name),hi(C,e.name),we(typeof U=="boolean",e,"internal-error"),we(typeof F=="boolean",e,"internal-error"),hi(j,e.name),hi(b,e.name),hi(M,e.name),hi(x,e.name),hi(L,e.name),hi($,e.name);const R=new bs({uid:O,auth:e,email:C,emailVerified:U,displayName:N,isAnonymous:F,photoURL:b,phoneNumber:j,tenantId:M,stsTokenManager:A,createdAt:L,lastLoginAt:$});return X&&Array.isArray(X)&&(R.providerData=X.map(I=>Object.assign({},I))),x&&(R._redirectEventId=x),R}static async _fromIdTokenResponse(e,t,a=!1){const o=new Bo;o.updateFromServerResponse(t);const c=new bs({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:a});return await ph(c),c}static async _fromGetAccountInfoResponse(e,t,a){const o=t.users[0];we(o.localId!==void 0,"internal-error");const c=o.providerUserInfo!==void 0?QT(o.providerUserInfo):[],d=!(o.email&&o.passwordHash)&&!c?.length,f=new Bo;f.updateFromIdToken(a);const p=new bs({uid:o.localId,auth:e,stsTokenManager:f,isAnonymous:d}),v={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new Wp(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!c?.length};return Object.assign(p,v),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sb=new Map;function Sa(n){Ra(n instanceof Function,"Expected a class definition");let e=Sb.get(n);return e?(Ra(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Sb.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}XT.type="NONE";const wb=XT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eh(n,e,t){return`firebase:${n}:${e}:${t}`}class zo{constructor(e,t,a){this.persistence=e,this.auth=t,this.userKey=a;const{config:o,name:c}=this.auth;this.fullUserKey=eh(this.userKey,o.apiKey,c),this.fullPersistenceKey=eh("persistence",o.apiKey,c),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await mh(this.auth,{idToken:e}).catch(()=>{});return t?bs._fromGetAccountInfoResponse(this.auth,t,e):null}return bs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,a="authUser"){if(!t.length)return new zo(Sa(wb),e,a);const o=(await Promise.all(t.map(async v=>{if(await v._isAvailable())return v}))).filter(v=>v);let c=o[0]||Sa(wb);const d=eh(a,e.config.apiKey,e.name);let f=null;for(const v of t)try{const _=await v._get(d);if(_){let N;if(typeof _=="string"){const C=await mh(e,{idToken:_}).catch(()=>{});if(!C)break;N=await bs._fromGetAccountInfoResponse(e,C,_)}else N=bs._fromJSON(e,_);v!==c&&(f=N),c=v;break}}catch{}const p=o.filter(v=>v._shouldAllowMigration);return!c._shouldAllowMigration||!p.length?new zo(c,e,a):(c=p[0],f&&await c._set(d,f.toJSON()),await Promise.all(t.map(async v=>{if(v!==c)try{await v._remove(d)}catch{}})),new zo(c,e,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ib(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ex(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(WT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(nx(e))return"Blackberry";if(sx(e))return"Webos";if(ZT(e))return"Safari";if((e.includes("chrome/")||JT(e))&&!e.includes("edge/"))return"Chrome";if(tx(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,a=n.match(t);if(a?.length===2)return a[1]}return"Other"}function WT(n=_n()){return/firefox\//i.test(n)}function ZT(n=_n()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function JT(n=_n()){return/crios\//i.test(n)}function ex(n=_n()){return/iemobile/i.test(n)}function tx(n=_n()){return/android/i.test(n)}function nx(n=_n()){return/blackberry/i.test(n)}function sx(n=_n()){return/webos/i.test(n)}function Og(n=_n()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function cI(n=_n()){var e;return Og(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function uI(){return NS()&&document.documentMode===10}function ax(n=_n()){return Og(n)||tx(n)||sx(n)||nx(n)||/windows phone/i.test(n)||ex(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ix(n,e=[]){let t;switch(n){case"Browser":t=Ib(_n());break;case"Worker":t=`${Ib(_n())}-${n}`;break;default:t=n}const a=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${kr}/${a}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const a=c=>new Promise((d,f)=>{try{const p=e(c);d(p)}catch(p){f(p)}});a.onAbort=t,this.queue.push(a);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const a of this.queue)await a(e),a.onAbort&&t.push(a.onAbort)}catch(a){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:a?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hI(n,e={}){return Pi(n,"GET","/v2/passwordPolicy",Mi(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fI=6;class mI{constructor(e){var t,a,o,c;const d=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=d.minPasswordLength)!==null&&t!==void 0?t:fI,d.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=d.maxPasswordLength),d.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=d.containsLowercaseCharacter),d.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=d.containsUppercaseCharacter),d.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=d.containsNumericCharacter),d.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=d.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(o=(a=e.allowedNonAlphanumericCharacters)===null||a===void 0?void 0:a.join(""))!==null&&o!==void 0?o:"",this.forceUpgradeOnSignin=(c=e.forceUpgradeOnSignin)!==null&&c!==void 0?c:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,a,o,c,d,f;const p={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,p),this.validatePasswordCharacterOptions(e,p),p.isValid&&(p.isValid=(t=p.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),p.isValid&&(p.isValid=(a=p.meetsMaxPasswordLength)!==null&&a!==void 0?a:!0),p.isValid&&(p.isValid=(o=p.containsLowercaseLetter)!==null&&o!==void 0?o:!0),p.isValid&&(p.isValid=(c=p.containsUppercaseLetter)!==null&&c!==void 0?c:!0),p.isValid&&(p.isValid=(d=p.containsNumericCharacter)!==null&&d!==void 0?d:!0),p.isValid&&(p.isValid=(f=p.containsNonAlphanumericCharacter)!==null&&f!==void 0?f:!0),p}validatePasswordLengthOptions(e,t){const a=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;a&&(t.meetsMinPasswordLength=e.length>=a),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let a;for(let o=0;o<e.length;o++)a=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,a>="a"&&a<="z",a>="A"&&a<="Z",a>="0"&&a<="9",this.allowedNonAlphanumericCharacters.includes(a))}updatePasswordCharacterOptionsStatuses(e,t,a,o,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=a)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pI{constructor(e,t,a,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=a,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Rb(this),this.idTokenSubscription=new Rb(this),this.beforeStateQueue=new dI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=GT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(c=>this._resolvePersistenceManagerAvailable=c)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Sa(t)),this._initializationPromise=this.queue(async()=>{var a,o,c;if(!this._deleted&&(this.persistenceManager=await zo.create(this,e),(a=this._resolvePersistenceManagerAvailable)===null||a===void 0||a.call(this),!this._deleted)){if(!((o=this._popupRedirectResolver)===null||o===void 0)&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((c=this.currentUser)===null||c===void 0?void 0:c.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await mh(this,{idToken:e}),a=await bs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(a)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Dn(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(f,f))}):this.directlySetCurrentUser(null)}const a=await this.assertedPersistence.getCurrentUser();let o=a,c=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,f=o?._redirectEventId,p=await this.tryRedirectSignIn(e);(!d||d===f)&&p?.user&&(o=p.user,c=!0)}if(!o)return this.directlySetCurrentUser(null);if(!o._redirectEventId){if(c)try{await this.beforeStateQueue.runMiddleware(o)}catch(d){o=a,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return o?this.reloadAndSetCurrentUserOrClear(o):this.directlySetCurrentUser(null)}return we(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===o._redirectEventId?this.directlySetCurrentUser(o):this.reloadAndSetCurrentUserOrClear(o)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ph(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Yw()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Dn(this.app))return Promise.reject(wa(this));const t=e?gt(e):null;return t&&we(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&we(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Dn(this.app)?Promise.reject(wa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Dn(this.app)?Promise.reject(wa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Sa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await hI(this),t=new mI(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Oi("auth","Firebase",e())}onAuthStateChanged(e,t,a){return this.registerStateListener(this.authStateSubscription,e,t,a)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,a){return this.registerStateListener(this.idTokenSubscription,e,t,a)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const a=this.onAuthStateChanged(()=>{a(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),a={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(a.tenantId=this.tenantId),await lI(this,a)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const a=await this.getOrInitRedirectPersistenceManager(t);return e===null?a.removeCurrentUser():a.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Sa(e)||this._popupRedirectResolver;we(t,this,"argument-error"),this.redirectPersistenceManager=await zo.create(this,[Sa(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,a;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((a=this.redirectUser)===null||a===void 0?void 0:a._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const a=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==a&&(this.lastNotifiedUid=a,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,a,o){if(this._deleted)return()=>{};const c=typeof t=="function"?t:t.next.bind(t);let d=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(we(f,this,"internal-error"),f.then(()=>{d||c(this.currentUser)}),typeof t=="function"){const p=e.addObserver(t,a,o);return()=>{d=!0,p()}}else{const p=e.addObserver(t);return()=>{d=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return we(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ix(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const a=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());a&&(t["X-Firebase-Client"]=a);const o=await this._getAppCheckToken();return o&&(t["X-Firebase-AppCheck"]=o),t}async _getAppCheckToken(){var e;if(Dn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&Bw(`Error while retrieving App Check token: ${t.error}`),t?.token}}function ki(n){return gt(n)}class Rb{constructor(e){this.auth=e,this.observer=null,this.addObserver=SS(t=>this.observer=t)}get next(){return we(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function gI(n){Fh=n}function rx(n){return Fh.loadJS(n)}function vI(){return Fh.recaptchaEnterpriseScript}function yI(){return Fh.gapiScript}function _I(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class EI{constructor(){this.enterprise=new bI}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class bI{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const NI="recaptcha-enterprise",ox="NO_RECAPTCHA";class TI{constructor(e){this.type=NI,this.auth=ki(e)}async verify(e="verify",t=!1){async function a(c){if(!t){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(d,f)=>{eI(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const v=new Jw(p);return c.tenantId==null?c._agentRecaptchaConfig=v:c._tenantRecaptchaConfigs[c.tenantId]=v,d(v.siteKey)}}).catch(p=>{f(p)})})}function o(c,d,f){const p=window.grecaptcha;Cb(p)?p.enterprise.ready(()=>{p.enterprise.execute(c,{action:e}).then(v=>{d(v)}).catch(()=>{d(ox)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new EI().execute("siteKey",{action:"verify"}):new Promise((c,d)=>{a(this.auth).then(f=>{if(!t&&Cb(window.grecaptcha))o(f,c,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let p=vI();p.length!==0&&(p+=f),rx(p).then(()=>{o(f,c,d)}).catch(v=>{d(v)})}}).catch(f=>{d(f)})})}}async function Db(n,e,t,a=!1,o=!1){const c=new TI(n);let d;if(o)d=ox;else try{d=await c.verify(t)}catch{d=await c.verify(t,!0)}const f=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const p=f.phoneEnrollmentInfo.phoneNumber,v=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:p,recaptchaToken:v,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const p=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:p,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return a?Object.assign(f,{captchaResp:d}):Object.assign(f,{captchaResponse:d}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function Zp(n,e,t,a,o){var c;if(!((c=n._getRecaptchaConfig())===null||c===void 0)&&c.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await Db(n,e,t,t==="getOobCode");return a(n,d)}else return a(n,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await Db(n,e,t,t==="getOobCode");return a(n,f)}else return Promise.reject(d)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xI(n,e){const t=Ma(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),c=t.getOptions();if(Ti(c,e??{}))return o;us(o,"already-initialized")}return t.initialize({options:e})}function AI(n,e){const t=e?.persistence||[],a=(Array.isArray(t)?t:[t]).map(Sa);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(a,e?.popupRedirectResolver)}function CI(n,e,t){const a=ki(n);we(/^https?:\/\//.test(e),a,"invalid-emulator-scheme");const o=!1,c=lx(e),{host:d,port:f}=jI(e),p=f===null?"":`:${f}`,v={url:`${c}//${d}${p}/`},_=Object.freeze({host:d,port:f,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!a._canInitEmulator){we(a.config.emulator&&a.emulatorConfig,a,"emulator-config-failed"),we(Ti(v,a.config.emulator)&&Ti(_,a.emulatorConfig),a,"emulator-config-failed");return}a.config.emulator=v,a.emulatorConfig=_,a.settings.appVerificationDisabledForTesting=!0,Pr(d)?(Tg(`${c}//${d}${p}`),xg("Auth",!0)):SI()}function lx(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function jI(n){const e=lx(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const a=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(a);if(o){const c=o[1];return{host:c,port:Ob(a.substr(c.length+1))}}else{const[c,d]=a.split(":");return{host:c,port:Ob(d)}}}function Ob(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function SI(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ja("not implemented")}_getIdTokenResponse(e){return ja("not implemented")}_linkToIdToken(e,t){return ja("not implemented")}_getReauthenticationResolver(e){return ja("not implemented")}}async function wI(n,e){return Pi(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function II(n,e){return au(n,"POST","/v1/accounts:signInWithPassword",Mi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RI(n,e){return au(n,"POST","/v1/accounts:signInWithEmailLink",Mi(n,e))}async function DI(n,e){return au(n,"POST","/v1/accounts:signInWithEmailLink",Mi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc extends Mg{constructor(e,t,a,o=null){super("password",a),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new zc(e,t,"password")}static _fromEmailAndCode(e,t,a=null){return new zc(e,t,"emailLink",a)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Zp(e,t,"signInWithPassword",II);case"emailLink":return RI(e,{email:this._email,oobCode:this._password});default:us(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const a={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Zp(e,a,"signUpPassword",wI);case"emailLink":return DI(e,{idToken:t,email:this._email,oobCode:this._password});default:us(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Go(n,e){return au(n,"POST","/v1/accounts:signInWithIdp",Mi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OI="http://localhost";class Sr extends Mg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Sr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):us("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:a,signInMethod:o}=t,c=Sg(t,["providerId","signInMethod"]);if(!a||!o)return null;const d=new Sr(a,o);return d.idToken=c.idToken||void 0,d.accessToken=c.accessToken||void 0,d.secret=c.secret,d.nonce=c.nonce,d.pendingToken=c.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Go(e,t)}_linkToIdToken(e,t){const a=this.buildRequest();return a.idToken=t,Go(e,a)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Go(e,t)}buildRequest(){const e={requestUri:OI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=eu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MI(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function PI(n){const e=xc(Ac(n)).link,t=e?xc(Ac(e)).deep_link_id:null,a=xc(Ac(n)).deep_link_id;return(a?xc(Ac(a)).link:null)||a||t||e||n}class Pg{constructor(e){var t,a,o,c,d,f;const p=xc(Ac(e)),v=(t=p.apiKey)!==null&&t!==void 0?t:null,_=(a=p.oobCode)!==null&&a!==void 0?a:null,N=MI((o=p.mode)!==null&&o!==void 0?o:null);we(v&&_&&N,"argument-error"),this.apiKey=v,this.operation=N,this.code=_,this.continueUrl=(c=p.continueUrl)!==null&&c!==void 0?c:null,this.languageCode=(d=p.lang)!==null&&d!==void 0?d:null,this.tenantId=(f=p.tenantId)!==null&&f!==void 0?f:null}static parseLink(e){const t=PI(e);try{return new Pg(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(){this.providerId=il.PROVIDER_ID}static credential(e,t){return zc._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const a=Pg.parseLink(t);return we(a,"argument-error"),zc._fromEmailAndCode(e,a.code,a.tenantId)}}il.PROVIDER_ID="password";il.EMAIL_PASSWORD_SIGN_IN_METHOD="password";il.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu extends kg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi extends iu{constructor(){super("facebook.com")}static credential(e){return Sr._fromParams({providerId:mi.PROVIDER_ID,signInMethod:mi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return mi.credentialFromTaggedObject(e)}static credentialFromError(e){return mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return mi.credential(e.oauthAccessToken)}catch{return null}}}mi.FACEBOOK_SIGN_IN_METHOD="facebook.com";mi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca extends iu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Sr._fromParams({providerId:Ca.PROVIDER_ID,signInMethod:Ca.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ca.credentialFromTaggedObject(e)}static credentialFromError(e){return Ca.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:a}=e;if(!t&&!a)return null;try{return Ca.credential(t,a)}catch{return null}}}Ca.GOOGLE_SIGN_IN_METHOD="google.com";Ca.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi extends iu{constructor(){super("github.com")}static credential(e){return Sr._fromParams({providerId:pi.PROVIDER_ID,signInMethod:pi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return pi.credentialFromTaggedObject(e)}static credentialFromError(e){return pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return pi.credential(e.oauthAccessToken)}catch{return null}}}pi.GITHUB_SIGN_IN_METHOD="github.com";pi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi extends iu{constructor(){super("twitter.com")}static credential(e,t){return Sr._fromParams({providerId:gi.PROVIDER_ID,signInMethod:gi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return gi.credentialFromTaggedObject(e)}static credentialFromError(e){return gi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:a}=e;if(!t||!a)return null;try{return gi.credential(t,a)}catch{return null}}}gi.TWITTER_SIGN_IN_METHOD="twitter.com";gi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kI(n,e){return au(n,"POST","/v1/accounts:signUp",Mi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,a,o=!1){const c=await bs._fromIdTokenResponse(e,a,o),d=Mb(a);return new wr({user:c,providerId:d,_tokenResponse:a,operationType:t})}static async _forOperation(e,t,a){await e._updateTokensIfNecessary(a,!0);const o=Mb(a);return new wr({user:e,providerId:o,_tokenResponse:a,operationType:t})}}function Mb(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gh extends ds{constructor(e,t,a,o){var c;super(t.code,t.message),this.operationType=a,this.user=o,Object.setPrototypeOf(this,gh.prototype),this.customData={appName:e.name,tenantId:(c=e.tenantId)!==null&&c!==void 0?c:void 0,_serverResponse:t.customData._serverResponse,operationType:a}}static _fromErrorAndOperation(e,t,a,o){return new gh(e,t,a,o)}}function cx(n,e,t,a){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?gh._fromErrorAndOperation(n,c,e,a):c})}async function LI(n,e,t=!1){const a=await Bc(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return wr._forOperation(n,"link",a)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VI(n,e,t=!1){const{auth:a}=n;if(Dn(a.app))return Promise.reject(wa(a));const o="reauthenticate";try{const c=await Bc(n,cx(a,o,e,n),t);we(c.idToken,a,"internal-error");const d=Dg(c.idToken);we(d,a,"internal-error");const{sub:f}=d;return we(n.uid===f,a,"user-mismatch"),wr._forOperation(n,o,c)}catch(c){throw c?.code==="auth/user-not-found"&&us(a,"user-mismatch"),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ux(n,e,t=!1){if(Dn(n.app))return Promise.reject(wa(n));const a="signIn",o=await cx(n,a,e),c=await wr._fromIdTokenResponse(n,a,o);return t||await n._updateCurrentUser(c.user),c}async function UI(n,e){return ux(ki(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dx(n){const e=ki(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function FI(n,e,t){if(Dn(n.app))return Promise.reject(wa(n));const a=ki(n),d=await Zp(a,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",kI).catch(p=>{throw p.code==="auth/password-does-not-meet-requirements"&&dx(n),p}),f=await wr._fromIdTokenResponse(a,"signIn",d);return await a._updateCurrentUser(f.user),f}function HI(n,e,t){return Dn(n.app)?Promise.reject(wa(n)):UI(gt(n),il.credential(e,t)).catch(async a=>{throw a.code==="auth/password-does-not-meet-requirements"&&dx(n),a})}function qI(n,e,t,a){return gt(n).onIdTokenChanged(e,t,a)}function BI(n,e,t){return gt(n).beforeAuthStateChanged(e,t)}function zI(n,e,t,a){return gt(n).onAuthStateChanged(e,t,a)}function GI(n){return gt(n).signOut()}const vh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hx{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(vh,"1"),this.storage.removeItem(vh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $I=1e3,YI=10;class fx extends hx{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ax(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const a=this.storage.getItem(t),o=this.localCache[t];a!==o&&e(t,o,a)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,f,p)=>{this.notifyListeners(d,p)});return}const a=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const d=this.storage.getItem(a);!t&&this.localCache[a]===d||this.notifyListeners(a,d)},c=this.storage.getItem(a);uI()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,YI):o()}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const o of Array.from(a))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,a)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:a}),!0)})},$I)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}fx.type="LOCAL";const KI=fx;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mx extends hx{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}mx.type="SESSION";const px=mx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QI(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const a=new Hh(e);return this.receivers.push(a),a}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:a,eventType:o,data:c}=t.data,d=this.handlersMap[o];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:a,eventType:o});const f=Array.from(d).map(async v=>v(t.origin,c)),p=await QI(f);t.ports[0].postMessage({status:"done",eventId:a,eventType:o,response:p})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Hh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lg(n="",e=10){let t="";for(let a=0;a<e;a++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,a=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let c,d;return new Promise((f,p)=>{const v=Lg("",20);o.port1.start();const _=setTimeout(()=>{p(new Error("unsupported_event"))},a);d={messageChannel:o,onMessage(N){const C=N;if(C.data.eventId===v)switch(C.data.status){case"ack":clearTimeout(_),c=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),f(C.data.response);break;default:clearTimeout(_),clearTimeout(c),p(new Error("invalid_response"));break}}},this.handlers.add(d),o.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:v,data:t},[o.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gs(){return window}function WI(n){Gs().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gx(){return typeof Gs().WorkerGlobalScope<"u"&&typeof Gs().importScripts=="function"}async function ZI(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function JI(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function eR(){return gx()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vx="firebaseLocalStorageDb",tR=1,yh="firebaseLocalStorage",yx="fbase_key";class ru{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function qh(n,e){return n.transaction([yh],e?"readwrite":"readonly").objectStore(yh)}function nR(){const n=indexedDB.deleteDatabase(vx);return new ru(n).toPromise()}function Jp(){const n=indexedDB.open(vx,tR);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const a=n.result;try{a.createObjectStore(yh,{keyPath:yx})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const a=n.result;a.objectStoreNames.contains(yh)?e(a):(a.close(),await nR(),e(await Jp()))})})}async function Pb(n,e,t){const a=qh(n,!0).put({[yx]:e,value:t});return new ru(a).toPromise()}async function sR(n,e){const t=qh(n,!1).get(e),a=await new ru(t).toPromise();return a===void 0?null:a.value}function kb(n,e){const t=qh(n,!0).delete(e);return new ru(t).toPromise()}const aR=800,iR=3;class _x{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Jp(),this.db)}async _withRetries(e){let t=0;for(;;)try{const a=await this._openDb();return await e(a)}catch(a){if(t++>iR)throw a;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return gx()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Hh._getInstance(eR()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await ZI(),!this.activeServiceWorker)return;this.sender=new XI(this.activeServiceWorker);const a=await this.sender._send("ping",{},800);a&&!((e=a[0])===null||e===void 0)&&e.fulfilled&&!((t=a[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||JI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Jp();return await Pb(e,vh,"1"),await kb(e,vh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(a=>Pb(a,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(a=>sR(a,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>kb(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const c=qh(o,!1).getAll();return new ru(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],a=new Set;if(e.length!==0)for(const{fbase_key:o,value:c}of e)a.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(c)&&(this.notifyListeners(o,c),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!a.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const o of Array.from(a))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),aR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}_x.type="LOCAL";const rR=_x;new su(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ex(n,e){return e?Sa(e):(we(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg extends Mg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Go(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Go(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Go(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function oR(n){return ux(n.auth,new Vg(n),n.bypassAuthState)}function lR(n){const{auth:e,user:t}=n;return we(t,e,"internal-error"),VI(t,new Vg(n),n.bypassAuthState)}async function cR(n){const{auth:e,user:t}=n;return we(t,e,"internal-error"),LI(t,new Vg(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx{constructor(e,t,a,o,c=!1){this.auth=e,this.resolver=a,this.user=o,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(a){this.reject(a)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:a,postBody:o,tenantId:c,error:d,type:f}=e;if(d){this.reject(d);return}const p={auth:this.auth,requestUri:t,sessionId:a,tenantId:c||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(p))}catch(v){this.reject(v)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return oR;case"linkViaPopup":case"linkViaRedirect":return cR;case"reauthViaPopup":case"reauthViaRedirect":return lR;default:us(this.auth,"internal-error")}}resolve(e){Ra(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ra(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uR=new su(2e3,1e4);async function dR(n,e,t){if(Dn(n.app))return Promise.reject(Ts(n,"operation-not-supported-in-this-environment"));const a=ki(n);zw(n,e,kg);const o=Ex(a,t);return new xr(a,"signInViaPopup",e,o).executeNotNull()}class xr extends bx{constructor(e,t,a,o,c){super(e,t,o,c),this.provider=a,this.authWindow=null,this.pollId=null,xr.currentPopupAction&&xr.currentPopupAction.cancel(),xr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return we(e,this.auth,"internal-error"),e}async onExecution(){Ra(this.filter.length===1,"Popup operations only handle one event");const e=Lg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ts(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Ts(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,xr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,a;if(!((a=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||a===void 0)&&a.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ts(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,uR.get())};e()}}xr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hR="pendingRedirect",th=new Map;class fR extends bx{constructor(e,t,a=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,a),this.eventId=null}async execute(){let e=th.get(this.auth._key());if(!e){try{const a=await mR(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(a)}catch(t){e=()=>Promise.reject(t)}th.set(this.auth._key(),e)}return this.bypassAuthState||th.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function mR(n,e){const t=vR(e),a=gR(n);if(!await a._isAvailable())return!1;const o=await a._get(t)==="true";return await a._remove(t),o}function pR(n,e){th.set(n._key(),e)}function gR(n){return Sa(n._redirectPersistence)}function vR(n){return eh(hR,n.config.apiKey,n.name)}async function yR(n,e,t=!1){if(Dn(n.app))return Promise.reject(wa(n));const a=ki(n),o=Ex(a,e),d=await new fR(a,o,t).execute();return d&&!t&&(delete d.user._redirectEventId,await a._persistUserIfCurrent(d.user),await a._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _R=10*60*1e3;class ER{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(a=>{this.isEventForConsumer(e,a)&&(t=!0,this.sendToConsumer(e,a),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!bR(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var a;if(e.error&&!Nx(e)){const o=((a=e.error.code)===null||a===void 0?void 0:a.split("auth/")[1])||"internal-error";t.onError(Ts(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const a=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&a}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=_R&&this.cachedEventUids.clear(),this.cachedEventUids.has(Lb(e))}saveEventToCache(e){this.cachedEventUids.add(Lb(e)),this.lastProcessedEventTime=Date.now()}}function Lb(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Nx({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function bR(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Nx(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NR(n,e={}){return Pi(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TR=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,xR=/^https?/;async function AR(n){if(n.config.emulator)return;const{authorizedDomains:e}=await NR(n);for(const t of e)try{if(CR(t))return}catch{}us(n,"unauthorized-domain")}function CR(n){const e=Xp(),{protocol:t,hostname:a}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&a===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===a}if(!xR.test(t))return!1;if(TR.test(n))return a===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jR=new su(3e4,6e4);function Vb(){const n=Gs().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function SR(n){return new Promise((e,t)=>{var a,o,c;function d(){Vb(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Vb(),t(Ts(n,"network-request-failed"))},timeout:jR.get()})}if(!((o=(a=Gs().gapi)===null||a===void 0?void 0:a.iframes)===null||o===void 0)&&o.Iframe)e(gapi.iframes.getContext());else if(!((c=Gs().gapi)===null||c===void 0)&&c.load)d();else{const f=_I("iframefcb");return Gs()[f]=()=>{gapi.load?d():t(Ts(n,"network-request-failed"))},rx(`${yI()}?onload=${f}`).catch(p=>t(p))}}).catch(e=>{throw nh=null,e})}let nh=null;function wR(n){return nh=nh||SR(n),nh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IR=new su(5e3,15e3),RR="__/auth/iframe",DR="emulator/auth/iframe",OR={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},MR=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function PR(n){const e=n.config;we(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Rg(e,DR):`https://${n.config.authDomain}/${RR}`,a={apiKey:e.apiKey,appName:n.name,v:kr},o=MR.get(n.config.apiHost);o&&(a.eid=o);const c=n._getFrameworks();return c.length&&(a.fw=c.join(",")),`${t}?${eu(a).slice(1)}`}async function kR(n){const e=await wR(n),t=Gs().gapi;return we(t,n,"internal-error"),e.open({where:document.body,url:PR(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:OR,dontclear:!0},a=>new Promise(async(o,c)=>{await a.restyle({setHideOnLeave:!1});const d=Ts(n,"network-request-failed"),f=Gs().setTimeout(()=>{c(d)},IR.get());function p(){Gs().clearTimeout(f),o(a)}a.ping(p).then(p,()=>{c(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LR={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},VR=500,UR=600,FR="_blank",HR="http://localhost";class Ub{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function qR(n,e,t,a=VR,o=UR){const c=Math.max((window.screen.availHeight-o)/2,0).toString(),d=Math.max((window.screen.availWidth-a)/2,0).toString();let f="";const p=Object.assign(Object.assign({},LR),{width:a.toString(),height:o.toString(),top:c,left:d}),v=_n().toLowerCase();t&&(f=JT(v)?FR:t),WT(v)&&(e=e||HR,p.scrollbars="yes");const _=Object.entries(p).reduce((C,[j,b])=>`${C}${j}=${b},`,"");if(cI(v)&&f!=="_self")return BR(e||"",f),new Ub(null);const N=window.open(e||"",f,_);we(N,n,"popup-blocked");try{N.focus()}catch{}return new Ub(N)}function BR(n,e){const t=document.createElement("a");t.href=n,t.target=e;const a=document.createEvent("MouseEvent");a.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zR="__/auth/handler",GR="emulator/auth/handler",$R=encodeURIComponent("fac");async function Fb(n,e,t,a,o,c){we(n.config.authDomain,n,"auth-domain-config-required"),we(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:a,v:kr,eventId:o};if(e instanceof kg){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",jS(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,N]of Object.entries({}))d[_]=N}if(e instanceof iu){const _=e.getScopes().filter(N=>N!=="");_.length>0&&(d.scopes=_.join(","))}n.tenantId&&(d.tid=n.tenantId);const f=d;for(const _ of Object.keys(f))f[_]===void 0&&delete f[_];const p=await n._getAppCheckToken(),v=p?`#${$R}=${encodeURIComponent(p)}`:"";return`${YR(n)}?${eu(f).slice(1)}${v}`}function YR({config:n}){return n.emulator?Rg(n,GR):`https://${n.authDomain}/${zR}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wp="webStorageSupport";class KR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=px,this._completeRedirectFn=yR,this._overrideRedirectResult=pR}async _openPopup(e,t,a,o){var c;Ra((c=this.eventManagers[e._key()])===null||c===void 0?void 0:c.manager,"_initialize() not called before _openPopup()");const d=await Fb(e,t,a,Xp(),o);return qR(e,d,Lg())}async _openRedirect(e,t,a,o){await this._originValidation(e);const c=await Fb(e,t,a,Xp(),o);return WI(c),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:c}=this.eventManagers[t];return o?Promise.resolve(o):(Ra(c,"If manager is not set, promise should be"),c)}const a=this.initAndGetManager(e);return this.eventManagers[t]={promise:a},a.catch(()=>{delete this.eventManagers[t]}),a}async initAndGetManager(e){const t=await kR(e),a=new ER(e);return t.register("authEvent",o=>(we(o?.authEvent,e,"invalid-auth-event"),{status:a.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:a},this.iframes[e._key()]=t,a}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(wp,{type:wp},o=>{var c;const d=(c=o?.[0])===null||c===void 0?void 0:c[wp];d!==void 0&&t(!!d),us(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=AR(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ax()||ZT()||Og()}}const QR=KR;var Hb="@firebase/auth",qb="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(a=>{e(a?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){we(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WR(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function ZR(n){cs(new Kn("auth",(e,{options:t})=>{const a=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:d,authDomain:f}=a.options;we(d&&!d.includes(":"),"invalid-api-key",{appName:a.name});const p={apiKey:d,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ix(n)},v=new pI(a,o,c,p);return AI(v,t),v},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,a)=>{e.getProvider("auth-internal").initialize()})),cs(new Kn("auth-internal",e=>{const t=ki(e.getProvider("auth").getImmediate());return(a=>new XR(a))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),yn(Hb,qb,WR(n)),yn(Hb,qb,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JR=5*60,e1=MT("authIdTokenMaxAge")||JR;let Bb=null;const t1=n=>async e=>{const t=e&&await e.getIdTokenResult(),a=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(a&&a>e1)return;const o=t?.token;Bb!==o&&(Bb=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function n1(n=nu()){const e=Ma(n,"auth");if(e.isInitialized())return e.getImmediate();const t=xI(n,{popupRedirectResolver:QR,persistence:[rR,KI,px]}),a=MT("authTokenSyncURL");if(a&&typeof isSecureContext=="boolean"&&isSecureContext){const c=new URL(a,location.origin);if(location.origin===c.origin){const d=t1(c.toString());BI(t,d,()=>d(t.currentUser)),qI(t,f=>d(f))}}const o=RT("auth");return o&&CI(t,`http://${o}`),t}function s1(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}gI({loadJS(n){return new Promise((e,t)=>{const a=document.createElement("script");a.setAttribute("src",n),a.onload=e,a.onerror=o=>{const c=Ts("internal-error");c.customData=o,t(c)},a.type="text/javascript",a.charset="UTF-8",s1().appendChild(a)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});ZR("Browser");var a1="firebase",i1="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */yn(a1,i1,"app");var zb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var bi,Tx;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,A){function R(){}R.prototype=A.prototype,w.D=A.prototype,w.prototype=new R,w.prototype.constructor=w,w.C=function(I,P,V){for(var k=Array(arguments.length-2),Le=2;Le<arguments.length;Le++)k[Le-2]=arguments[Le];return A.prototype[P].apply(I,k)}}function t(){this.blockSize=-1}function a(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(a,t),a.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(w,A,R){R||(R=0);var I=Array(16);if(typeof A=="string")for(var P=0;16>P;++P)I[P]=A.charCodeAt(R++)|A.charCodeAt(R++)<<8|A.charCodeAt(R++)<<16|A.charCodeAt(R++)<<24;else for(P=0;16>P;++P)I[P]=A[R++]|A[R++]<<8|A[R++]<<16|A[R++]<<24;A=w.g[0],R=w.g[1],P=w.g[2];var V=w.g[3],k=A+(V^R&(P^V))+I[0]+3614090360&4294967295;A=R+(k<<7&4294967295|k>>>25),k=V+(P^A&(R^P))+I[1]+3905402710&4294967295,V=A+(k<<12&4294967295|k>>>20),k=P+(R^V&(A^R))+I[2]+606105819&4294967295,P=V+(k<<17&4294967295|k>>>15),k=R+(A^P&(V^A))+I[3]+3250441966&4294967295,R=P+(k<<22&4294967295|k>>>10),k=A+(V^R&(P^V))+I[4]+4118548399&4294967295,A=R+(k<<7&4294967295|k>>>25),k=V+(P^A&(R^P))+I[5]+1200080426&4294967295,V=A+(k<<12&4294967295|k>>>20),k=P+(R^V&(A^R))+I[6]+2821735955&4294967295,P=V+(k<<17&4294967295|k>>>15),k=R+(A^P&(V^A))+I[7]+4249261313&4294967295,R=P+(k<<22&4294967295|k>>>10),k=A+(V^R&(P^V))+I[8]+1770035416&4294967295,A=R+(k<<7&4294967295|k>>>25),k=V+(P^A&(R^P))+I[9]+2336552879&4294967295,V=A+(k<<12&4294967295|k>>>20),k=P+(R^V&(A^R))+I[10]+4294925233&4294967295,P=V+(k<<17&4294967295|k>>>15),k=R+(A^P&(V^A))+I[11]+2304563134&4294967295,R=P+(k<<22&4294967295|k>>>10),k=A+(V^R&(P^V))+I[12]+1804603682&4294967295,A=R+(k<<7&4294967295|k>>>25),k=V+(P^A&(R^P))+I[13]+4254626195&4294967295,V=A+(k<<12&4294967295|k>>>20),k=P+(R^V&(A^R))+I[14]+2792965006&4294967295,P=V+(k<<17&4294967295|k>>>15),k=R+(A^P&(V^A))+I[15]+1236535329&4294967295,R=P+(k<<22&4294967295|k>>>10),k=A+(P^V&(R^P))+I[1]+4129170786&4294967295,A=R+(k<<5&4294967295|k>>>27),k=V+(R^P&(A^R))+I[6]+3225465664&4294967295,V=A+(k<<9&4294967295|k>>>23),k=P+(A^R&(V^A))+I[11]+643717713&4294967295,P=V+(k<<14&4294967295|k>>>18),k=R+(V^A&(P^V))+I[0]+3921069994&4294967295,R=P+(k<<20&4294967295|k>>>12),k=A+(P^V&(R^P))+I[5]+3593408605&4294967295,A=R+(k<<5&4294967295|k>>>27),k=V+(R^P&(A^R))+I[10]+38016083&4294967295,V=A+(k<<9&4294967295|k>>>23),k=P+(A^R&(V^A))+I[15]+3634488961&4294967295,P=V+(k<<14&4294967295|k>>>18),k=R+(V^A&(P^V))+I[4]+3889429448&4294967295,R=P+(k<<20&4294967295|k>>>12),k=A+(P^V&(R^P))+I[9]+568446438&4294967295,A=R+(k<<5&4294967295|k>>>27),k=V+(R^P&(A^R))+I[14]+3275163606&4294967295,V=A+(k<<9&4294967295|k>>>23),k=P+(A^R&(V^A))+I[3]+4107603335&4294967295,P=V+(k<<14&4294967295|k>>>18),k=R+(V^A&(P^V))+I[8]+1163531501&4294967295,R=P+(k<<20&4294967295|k>>>12),k=A+(P^V&(R^P))+I[13]+2850285829&4294967295,A=R+(k<<5&4294967295|k>>>27),k=V+(R^P&(A^R))+I[2]+4243563512&4294967295,V=A+(k<<9&4294967295|k>>>23),k=P+(A^R&(V^A))+I[7]+1735328473&4294967295,P=V+(k<<14&4294967295|k>>>18),k=R+(V^A&(P^V))+I[12]+2368359562&4294967295,R=P+(k<<20&4294967295|k>>>12),k=A+(R^P^V)+I[5]+4294588738&4294967295,A=R+(k<<4&4294967295|k>>>28),k=V+(A^R^P)+I[8]+2272392833&4294967295,V=A+(k<<11&4294967295|k>>>21),k=P+(V^A^R)+I[11]+1839030562&4294967295,P=V+(k<<16&4294967295|k>>>16),k=R+(P^V^A)+I[14]+4259657740&4294967295,R=P+(k<<23&4294967295|k>>>9),k=A+(R^P^V)+I[1]+2763975236&4294967295,A=R+(k<<4&4294967295|k>>>28),k=V+(A^R^P)+I[4]+1272893353&4294967295,V=A+(k<<11&4294967295|k>>>21),k=P+(V^A^R)+I[7]+4139469664&4294967295,P=V+(k<<16&4294967295|k>>>16),k=R+(P^V^A)+I[10]+3200236656&4294967295,R=P+(k<<23&4294967295|k>>>9),k=A+(R^P^V)+I[13]+681279174&4294967295,A=R+(k<<4&4294967295|k>>>28),k=V+(A^R^P)+I[0]+3936430074&4294967295,V=A+(k<<11&4294967295|k>>>21),k=P+(V^A^R)+I[3]+3572445317&4294967295,P=V+(k<<16&4294967295|k>>>16),k=R+(P^V^A)+I[6]+76029189&4294967295,R=P+(k<<23&4294967295|k>>>9),k=A+(R^P^V)+I[9]+3654602809&4294967295,A=R+(k<<4&4294967295|k>>>28),k=V+(A^R^P)+I[12]+3873151461&4294967295,V=A+(k<<11&4294967295|k>>>21),k=P+(V^A^R)+I[15]+530742520&4294967295,P=V+(k<<16&4294967295|k>>>16),k=R+(P^V^A)+I[2]+3299628645&4294967295,R=P+(k<<23&4294967295|k>>>9),k=A+(P^(R|~V))+I[0]+4096336452&4294967295,A=R+(k<<6&4294967295|k>>>26),k=V+(R^(A|~P))+I[7]+1126891415&4294967295,V=A+(k<<10&4294967295|k>>>22),k=P+(A^(V|~R))+I[14]+2878612391&4294967295,P=V+(k<<15&4294967295|k>>>17),k=R+(V^(P|~A))+I[5]+4237533241&4294967295,R=P+(k<<21&4294967295|k>>>11),k=A+(P^(R|~V))+I[12]+1700485571&4294967295,A=R+(k<<6&4294967295|k>>>26),k=V+(R^(A|~P))+I[3]+2399980690&4294967295,V=A+(k<<10&4294967295|k>>>22),k=P+(A^(V|~R))+I[10]+4293915773&4294967295,P=V+(k<<15&4294967295|k>>>17),k=R+(V^(P|~A))+I[1]+2240044497&4294967295,R=P+(k<<21&4294967295|k>>>11),k=A+(P^(R|~V))+I[8]+1873313359&4294967295,A=R+(k<<6&4294967295|k>>>26),k=V+(R^(A|~P))+I[15]+4264355552&4294967295,V=A+(k<<10&4294967295|k>>>22),k=P+(A^(V|~R))+I[6]+2734768916&4294967295,P=V+(k<<15&4294967295|k>>>17),k=R+(V^(P|~A))+I[13]+1309151649&4294967295,R=P+(k<<21&4294967295|k>>>11),k=A+(P^(R|~V))+I[4]+4149444226&4294967295,A=R+(k<<6&4294967295|k>>>26),k=V+(R^(A|~P))+I[11]+3174756917&4294967295,V=A+(k<<10&4294967295|k>>>22),k=P+(A^(V|~R))+I[2]+718787259&4294967295,P=V+(k<<15&4294967295|k>>>17),k=R+(V^(P|~A))+I[9]+3951481745&4294967295,w.g[0]=w.g[0]+A&4294967295,w.g[1]=w.g[1]+(P+(k<<21&4294967295|k>>>11))&4294967295,w.g[2]=w.g[2]+P&4294967295,w.g[3]=w.g[3]+V&4294967295}a.prototype.u=function(w,A){A===void 0&&(A=w.length);for(var R=A-this.blockSize,I=this.B,P=this.h,V=0;V<A;){if(P==0)for(;V<=R;)o(this,w,V),V+=this.blockSize;if(typeof w=="string"){for(;V<A;)if(I[P++]=w.charCodeAt(V++),P==this.blockSize){o(this,I),P=0;break}}else for(;V<A;)if(I[P++]=w[V++],P==this.blockSize){o(this,I),P=0;break}}this.h=P,this.o+=A},a.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var A=1;A<w.length-8;++A)w[A]=0;var R=8*this.o;for(A=w.length-8;A<w.length;++A)w[A]=R&255,R/=256;for(this.u(w),w=Array(16),A=R=0;4>A;++A)for(var I=0;32>I;I+=8)w[R++]=this.g[A]>>>I&255;return w};function c(w,A){var R=f;return Object.prototype.hasOwnProperty.call(R,w)?R[w]:R[w]=A(w)}function d(w,A){this.h=A;for(var R=[],I=!0,P=w.length-1;0<=P;P--){var V=w[P]|0;I&&V==A||(R[P]=V,I=!1)}this.g=R}var f={};function p(w){return-128<=w&&128>w?c(w,function(A){return new d([A|0],0>A?-1:0)}):new d([w|0],0>w?-1:0)}function v(w){if(isNaN(w)||!isFinite(w))return N;if(0>w)return x(v(-w));for(var A=[],R=1,I=0;w>=R;I++)A[I]=w/R|0,R*=4294967296;return new d(A,0)}function _(w,A){if(w.length==0)throw Error("number format error: empty string");if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(w.charAt(0)=="-")return x(_(w.substring(1),A));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=v(Math.pow(A,8)),I=N,P=0;P<w.length;P+=8){var V=Math.min(8,w.length-P),k=parseInt(w.substring(P,P+V),A);8>V?(V=v(Math.pow(A,V)),I=I.j(V).add(v(k))):(I=I.j(R),I=I.add(v(k)))}return I}var N=p(0),C=p(1),j=p(16777216);n=d.prototype,n.m=function(){if(M(this))return-x(this).m();for(var w=0,A=1,R=0;R<this.g.length;R++){var I=this.i(R);w+=(0<=I?I:4294967296+I)*A,A*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(b(this))return"0";if(M(this))return"-"+x(this).toString(w);for(var A=v(Math.pow(w,6)),R=this,I="";;){var P=U(R,A).g;R=L(R,P.j(A));var V=((0<R.g.length?R.g[0]:R.h)>>>0).toString(w);if(R=P,b(R))return V+I;for(;6>V.length;)V="0"+V;I=V+I}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function b(w){if(w.h!=0)return!1;for(var A=0;A<w.g.length;A++)if(w.g[A]!=0)return!1;return!0}function M(w){return w.h==-1}n.l=function(w){return w=L(this,w),M(w)?-1:b(w)?0:1};function x(w){for(var A=w.g.length,R=[],I=0;I<A;I++)R[I]=~w.g[I];return new d(R,~w.h).add(C)}n.abs=function(){return M(this)?x(this):this},n.add=function(w){for(var A=Math.max(this.g.length,w.g.length),R=[],I=0,P=0;P<=A;P++){var V=I+(this.i(P)&65535)+(w.i(P)&65535),k=(V>>>16)+(this.i(P)>>>16)+(w.i(P)>>>16);I=k>>>16,V&=65535,k&=65535,R[P]=k<<16|V}return new d(R,R[R.length-1]&-2147483648?-1:0)};function L(w,A){return w.add(x(A))}n.j=function(w){if(b(this)||b(w))return N;if(M(this))return M(w)?x(this).j(x(w)):x(x(this).j(w));if(M(w))return x(this.j(x(w)));if(0>this.l(j)&&0>w.l(j))return v(this.m()*w.m());for(var A=this.g.length+w.g.length,R=[],I=0;I<2*A;I++)R[I]=0;for(I=0;I<this.g.length;I++)for(var P=0;P<w.g.length;P++){var V=this.i(I)>>>16,k=this.i(I)&65535,Le=w.i(P)>>>16,ae=w.i(P)&65535;R[2*I+2*P]+=k*ae,$(R,2*I+2*P),R[2*I+2*P+1]+=V*ae,$(R,2*I+2*P+1),R[2*I+2*P+1]+=k*Le,$(R,2*I+2*P+1),R[2*I+2*P+2]+=V*Le,$(R,2*I+2*P+2)}for(I=0;I<A;I++)R[I]=R[2*I+1]<<16|R[2*I];for(I=A;I<2*A;I++)R[I]=0;return new d(R,0)};function $(w,A){for(;(w[A]&65535)!=w[A];)w[A+1]+=w[A]>>>16,w[A]&=65535,A++}function O(w,A){this.g=w,this.h=A}function U(w,A){if(b(A))throw Error("division by zero");if(b(w))return new O(N,N);if(M(w))return A=U(x(w),A),new O(x(A.g),x(A.h));if(M(A))return A=U(w,x(A)),new O(x(A.g),A.h);if(30<w.g.length){if(M(w)||M(A))throw Error("slowDivide_ only works with positive integers.");for(var R=C,I=A;0>=I.l(w);)R=F(R),I=F(I);var P=X(R,1),V=X(I,1);for(I=X(I,2),R=X(R,2);!b(I);){var k=V.add(I);0>=k.l(w)&&(P=P.add(R),V=k),I=X(I,1),R=X(R,1)}return A=L(w,P.j(A)),new O(P,A)}for(P=N;0<=w.l(A);){for(R=Math.max(1,Math.floor(w.m()/A.m())),I=Math.ceil(Math.log(R)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),V=v(R),k=V.j(A);M(k)||0<k.l(w);)R-=I,V=v(R),k=V.j(A);b(V)&&(V=C),P=P.add(V),w=L(w,k)}return new O(P,w)}n.A=function(w){return U(this,w).h},n.and=function(w){for(var A=Math.max(this.g.length,w.g.length),R=[],I=0;I<A;I++)R[I]=this.i(I)&w.i(I);return new d(R,this.h&w.h)},n.or=function(w){for(var A=Math.max(this.g.length,w.g.length),R=[],I=0;I<A;I++)R[I]=this.i(I)|w.i(I);return new d(R,this.h|w.h)},n.xor=function(w){for(var A=Math.max(this.g.length,w.g.length),R=[],I=0;I<A;I++)R[I]=this.i(I)^w.i(I);return new d(R,this.h^w.h)};function F(w){for(var A=w.g.length+1,R=[],I=0;I<A;I++)R[I]=w.i(I)<<1|w.i(I-1)>>>31;return new d(R,w.h)}function X(w,A){var R=A>>5;A%=32;for(var I=w.g.length-R,P=[],V=0;V<I;V++)P[V]=0<A?w.i(V+R)>>>A|w.i(V+R+1)<<32-A:w.i(V+R);return new d(P,w.h)}a.prototype.digest=a.prototype.v,a.prototype.reset=a.prototype.s,a.prototype.update=a.prototype.u,Tx=a,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=v,d.fromString=_,bi=d}).apply(typeof zb<"u"?zb:typeof self<"u"?self:typeof window<"u"?window:{});var Gd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var xx,Cc,Ax,sh,eg,Cx,jx,Sx;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,y,E){return h==Array.prototype||h==Object.prototype||(h[y]=E.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Gd=="object"&&Gd];for(var y=0;y<h.length;++y){var E=h[y];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var a=t(this);function o(h,y){if(y)e:{var E=a;h=h.split(".");for(var D=0;D<h.length-1;D++){var K=h[D];if(!(K in E))break e;E=E[K]}h=h[h.length-1],D=E[h],y=y(D),y!=D&&y!=null&&e(E,h,{configurable:!0,writable:!0,value:y})}}function c(h,y){h instanceof String&&(h+="");var E=0,D=!1,K={next:function(){if(!D&&E<h.length){var te=E++;return{value:y(te,h[te]),done:!1}}return D=!0,{done:!0,value:void 0}}};return K[Symbol.iterator]=function(){return K},K}o("Array.prototype.values",function(h){return h||function(){return c(this,function(y,E){return E})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},f=this||self;function p(h){var y=typeof h;return y=y!="object"?y:h?Array.isArray(h)?"array":y:"null",y=="array"||y=="object"&&typeof h.length=="number"}function v(h){var y=typeof h;return y=="object"&&h!=null||y=="function"}function _(h,y,E){return h.call.apply(h.bind,arguments)}function N(h,y,E){if(!h)throw Error();if(2<arguments.length){var D=Array.prototype.slice.call(arguments,2);return function(){var K=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(K,D),h.apply(y,K)}}return function(){return h.apply(y,arguments)}}function C(h,y,E){return C=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_:N,C.apply(null,arguments)}function j(h,y){var E=Array.prototype.slice.call(arguments,1);return function(){var D=E.slice();return D.push.apply(D,arguments),h.apply(this,D)}}function b(h,y){function E(){}E.prototype=y.prototype,h.aa=y.prototype,h.prototype=new E,h.prototype.constructor=h,h.Qb=function(D,K,te){for(var de=Array(arguments.length-2),Qe=2;Qe<arguments.length;Qe++)de[Qe-2]=arguments[Qe];return y.prototype[K].apply(D,de)}}function M(h){const y=h.length;if(0<y){const E=Array(y);for(let D=0;D<y;D++)E[D]=h[D];return E}return[]}function x(h,y){for(let E=1;E<arguments.length;E++){const D=arguments[E];if(p(D)){const K=h.length||0,te=D.length||0;h.length=K+te;for(let de=0;de<te;de++)h[K+de]=D[de]}else h.push(D)}}class L{constructor(y,E){this.i=y,this.j=E,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function $(h){return/^[\s\xa0]*$/.test(h)}function O(){var h=f.navigator;return h&&(h=h.userAgent)?h:""}function U(h){return U[" "](h),h}U[" "]=function(){};var F=O().indexOf("Gecko")!=-1&&!(O().toLowerCase().indexOf("webkit")!=-1&&O().indexOf("Edge")==-1)&&!(O().indexOf("Trident")!=-1||O().indexOf("MSIE")!=-1)&&O().indexOf("Edge")==-1;function X(h,y,E){for(const D in h)y.call(E,h[D],D,h)}function w(h,y){for(const E in h)y.call(void 0,h[E],E,h)}function A(h){const y={};for(const E in h)y[E]=h[E];return y}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(h,y){let E,D;for(let K=1;K<arguments.length;K++){D=arguments[K];for(E in D)h[E]=D[E];for(let te=0;te<R.length;te++)E=R[te],Object.prototype.hasOwnProperty.call(D,E)&&(h[E]=D[E])}}function P(h){var y=1;h=h.split(":");const E=[];for(;0<y&&h.length;)E.push(h.shift()),y--;return h.length&&E.push(h.join(":")),E}function V(h){f.setTimeout(()=>{throw h},0)}function k(){var h=ye;let y=null;return h.g&&(y=h.g,h.g=h.g.next,h.g||(h.h=null),y.next=null),y}class Le{constructor(){this.h=this.g=null}add(y,E){const D=ae.get();D.set(y,E),this.h?this.h.next=D:this.g=D,this.h=D}}var ae=new L(()=>new B,h=>h.reset());class B{constructor(){this.next=this.g=this.h=null}set(y,E){this.h=y,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let J,ce=!1,ye=new Le,q=()=>{const h=f.Promise.resolve(void 0);J=()=>{h.then(ne)}};var ne=()=>{for(var h;h=k();){try{h.h.call(h.g)}catch(E){V(E)}var y=ae;y.j(h),100>y.h&&(y.h++,h.next=y.g,y.g=h)}ce=!1};function he(){this.s=this.s,this.C=this.C}he.prototype.s=!1,he.prototype.ma=function(){this.s||(this.s=!0,this.N())},he.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ue(h,y){this.type=h,this.g=this.target=y,this.defaultPrevented=!1}ue.prototype.h=function(){this.defaultPrevented=!0};var xe=function(){if(!f.addEventListener||!Object.defineProperty)return!1;var h=!1,y=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const E=()=>{};f.addEventListener("test",E,y),f.removeEventListener("test",E,y)}catch{}return h}();function Fe(h,y){if(ue.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var E=this.type=h.type,D=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=y,y=h.relatedTarget){if(F){e:{try{U(y.nodeName);var K=!0;break e}catch{}K=!1}K||(y=null)}}else E=="mouseover"?y=h.fromElement:E=="mouseout"&&(y=h.toElement);this.relatedTarget=y,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:De[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&Fe.aa.h.call(this)}}b(Fe,ue);var De={2:"touch",3:"pen",4:"mouse"};Fe.prototype.h=function(){Fe.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Gt="closure_listenable_"+(1e6*Math.random()|0),mt=0;function As(h,y,E,D,K){this.listener=h,this.proxy=null,this.src=y,this.type=E,this.capture=!!D,this.ha=K,this.key=++mt,this.da=this.fa=!1}function La(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Js(h){this.src=h,this.g={},this.h=0}Js.prototype.add=function(h,y,E,D,K){var te=h.toString();h=this.g[te],h||(h=this.g[te]=[],this.h++);var de=Fi(h,y,D,K);return-1<de?(y=h[de],E||(y.fa=!1)):(y=new As(y,this.src,te,!!D,K),y.fa=E,h.push(y)),y};function Ui(h,y){var E=y.type;if(E in h.g){var D=h.g[E],K=Array.prototype.indexOf.call(D,y,void 0),te;(te=0<=K)&&Array.prototype.splice.call(D,K,1),te&&(La(y),h.g[E].length==0&&(delete h.g[E],h.h--))}}function Fi(h,y,E,D){for(var K=0;K<h.length;++K){var te=h[K];if(!te.da&&te.listener==y&&te.capture==!!E&&te.ha==D)return K}return-1}var Hi="closure_lm_"+(1e6*Math.random()|0),ml={};function Eu(h,y,E,D,K){if(Array.isArray(y)){for(var te=0;te<y.length;te++)Eu(h,y[te],E,D,K);return null}return E=bu(E),h&&h[Gt]?h.K(y,E,v(D)?!!D.capture:!1,K):Xn(h,y,E,!1,D,K)}function Xn(h,y,E,D,K,te){if(!y)throw Error("Invalid event type");var de=v(K)?!!K.capture:!!K,Qe=Hr(h);if(Qe||(h[Hi]=Qe=new Js(h)),E=Qe.add(y,E,D,de,te),E.proxy)return E;if(D=vf(),E.proxy=D,D.src=h,D.listener=E,h.addEventListener)xe||(K=de),K===void 0&&(K=!1),h.addEventListener(y.toString(),D,K);else if(h.attachEvent)h.attachEvent(qi(y.toString()),D);else if(h.addListener&&h.removeListener)h.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return E}function vf(){function h(E){return y.call(h.src,h.listener,E)}const y=yf;return h}function pl(h,y,E,D,K){if(Array.isArray(y))for(var te=0;te<y.length;te++)pl(h,y[te],E,D,K);else D=v(D)?!!D.capture:!!D,E=bu(E),h&&h[Gt]?(h=h.i,y=String(y).toString(),y in h.g&&(te=h.g[y],E=Fi(te,E,D,K),-1<E&&(La(te[E]),Array.prototype.splice.call(te,E,1),te.length==0&&(delete h.g[y],h.h--)))):h&&(h=Hr(h))&&(y=h.g[y.toString()],h=-1,y&&(h=Fi(y,E,D,K)),(E=-1<h?y[h]:null)&&Fr(E))}function Fr(h){if(typeof h!="number"&&h&&!h.da){var y=h.src;if(y&&y[Gt])Ui(y.i,h);else{var E=h.type,D=h.proxy;y.removeEventListener?y.removeEventListener(E,D,h.capture):y.detachEvent?y.detachEvent(qi(E),D):y.addListener&&y.removeListener&&y.removeListener(D),(E=Hr(y))?(Ui(E,h),E.h==0&&(E.src=null,y[Hi]=null)):La(h)}}}function qi(h){return h in ml?ml[h]:ml[h]="on"+h}function yf(h,y){if(h.da)h=!0;else{y=new Fe(y,this);var E=h.listener,D=h.ha||h.src;h.fa&&Fr(h),h=E.call(D,y)}return h}function Hr(h){return h=h[Hi],h instanceof Js?h:null}var gl="__closure_events_fn_"+(1e9*Math.random()>>>0);function bu(h){return typeof h=="function"?h:(h[gl]||(h[gl]=function(y){return h.handleEvent(y)}),h[gl])}function bt(){he.call(this),this.i=new Js(this),this.M=this,this.F=null}b(bt,he),bt.prototype[Gt]=!0,bt.prototype.removeEventListener=function(h,y,E,D){pl(this,h,y,E,D)};function at(h,y){var E,D=h.F;if(D)for(E=[];D;D=D.F)E.push(D);if(h=h.M,D=y.type||y,typeof y=="string")y=new ue(y,h);else if(y instanceof ue)y.target=y.target||h;else{var K=y;y=new ue(D,h),I(y,K)}if(K=!0,E)for(var te=E.length-1;0<=te;te--){var de=y.g=E[te];K=Pn(de,D,!0,y)&&K}if(de=y.g=h,K=Pn(de,D,!0,y)&&K,K=Pn(de,D,!1,y)&&K,E)for(te=0;te<E.length;te++)de=y.g=E[te],K=Pn(de,D,!1,y)&&K}bt.prototype.N=function(){if(bt.aa.N.call(this),this.i){var h=this.i,y;for(y in h.g){for(var E=h.g[y],D=0;D<E.length;D++)La(E[D]);delete h.g[y],h.h--}}this.F=null},bt.prototype.K=function(h,y,E,D){return this.i.add(String(h),y,!1,E,D)},bt.prototype.L=function(h,y,E,D){return this.i.add(String(h),y,!0,E,D)};function Pn(h,y,E,D){if(y=h.i.g[String(y)],!y)return!0;y=y.concat();for(var K=!0,te=0;te<y.length;++te){var de=y[te];if(de&&!de.da&&de.capture==E){var Qe=de.listener,Vt=de.ha||de.src;de.fa&&Ui(h.i,de),K=Qe.call(Vt,D)!==!1&&K}}return K&&!D.defaultPrevented}function hn(h,y,E){if(typeof h=="function")E&&(h=C(h,E));else if(h&&typeof h.handleEvent=="function")h=C(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:f.setTimeout(h,y||0)}function Nu(h){h.g=hn(()=>{h.g=null,h.i&&(h.i=!1,Nu(h))},h.l);const y=h.h;h.h=null,h.m.apply(null,y)}class _f extends he{constructor(y,E){super(),this.m=y,this.l=E,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:Nu(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Bi(h){he.call(this),this.h=h,this.g={}}b(Bi,he);var zi=[];function Gi(h){X(h.g,function(y,E){this.g.hasOwnProperty(E)&&Fr(y)},h),h.g={}}Bi.prototype.N=function(){Bi.aa.N.call(this),Gi(this)},Bi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var hs=f.JSON.stringify,qr=f.JSON.parse,$i=class{stringify(h){return f.JSON.stringify(h,void 0)}parse(h){return f.JSON.parse(h,void 0)}};function vl(){}vl.prototype.h=null;function yl(h){return h.h||(h.h=h.i())}function _l(){}var ea={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ta(){ue.call(this,"d")}b(ta,ue);function El(){ue.call(this,"c")}b(El,ue);var Cs={},bl=null;function Va(){return bl=bl||new bt}Cs.La="serverreachability";function Br(h){ue.call(this,Cs.La,h)}b(Br,ue);function Ua(h){const y=Va();at(y,new Br(y))}Cs.STAT_EVENT="statevent";function Tu(h,y){ue.call(this,Cs.STAT_EVENT,h),this.stat=y}b(Tu,ue);function vt(h){const y=Va();at(y,new Tu(y,h))}Cs.Ma="timingevent";function Lt(h,y){ue.call(this,Cs.Ma,h),this.size=y}b(Lt,ue);function It(h,y){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){h()},y)}function Wn(){this.g=!0}Wn.prototype.xa=function(){this.g=!1};function Nl(h,y,E,D,K,te){h.info(function(){if(h.g)if(te)for(var de="",Qe=te.split("&"),Vt=0;Vt<Qe.length;Vt++){var Xe=Qe[Vt].split("=");if(1<Xe.length){var Yt=Xe[0];Xe=Xe[1];var Ut=Yt.split("_");de=2<=Ut.length&&Ut[1]=="type"?de+(Yt+"="+Xe+"&"):de+(Yt+"=redacted&")}}else de=null;else de=te;return"XMLHTTP REQ ("+D+") [attempt "+K+"]: "+y+`
`+E+`
`+de})}function Ef(h,y,E,D,K,te,de){h.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+K+"]: "+y+`
`+E+`
`+te+" "+de})}function Fa(h,y,E,D){h.info(function(){return"XMLHTTP TEXT ("+y+"): "+Yi(h,E)+(D?" "+D:"")})}function xu(h,y){h.info(function(){return"TIMEOUT: "+y})}Wn.prototype.info=function(){};function Yi(h,y){if(!h.g)return y;if(!y)return null;try{var E=JSON.parse(y);if(E){for(h=0;h<E.length;h++)if(Array.isArray(E[h])){var D=E[h];if(!(2>D.length)){var K=D[1];if(Array.isArray(K)&&!(1>K.length)){var te=K[0];if(te!="noop"&&te!="stop"&&te!="close")for(var de=1;de<K.length;de++)K[de]=""}}}}return hs(E)}catch{return y}}var Ha={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},na={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},js;function Ss(){}b(Ss,vl),Ss.prototype.g=function(){return new XMLHttpRequest},Ss.prototype.i=function(){return{}},js=new Ss;function En(h,y,E,D){this.j=h,this.i=y,this.l=E,this.R=D||1,this.U=new Bi(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new At}function At(){this.i=null,this.g="",this.h=!1}var Tl={},zr={};function fs(h,y,E){h.L=1,h.v=Zi(kn(y)),h.m=E,h.P=!0,sa(h,null)}function sa(h,y){h.F=Date.now(),Ki(h),h.A=kn(h.v);var E=h.A,D=h.R;Array.isArray(D)||(D=[String(D)]),wl(E.i,"t",D),h.C=0,E=h.j.J,h.h=new At,h.g=Fu(h.j,E?y:null,!h.m),0<h.O&&(h.M=new _f(C(h.Y,h,h.g),h.O)),y=h.U,E=h.g,D=h.ca;var K="readystatechange";Array.isArray(K)||(K&&(zi[0]=K.toString()),K=zi);for(var te=0;te<K.length;te++){var de=Eu(E,K[te],D||y.handleEvent,!1,y.h||y);if(!de)break;y.g[de.key]=de}y=h.H?A(h.H):{},h.m?(h.u||(h.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,y)):(h.u="GET",h.g.ea(h.A,h.u,null,y)),Ua(),Nl(h.i,h.u,h.A,h.l,h.R,h.m)}En.prototype.ca=function(h){h=h.target;const y=this.M;y&&ts(h)==3?y.j():this.Y(h)},En.prototype.Y=function(h){try{if(h==this.g)e:{const Ut=ts(this.g);var y=this.g.Ba();const da=this.g.Z();if(!(3>Ut)&&(Ut!=3||this.g&&(this.h.h||this.g.oa()||Du(this.g)))){this.J||Ut!=4||y==7||(y==8||0>=da?Ua(3):Ua(2)),qa(this);var E=this.g.Z();this.X=E;t:if(Au(this)){var D=Du(this.g);h="";var K=D.length,te=ts(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Jt(this),ws(this);var de="";break t}this.h.i=new f.TextDecoder}for(y=0;y<K;y++)this.h.h=!0,h+=this.h.i.decode(D[y],{stream:!(te&&y==K-1)});D.length=0,this.h.g+=h,this.C=0,de=this.h.g}else de=this.g.oa();if(this.o=E==200,Ef(this.i,this.u,this.A,this.l,this.R,Ut,E),this.o){if(this.T&&!this.K){t:{if(this.g){var Qe,Vt=this.g;if((Qe=Vt.g?Vt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$(Qe)){var Xe=Qe;break t}}Xe=null}if(E=Xe)Fa(this.i,this.l,E,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Qi(this,E);else{this.o=!1,this.s=3,vt(12),Jt(this),ws(this);break e}}if(this.P){E=!0;let en;for(;!this.J&&this.C<de.length;)if(en=Cu(this,de),en==zr){Ut==4&&(this.s=4,vt(14),E=!1),Fa(this.i,this.l,null,"[Incomplete Response]");break}else if(en==Tl){this.s=4,vt(15),Fa(this.i,this.l,de,"[Invalid Chunk]"),E=!1;break}else Fa(this.i,this.l,en,null),Qi(this,en);if(Au(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ut!=4||de.length!=0||this.h.h||(this.s=1,vt(16),E=!1),this.o=this.o&&E,!E)Fa(this.i,this.l,de,"[Invalid Chunked Response]"),Jt(this),ws(this);else if(0<de.length&&!this.W){this.W=!0;var Yt=this.j;Yt.g==this&&Yt.ba&&!Yt.M&&(Yt.j.info("Great, no buffering proxy detected. Bytes received: "+de.length),rr(Yt),Yt.M=!0,vt(11))}}else Fa(this.i,this.l,de,null),Qi(this,de);Ut==4&&Jt(this),this.o&&!this.J&&(Ut==4?Lu(this.j,this):(this.o=!1,Ki(this)))}else Af(this.g),E==400&&0<de.indexOf("Unknown SID")?(this.s=3,vt(12)):(this.s=0,vt(13)),Jt(this),ws(this)}}}catch{}finally{}};function Au(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function Cu(h,y){var E=h.C,D=y.indexOf(`
`,E);return D==-1?zr:(E=Number(y.substring(E,D)),isNaN(E)?Tl:(D+=1,D+E>y.length?zr:(y=y.slice(D,D+E),h.C=D+E,y)))}En.prototype.cancel=function(){this.J=!0,Jt(this)};function Ki(h){h.S=Date.now()+h.I,ju(h,h.I)}function ju(h,y){if(h.B!=null)throw Error("WatchDog timer not null");h.B=It(C(h.ba,h),y)}function qa(h){h.B&&(f.clearTimeout(h.B),h.B=null)}En.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(xu(this.i,this.A),this.L!=2&&(Ua(),vt(17)),Jt(this),this.s=2,ws(this)):ju(this,this.S-h)};function ws(h){h.j.G==0||h.J||Lu(h.j,h)}function Jt(h){qa(h);var y=h.M;y&&typeof y.ma=="function"&&y.ma(),h.M=null,Gi(h.U),h.g&&(y=h.g,h.g=null,y.abort(),y.ma())}function Qi(h,y){try{var E=h.j;if(E.G!=0&&(E.g==h||xl(E.h,h))){if(!h.K&&xl(E.h,h)&&E.G==3){try{var D=E.Da.g.parse(y)}catch{D=null}if(Array.isArray(D)&&D.length==3){var K=D;if(K[0]==0){e:if(!E.u){if(E.g)if(E.g.F+3e3<h.F)no(E),eo(E);else break e;Ml(E),vt(18)}}else E.za=K[1],0<E.za-E.T&&37500>K[2]&&E.F&&E.v==0&&!E.C&&(E.C=It(C(E.Za,E),6e3));if(1>=$r(E.h)&&E.ca){try{E.ca()}catch{}E.ca=void 0}}else ua(E,11)}else if((h.K||E.g==h)&&no(E),!$(y))for(K=E.Da.g.parse(y),y=0;y<K.length;y++){let Xe=K[y];if(E.T=Xe[0],Xe=Xe[1],E.G==2)if(Xe[0]=="c"){E.K=Xe[1],E.ia=Xe[2];const Yt=Xe[3];Yt!=null&&(E.la=Yt,E.j.info("VER="+E.la));const Ut=Xe[4];Ut!=null&&(E.Aa=Ut,E.j.info("SVER="+E.Aa));const da=Xe[5];da!=null&&typeof da=="number"&&0<da&&(D=1.5*da,E.L=D,E.j.info("backChannelRequestTimeoutMs_="+D)),D=E;const en=h.g;if(en){const ks=en.g?en.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ks){var te=D.h;te.g||ks.indexOf("spdy")==-1&&ks.indexOf("quic")==-1&&ks.indexOf("h2")==-1||(te.j=te.l,te.g=new Set,te.h&&(Yr(te,te.h),te.h=null))}if(D.D){const kl=en.g?en.g.getResponseHeader("X-HTTP-Session-Id"):null;kl&&(D.ya=kl,ot(D.I,D.D,kl))}}E.G=3,E.l&&E.l.ua(),E.ba&&(E.R=Date.now()-h.F,E.j.info("Handshake RTT: "+E.R+"ms")),D=E;var de=h;if(D.qa=Uu(D,D.J?D.ia:null,D.W),de.K){bn(D.h,de);var Qe=de,Vt=D.L;Vt&&(Qe.I=Vt),Qe.B&&(qa(Qe),Ki(Qe)),D.g=de}else Pu(D);0<E.i.length&&to(E)}else Xe[0]!="stop"&&Xe[0]!="close"||ua(E,7);else E.G==3&&(Xe[0]=="stop"||Xe[0]=="close"?Xe[0]=="stop"?ua(E,7):Dl(E):Xe[0]!="noop"&&E.l&&E.l.ta(Xe),E.v=0)}}Ua(4)}catch{}}var Su=class{constructor(h,y){this.g=h,this.map=y}};function aa(h){this.l=h||10,f.PerformanceNavigationTiming?(h=f.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Gr(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function $r(h){return h.h?1:h.g?h.g.size:0}function xl(h,y){return h.h?h.h==y:h.g?h.g.has(y):!1}function Yr(h,y){h.g?h.g.add(y):h.h=y}function bn(h,y){h.h&&h.h==y?h.h=null:h.g&&h.g.has(y)&&h.g.delete(y)}aa.prototype.cancel=function(){if(this.i=Al(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Al(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let y=h.i;for(const E of h.g.values())y=y.concat(E.D);return y}return M(h.i)}function bf(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(p(h)){for(var y=[],E=h.length,D=0;D<E;D++)y.push(h[D]);return y}y=[],E=0;for(D in h)y[E++]=h[D];return y}function Kr(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(p(h)||typeof h=="string"){var y=[];h=h.length;for(var E=0;E<h;E++)y.push(E);return y}y=[],E=0;for(const D in h)y[E++]=D;return y}}}function Cl(h,y){if(h.forEach&&typeof h.forEach=="function")h.forEach(y,void 0);else if(p(h)||typeof h=="string")Array.prototype.forEach.call(h,y,void 0);else for(var E=Kr(h),D=bf(h),K=D.length,te=0;te<K;te++)y.call(void 0,D[te],E&&E[te],h)}var Xi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Nf(h,y){if(h){h=h.split("&");for(var E=0;E<h.length;E++){var D=h[E].indexOf("="),K=null;if(0<=D){var te=h[E].substring(0,D);K=h[E].substring(D+1)}else te=h[E];y(te,K?decodeURIComponent(K.replace(/\+/g," ")):"")}}}function Rt(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof Rt){this.h=h.h,Wi(this,h.j),this.o=h.o,this.g=h.g,Ba(this,h.s),this.l=h.l;var y=h.i,E=new ra;E.i=y.i,y.g&&(E.g=new Map(y.g),E.h=y.h),ia(this,E),this.m=h.m}else h&&(y=String(h).match(Xi))?(this.h=!1,Wi(this,y[1]||"",!0),this.o=Zn(y[2]||""),this.g=Zn(y[3]||"",!0),Ba(this,y[4]),this.l=Zn(y[5]||"",!0),ia(this,y[6]||"",!0),this.m=Zn(y[7]||"")):(this.h=!1,this.i=new ra(null,this.h))}Rt.prototype.toString=function(){var h=[],y=this.j;y&&h.push(Ji(y,jl,!0),":");var E=this.g;return(E||y=="file")&&(h.push("//"),(y=this.o)&&h.push(Ji(y,jl,!0),"@"),h.push(encodeURIComponent(String(E)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.s,E!=null&&h.push(":",String(E))),(E=this.l)&&(this.g&&E.charAt(0)!="/"&&h.push("/"),h.push(Ji(E,E.charAt(0)=="/"?Tf:Sl,!0))),(E=this.i.toString())&&h.push("?",E),(E=this.m)&&h.push("#",Ji(E,Qr)),h.join("")};function kn(h){return new Rt(h)}function Wi(h,y,E){h.j=E?Zn(y,!0):y,h.j&&(h.j=h.j.replace(/:$/,""))}function Ba(h,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);h.s=y}else h.s=null}function ia(h,y,E){y instanceof ra?(h.i=y,Iu(h.i,h.h)):(E||(y=Ji(y,xf)),h.i=new ra(y,h.h))}function ot(h,y,E){h.i.set(y,E)}function Zi(h){return ot(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Zn(h,y){return h?y?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Ji(h,y,E){return typeof h=="string"?(h=encodeURI(h).replace(y,wu),E&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function wu(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var jl=/[#\/\?@]/g,Sl=/[#\?:]/g,Tf=/[#\?]/g,xf=/[#\?@]/g,Qr=/#/g;function ra(h,y){this.h=this.g=null,this.i=h||null,this.j=!!y}function Jn(h){h.g||(h.g=new Map,h.h=0,h.i&&Nf(h.i,function(y,E){h.add(decodeURIComponent(y.replace(/\+/g," ")),E)}))}n=ra.prototype,n.add=function(h,y){Jn(this),this.i=null,h=Is(this,h);var E=this.g.get(h);return E||this.g.set(h,E=[]),E.push(y),this.h+=1,this};function oa(h,y){Jn(h),y=Is(h,y),h.g.has(y)&&(h.i=null,h.h-=h.g.get(y).length,h.g.delete(y))}function la(h,y){return Jn(h),y=Is(h,y),h.g.has(y)}n.forEach=function(h,y){Jn(this),this.g.forEach(function(E,D){E.forEach(function(K){h.call(y,K,D,this)},this)},this)},n.na=function(){Jn(this);const h=Array.from(this.g.values()),y=Array.from(this.g.keys()),E=[];for(let D=0;D<y.length;D++){const K=h[D];for(let te=0;te<K.length;te++)E.push(y[D])}return E},n.V=function(h){Jn(this);let y=[];if(typeof h=="string")la(this,h)&&(y=y.concat(this.g.get(Is(this,h))));else{h=Array.from(this.g.values());for(let E=0;E<h.length;E++)y=y.concat(h[E])}return y},n.set=function(h,y){return Jn(this),this.i=null,h=Is(this,h),la(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[y]),this.h+=1,this},n.get=function(h,y){return h?(h=this.V(h),0<h.length?String(h[0]):y):y};function wl(h,y,E){oa(h,y),0<E.length&&(h.i=null,h.g.set(Is(h,y),M(E)),h.h+=E.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],y=Array.from(this.g.keys());for(var E=0;E<y.length;E++){var D=y[E];const te=encodeURIComponent(String(D)),de=this.V(D);for(D=0;D<de.length;D++){var K=te;de[D]!==""&&(K+="="+encodeURIComponent(String(de[D]))),h.push(K)}}return this.i=h.join("&")};function Is(h,y){return y=String(y),h.j&&(y=y.toLowerCase()),y}function Iu(h,y){y&&!h.j&&(Jn(h),h.i=null,h.g.forEach(function(E,D){var K=D.toLowerCase();D!=K&&(oa(this,D),wl(this,K,E))},h)),h.j=y}function er(h,y){const E=new Wn;if(f.Image){const D=new Image;D.onload=j(es,E,"TestLoadImage: loaded",!0,y,D),D.onerror=j(es,E,"TestLoadImage: error",!1,y,D),D.onabort=j(es,E,"TestLoadImage: abort",!1,y,D),D.ontimeout=j(es,E,"TestLoadImage: timeout",!1,y,D),f.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=h}else y(!1)}function ms(h,y){const E=new Wn,D=new AbortController,K=setTimeout(()=>{D.abort(),es(E,"TestPingServer: timeout",!1,y)},1e4);fetch(h,{signal:D.signal}).then(te=>{clearTimeout(K),te.ok?es(E,"TestPingServer: ok",!0,y):es(E,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(K),es(E,"TestPingServer: error",!1,y)})}function es(h,y,E,D,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),D(E)}catch{}}function tr(){this.g=new $i}function Rs(h,y,E){const D=E||"";try{Cl(h,function(K,te){let de=K;v(K)&&(de=hs(K)),y.push(D+te+"="+encodeURIComponent(de))})}catch(K){throw y.push(D+"type="+encodeURIComponent("_badmap")),K}}function za(h){this.l=h.Ub||null,this.j=h.eb||!1}b(za,vl),za.prototype.g=function(){return new ca(this.l,this.j)},za.prototype.i=function(h){return function(){return h}}({});function ca(h,y){bt.call(this),this.D=h,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}b(ca,bt),n=ca.prototype,n.open=function(h,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=y,this.readyState=1,Os(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(y.body=h),(this.D||f).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ds(this)),this.readyState=0},n.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Os(this)),this.g&&(this.readyState=3,Os(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Il(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Il(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}n.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var y=h.value?h.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!h.done}))&&(this.response=this.responseText+=y)}h.done?Ds(this):Os(this),this.readyState==3&&Il(this)}},n.Ra=function(h){this.g&&(this.response=this.responseText=h,Ds(this))},n.Qa=function(h){this.g&&(this.response=h,Ds(this))},n.ga=function(){this.g&&Ds(this)};function Ds(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Os(h)}n.setRequestHeader=function(h,y){this.u.append(h,y)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],y=this.h.entries();for(var E=y.next();!E.done;)E=E.value,h.push(E[0]+": "+E[1]),E=y.next();return h.join(`\r
`)};function Os(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(ca.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Rl(h){let y="";return X(h,function(E,D){y+=D,y+=":",y+=E,y+=`\r
`}),y}function $t(h,y,E){e:{for(D in E){var D=!1;break e}D=!0}D||(E=Rl(E),typeof h=="string"?E!=null&&encodeURIComponent(String(E)):ot(h,y,E))}function st(h){bt.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}b(st,bt);var Xr=/^https?$/i,nr=["POST","PUT"];n=st.prototype,n.Ha=function(h){this.J=h},n.ea=function(h,y,E,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);y=y?y.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():js.g(),this.v=this.o?yl(this.o):yl(js),this.g.onreadystatechange=C(this.Ea,this);try{this.B=!0,this.g.open(y,String(h),!0),this.B=!1}catch(te){Ru(this,te);return}if(h=E||"",E=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var K in D)E.set(K,D[K]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const te of D.keys())E.set(te,D.get(te));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(E.keys()).find(te=>te.toLowerCase()=="content-type"),K=f.FormData&&h instanceof f.FormData,!(0<=Array.prototype.indexOf.call(nr,y,void 0))||D||K||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[te,de]of E)this.g.setRequestHeader(te,de);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{sr(this),this.u=!0,this.g.send(h),this.u=!1}catch(te){Ru(this,te)}};function Ru(h,y){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=y,h.m=5,Wr(h),Ms(h)}function Wr(h){h.A||(h.A=!0,at(h,"complete"),at(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,at(this,"complete"),at(this,"abort"),Ms(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ms(this,!0)),st.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Zr(this):this.bb())},n.bb=function(){Zr(this)};function Zr(h){if(h.h&&typeof d<"u"&&(!h.v[1]||ts(h)!=4||h.Z()!=2)){if(h.u&&ts(h)==4)hn(h.Ea,0,h);else if(at(h,"readystatechange"),ts(h)==4){h.h=!1;try{const de=h.Z();e:switch(de){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var E;if(!(E=y)){var D;if(D=de===0){var K=String(h.D).match(Xi)[1]||null;!K&&f.self&&f.self.location&&(K=f.self.location.protocol.slice(0,-1)),D=!Xr.test(K?K.toLowerCase():"")}E=D}if(E)at(h,"complete"),at(h,"success");else{h.m=6;try{var te=2<ts(h)?h.g.statusText:""}catch{te=""}h.l=te+" ["+h.Z()+"]",Wr(h)}}finally{Ms(h)}}}}function Ms(h,y){if(h.g){sr(h);const E=h.g,D=h.v[0]?()=>{}:null;h.g=null,h.v=null,y||at(h,"ready");try{E.onreadystatechange=D}catch{}}}function sr(h){h.I&&(f.clearTimeout(h.I),h.I=null)}n.isActive=function(){return!!this.g};function ts(h){return h.g?h.g.readyState:0}n.Z=function(){try{return 2<ts(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(h){if(this.g){var y=this.g.responseText;return h&&y.indexOf(h)==0&&(y=y.substring(h.length)),qr(y)}};function Du(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Af(h){const y={};h=(h.g&&2<=ts(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<h.length;D++){if($(h[D]))continue;var E=P(h[D]);const K=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const te=y[K]||[];y[K]=te,te.push(E)}w(y,function(D){return D.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ar(h,y,E){return E&&E.internalChannelParams&&E.internalChannelParams[h]||y}function Jr(h){this.Aa=0,this.i=[],this.j=new Wn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ar("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ar("baseRetryDelayMs",5e3,h),this.cb=ar("retryDelaySeedMs",1e4,h),this.Wa=ar("forwardChannelMaxRetries",2,h),this.wa=ar("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new aa(h&&h.concurrentRequestLimit),this.Da=new tr,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Jr.prototype,n.la=8,n.G=1,n.connect=function(h,y,E,D){vt(0),this.W=h,this.H=y||{},E&&D!==void 0&&(this.H.OSID=E,this.H.OAID=D),this.F=this.X,this.I=Uu(this,null,this.W),to(this)};function Dl(h){if(Ou(h),h.G==3){var y=h.U++,E=kn(h.I);if(ot(E,"SID",h.K),ot(E,"RID",y),ot(E,"TYPE","terminate"),ir(h,E),y=new En(h,h.j,y),y.L=2,y.v=Zi(kn(E)),E=!1,f.navigator&&f.navigator.sendBeacon)try{E=f.navigator.sendBeacon(y.v.toString(),"")}catch{}!E&&f.Image&&(new Image().src=y.v,E=!0),E||(y.g=Fu(y.j,null),y.g.ea(y.v)),y.F=Date.now(),Ki(y)}Vu(h)}function eo(h){h.g&&(rr(h),h.g.cancel(),h.g=null)}function Ou(h){eo(h),h.u&&(f.clearTimeout(h.u),h.u=null),no(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&f.clearTimeout(h.s),h.s=null)}function to(h){if(!Gr(h.h)&&!h.s){h.s=!0;var y=h.Ga;J||q(),ce||(J(),ce=!0),ye.add(y,h),h.B=0}}function Cf(h,y){return $r(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=y.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=It(C(h.Ga,h,y),Pl(h,h.B)),h.B++,!0)}n.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const K=new En(this,this.j,h);let te=this.o;if(this.S&&(te?(te=A(te),I(te,this.S)):te=this.S),this.m!==null||this.O||(K.H=te,te=null),this.P)e:{for(var y=0,E=0;E<this.i.length;E++){t:{var D=this.i[E];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(y+=D,4096<y){y=E;break e}if(y===4096||E===this.i.length-1){y=E+1;break e}}y=1e3}else y=1e3;y=Mu(this,K,y),E=kn(this.I),ot(E,"RID",h),ot(E,"CVER",22),this.D&&ot(E,"X-HTTP-Session-Id",this.D),ir(this,E),te&&(this.O?y="headers="+encodeURIComponent(String(Rl(te)))+"&"+y:this.m&&$t(E,this.m,te)),Yr(this.h,K),this.Ua&&ot(E,"TYPE","init"),this.P?(ot(E,"$req",y),ot(E,"SID","null"),K.T=!0,fs(K,E,null)):fs(K,E,y),this.G=2}}else this.G==3&&(h?Ol(this,h):this.i.length==0||Gr(this.h)||Ol(this))};function Ol(h,y){var E;y?E=y.l:E=h.U++;const D=kn(h.I);ot(D,"SID",h.K),ot(D,"RID",E),ot(D,"AID",h.T),ir(h,D),h.m&&h.o&&$t(D,h.m,h.o),E=new En(h,h.j,E,h.B+1),h.m===null&&(E.H=h.o),y&&(h.i=y.D.concat(h.i)),y=Mu(h,E,1e3),E.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Yr(h.h,E),fs(E,D,y)}function ir(h,y){h.H&&X(h.H,function(E,D){ot(y,D,E)}),h.l&&Cl({},function(E,D){ot(y,D,E)})}function Mu(h,y,E){E=Math.min(h.i.length,E);var D=h.l?C(h.l.Na,h.l,h):null;e:{var K=h.i;let te=-1;for(;;){const de=["count="+E];te==-1?0<E?(te=K[0].g,de.push("ofs="+te)):te=0:de.push("ofs="+te);let Qe=!0;for(let Vt=0;Vt<E;Vt++){let Xe=K[Vt].g;const Yt=K[Vt].map;if(Xe-=te,0>Xe)te=Math.max(0,K[Vt].g-100),Qe=!1;else try{Rs(Yt,de,"req"+Xe+"_")}catch{D&&D(Yt)}}if(Qe){D=de.join("&");break e}}}return h=h.i.splice(0,E),y.D=h,D}function Pu(h){if(!h.g&&!h.u){h.Y=1;var y=h.Fa;J||q(),ce||(J(),ce=!0),ye.add(y,h),h.v=0}}function Ml(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=It(C(h.Fa,h),Pl(h,h.v)),h.v++,!0)}n.Fa=function(){if(this.u=null,ku(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=It(C(this.ab,this),h)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,vt(10),eo(this),ku(this))};function rr(h){h.A!=null&&(f.clearTimeout(h.A),h.A=null)}function ku(h){h.g=new En(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var y=kn(h.qa);ot(y,"RID","rpc"),ot(y,"SID",h.K),ot(y,"AID",h.T),ot(y,"CI",h.F?"0":"1"),!h.F&&h.ja&&ot(y,"TO",h.ja),ot(y,"TYPE","xmlhttp"),ir(h,y),h.m&&h.o&&$t(y,h.m,h.o),h.L&&(h.g.I=h.L);var E=h.g;h=h.ia,E.L=1,E.v=Zi(kn(y)),E.m=null,E.P=!0,sa(E,h)}n.Za=function(){this.C!=null&&(this.C=null,eo(this),Ml(this),vt(19))};function no(h){h.C!=null&&(f.clearTimeout(h.C),h.C=null)}function Lu(h,y){var E=null;if(h.g==y){no(h),rr(h),h.g=null;var D=2}else if(xl(h.h,y))E=y.D,bn(h.h,y),D=1;else return;if(h.G!=0){if(y.o)if(D==1){E=y.m?y.m.length:0,y=Date.now()-y.F;var K=h.B;D=Va(),at(D,new Lt(D,E)),to(h)}else Pu(h);else if(K=y.s,K==3||K==0&&0<y.X||!(D==1&&Cf(h,y)||D==2&&Ml(h)))switch(E&&0<E.length&&(y=h.h,y.i=y.i.concat(E)),K){case 1:ua(h,5);break;case 4:ua(h,10);break;case 3:ua(h,6);break;default:ua(h,2)}}}function Pl(h,y){let E=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(E*=2),E*y}function ua(h,y){if(h.j.info("Error code "+y),y==2){var E=C(h.fb,h),D=h.Xa;const K=!D;D=new Rt(D||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||Wi(D,"https"),Zi(D),K?er(D.toString(),E):ms(D.toString(),E)}else vt(2);h.G=0,h.l&&h.l.sa(y),Vu(h),Ou(h)}n.fb=function(h){h?(this.j.info("Successfully pinged google.com"),vt(2)):(this.j.info("Failed to ping google.com"),vt(1))};function Vu(h){if(h.G=0,h.ka=[],h.l){const y=Al(h.h);(y.length!=0||h.i.length!=0)&&(x(h.ka,y),x(h.ka,h.i),h.h.i.length=0,M(h.i),h.i.length=0),h.l.ra()}}function Uu(h,y,E){var D=E instanceof Rt?kn(E):new Rt(E);if(D.g!="")y&&(D.g=y+"."+D.g),Ba(D,D.s);else{var K=f.location;D=K.protocol,y=y?y+"."+K.hostname:K.hostname,K=+K.port;var te=new Rt(null);D&&Wi(te,D),y&&(te.g=y),K&&Ba(te,K),E&&(te.l=E),D=te}return E=h.D,y=h.ya,E&&y&&ot(D,E,y),ot(D,"VER",h.la),ir(h,D),D}function Fu(h,y,E){if(y&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=h.Ca&&!h.pa?new st(new za({eb:E})):new st(h.pa),y.Ha(h.J),y}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Hu(){}n=Hu.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function so(){}so.prototype.g=function(h,y){return new Nn(h,y)};function Nn(h,y){bt.call(this),this.g=new Jr(y),this.l=h,this.h=y&&y.messageUrlParams||null,h=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(h?h["X-WebChannel-Content-Type"]=y.messageContentType:h={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(h?h["X-WebChannel-Client-Profile"]=y.va:h={"X-WebChannel-Client-Profile":y.va}),this.g.S=h,(h=y&&y.Sb)&&!$(h)&&(this.g.m=h),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!$(y)&&(this.g.D=y,h=this.h,h!==null&&y in h&&(h=this.h,y in h&&delete h[y])),this.j=new Ps(this)}b(Nn,bt),Nn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Nn.prototype.close=function(){Dl(this.g)},Nn.prototype.o=function(h){var y=this.g;if(typeof h=="string"){var E={};E.__data__=h,h=E}else this.u&&(E={},E.__data__=hs(h),h=E);y.i.push(new Su(y.Ya++,h)),y.G==3&&to(y)},Nn.prototype.N=function(){this.g.l=null,delete this.j,Dl(this.g),delete this.g,Nn.aa.N.call(this)};function qu(h){ta.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var y=h.__sm__;if(y){e:{for(const E in y){h=E;break e}h=void 0}(this.i=h)&&(h=this.i,y=y!==null&&h in y?y[h]:void 0),this.data=y}else this.data=h}b(qu,ta);function Bu(){El.call(this),this.status=1}b(Bu,El);function Ps(h){this.g=h}b(Ps,Hu),Ps.prototype.ua=function(){at(this.g,"a")},Ps.prototype.ta=function(h){at(this.g,new qu(h))},Ps.prototype.sa=function(h){at(this.g,new Bu)},Ps.prototype.ra=function(){at(this.g,"b")},so.prototype.createWebChannel=so.prototype.g,Nn.prototype.send=Nn.prototype.o,Nn.prototype.open=Nn.prototype.m,Nn.prototype.close=Nn.prototype.close,Sx=function(){return new so},jx=function(){return Va()},Cx=Cs,eg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ha.NO_ERROR=0,Ha.TIMEOUT=8,Ha.HTTP_ERROR=6,sh=Ha,na.COMPLETE="complete",Ax=na,_l.EventType=ea,ea.OPEN="a",ea.CLOSE="b",ea.ERROR="c",ea.MESSAGE="d",bt.prototype.listen=bt.prototype.K,Cc=_l,st.prototype.listenOnce=st.prototype.L,st.prototype.getLastError=st.prototype.Ka,st.prototype.getLastErrorCode=st.prototype.Ba,st.prototype.getStatus=st.prototype.Z,st.prototype.getResponseJson=st.prototype.Oa,st.prototype.getResponseText=st.prototype.oa,st.prototype.send=st.prototype.ea,st.prototype.setWithCredentials=st.prototype.Ha,xx=st}).apply(typeof Gd<"u"?Gd:typeof self<"u"?self:typeof window<"u"?window:{});const Gb="@firebase/firestore",$b="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}gn.UNAUTHENTICATED=new gn(null),gn.GOOGLE_CREDENTIALS=new gn("google-credentials-uid"),gn.FIRST_PARTY=new gn("first-party-uid"),gn.MOCK_USER=new gn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rl="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ir=new tu("@firebase/firestore");function Po(){return Ir.logLevel}function ge(n,...e){if(Ir.logLevel<=ze.DEBUG){const t=e.map(Ug);Ir.debug(`Firestore (${rl}): ${n}`,...t)}}function Da(n,...e){if(Ir.logLevel<=ze.ERROR){const t=e.map(Ug);Ir.error(`Firestore (${rl}): ${n}`,...t)}}function Qo(n,...e){if(Ir.logLevel<=ze.WARN){const t=e.map(Ug);Ir.warn(`Firestore (${rl}): ${n}`,...t)}}function Ug(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ae(n,e,t){let a="Unexpected state";typeof e=="string"?a=e:t=e,wx(n,a,t)}function wx(n,e,t){let a=`FIRESTORE (${rl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{a+=" CONTEXT: "+JSON.stringify(t)}catch{a+=" CONTEXT: "+t}throw Da(a),new Error(a)}function Je(n,e,t,a){let o="Unexpected state";typeof t=="string"?o=t:a=t,n||wx(e,o,a)}function Me(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class pe extends ds{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ix{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class r1{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(gn.UNAUTHENTICATED))}shutdown(){}}class o1{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class l1{constructor(e){this.t=e,this.currentUser=gn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Je(this.o===void 0,42304);let a=this.i;const o=p=>this.i!==a?(a=this.i,t(p)):Promise.resolve();let c=new $s;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new $s,e.enqueueRetryable(()=>o(this.currentUser))};const d=()=>{const p=c;e.enqueueRetryable(async()=>{await p.promise,await o(this.currentUser)})},f=p=>{ge("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit(p=>f(p)),setTimeout(()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?f(p):(ge("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new $s)}},0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(a=>this.i!==e?(ge("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):a?(Je(typeof a.accessToken=="string",31837,{l:a}),new Ix(a.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Je(e===null||typeof e=="string",2055,{h:e}),new gn(e)}}class c1{constructor(e,t,a){this.P=e,this.T=t,this.I=a,this.type="FirstParty",this.user=gn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class u1{constructor(e,t,a){this.P=e,this.T=t,this.I=a}getToken(){return Promise.resolve(new c1(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(gn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Yb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class d1{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Dn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Je(this.o===void 0,3512);const a=c=>{c.error!=null&&ge("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const d=c.token!==this.m;return this.m=c.token,ge("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable(()=>a(c))};const o=c=>{ge("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(c=>o(c)),setTimeout(()=>{if(!this.appCheck){const c=this.V.getImmediate({optional:!0});c?o(c):ge("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Yb(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Je(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Yb(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h1(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let a=0;a<n;a++)t[a]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rx(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dx{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let a="";for(;a.length<20;){const o=h1(40);for(let c=0;c<o.length;++c)a.length<20&&o[c]<t&&(a+=e.charAt(o[c]%62))}return a}}function Ue(n,e){return n<e?-1:n>e?1:0}function tg(n,e){let t=0;for(;t<n.length&&t<e.length;){const a=n.codePointAt(t),o=e.codePointAt(t);if(a!==o){if(a<128&&o<128)return Ue(a,o);{const c=Rx(),d=f1(c.encode(Kb(n,t)),c.encode(Kb(e,t)));return d!==0?d:Ue(a,o)}}t+=a>65535?2:1}return Ue(n.length,e.length)}function Kb(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function f1(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return Ue(n[t],e[t]);return Ue(n.length,e.length)}function Xo(n,e,t){return n.length===e.length&&n.every((a,o)=>t(a,e[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qb=-62135596800,Xb=1e6;class qt{static now(){return qt.fromMillis(Date.now())}static fromDate(e){return qt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),a=Math.floor((e-1e3*t)*Xb);return new qt(t,a)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new pe(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new pe(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Qb)throw new pe(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new pe(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Xb}_compareTo(e){return this.seconds===e.seconds?Ue(this.nanoseconds,e.nanoseconds):Ue(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-Qb;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{static fromTimestamp(e){return new Se(e)}static min(){return new Se(new qt(0,0))}static max(){return new Se(new qt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wb="__name__";class Bs{constructor(e,t,a){t===void 0?t=0:t>e.length&&Ae(637,{offset:t,range:e.length}),a===void 0?a=e.length-t:a>e.length-t&&Ae(1746,{length:a,range:e.length-t}),this.segments=e,this.offset=t,this.len=a}get length(){return this.len}isEqual(e){return Bs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Bs?e.forEach(a=>{t.push(a)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,a=this.limit();t<a;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const a=Math.min(e.length,t.length);for(let o=0;o<a;o++){const c=Bs.compareSegments(e.get(o),t.get(o));if(c!==0)return c}return Ue(e.length,t.length)}static compareSegments(e,t){const a=Bs.isNumericId(e),o=Bs.isNumericId(t);return a&&!o?-1:!a&&o?1:a&&o?Bs.extractNumericId(e).compare(Bs.extractNumericId(t)):tg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return bi.fromString(e.substring(4,e.length-2))}}class ft extends Bs{construct(e,t,a){return new ft(e,t,a)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const a of e){if(a.indexOf("//")>=0)throw new pe(re.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);t.push(...a.split("/").filter(o=>o.length>0))}return new ft(t)}static emptyPath(){return new ft([])}}const m1=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ln extends Bs{construct(e,t,a){return new ln(e,t,a)}static isValidIdentifier(e){return m1.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ln.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Wb}static keyField(){return new ln([Wb])}static fromServerFormat(e){const t=[];let a="",o=0;const c=()=>{if(a.length===0)throw new pe(re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(a),a=""};let d=!1;for(;o<e.length;){const f=e[o];if(f==="\\"){if(o+1===e.length)throw new pe(re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[o+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new pe(re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);a+=p,o+=2}else f==="`"?(d=!d,o++):f!=="."||d?(a+=f,o++):(c(),o++)}if(c(),d)throw new pe(re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ln(t)}static emptyPath(){return new ln([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(e){this.path=e}static fromPath(e){return new Ne(ft.fromString(e))}static fromName(e){return new Ne(ft.fromString(e).popFirst(5))}static empty(){return new Ne(ft.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ft.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ft.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ne(new ft(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gc=-1;function p1(n,e){const t=n.toTimestamp().seconds,a=n.toTimestamp().nanoseconds+1,o=Se.fromTimestamp(a===1e9?new qt(t+1,0):new qt(t,a));return new xi(o,Ne.empty(),e)}function g1(n){return new xi(n.readTime,n.key,Gc)}class xi{constructor(e,t,a){this.readTime=e,this.documentKey=t,this.largestBatchId=a}static min(){return new xi(Se.min(),Ne.empty(),Gc)}static max(){return new xi(Se.max(),Ne.empty(),Gc)}}function v1(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ne.comparator(n.documentKey,e.documentKey),t!==0?t:Ue(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class _1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ol(n){if(n.code!==re.FAILED_PRECONDITION||n.message!==y1)throw n;ge("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ae(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new le((a,o)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(a,o)},this.catchCallback=c=>{this.wrapFailure(t,c).next(a,o)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof le?t:le.resolve(t)}catch(t){return le.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):le.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):le.reject(t)}static resolve(e){return new le((t,a)=>{t(e)})}static reject(e){return new le((t,a)=>{a(e)})}static waitFor(e){return new le((t,a)=>{let o=0,c=0,d=!1;e.forEach(f=>{++o,f.next(()=>{++c,d&&c===o&&t()},p=>a(p))}),d=!0,c===o&&t()})}static or(e){let t=le.resolve(!1);for(const a of e)t=t.next(o=>o?le.resolve(o):a());return t}static forEach(e,t){const a=[];return e.forEach((o,c)=>{a.push(t.call(this,o,c))}),this.waitFor(a)}static mapArray(e,t){return new le((a,o)=>{const c=e.length,d=new Array(c);let f=0;for(let p=0;p<c;p++){const v=p;t(e[v]).next(_=>{d[v]=_,++f,f===c&&a(d)},_=>o(_))}})}static doWhile(e,t){return new le((a,o)=>{const c=()=>{e()===!0?t().next(()=>{c()},o):a()};c()})}}function E1(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function ll(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=a=>this.ue(a),this.ce=a=>t.writeSequenceNumber(a))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}Bh.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fg=-1;function ou(n){return n==null}function _h(n){return n===0&&1/n==-1/0}function b1(n){return typeof n=="number"&&Number.isInteger(n)&&!_h(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ox="";function N1(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Zb(e)),e=T1(n.get(t),e);return Zb(e)}function T1(n,e){let t=e;const a=n.length;for(let o=0;o<a;o++){const c=n.charAt(o);switch(c){case"\0":t+="";break;case Ox:t+="";break;default:t+=c}}return t}function Zb(n){return n+Ox+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jb(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Li(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Mx(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e,t){this.comparator=e,this.root=t||on.EMPTY}insert(e,t){return new Et(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,on.BLACK,null,null))}remove(e){return new Et(this.comparator,this.root.remove(e,this.comparator).copy(null,null,on.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const a=this.comparator(e,t.key);if(a===0)return t.value;a<0?t=t.left:a>0&&(t=t.right)}return null}indexOf(e){let t=0,a=this.root;for(;!a.isEmpty();){const o=this.comparator(e,a.key);if(o===0)return t+a.left.size;o<0?a=a.left:(t+=a.left.size+1,a=a.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,a)=>(e(t,a),!1))}toString(){const e=[];return this.inorderTraversal((t,a)=>(e.push(`${t}:${a}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $d(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $d(this.root,e,this.comparator,!1)}getReverseIterator(){return new $d(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $d(this.root,e,this.comparator,!0)}}class $d{constructor(e,t,a,o){this.isReverse=o,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=t?a(e.key,t):1,t&&o&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class on{constructor(e,t,a,o,c){this.key=e,this.value=t,this.color=a??on.RED,this.left=o??on.EMPTY,this.right=c??on.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,a,o,c){return new on(e??this.key,t??this.value,a??this.color,o??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,a){let o=this;const c=a(e,o.key);return o=c<0?o.copy(null,null,null,o.left.insert(e,t,a),null):c===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,a)),o.fixUp()}removeMin(){if(this.left.isEmpty())return on.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let a,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return on.EMPTY;a=o.right.min(),o=o.copy(a.key,a.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,on.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,on.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ae(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ae(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ae(27949);return e+(this.isRed()?0:1)}}on.EMPTY=null,on.RED=!0,on.BLACK=!1;on.EMPTY=new class{constructor(){this.size=0}get key(){throw Ae(57766)}get value(){throw Ae(16141)}get color(){throw Ae(16727)}get left(){throw Ae(29726)}get right(){throw Ae(36894)}copy(e,t,a,o,c){return this}insert(e,t,a){return new on(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.comparator=e,this.data=new Et(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,a)=>(e(t),!1))}forEachInRange(e,t){const a=this.data.getIteratorFrom(e[0]);for(;a.hasNext();){const o=a.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let a;for(a=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();a.hasNext();)if(!e(a.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new eN(this.data.getIterator())}getIteratorFrom(e){return new eN(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(a=>{t=t.add(a)}),t}isEqual(e){if(!(e instanceof Bt)||this.size!==e.size)return!1;const t=this.data.getIterator(),a=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=a.getNext().key;if(this.comparator(o,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Bt(this.comparator);return t.data=e,t}}class eN{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e){this.fields=e,e.sort(ln.comparator)}static empty(){return new zn([])}unionWith(e){let t=new Bt(ln.comparator);for(const a of this.fields)t=t.add(a);for(const a of e)t=t.add(a);return new zn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Xo(this.fields,e.fields,(t,a)=>t.isEqual(a))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Px extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(o){try{return atob(o)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new Px("Invalid base64 string: "+c):c}}(e);return new dn(t)}static fromUint8Array(e){const t=function(o){let c="";for(let d=0;d<o.length;++d)c+=String.fromCharCode(o[d]);return c}(e);return new dn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const a=new Uint8Array(t.length);for(let o=0;o<t.length;o++)a[o]=t.charCodeAt(o);return a}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ue(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}dn.EMPTY_BYTE_STRING=new dn("");const x1=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ai(n){if(Je(!!n,39018),typeof n=="string"){let e=0;const t=x1.exec(n);if(Je(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const a=new Date(n);return{seconds:Math.floor(a.getTime()/1e3),nanos:e}}return{seconds:St(n.seconds),nanos:St(n.nanos)}}function St(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ci(n){return typeof n=="string"?dn.fromBase64String(n):dn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kx="server_timestamp",Lx="__type__",Vx="__previous_value__",Ux="__local_write_time__";function Hg(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Lx])===null||t===void 0?void 0:t.stringValue)===kx}function zh(n){const e=n.mapValue.fields[Vx];return Hg(e)?zh(e):e}function $c(n){const e=Ai(n.mapValue.fields[Ux].timestampValue);return new qt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1{constructor(e,t,a,o,c,d,f,p,v,_){this.databaseId=e,this.appId=t,this.persistenceKey=a,this.host=o,this.ssl=c,this.forceLongPolling=d,this.autoDetectLongPolling=f,this.longPollingOptions=p,this.useFetchStreams=v,this.isUsingEmulator=_}}const Eh="(default)";class Yc{constructor(e,t){this.projectId=e,this.database=t||Eh}static empty(){return new Yc("","")}get isDefaultDatabase(){return this.database===Eh}isEqual(e){return e instanceof Yc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fx="__type__",C1="__max__",Yd={mapValue:{}},Hx="__vector__",bh="value";function ji(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Hg(n)?4:S1(n)?9007199254740991:j1(n)?10:11:Ae(28295,{value:n})}function Ks(n,e){if(n===e)return!0;const t=ji(n);if(t!==ji(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return $c(n).isEqual($c(e));case 3:return function(o,c){if(typeof o.timestampValue=="string"&&typeof c.timestampValue=="string"&&o.timestampValue.length===c.timestampValue.length)return o.timestampValue===c.timestampValue;const d=Ai(o.timestampValue),f=Ai(c.timestampValue);return d.seconds===f.seconds&&d.nanos===f.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(o,c){return Ci(o.bytesValue).isEqual(Ci(c.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(o,c){return St(o.geoPointValue.latitude)===St(c.geoPointValue.latitude)&&St(o.geoPointValue.longitude)===St(c.geoPointValue.longitude)}(n,e);case 2:return function(o,c){if("integerValue"in o&&"integerValue"in c)return St(o.integerValue)===St(c.integerValue);if("doubleValue"in o&&"doubleValue"in c){const d=St(o.doubleValue),f=St(c.doubleValue);return d===f?_h(d)===_h(f):isNaN(d)&&isNaN(f)}return!1}(n,e);case 9:return Xo(n.arrayValue.values||[],e.arrayValue.values||[],Ks);case 10:case 11:return function(o,c){const d=o.mapValue.fields||{},f=c.mapValue.fields||{};if(Jb(d)!==Jb(f))return!1;for(const p in d)if(d.hasOwnProperty(p)&&(f[p]===void 0||!Ks(d[p],f[p])))return!1;return!0}(n,e);default:return Ae(52216,{left:n})}}function Kc(n,e){return(n.values||[]).find(t=>Ks(t,e))!==void 0}function Wo(n,e){if(n===e)return 0;const t=ji(n),a=ji(e);if(t!==a)return Ue(t,a);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ue(n.booleanValue,e.booleanValue);case 2:return function(c,d){const f=St(c.integerValue||c.doubleValue),p=St(d.integerValue||d.doubleValue);return f<p?-1:f>p?1:f===p?0:isNaN(f)?isNaN(p)?0:-1:1}(n,e);case 3:return tN(n.timestampValue,e.timestampValue);case 4:return tN($c(n),$c(e));case 5:return tg(n.stringValue,e.stringValue);case 6:return function(c,d){const f=Ci(c),p=Ci(d);return f.compareTo(p)}(n.bytesValue,e.bytesValue);case 7:return function(c,d){const f=c.split("/"),p=d.split("/");for(let v=0;v<f.length&&v<p.length;v++){const _=Ue(f[v],p[v]);if(_!==0)return _}return Ue(f.length,p.length)}(n.referenceValue,e.referenceValue);case 8:return function(c,d){const f=Ue(St(c.latitude),St(d.latitude));return f!==0?f:Ue(St(c.longitude),St(d.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return nN(n.arrayValue,e.arrayValue);case 10:return function(c,d){var f,p,v,_;const N=c.fields||{},C=d.fields||{},j=(f=N[bh])===null||f===void 0?void 0:f.arrayValue,b=(p=C[bh])===null||p===void 0?void 0:p.arrayValue,M=Ue(((v=j?.values)===null||v===void 0?void 0:v.length)||0,((_=b?.values)===null||_===void 0?void 0:_.length)||0);return M!==0?M:nN(j,b)}(n.mapValue,e.mapValue);case 11:return function(c,d){if(c===Yd.mapValue&&d===Yd.mapValue)return 0;if(c===Yd.mapValue)return 1;if(d===Yd.mapValue)return-1;const f=c.fields||{},p=Object.keys(f),v=d.fields||{},_=Object.keys(v);p.sort(),_.sort();for(let N=0;N<p.length&&N<_.length;++N){const C=tg(p[N],_[N]);if(C!==0)return C;const j=Wo(f[p[N]],v[_[N]]);if(j!==0)return j}return Ue(p.length,_.length)}(n.mapValue,e.mapValue);default:throw Ae(23264,{Pe:t})}}function tN(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ue(n,e);const t=Ai(n),a=Ai(e),o=Ue(t.seconds,a.seconds);return o!==0?o:Ue(t.nanos,a.nanos)}function nN(n,e){const t=n.values||[],a=e.values||[];for(let o=0;o<t.length&&o<a.length;++o){const c=Wo(t[o],a[o]);if(c)return c}return Ue(t.length,a.length)}function Zo(n){return ng(n)}function ng(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const a=Ai(t);return`time(${a.seconds},${a.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Ci(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Ne.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let a="[",o=!0;for(const c of t.values||[])o?o=!1:a+=",",a+=ng(c);return a+"]"}(n.arrayValue):"mapValue"in n?function(t){const a=Object.keys(t.fields||{}).sort();let o="{",c=!0;for(const d of a)c?c=!1:o+=",",o+=`${d}:${ng(t.fields[d])}`;return o+"}"}(n.mapValue):Ae(61005,{value:n})}function ah(n){switch(ji(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=zh(n);return e?16+ah(e):16;case 5:return 2*n.stringValue.length;case 6:return Ci(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(a){return(a.values||[]).reduce((o,c)=>o+ah(c),0)}(n.arrayValue);case 10:case 11:return function(a){let o=0;return Li(a.fields,(c,d)=>{o+=c.length+ah(d)}),o}(n.mapValue);default:throw Ae(13486,{value:n})}}function sN(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function sg(n){return!!n&&"integerValue"in n}function qg(n){return!!n&&"arrayValue"in n}function aN(n){return!!n&&"nullValue"in n}function iN(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ih(n){return!!n&&"mapValue"in n}function j1(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Fx])===null||t===void 0?void 0:t.stringValue)===Hx}function Dc(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Li(n.mapValue.fields,(t,a)=>e.mapValue.fields[t]=Dc(a)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Dc(n.arrayValue.values[t]);return e}return Object.assign({},n)}function S1(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===C1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(e){this.value=e}static empty(){return new Cn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let a=0;a<e.length-1;++a)if(t=(t.mapValue.fields||{})[e.get(a)],!ih(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Dc(t)}setAll(e){let t=ln.emptyPath(),a={},o=[];e.forEach((d,f)=>{if(!t.isImmediateParentOf(f)){const p=this.getFieldsMap(t);this.applyChanges(p,a,o),a={},o=[],t=f.popLast()}d?a[f.lastSegment()]=Dc(d):o.push(f.lastSegment())});const c=this.getFieldsMap(t);this.applyChanges(c,a,o)}delete(e){const t=this.field(e.popLast());ih(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ks(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let a=0;a<e.length;++a){let o=t.mapValue.fields[e.get(a)];ih(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(a)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,a){Li(t,(o,c)=>e[o]=c);for(const o of a)delete e[o]}clone(){return new Cn(Dc(this.value))}}function qx(n){const e=[];return Li(n.fields,(t,a)=>{const o=new ln([t]);if(ih(a)){const c=qx(a.mapValue).fields;if(c.length===0)e.push(o);else for(const d of c)e.push(o.child(d))}else e.push(o)}),new zn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e,t,a,o,c,d,f){this.key=e,this.documentType=t,this.version=a,this.readTime=o,this.createTime=c,this.data=d,this.documentState=f}static newInvalidDocument(e){return new Zt(e,0,Se.min(),Se.min(),Se.min(),Cn.empty(),0)}static newFoundDocument(e,t,a,o){return new Zt(e,1,t,Se.min(),a,o,0)}static newNoDocument(e,t){return new Zt(e,2,t,Se.min(),Se.min(),Cn.empty(),0)}static newUnknownDocument(e,t){return new Zt(e,3,t,Se.min(),Se.min(),Cn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Se.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Cn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Cn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Se.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Zt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Zt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nh{constructor(e,t){this.position=e,this.inclusive=t}}function rN(n,e,t){let a=0;for(let o=0;o<n.position.length;o++){const c=e[o],d=n.position[o];if(c.field.isKeyField()?a=Ne.comparator(Ne.fromName(d.referenceValue),t.key):a=Wo(d,t.data.field(c.field)),c.dir==="desc"&&(a*=-1),a!==0)break}return a}function oN(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ks(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(e,t="asc"){this.field=e,this.dir=t}}function w1(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx{}class Pt extends Bx{constructor(e,t,a){super(),this.field=e,this.op=t,this.value=a}static create(e,t,a){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,a):new R1(e,t,a):t==="array-contains"?new M1(e,a):t==="in"?new P1(e,a):t==="not-in"?new k1(e,a):t==="array-contains-any"?new L1(e,a):new Pt(e,t,a)}static createKeyFieldInFilter(e,t,a){return t==="in"?new D1(e,a):new O1(e,a)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Wo(t,this.value)):t!==null&&ji(this.value)===ji(t)&&this.matchesComparison(Wo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ae(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class xs extends Bx{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new xs(e,t)}matches(e){return zx(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function zx(n){return n.op==="and"}function Gx(n){return I1(n)&&zx(n)}function I1(n){for(const e of n.filters)if(e instanceof xs)return!1;return!0}function ag(n){if(n instanceof Pt)return n.field.canonicalString()+n.op.toString()+Zo(n.value);if(Gx(n))return n.filters.map(e=>ag(e)).join(",");{const e=n.filters.map(t=>ag(t)).join(",");return`${n.op}(${e})`}}function $x(n,e){return n instanceof Pt?function(a,o){return o instanceof Pt&&a.op===o.op&&a.field.isEqual(o.field)&&Ks(a.value,o.value)}(n,e):n instanceof xs?function(a,o){return o instanceof xs&&a.op===o.op&&a.filters.length===o.filters.length?a.filters.reduce((c,d,f)=>c&&$x(d,o.filters[f]),!0):!1}(n,e):void Ae(19439)}function Yx(n){return n instanceof Pt?function(t){return`${t.field.canonicalString()} ${t.op} ${Zo(t.value)}`}(n):n instanceof xs?function(t){return t.op.toString()+" {"+t.getFilters().map(Yx).join(" ,")+"}"}(n):"Filter"}class R1 extends Pt{constructor(e,t,a){super(e,t,a),this.key=Ne.fromName(a.referenceValue)}matches(e){const t=Ne.comparator(e.key,this.key);return this.matchesComparison(t)}}class D1 extends Pt{constructor(e,t){super(e,"in",t),this.keys=Kx("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class O1 extends Pt{constructor(e,t){super(e,"not-in",t),this.keys=Kx("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Kx(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(a=>Ne.fromName(a.referenceValue))}class M1 extends Pt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return qg(t)&&Kc(t.arrayValue,this.value)}}class P1 extends Pt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Kc(this.value.arrayValue,t)}}class k1 extends Pt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Kc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Kc(this.value.arrayValue,t)}}class L1 extends Pt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!qg(t)||!t.arrayValue.values)&&t.arrayValue.values.some(a=>Kc(this.value.arrayValue,a))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e,t=null,a=[],o=[],c=null,d=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=a,this.filters=o,this.limit=c,this.startAt=d,this.endAt=f,this.Ie=null}}function lN(n,e=null,t=[],a=[],o=null,c=null,d=null){return new V1(n,e,t,a,o,c,d)}function Bg(n){const e=Me(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(a=>ag(a)).join(","),t+="|ob:",t+=e.orderBy.map(a=>function(c){return c.field.canonicalString()+c.dir}(a)).join(","),ou(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(a=>Zo(a)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(a=>Zo(a)).join(",")),e.Ie=t}return e.Ie}function zg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!w1(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!$x(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!oN(n.startAt,e.startAt)&&oN(n.endAt,e.endAt)}function ig(n){return Ne.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(e,t=null,a=[],o=[],c=null,d="F",f=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=a,this.filters=o,this.limit=c,this.limitType=d,this.startAt=f,this.endAt=p,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function U1(n,e,t,a,o,c,d,f){return new cl(n,e,t,a,o,c,d,f)}function Gh(n){return new cl(n)}function cN(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Qx(n){return n.collectionGroup!==null}function Oc(n){const e=Me(n);if(e.Ee===null){e.Ee=[];const t=new Set;for(const c of e.explicitOrderBy)e.Ee.push(c),t.add(c.field.canonicalString());const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let f=new Bt(ln.comparator);return d.filters.forEach(p=>{p.getFlattenedFilters().forEach(v=>{v.isInequality()&&(f=f.add(v.field))})}),f})(e).forEach(c=>{t.has(c.canonicalString())||c.isKeyField()||e.Ee.push(new Qc(c,a))}),t.has(ln.keyField().canonicalString())||e.Ee.push(new Qc(ln.keyField(),a))}return e.Ee}function Ys(n){const e=Me(n);return e.de||(e.de=F1(e,Oc(n))),e.de}function F1(n,e){if(n.limitType==="F")return lN(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(o=>{const c=o.dir==="desc"?"asc":"desc";return new Qc(o.field,c)});const t=n.endAt?new Nh(n.endAt.position,n.endAt.inclusive):null,a=n.startAt?new Nh(n.startAt.position,n.startAt.inclusive):null;return lN(n.path,n.collectionGroup,e,n.filters,n.limit,t,a)}}function rg(n,e){const t=n.filters.concat([e]);return new cl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Th(n,e,t){return new cl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function $h(n,e){return zg(Ys(n),Ys(e))&&n.limitType===e.limitType}function Xx(n){return`${Bg(Ys(n))}|lt:${n.limitType}`}function ko(n){return`Query(target=${function(t){let a=t.path.canonicalString();return t.collectionGroup!==null&&(a+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(a+=`, filters: [${t.filters.map(o=>Yx(o)).join(", ")}]`),ou(t.limit)||(a+=", limit: "+t.limit),t.orderBy.length>0&&(a+=`, orderBy: [${t.orderBy.map(o=>function(d){return`${d.field.canonicalString()} (${d.dir})`}(o)).join(", ")}]`),t.startAt&&(a+=", startAt: ",a+=t.startAt.inclusive?"b:":"a:",a+=t.startAt.position.map(o=>Zo(o)).join(",")),t.endAt&&(a+=", endAt: ",a+=t.endAt.inclusive?"a:":"b:",a+=t.endAt.position.map(o=>Zo(o)).join(",")),`Target(${a})`}(Ys(n))}; limitType=${n.limitType})`}function Yh(n,e){return e.isFoundDocument()&&function(a,o){const c=o.key.path;return a.collectionGroup!==null?o.key.hasCollectionId(a.collectionGroup)&&a.path.isPrefixOf(c):Ne.isDocumentKey(a.path)?a.path.isEqual(c):a.path.isImmediateParentOf(c)}(n,e)&&function(a,o){for(const c of Oc(a))if(!c.field.isKeyField()&&o.data.field(c.field)===null)return!1;return!0}(n,e)&&function(a,o){for(const c of a.filters)if(!c.matches(o))return!1;return!0}(n,e)&&function(a,o){return!(a.startAt&&!function(d,f,p){const v=rN(d,f,p);return d.inclusive?v<=0:v<0}(a.startAt,Oc(a),o)||a.endAt&&!function(d,f,p){const v=rN(d,f,p);return d.inclusive?v>=0:v>0}(a.endAt,Oc(a),o))}(n,e)}function H1(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Wx(n){return(e,t)=>{let a=!1;for(const o of Oc(n)){const c=q1(o,e,t);if(c!==0)return c;a=a||o.field.isKeyField()}return 0}}function q1(n,e,t){const a=n.field.isKeyField()?Ne.comparator(e.key,t.key):function(c,d,f){const p=d.data.field(c),v=f.data.field(c);return p!==null&&v!==null?Wo(p,v):Ae(42886)}(n.field,e,t);switch(n.dir){case"asc":return a;case"desc":return-1*a;default:return Ae(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a!==void 0){for(const[o,c]of a)if(this.equalsFn(o,e))return c}}has(e){return this.get(e)!==void 0}set(e,t){const a=this.mapKeyFn(e),o=this.inner[a];if(o===void 0)return this.inner[a]=[[e,t]],void this.innerSize++;for(let c=0;c<o.length;c++)if(this.equalsFn(o[c][0],e))return void(o[c]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a===void 0)return!1;for(let o=0;o<a.length;o++)if(this.equalsFn(a[o][0],e))return a.length===1?delete this.inner[t]:a.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Li(this.inner,(t,a)=>{for(const[o,c]of a)e(o,c)})}isEmpty(){return Mx(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B1=new Et(Ne.comparator);function Oa(){return B1}const Zx=new Et(Ne.comparator);function jc(...n){let e=Zx;for(const t of n)e=e.insert(t.key,t);return e}function Jx(n){let e=Zx;return n.forEach((t,a)=>e=e.insert(t,a.overlayedDocument)),e}function Ar(){return Mc()}function e0(){return Mc()}function Mc(){return new Lr(n=>n.toString(),(n,e)=>n.isEqual(e))}const z1=new Et(Ne.comparator),G1=new Bt(Ne.comparator);function Ye(...n){let e=G1;for(const t of n)e=e.add(t);return e}const $1=new Bt(Ue);function Y1(){return $1}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_h(e)?"-0":e}}function t0(n){return{integerValue:""+n}}function K1(n,e){return b1(e)?t0(e):Gg(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh{constructor(){this._=void 0}}function Q1(n,e,t){return n instanceof Xc?function(o,c){const d={fields:{[Lx]:{stringValue:kx},[Ux]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return c&&Hg(c)&&(c=zh(c)),c&&(d.fields[Vx]=c),{mapValue:d}}(t,e):n instanceof Wc?s0(n,e):n instanceof Zc?a0(n,e):function(o,c){const d=n0(o,c),f=uN(d)+uN(o.Re);return sg(d)&&sg(o.Re)?t0(f):Gg(o.serializer,f)}(n,e)}function X1(n,e,t){return n instanceof Wc?s0(n,e):n instanceof Zc?a0(n,e):t}function n0(n,e){return n instanceof xh?function(a){return sg(a)||function(c){return!!c&&"doubleValue"in c}(a)}(e)?e:{integerValue:0}:null}class Xc extends Kh{}class Wc extends Kh{constructor(e){super(),this.elements=e}}function s0(n,e){const t=i0(e);for(const a of n.elements)t.some(o=>Ks(o,a))||t.push(a);return{arrayValue:{values:t}}}class Zc extends Kh{constructor(e){super(),this.elements=e}}function a0(n,e){let t=i0(e);for(const a of n.elements)t=t.filter(o=>!Ks(o,a));return{arrayValue:{values:t}}}class xh extends Kh{constructor(e,t){super(),this.serializer=e,this.Re=t}}function uN(n){return St(n.integerValue||n.doubleValue)}function i0(n){return qg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1{constructor(e,t){this.field=e,this.transform=t}}function Z1(n,e){return n.field.isEqual(e.field)&&function(a,o){return a instanceof Wc&&o instanceof Wc||a instanceof Zc&&o instanceof Zc?Xo(a.elements,o.elements,Ks):a instanceof xh&&o instanceof xh?Ks(a.Re,o.Re):a instanceof Xc&&o instanceof Xc}(n.transform,e.transform)}class J1{constructor(e,t){this.version=e,this.transformResults=t}}class cn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new cn}static exists(e){return new cn(void 0,e)}static updateTime(e){return new cn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function rh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Qh{}function r0(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Xh(n.key,cn.none()):new lu(n.key,n.data,cn.none());{const t=n.data,a=Cn.empty();let o=new Bt(ln.comparator);for(let c of e.fields)if(!o.has(c)){let d=t.field(c);d===null&&c.length>1&&(c=c.popLast(),d=t.field(c)),d===null?a.delete(c):a.set(c,d),o=o.add(c)}return new Vi(n.key,a,new zn(o.toArray()),cn.none())}}function eD(n,e,t){n instanceof lu?function(o,c,d){const f=o.value.clone(),p=hN(o.fieldTransforms,c,d.transformResults);f.setAll(p),c.convertToFoundDocument(d.version,f).setHasCommittedMutations()}(n,e,t):n instanceof Vi?function(o,c,d){if(!rh(o.precondition,c))return void c.convertToUnknownDocument(d.version);const f=hN(o.fieldTransforms,c,d.transformResults),p=c.data;p.setAll(o0(o)),p.setAll(f),c.convertToFoundDocument(d.version,p).setHasCommittedMutations()}(n,e,t):function(o,c,d){c.convertToNoDocument(d.version).setHasCommittedMutations()}(0,e,t)}function Pc(n,e,t,a){return n instanceof lu?function(c,d,f,p){if(!rh(c.precondition,d))return f;const v=c.value.clone(),_=fN(c.fieldTransforms,p,d);return v.setAll(_),d.convertToFoundDocument(d.version,v).setHasLocalMutations(),null}(n,e,t,a):n instanceof Vi?function(c,d,f,p){if(!rh(c.precondition,d))return f;const v=fN(c.fieldTransforms,p,d),_=d.data;return _.setAll(o0(c)),_.setAll(v),d.convertToFoundDocument(d.version,_).setHasLocalMutations(),f===null?null:f.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map(N=>N.field))}(n,e,t,a):function(c,d,f){return rh(c.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):f}(n,e,t)}function tD(n,e){let t=null;for(const a of n.fieldTransforms){const o=e.data.field(a.field),c=n0(a.transform,o||null);c!=null&&(t===null&&(t=Cn.empty()),t.set(a.field,c))}return t||null}function dN(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(a,o){return a===void 0&&o===void 0||!(!a||!o)&&Xo(a,o,(c,d)=>Z1(c,d))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class lu extends Qh{constructor(e,t,a,o=[]){super(),this.key=e,this.value=t,this.precondition=a,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Vi extends Qh{constructor(e,t,a,o,c=[]){super(),this.key=e,this.data=t,this.fieldMask=a,this.precondition=o,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function o0(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const a=n.data.field(t);e.set(t,a)}}),e}function hN(n,e,t){const a=new Map;Je(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let o=0;o<t.length;o++){const c=n[o],d=c.transform,f=e.data.field(c.field);a.set(c.field,X1(d,f,t[o]))}return a}function fN(n,e,t){const a=new Map;for(const o of n){const c=o.transform,d=t.data.field(o.field);a.set(o.field,Q1(c,d,e))}return a}class Xh extends Qh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class l0 extends Qh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nD{constructor(e,t,a,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=a,this.mutations=o}applyToRemoteDocument(e,t){const a=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const c=this.mutations[o];c.key.isEqual(e.key)&&eD(c,e,a[o])}}applyToLocalView(e,t){for(const a of this.baseMutations)a.key.isEqual(e.key)&&(t=Pc(a,e,t,this.localWriteTime));for(const a of this.mutations)a.key.isEqual(e.key)&&(t=Pc(a,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const a=e0();return this.mutations.forEach(o=>{const c=e.get(o.key),d=c.overlayedDocument;let f=this.applyToLocalView(d,c.mutatedFields);f=t.has(o.key)?null:f;const p=r0(d,f);p!==null&&a.set(o.key,p),d.isValidDocument()||d.convertToNoDocument(Se.min())}),a}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ye())}isEqual(e){return this.batchId===e.batchId&&Xo(this.mutations,e.mutations,(t,a)=>dN(t,a))&&Xo(this.baseMutations,e.baseMutations,(t,a)=>dN(t,a))}}class $g{constructor(e,t,a,o){this.batch=e,this.commitVersion=t,this.mutationResults=a,this.docVersions=o}static from(e,t,a){Je(e.mutations.length===a.length,58842,{fe:e.mutations.length,ge:a.length});let o=function(){return z1}();const c=e.mutations;for(let d=0;d<c.length;d++)o=o.insert(c[d].key,a[d].version);return new $g(e,t,a,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sD{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aD{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Mt,Ze;function c0(n){switch(n){case re.OK:return Ae(64938);case re.CANCELLED:case re.UNKNOWN:case re.DEADLINE_EXCEEDED:case re.RESOURCE_EXHAUSTED:case re.INTERNAL:case re.UNAVAILABLE:case re.UNAUTHENTICATED:return!1;case re.INVALID_ARGUMENT:case re.NOT_FOUND:case re.ALREADY_EXISTS:case re.PERMISSION_DENIED:case re.FAILED_PRECONDITION:case re.ABORTED:case re.OUT_OF_RANGE:case re.UNIMPLEMENTED:case re.DATA_LOSS:return!0;default:return Ae(15467,{code:n})}}function u0(n){if(n===void 0)return Da("GRPC error has no .code"),re.UNKNOWN;switch(n){case Mt.OK:return re.OK;case Mt.CANCELLED:return re.CANCELLED;case Mt.UNKNOWN:return re.UNKNOWN;case Mt.DEADLINE_EXCEEDED:return re.DEADLINE_EXCEEDED;case Mt.RESOURCE_EXHAUSTED:return re.RESOURCE_EXHAUSTED;case Mt.INTERNAL:return re.INTERNAL;case Mt.UNAVAILABLE:return re.UNAVAILABLE;case Mt.UNAUTHENTICATED:return re.UNAUTHENTICATED;case Mt.INVALID_ARGUMENT:return re.INVALID_ARGUMENT;case Mt.NOT_FOUND:return re.NOT_FOUND;case Mt.ALREADY_EXISTS:return re.ALREADY_EXISTS;case Mt.PERMISSION_DENIED:return re.PERMISSION_DENIED;case Mt.FAILED_PRECONDITION:return re.FAILED_PRECONDITION;case Mt.ABORTED:return re.ABORTED;case Mt.OUT_OF_RANGE:return re.OUT_OF_RANGE;case Mt.UNIMPLEMENTED:return re.UNIMPLEMENTED;case Mt.DATA_LOSS:return re.DATA_LOSS;default:return Ae(39323,{code:n})}}(Ze=Mt||(Mt={}))[Ze.OK=0]="OK",Ze[Ze.CANCELLED=1]="CANCELLED",Ze[Ze.UNKNOWN=2]="UNKNOWN",Ze[Ze.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ze[Ze.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ze[Ze.NOT_FOUND=5]="NOT_FOUND",Ze[Ze.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ze[Ze.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ze[Ze.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ze[Ze.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ze[Ze.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ze[Ze.ABORTED=10]="ABORTED",Ze[Ze.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ze[Ze.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ze[Ze.INTERNAL=13]="INTERNAL",Ze[Ze.UNAVAILABLE=14]="UNAVAILABLE",Ze[Ze.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iD=new bi([4294967295,4294967295],0);function mN(n){const e=Rx().encode(n),t=new Tx;return t.update(e),new Uint8Array(t.digest())}function pN(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),a=e.getUint32(4,!0),o=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new bi([t,a],0),new bi([o,c],0)]}class Yg{constructor(e,t,a){if(this.bitmap=e,this.padding=t,this.hashCount=a,t<0||t>=8)throw new Sc(`Invalid padding: ${t}`);if(a<0)throw new Sc(`Invalid hash count: ${a}`);if(e.length>0&&this.hashCount===0)throw new Sc(`Invalid hash count: ${a}`);if(e.length===0&&t!==0)throw new Sc(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=bi.fromNumber(this.pe)}we(e,t,a){let o=e.add(t.multiply(bi.fromNumber(a)));return o.compare(iD)===1&&(o=new bi([o.getBits(0),o.getBits(1)],0)),o.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=mN(e),[a,o]=pN(t);for(let c=0;c<this.hashCount;c++){const d=this.we(a,o,c);if(!this.be(d))return!1}return!0}static create(e,t,a){const o=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),d=new Yg(c,o,t);return a.forEach(f=>d.insert(f)),d}insert(e){if(this.pe===0)return;const t=mN(e),[a,o]=pN(t);for(let c=0;c<this.hashCount;c++){const d=this.we(a,o,c);this.Se(d)}}Se(e){const t=Math.floor(e/8),a=e%8;this.bitmap[t]|=1<<a}}class Sc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(e,t,a,o,c){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=a,this.documentUpdates=o,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,t,a){const o=new Map;return o.set(e,cu.createSynthesizedTargetChangeForCurrentChange(e,t,a)),new Wh(Se.min(),o,new Et(Ue),Oa(),Ye())}}class cu{constructor(e,t,a,o,c){this.resumeToken=e,this.current=t,this.addedDocuments=a,this.modifiedDocuments=o,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,t,a){return new cu(a,t,Ye(),Ye(),Ye())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oh{constructor(e,t,a,o){this.De=e,this.removedTargetIds=t,this.key=a,this.ve=o}}class d0{constructor(e,t){this.targetId=e,this.Ce=t}}class h0{constructor(e,t,a=dn.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=a,this.cause=o}}class gN{constructor(){this.Fe=0,this.Me=vN(),this.xe=dn.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Ye(),t=Ye(),a=Ye();return this.Me.forEach((o,c)=>{switch(c){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:a=a.add(o);break;default:Ae(38017,{changeType:c})}}),new cu(this.xe,this.Oe,e,t,a)}Qe(){this.Ne=!1,this.Me=vN()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Je(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class rD{constructor(e){this.ze=e,this.je=new Map,this.He=Oa(),this.Je=Kd(),this.Ye=Kd(),this.Ze=new Et(Ue)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const a=this.rt(t);switch(e.state){case 0:this.it(t)&&a.ke(e.resumeToken);break;case 1:a.We(),a.Be||a.Qe(),a.ke(e.resumeToken);break;case 2:a.We(),a.Be||this.removeTarget(t);break;case 3:this.it(t)&&(a.Ge(),a.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),a.ke(e.resumeToken));break;default:Ae(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((a,o)=>{this.it(o)&&t(o)})}ot(e){const t=e.targetId,a=e.Ce.count,o=this._t(t);if(o){const c=o.target;if(ig(c))if(a===0){const d=new Ne(c.path);this.tt(t,d,Zt.newNoDocument(d,Se.min()))}else Je(a===1,20013,{expectedCount:a});else{const d=this.ut(t);if(d!==a){const f=this.ct(e),p=f?this.lt(f,e,d):1;if(p!==0){this.st(t);const v=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,v)}}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:a="",padding:o=0},hashCount:c=0}=t;let d,f;try{d=Ci(a).toUint8Array()}catch(p){if(p instanceof Px)return Qo("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{f=new Yg(d,o,c)}catch(p){return Qo(p instanceof Sc?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return f.pe===0?null:f}lt(e,t,a){return t.Ce.count===a-this.Tt(e,t.targetId)?0:2}Tt(e,t){const a=this.ze.getRemoteKeysForTarget(t);let o=0;return a.forEach(c=>{const d=this.ze.Pt(),f=`projects/${d.projectId}/databases/${d.database}/documents/${c.path.canonicalString()}`;e.mightContain(f)||(this.tt(t,c,null),o++)}),o}It(e){const t=new Map;this.je.forEach((c,d)=>{const f=this._t(d);if(f){if(c.current&&ig(f.target)){const p=new Ne(f.target.path);this.Et(p).has(d)||this.dt(d,p)||this.tt(d,p,Zt.newNoDocument(p,e))}c.Le&&(t.set(d,c.qe()),c.Qe())}});let a=Ye();this.Ye.forEach((c,d)=>{let f=!0;d.forEachWhile(p=>{const v=this._t(p);return!v||v.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)}),f&&(a=a.add(c))}),this.He.forEach((c,d)=>d.setReadTime(e));const o=new Wh(e,t,this.Ze,this.He,a);return this.He=Oa(),this.Je=Kd(),this.Ye=Kd(),this.Ze=new Et(Ue),o}et(e,t){if(!this.it(e))return;const a=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,a),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,a){if(!this.it(e))return;const o=this.rt(e);this.dt(e,t)?o.$e(t,1):o.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),a&&(this.He=this.He.insert(t,a))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new gN,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new Bt(Ue),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new Bt(Ue),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||ge("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new gN),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function Kd(){return new Et(Ne.comparator)}function vN(){return new Et(Ne.comparator)}const oD={asc:"ASCENDING",desc:"DESCENDING"},lD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},cD={and:"AND",or:"OR"};class uD{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function og(n,e){return n.useProto3Json||ou(e)?e:{value:e}}function Ah(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function f0(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function dD(n,e){return Ah(n,e.toTimestamp())}function $n(n){return Je(!!n,49232),Se.fromTimestamp(function(t){const a=Ai(t);return new qt(a.seconds,a.nanos)}(n))}function Kg(n,e){return lg(n,e).canonicalString()}function lg(n,e){const t=function(o){return new ft(["projects",o.projectId,"databases",o.database])}(n).child("documents");return e===void 0?t:t.child(e)}function m0(n){const e=ft.fromString(n);return Je(E0(e),10190,{key:e.toString()}),e}function Ch(n,e){return Kg(n.databaseId,e.path)}function kc(n,e){const t=m0(e);if(t.get(1)!==n.databaseId.projectId)throw new pe(re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new pe(re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ne(g0(t))}function p0(n,e){return Kg(n.databaseId,e)}function hD(n){const e=m0(n);return e.length===4?ft.emptyPath():g0(e)}function cg(n){return new ft(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function g0(n){return Je(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function yN(n,e,t){return{name:Ch(n,e),fields:t.value.mapValue.fields}}function fD(n,e){return"found"in e?function(a,o){Je(!!o.found,43571),o.found.name,o.found.updateTime;const c=kc(a,o.found.name),d=$n(o.found.updateTime),f=o.found.createTime?$n(o.found.createTime):Se.min(),p=new Cn({mapValue:{fields:o.found.fields}});return Zt.newFoundDocument(c,d,f,p)}(n,e):"missing"in e?function(a,o){Je(!!o.missing,3894),Je(!!o.readTime,22933);const c=kc(a,o.missing),d=$n(o.readTime);return Zt.newNoDocument(c,d)}(n,e):Ae(7234,{result:e})}function mD(n,e){let t;if("targetChange"in e){e.targetChange;const a=function(v){return v==="NO_CHANGE"?0:v==="ADD"?1:v==="REMOVE"?2:v==="CURRENT"?3:v==="RESET"?4:Ae(39313,{state:v})}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],c=function(v,_){return v.useProto3Json?(Je(_===void 0||typeof _=="string",58123),dn.fromBase64String(_||"")):(Je(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),dn.fromUint8Array(_||new Uint8Array))}(n,e.targetChange.resumeToken),d=e.targetChange.cause,f=d&&function(v){const _=v.code===void 0?re.UNKNOWN:u0(v.code);return new pe(_,v.message||"")}(d);t=new h0(a,o,c,f||null)}else if("documentChange"in e){e.documentChange;const a=e.documentChange;a.document,a.document.name,a.document.updateTime;const o=kc(n,a.document.name),c=$n(a.document.updateTime),d=a.document.createTime?$n(a.document.createTime):Se.min(),f=new Cn({mapValue:{fields:a.document.fields}}),p=Zt.newFoundDocument(o,c,d,f),v=a.targetIds||[],_=a.removedTargetIds||[];t=new oh(v,_,p.key,p)}else if("documentDelete"in e){e.documentDelete;const a=e.documentDelete;a.document;const o=kc(n,a.document),c=a.readTime?$n(a.readTime):Se.min(),d=Zt.newNoDocument(o,c),f=a.removedTargetIds||[];t=new oh([],f,d.key,d)}else if("documentRemove"in e){e.documentRemove;const a=e.documentRemove;a.document;const o=kc(n,a.document),c=a.removedTargetIds||[];t=new oh([],c,o,null)}else{if(!("filter"in e))return Ae(11601,{Vt:e});{e.filter;const a=e.filter;a.targetId;const{count:o=0,unchangedNames:c}=a,d=new aD(o,c),f=a.targetId;t=new d0(f,d)}}return t}function v0(n,e){let t;if(e instanceof lu)t={update:yN(n,e.key,e.value)};else if(e instanceof Xh)t={delete:Ch(n,e.key)};else if(e instanceof Vi)t={update:yN(n,e.key,e.data),updateMask:TD(e.fieldMask)};else{if(!(e instanceof l0))return Ae(16599,{ft:e.type});t={verify:Ch(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(a=>function(c,d){const f=d.transform;if(f instanceof Xc)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof Wc)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof Zc)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof xh)return{fieldPath:d.field.canonicalString(),increment:f.Re};throw Ae(20930,{transform:d.transform})}(0,a))),e.precondition.isNone||(t.currentDocument=function(o,c){return c.updateTime!==void 0?{updateTime:dD(o,c.updateTime)}:c.exists!==void 0?{exists:c.exists}:Ae(27497)}(n,e.precondition)),t}function pD(n,e){return n&&n.length>0?(Je(e!==void 0,14353),n.map(t=>function(o,c){let d=o.updateTime?$n(o.updateTime):$n(c);return d.isEqual(Se.min())&&(d=$n(c)),new J1(d,o.transformResults||[])}(t,e))):[]}function gD(n,e){return{documents:[p0(n,e.path)]}}function vD(n,e){const t={structuredQuery:{}},a=e.path;let o;e.collectionGroup!==null?(o=a,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=a.popLast(),t.structuredQuery.from=[{collectionId:a.lastSegment()}]),t.parent=p0(n,o);const c=function(v){if(v.length!==0)return _0(xs.create(v,"and"))}(e.filters);c&&(t.structuredQuery.where=c);const d=function(v){if(v.length!==0)return v.map(_=>function(C){return{field:Lo(C.field),direction:ED(C.dir)}}(_))}(e.orderBy);d&&(t.structuredQuery.orderBy=d);const f=og(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=function(v){return{before:v.inclusive,values:v.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(v){return{before:!v.inclusive,values:v.position}}(e.endAt)),{gt:t,parent:o}}function yD(n){let e=hD(n.parent);const t=n.structuredQuery,a=t.from?t.from.length:0;let o=null;if(a>0){Je(a===1,65062);const _=t.from[0];_.allDescendants?o=_.collectionId:e=e.child(_.collectionId)}let c=[];t.where&&(c=function(N){const C=y0(N);return C instanceof xs&&Gx(C)?C.getFilters():[C]}(t.where));let d=[];t.orderBy&&(d=function(N){return N.map(C=>function(b){return new Qc(Vo(b.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction))}(C))}(t.orderBy));let f=null;t.limit&&(f=function(N){let C;return C=typeof N=="object"?N.value:N,ou(C)?null:C}(t.limit));let p=null;t.startAt&&(p=function(N){const C=!!N.before,j=N.values||[];return new Nh(j,C)}(t.startAt));let v=null;return t.endAt&&(v=function(N){const C=!N.before,j=N.values||[];return new Nh(j,C)}(t.endAt)),U1(e,o,d,c,f,"F",p,v)}function _D(n,e){const t=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ae(28987,{purpose:o})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function y0(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const a=Vo(t.unaryFilter.field);return Pt.create(a,"==",{doubleValue:NaN});case"IS_NULL":const o=Vo(t.unaryFilter.field);return Pt.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=Vo(t.unaryFilter.field);return Pt.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Vo(t.unaryFilter.field);return Pt.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ae(61313);default:return Ae(60726)}}(n):n.fieldFilter!==void 0?function(t){return Pt.create(Vo(t.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ae(58110);default:return Ae(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return xs.create(t.compositeFilter.filters.map(a=>y0(a)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return Ae(1026)}}(t.compositeFilter.op))}(n):Ae(30097,{filter:n})}function ED(n){return oD[n]}function bD(n){return lD[n]}function ND(n){return cD[n]}function Lo(n){return{fieldPath:n.canonicalString()}}function Vo(n){return ln.fromServerFormat(n.fieldPath)}function _0(n){return n instanceof Pt?function(t){if(t.op==="=="){if(iN(t.value))return{unaryFilter:{field:Lo(t.field),op:"IS_NAN"}};if(aN(t.value))return{unaryFilter:{field:Lo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(iN(t.value))return{unaryFilter:{field:Lo(t.field),op:"IS_NOT_NAN"}};if(aN(t.value))return{unaryFilter:{field:Lo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Lo(t.field),op:bD(t.op),value:t.value}}}(n):n instanceof xs?function(t){const a=t.getFilters().map(o=>_0(o));return a.length===1?a[0]:{compositeFilter:{op:ND(t.op),filters:a}}}(n):Ae(54877,{filter:n})}function TD(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function E0(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(e,t,a,o,c=Se.min(),d=Se.min(),f=dn.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=a,this.sequenceNumber=o,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=f,this.expectedCount=p}withSequenceNumber(e){return new yi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new yi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xD{constructor(e){this.wt=e}}function AD(n){const e=yD({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Th(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CD{constructor(){this.Cn=new jD}addToCollectionParentIndex(e,t){return this.Cn.add(t),le.resolve()}getCollectionParents(e,t){return le.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return le.resolve()}deleteFieldIndex(e,t){return le.resolve()}deleteAllFieldIndexes(e){return le.resolve()}createTargetIndexes(e,t){return le.resolve()}getDocumentsMatchingTarget(e,t){return le.resolve(null)}getIndexType(e,t){return le.resolve(0)}getFieldIndexes(e,t){return le.resolve([])}getNextCollectionGroupToUpdate(e){return le.resolve(null)}getMinOffset(e,t){return le.resolve(xi.min())}getMinOffsetFromCollectionGroup(e,t){return le.resolve(xi.min())}updateCollectionGroup(e,t,a){return le.resolve()}updateIndexEntries(e,t){return le.resolve()}}class jD{constructor(){this.index={}}add(e){const t=e.lastSegment(),a=e.popLast(),o=this.index[t]||new Bt(ft.comparator),c=!o.has(a);return this.index[t]=o.add(a),c}has(e){const t=e.lastSegment(),a=e.popLast(),o=this.index[t];return o&&o.has(a)}getEntries(e){return(this.index[e]||new Bt(ft.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _N={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},b0=41943040;class Rn{static withCacheSize(e){return new Rn(e,Rn.DEFAULT_COLLECTION_PERCENTILE,Rn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,a){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Rn.DEFAULT_COLLECTION_PERCENTILE=10,Rn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Rn.DEFAULT=new Rn(b0,Rn.DEFAULT_COLLECTION_PERCENTILE,Rn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Rn.DISABLED=new Rn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new Jo(0)}static lr(){return new Jo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EN="LruGarbageCollector",SD=1048576;function bN([n,e],[t,a]){const o=Ue(n,t);return o===0?Ue(e,a):o}class wD{constructor(e){this.Er=e,this.buffer=new Bt(bN),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const a=this.buffer.last();bN(t,a)<0&&(this.buffer=this.buffer.delete(a).add(t))}}get maxValue(){return this.buffer.last()[0]}}class ID{constructor(e,t,a){this.garbageCollector=e,this.asyncQueue=t,this.localStore=a,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){ge(EN,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ll(t)?ge(EN,"Ignoring IndexedDB error during garbage collection: ",t):await ol(t)}await this.mr(3e5)})}}class RD{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(a=>Math.floor(t/100*a))}nthSequenceNumber(e,t){if(t===0)return le.resolve(Bh.le);const a=new wD(t);return this.gr.forEachTarget(e,o=>a.Rr(o.sequenceNumber)).next(()=>this.gr.yr(e,o=>a.Rr(o))).next(()=>a.maxValue)}removeTargets(e,t,a){return this.gr.removeTargets(e,t,a)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ge("LruGarbageCollector","Garbage collection skipped; disabled"),le.resolve(_N)):this.getCacheSize(e).next(a=>a<this.params.cacheSizeCollectionThreshold?(ge("LruGarbageCollector",`Garbage collection skipped; Cache size ${a} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),_N):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let a,o,c,d,f,p,v;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(N=>(N>this.params.maximumSequenceNumbersToCollect?(ge("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${N}`),o=this.params.maximumSequenceNumbersToCollect):o=N,d=Date.now(),this.nthSequenceNumber(e,o))).next(N=>(a=N,f=Date.now(),this.removeTargets(e,a,t))).next(N=>(c=N,p=Date.now(),this.removeOrphanedDocuments(e,a))).next(N=>(v=Date.now(),Po()<=ze.DEBUG&&ge("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-_}ms
	Determined least recently used ${o} in `+(f-d)+`ms
	Removed ${c} targets in `+(p-f)+`ms
	Removed ${N} documents in `+(v-p)+`ms
Total Duration: ${v-_}ms`),le.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:c,documentsRemoved:N})))}}function DD(n,e){return new RD(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD{constructor(){this.changes=new Lr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Zt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const a=this.changes.get(t);return a!==void 0?le.resolve(a):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PD{constructor(e,t,a,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=a,this.indexManager=o}getDocument(e,t){let a=null;return this.documentOverlayCache.getOverlay(e,t).next(o=>(a=o,this.remoteDocumentCache.getEntry(e,t))).next(o=>(a!==null&&Pc(a.mutation,o,zn.empty(),qt.now()),o))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(a=>this.getLocalViewOfDocuments(e,a,Ye()).next(()=>a))}getLocalViewOfDocuments(e,t,a=Ye()){const o=Ar();return this.populateOverlays(e,o,t).next(()=>this.computeViews(e,t,o,a).next(c=>{let d=jc();return c.forEach((f,p)=>{d=d.insert(f,p.overlayedDocument)}),d}))}getOverlayedDocuments(e,t){const a=Ar();return this.populateOverlays(e,a,t).next(()=>this.computeViews(e,t,a,Ye()))}populateOverlays(e,t,a){const o=[];return a.forEach(c=>{t.has(c)||o.push(c)}),this.documentOverlayCache.getOverlays(e,o).next(c=>{c.forEach((d,f)=>{t.set(d,f)})})}computeViews(e,t,a,o){let c=Oa();const d=Mc(),f=function(){return Mc()}();return t.forEach((p,v)=>{const _=a.get(v.key);o.has(v.key)&&(_===void 0||_.mutation instanceof Vi)?c=c.insert(v.key,v):_!==void 0?(d.set(v.key,_.mutation.getFieldMask()),Pc(_.mutation,v,_.mutation.getFieldMask(),qt.now())):d.set(v.key,zn.empty())}),this.recalculateAndSaveOverlays(e,c).next(p=>(p.forEach((v,_)=>d.set(v,_)),t.forEach((v,_)=>{var N;return f.set(v,new MD(_,(N=d.get(v))!==null&&N!==void 0?N:null))}),f))}recalculateAndSaveOverlays(e,t){const a=Mc();let o=new Et((d,f)=>d-f),c=Ye();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(d=>{for(const f of d)f.keys().forEach(p=>{const v=t.get(p);if(v===null)return;let _=a.get(p)||zn.empty();_=f.applyToLocalView(v,_),a.set(p,_);const N=(o.get(f.batchId)||Ye()).add(p);o=o.insert(f.batchId,N)})}).next(()=>{const d=[],f=o.getReverseIterator();for(;f.hasNext();){const p=f.getNext(),v=p.key,_=p.value,N=e0();_.forEach(C=>{if(!c.has(C)){const j=r0(t.get(C),a.get(C));j!==null&&N.set(C,j),c=c.add(C)}}),d.push(this.documentOverlayCache.saveOverlays(e,v,N))}return le.waitFor(d)}).next(()=>a)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(a=>this.recalculateAndSaveOverlays(e,a))}getDocumentsMatchingQuery(e,t,a,o){return function(d){return Ne.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Qx(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,a,o):this.getDocumentsMatchingCollectionQuery(e,t,a,o)}getNextDocuments(e,t,a,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,a,o).next(c=>{const d=o-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,a.largestBatchId,o-c.size):le.resolve(Ar());let f=Gc,p=c;return d.next(v=>le.forEach(v,(_,N)=>(f<N.largestBatchId&&(f=N.largestBatchId),c.get(_)?le.resolve():this.remoteDocumentCache.getEntry(e,_).next(C=>{p=p.insert(_,C)}))).next(()=>this.populateOverlays(e,v,c)).next(()=>this.computeViews(e,p,v,Ye())).next(_=>({batchId:f,changes:Jx(_)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ne(t)).next(a=>{let o=jc();return a.isFoundDocument()&&(o=o.insert(a.key,a)),o})}getDocumentsMatchingCollectionGroupQuery(e,t,a,o){const c=t.collectionGroup;let d=jc();return this.indexManager.getCollectionParents(e,c).next(f=>le.forEach(f,p=>{const v=function(N,C){return new cl(C,null,N.explicitOrderBy.slice(),N.filters.slice(),N.limit,N.limitType,N.startAt,N.endAt)}(t,p.child(c));return this.getDocumentsMatchingCollectionQuery(e,v,a,o).next(_=>{_.forEach((N,C)=>{d=d.insert(N,C)})})}).next(()=>d))}getDocumentsMatchingCollectionQuery(e,t,a,o){let c;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,a.largestBatchId).next(d=>(c=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,a,c,o))).next(d=>{c.forEach((p,v)=>{const _=v.getKey();d.get(_)===null&&(d=d.insert(_,Zt.newInvalidDocument(_)))});let f=jc();return d.forEach((p,v)=>{const _=c.get(p);_!==void 0&&Pc(_.mutation,v,zn.empty(),qt.now()),Yh(t,v)&&(f=f.insert(p,v))}),f})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kD{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return le.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(o){return{id:o.id,version:o.version,createTime:$n(o.createTime)}}(t)),le.resolve()}getNamedQuery(e,t){return le.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(o){return{name:o.name,query:AD(o.bundledQuery),readTime:$n(o.readTime)}}(t)),le.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LD{constructor(){this.overlays=new Et(Ne.comparator),this.Qr=new Map}getOverlay(e,t){return le.resolve(this.overlays.get(t))}getOverlays(e,t){const a=Ar();return le.forEach(t,o=>this.getOverlay(e,o).next(c=>{c!==null&&a.set(o,c)})).next(()=>a)}saveOverlays(e,t,a){return a.forEach((o,c)=>{this.St(e,t,c)}),le.resolve()}removeOverlaysForBatchId(e,t,a){const o=this.Qr.get(a);return o!==void 0&&(o.forEach(c=>this.overlays=this.overlays.remove(c)),this.Qr.delete(a)),le.resolve()}getOverlaysForCollection(e,t,a){const o=Ar(),c=t.length+1,d=new Ne(t.child("")),f=this.overlays.getIteratorFrom(d);for(;f.hasNext();){const p=f.getNext().value,v=p.getKey();if(!t.isPrefixOf(v.path))break;v.path.length===c&&p.largestBatchId>a&&o.set(p.getKey(),p)}return le.resolve(o)}getOverlaysForCollectionGroup(e,t,a,o){let c=new Et((v,_)=>v-_);const d=this.overlays.getIterator();for(;d.hasNext();){const v=d.getNext().value;if(v.getKey().getCollectionGroup()===t&&v.largestBatchId>a){let _=c.get(v.largestBatchId);_===null&&(_=Ar(),c=c.insert(v.largestBatchId,_)),_.set(v.getKey(),v)}}const f=Ar(),p=c.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach((v,_)=>f.set(v,_)),!(f.size()>=o)););return le.resolve(f)}St(e,t,a){const o=this.overlays.get(a.key);if(o!==null){const d=this.Qr.get(o.largestBatchId).delete(a.key);this.Qr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(a.key,new sD(t,a));let c=this.Qr.get(t);c===void 0&&(c=Ye(),this.Qr.set(t,c)),this.Qr.set(t,c.add(a.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VD{constructor(){this.sessionToken=dn.EMPTY_BYTE_STRING}getSessionToken(e){return le.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,le.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qg{constructor(){this.$r=new Bt(Wt.Ur),this.Kr=new Bt(Wt.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const a=new Wt(e,t);this.$r=this.$r.add(a),this.Kr=this.Kr.add(a)}Gr(e,t){e.forEach(a=>this.addReference(a,t))}removeReference(e,t){this.zr(new Wt(e,t))}jr(e,t){e.forEach(a=>this.removeReference(a,t))}Hr(e){const t=new Ne(new ft([])),a=new Wt(t,e),o=new Wt(t,e+1),c=[];return this.Kr.forEachInRange([a,o],d=>{this.zr(d),c.push(d.key)}),c}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new Ne(new ft([])),a=new Wt(t,e),o=new Wt(t,e+1);let c=Ye();return this.Kr.forEachInRange([a,o],d=>{c=c.add(d.key)}),c}containsKey(e){const t=new Wt(e,0),a=this.$r.firstAfterOrEqual(t);return a!==null&&e.isEqual(a.key)}}class Wt{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return Ne.comparator(e.key,t.key)||Ue(e.Zr,t.Zr)}static Wr(e,t){return Ue(e.Zr,t.Zr)||Ne.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UD{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new Bt(Wt.Ur)}checkEmpty(e){return le.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,a,o){const c=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new nD(c,t,a,o);this.mutationQueue.push(d);for(const f of o)this.Xr=this.Xr.add(new Wt(f.key,c)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return le.resolve(d)}lookupMutationBatch(e,t){return le.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const a=t+1,o=this.ti(a),c=o<0?0:o;return le.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return le.resolve(this.mutationQueue.length===0?Fg:this.nr-1)}getAllMutationBatches(e){return le.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const a=new Wt(t,0),o=new Wt(t,Number.POSITIVE_INFINITY),c=[];return this.Xr.forEachInRange([a,o],d=>{const f=this.ei(d.Zr);c.push(f)}),le.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,t){let a=new Bt(Ue);return t.forEach(o=>{const c=new Wt(o,0),d=new Wt(o,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([c,d],f=>{a=a.add(f.Zr)})}),le.resolve(this.ni(a))}getAllMutationBatchesAffectingQuery(e,t){const a=t.path,o=a.length+1;let c=a;Ne.isDocumentKey(c)||(c=c.child(""));const d=new Wt(new Ne(c),0);let f=new Bt(Ue);return this.Xr.forEachWhile(p=>{const v=p.key.path;return!!a.isPrefixOf(v)&&(v.length===o&&(f=f.add(p.Zr)),!0)},d),le.resolve(this.ni(f))}ni(e){const t=[];return e.forEach(a=>{const o=this.ei(a);o!==null&&t.push(o)}),t}removeMutationBatch(e,t){Je(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let a=this.Xr;return le.forEach(t.mutations,o=>{const c=new Wt(o.key,t.batchId);return a=a.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.Xr=a})}sr(e){}containsKey(e,t){const a=new Wt(t,0),o=this.Xr.firstAfterOrEqual(a);return le.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,le.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FD{constructor(e){this.ii=e,this.docs=function(){return new Et(Ne.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const a=t.key,o=this.docs.get(a),c=o?o.size:0,d=this.ii(t);return this.docs=this.docs.insert(a,{document:t.mutableCopy(),size:d}),this.size+=d-c,this.indexManager.addToCollectionParentIndex(e,a.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const a=this.docs.get(t);return le.resolve(a?a.document.mutableCopy():Zt.newInvalidDocument(t))}getEntries(e,t){let a=Oa();return t.forEach(o=>{const c=this.docs.get(o);a=a.insert(o,c?c.document.mutableCopy():Zt.newInvalidDocument(o))}),le.resolve(a)}getDocumentsMatchingQuery(e,t,a,o){let c=Oa();const d=t.path,f=new Ne(d.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(f);for(;p.hasNext();){const{key:v,value:{document:_}}=p.getNext();if(!d.isPrefixOf(v.path))break;v.path.length>d.length+1||v1(g1(_),a)<=0||(o.has(_.key)||Yh(t,_))&&(c=c.insert(_.key,_.mutableCopy()))}return le.resolve(c)}getAllFromCollectionGroup(e,t,a,o){Ae(9500)}si(e,t){return le.forEach(this.docs,a=>t(a))}newChangeBuffer(e){return new HD(this)}getSize(e){return le.resolve(this.size)}}class HD extends OD{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((a,o)=>{o.isValidDocument()?t.push(this.Br.addEntry(e,o)):this.Br.removeEntry(a)}),le.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qD{constructor(e){this.persistence=e,this.oi=new Lr(t=>Bg(t),zg),this.lastRemoteSnapshotVersion=Se.min(),this.highestTargetId=0,this._i=0,this.ai=new Qg,this.targetCount=0,this.ui=Jo.cr()}forEachTarget(e,t){return this.oi.forEach((a,o)=>t(o)),le.resolve()}getLastRemoteSnapshotVersion(e){return le.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return le.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),le.resolve(this.highestTargetId)}setTargetsMetadata(e,t,a){return a&&(this.lastRemoteSnapshotVersion=a),t>this._i&&(this._i=t),le.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new Jo(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,le.resolve()}updateTargetData(e,t){return this.Tr(t),le.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,le.resolve()}removeTargets(e,t,a){let o=0;const c=[];return this.oi.forEach((d,f)=>{f.sequenceNumber<=t&&a.get(f.targetId)===null&&(this.oi.delete(d),c.push(this.removeMatchingKeysForTargetId(e,f.targetId)),o++)}),le.waitFor(c).next(()=>o)}getTargetCount(e){return le.resolve(this.targetCount)}getTargetData(e,t){const a=this.oi.get(t)||null;return le.resolve(a)}addMatchingKeys(e,t,a){return this.ai.Gr(t,a),le.resolve()}removeMatchingKeys(e,t,a){this.ai.jr(t,a);const o=this.persistence.referenceDelegate,c=[];return o&&t.forEach(d=>{c.push(o.markPotentiallyOrphaned(e,d))}),le.waitFor(c)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),le.resolve()}getMatchingKeysForTargetId(e,t){const a=this.ai.Yr(t);return le.resolve(a)}containsKey(e,t){return le.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{constructor(e,t){this.ci={},this.overlays={},this.li=new Bh(0),this.hi=!1,this.hi=!0,this.Pi=new VD,this.referenceDelegate=e(this),this.Ti=new qD(this),this.indexManager=new CD,this.remoteDocumentCache=function(o){return new FD(o)}(a=>this.referenceDelegate.Ii(a)),this.serializer=new xD(t),this.Ei=new kD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new LD,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let a=this.ci[e.toKey()];return a||(a=new UD(t,this.referenceDelegate),this.ci[e.toKey()]=a),a}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,a){ge("MemoryPersistence","Starting transaction:",e);const o=new BD(this.li.next());return this.referenceDelegate.di(),a(o).next(c=>this.referenceDelegate.Ai(o).next(()=>c)).toPromise().then(c=>(o.raiseOnCommittedEvent(),c))}Ri(e,t){return le.or(Object.values(this.ci).map(a=>()=>a.containsKey(e,t)))}}class BD extends _1{constructor(e){super(),this.currentSequenceNumber=e}}class Xg{constructor(e){this.persistence=e,this.Vi=new Qg,this.mi=null}static fi(e){return new Xg(e)}get gi(){if(this.mi)return this.mi;throw Ae(60996)}addReference(e,t,a){return this.Vi.addReference(a,t),this.gi.delete(a.toString()),le.resolve()}removeReference(e,t,a){return this.Vi.removeReference(a,t),this.gi.add(a.toString()),le.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),le.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(o=>this.gi.add(o.toString()));const a=this.persistence.getTargetCache();return a.getMatchingKeysForTargetId(e,t.targetId).next(o=>{o.forEach(c=>this.gi.add(c.toString()))}).next(()=>a.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return le.forEach(this.gi,a=>{const o=Ne.fromPath(a);return this.pi(e,o).next(c=>{c||t.removeEntry(o,Se.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(a=>{a?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return le.or([()=>le.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class jh{constructor(e,t){this.persistence=e,this.yi=new Lr(a=>N1(a.path),(a,o)=>a.isEqual(o)),this.garbageCollector=DD(this,t)}static fi(e,t){return new jh(e,t)}di(){}Ai(e){return le.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(a=>t.next(o=>a+o))}br(e){let t=0;return this.yr(e,a=>{t++}).next(()=>t)}yr(e,t){return le.forEach(this.yi,(a,o)=>this.Dr(e,a,o).next(c=>c?le.resolve():t(o)))}removeTargets(e,t,a){return this.persistence.getTargetCache().removeTargets(e,t,a)}removeOrphanedDocuments(e,t){let a=0;const o=this.persistence.getRemoteDocumentCache(),c=o.newChangeBuffer();return o.si(e,d=>this.Dr(e,d,t).next(f=>{f||(a++,c.removeEntry(d,Se.min()))})).next(()=>c.apply(e)).next(()=>a)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),le.resolve()}removeTarget(e,t){const a=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,a)}addReference(e,t,a){return this.yi.set(a,e.currentSequenceNumber),le.resolve()}removeReference(e,t,a){return this.yi.set(a,e.currentSequenceNumber),le.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),le.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ah(e.data.value)),t}Dr(e,t,a){return le.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.yi.get(t);return le.resolve(o!==void 0&&o>a)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{constructor(e,t,a,o){this.targetId=e,this.fromCache=t,this.ds=a,this.As=o}static Rs(e,t){let a=Ye(),o=Ye();for(const c of t.docChanges)switch(c.type){case 0:a=a.add(c.doc.key);break;case 1:o=o.add(c.doc.key)}return new Wg(e,t.fromCache,a,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return TS()?8:E1(_n())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,a,o){const c={result:null};return this.ws(e,t).next(d=>{c.result=d}).next(()=>{if(!c.result)return this.bs(e,t,o,a).next(d=>{c.result=d})}).next(()=>{if(c.result)return;const d=new zD;return this.Ss(e,t,d).next(f=>{if(c.result=f,this.fs)return this.Ds(e,t,d,f.size)})}).next(()=>c.result)}Ds(e,t,a,o){return a.documentReadCount<this.gs?(Po()<=ze.DEBUG&&ge("QueryEngine","SDK will not create cache indexes for query:",ko(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),le.resolve()):(Po()<=ze.DEBUG&&ge("QueryEngine","Query:",ko(t),"scans",a.documentReadCount,"local documents and returns",o,"documents as results."),a.documentReadCount>this.ps*o?(Po()<=ze.DEBUG&&ge("QueryEngine","The SDK decides to create cache indexes for query:",ko(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ys(t))):le.resolve())}ws(e,t){if(cN(t))return le.resolve(null);let a=Ys(t);return this.indexManager.getIndexType(e,a).next(o=>o===0?null:(t.limit!==null&&o===1&&(t=Th(t,null,"F"),a=Ys(t)),this.indexManager.getDocumentsMatchingTarget(e,a).next(c=>{const d=Ye(...c);return this.ys.getDocuments(e,d).next(f=>this.indexManager.getMinOffset(e,a).next(p=>{const v=this.vs(t,f);return this.Cs(t,v,d,p.readTime)?this.ws(e,Th(t,null,"F")):this.Fs(e,v,t,p)}))})))}bs(e,t,a,o){return cN(t)||o.isEqual(Se.min())?le.resolve(null):this.ys.getDocuments(e,a).next(c=>{const d=this.vs(t,c);return this.Cs(t,d,a,o)?le.resolve(null):(Po()<=ze.DEBUG&&ge("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),ko(t)),this.Fs(e,d,t,p1(o,Gc)).next(f=>f))})}vs(e,t){let a=new Bt(Wx(e));return t.forEach((o,c)=>{Yh(e,c)&&(a=a.add(c))}),a}Cs(e,t,a,o){if(e.limit===null)return!1;if(a.size!==t.size)return!0;const c=e.limitType==="F"?t.last():t.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(o)>0)}Ss(e,t,a){return Po()<=ze.DEBUG&&ge("QueryEngine","Using full collection scan to execute query:",ko(t)),this.ys.getDocumentsMatchingQuery(e,t,xi.min(),a)}Fs(e,t,a,o){return this.ys.getDocumentsMatchingQuery(e,a,o).next(c=>(t.forEach(d=>{c=c.insert(d.key,d)}),c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zg="LocalStore",$D=3e8;class YD{constructor(e,t,a,o){this.persistence=e,this.Ms=t,this.serializer=o,this.xs=new Et(Ue),this.Os=new Lr(c=>Bg(c),zg),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(a)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new PD(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function KD(n,e,t,a){return new YD(n,e,t,a)}async function T0(n,e){const t=Me(n);return await t.persistence.runTransaction("Handle user change","readonly",a=>{let o;return t.mutationQueue.getAllMutationBatches(a).next(c=>(o=c,t.Ls(e),t.mutationQueue.getAllMutationBatches(a))).next(c=>{const d=[],f=[];let p=Ye();for(const v of o){d.push(v.batchId);for(const _ of v.mutations)p=p.add(_.key)}for(const v of c){f.push(v.batchId);for(const _ of v.mutations)p=p.add(_.key)}return t.localDocuments.getDocuments(a,p).next(v=>({ks:v,removedBatchIds:d,addedBatchIds:f}))})})}function QD(n,e){const t=Me(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",a=>{const o=e.batch.keys(),c=t.Bs.newChangeBuffer({trackRemovals:!0});return function(f,p,v,_){const N=v.batch,C=N.keys();let j=le.resolve();return C.forEach(b=>{j=j.next(()=>_.getEntry(p,b)).next(M=>{const x=v.docVersions.get(b);Je(x!==null,48541),M.version.compareTo(x)<0&&(N.applyToRemoteDocument(M,v),M.isValidDocument()&&(M.setReadTime(v.commitVersion),_.addEntry(M)))})}),j.next(()=>f.mutationQueue.removeMutationBatch(p,N))}(t,a,e,c).next(()=>c.apply(a)).next(()=>t.mutationQueue.performConsistencyCheck(a)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(a,o,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(a,function(f){let p=Ye();for(let v=0;v<f.mutationResults.length;++v)f.mutationResults[v].transformResults.length>0&&(p=p.add(f.batch.mutations[v].key));return p}(e))).next(()=>t.localDocuments.getDocuments(a,o))})}function x0(n){const e=Me(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function XD(n,e){const t=Me(n),a=e.snapshotVersion;let o=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",c=>{const d=t.Bs.newChangeBuffer({trackRemovals:!0});o=t.xs;const f=[];e.targetChanges.forEach((_,N)=>{const C=o.get(N);if(!C)return;f.push(t.Ti.removeMatchingKeys(c,_.removedDocuments,N).next(()=>t.Ti.addMatchingKeys(c,_.addedDocuments,N)));let j=C.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(N)!==null?j=j.withResumeToken(dn.EMPTY_BYTE_STRING,Se.min()).withLastLimboFreeSnapshotVersion(Se.min()):_.resumeToken.approximateByteSize()>0&&(j=j.withResumeToken(_.resumeToken,a)),o=o.insert(N,j),function(M,x,L){return M.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=$D?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0}(C,j,_)&&f.push(t.Ti.updateTargetData(c,j))});let p=Oa(),v=Ye();if(e.documentUpdates.forEach(_=>{e.resolvedLimboDocuments.has(_)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(c,_))}),f.push(WD(c,d,e.documentUpdates).next(_=>{p=_.qs,v=_.Qs})),!a.isEqual(Se.min())){const _=t.Ti.getLastRemoteSnapshotVersion(c).next(N=>t.Ti.setTargetsMetadata(c,c.currentSequenceNumber,a));f.push(_)}return le.waitFor(f).next(()=>d.apply(c)).next(()=>t.localDocuments.getLocalViewOfDocuments(c,p,v)).next(()=>p)}).then(c=>(t.xs=o,c))}function WD(n,e,t){let a=Ye(),o=Ye();return t.forEach(c=>a=a.add(c)),e.getEntries(n,a).next(c=>{let d=Oa();return t.forEach((f,p)=>{const v=c.get(f);p.isFoundDocument()!==v.isFoundDocument()&&(o=o.add(f)),p.isNoDocument()&&p.version.isEqual(Se.min())?(e.removeEntry(f,p.readTime),d=d.insert(f,p)):!v.isValidDocument()||p.version.compareTo(v.version)>0||p.version.compareTo(v.version)===0&&v.hasPendingWrites?(e.addEntry(p),d=d.insert(f,p)):ge(Zg,"Ignoring outdated watch update for ",f,". Current version:",v.version," Watch version:",p.version)}),{qs:d,Qs:o}})}function ZD(n,e){const t=Me(n);return t.persistence.runTransaction("Get next mutation batch","readonly",a=>(e===void 0&&(e=Fg),t.mutationQueue.getNextMutationBatchAfterBatchId(a,e)))}function JD(n,e){const t=Me(n);return t.persistence.runTransaction("Allocate target","readwrite",a=>{let o;return t.Ti.getTargetData(a,e).next(c=>c?(o=c,le.resolve(o)):t.Ti.allocateTargetId(a).next(d=>(o=new yi(e,d,"TargetPurposeListen",a.currentSequenceNumber),t.Ti.addTargetData(a,o).next(()=>o))))}).then(a=>{const o=t.xs.get(a.targetId);return(o===null||a.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.xs=t.xs.insert(a.targetId,a),t.Os.set(e,a.targetId)),a})}async function ug(n,e,t){const a=Me(n),o=a.xs.get(e),c=t?"readwrite":"readwrite-primary";try{t||await a.persistence.runTransaction("Release target",c,d=>a.persistence.referenceDelegate.removeTarget(d,o))}catch(d){if(!ll(d))throw d;ge(Zg,`Failed to update sequence numbers for target ${e}: ${d}`)}a.xs=a.xs.remove(e),a.Os.delete(o.target)}function NN(n,e,t){const a=Me(n);let o=Se.min(),c=Ye();return a.persistence.runTransaction("Execute query","readwrite",d=>function(p,v,_){const N=Me(p),C=N.Os.get(_);return C!==void 0?le.resolve(N.xs.get(C)):N.Ti.getTargetData(v,_)}(a,d,Ys(e)).next(f=>{if(f)return o=f.lastLimboFreeSnapshotVersion,a.Ti.getMatchingKeysForTargetId(d,f.targetId).next(p=>{c=p})}).next(()=>a.Ms.getDocumentsMatchingQuery(d,e,t?o:Se.min(),t?c:Ye())).next(f=>(eO(a,H1(e),f),{documents:f,$s:c})))}function eO(n,e,t){let a=n.Ns.get(e)||Se.min();t.forEach((o,c)=>{c.readTime.compareTo(a)>0&&(a=c.readTime)}),n.Ns.set(e,a)}class TN{constructor(){this.activeTargetIds=Y1()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class tO{constructor(){this.xo=new TN,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,a){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,a){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new TN,Promise.resolve()}handleUserChange(e,t,a){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xN="ConnectivityMonitor";class AN{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){ge(xN,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){ge(xN,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qd=null;function dg(){return Qd===null?Qd=function(){return 268435456+Math.round(2147483648*Math.random())}():Qd++,"0x"+Qd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ip="RestConnection",sO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class aO{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${a}/databases/${o}`,this.Go=this.databaseId.database===Eh?`project_id=${a}`:`project_id=${a}&database_id=${o}`}zo(e,t,a,o,c){const d=dg(),f=this.jo(e,t.toUriEncodedString());ge(Ip,`Sending RPC '${e}' ${d}:`,f,a);const p={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(p,o,c);const{host:v}=new URL(f),_=Pr(v);return this.Jo(e,f,p,a,_).then(N=>(ge(Ip,`Received RPC '${e}' ${d}: `,N),N),N=>{throw Qo(Ip,`RPC '${e}' ${d} failed with error: `,N,"url: ",f,"request:",a),N})}Yo(e,t,a,o,c,d){return this.zo(e,t,a,o,c)}Ho(e,t,a){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+rl}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((o,c)=>e[c]=o),a&&a.headers.forEach((o,c)=>e[c]=o)}jo(e,t){const a=sO[e];return`${this.Ko}/v1/${t}:${a}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iO{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pn="WebChannelConnection";class rO extends aO{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,a,o,c){const d=dg();return new Promise((f,p)=>{const v=new xx;v.setWithCredentials(!0),v.listenOnce(Ax.COMPLETE,()=>{try{switch(v.getLastErrorCode()){case sh.NO_ERROR:const N=v.getResponseJson();ge(pn,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(N)),f(N);break;case sh.TIMEOUT:ge(pn,`RPC '${e}' ${d} timed out`),p(new pe(re.DEADLINE_EXCEEDED,"Request time out"));break;case sh.HTTP_ERROR:const C=v.getStatus();if(ge(pn,`RPC '${e}' ${d} failed with status:`,C,"response text:",v.getResponseText()),C>0){let j=v.getResponseJson();Array.isArray(j)&&(j=j[0]);const b=j?.error;if(b&&b.status&&b.message){const M=function(L){const $=L.toLowerCase().replace(/_/g,"-");return Object.values(re).indexOf($)>=0?$:re.UNKNOWN}(b.status);p(new pe(M,b.message))}else p(new pe(re.UNKNOWN,"Server responded with status "+v.getStatus()))}else p(new pe(re.UNAVAILABLE,"Connection failed."));break;default:Ae(9055,{h_:e,streamId:d,P_:v.getLastErrorCode(),T_:v.getLastError()})}}finally{ge(pn,`RPC '${e}' ${d} completed.`)}});const _=JSON.stringify(o);ge(pn,`RPC '${e}' ${d} sending request:`,o),v.send(t,"POST",_,a,15)})}I_(e,t,a){const o=dg(),c=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=Sx(),f=jx(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},v=this.longPollingOptions.timeoutSeconds;v!==void 0&&(p.longPollingTimeout=Math.round(1e3*v)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Ho(p.initMessageHeaders,t,a),p.encodeInitMessageHeaders=!0;const _=c.join("");ge(pn,`Creating RPC '${e}' stream ${o}: ${_}`,p);const N=d.createWebChannel(_,p);this.E_(N);let C=!1,j=!1;const b=new iO({Zo:x=>{j?ge(pn,`Not sending because RPC '${e}' stream ${o} is closed:`,x):(C||(ge(pn,`Opening RPC '${e}' stream ${o} transport.`),N.open(),C=!0),ge(pn,`RPC '${e}' stream ${o} sending:`,x),N.send(x))},Xo:()=>N.close()}),M=(x,L,$)=>{x.listen(L,O=>{try{$(O)}catch(U){setTimeout(()=>{throw U},0)}})};return M(N,Cc.EventType.OPEN,()=>{j||(ge(pn,`RPC '${e}' stream ${o} transport opened.`),b.__())}),M(N,Cc.EventType.CLOSE,()=>{j||(j=!0,ge(pn,`RPC '${e}' stream ${o} transport closed`),b.u_(),this.d_(N))}),M(N,Cc.EventType.ERROR,x=>{j||(j=!0,Qo(pn,`RPC '${e}' stream ${o} transport errored. Name:`,x.name,"Message:",x.message),b.u_(new pe(re.UNAVAILABLE,"The operation could not be completed")))}),M(N,Cc.EventType.MESSAGE,x=>{var L;if(!j){const $=x.data[0];Je(!!$,16349);const O=$,U=O?.error||((L=O[0])===null||L===void 0?void 0:L.error);if(U){ge(pn,`RPC '${e}' stream ${o} received error:`,U);const F=U.status;let X=function(R){const I=Mt[R];if(I!==void 0)return u0(I)}(F),w=U.message;X===void 0&&(X=re.INTERNAL,w="Unknown error status: "+F+" with message "+U.message),j=!0,b.u_(new pe(X,w)),N.close()}else ge(pn,`RPC '${e}' stream ${o} received:`,$),b.c_($)}}),M(f,Cx.STAT_EVENT,x=>{x.stat===eg.PROXY?ge(pn,`RPC '${e}' stream ${o} detected buffering proxy`):x.stat===eg.NOPROXY&&ge(pn,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{b.a_()},0),b}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}function Rp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zh(n){return new uD(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(e,t,a=1e3,o=1.5,c=6e4){this.xi=e,this.timerId=t,this.A_=a,this.R_=o,this.V_=c,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),a=Math.max(0,Date.now()-this.g_),o=Math.max(0,t-a);o>0&&ge("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${a} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,o,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CN="PersistentStream";class A0{constructor(e,t,a,o,c,d,f,p){this.xi=e,this.S_=a,this.D_=o,this.connection=c,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=f,this.listener=p,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new Jg(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===re.RESOURCE_EXHAUSTED?(Da(t.toString()),Da("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([a,o])=>{this.v_===t&&this.z_(a,o)},a=>{e(()=>{const o=new pe(re.UNKNOWN,"Fetching auth token failed: "+a.message);return this.j_(o)})})}z_(e,t){const a=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{a(()=>this.listener.e_())}),this.stream.n_(()=>{a(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(o=>{a(()=>this.j_(o))}),this.stream.onMessage(o=>{a(()=>++this.M_==1?this.J_(o):this.onNext(o))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return ge(CN,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(ge(CN,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class oO extends A0{constructor(e,t,a,o,c,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,a,o,d),this.serializer=c}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=mD(this.serializer,e),a=function(c){if(!("targetChange"in c))return Se.min();const d=c.targetChange;return d.targetIds&&d.targetIds.length?Se.min():d.readTime?$n(d.readTime):Se.min()}(e);return this.listener.Y_(t,a)}Z_(e){const t={};t.database=cg(this.serializer),t.addTarget=function(c,d){let f;const p=d.target;if(f=ig(p)?{documents:gD(c,p)}:{query:vD(c,p).gt},f.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){f.resumeToken=f0(c,d.resumeToken);const v=og(c,d.expectedCount);v!==null&&(f.expectedCount=v)}else if(d.snapshotVersion.compareTo(Se.min())>0){f.readTime=Ah(c,d.snapshotVersion.toTimestamp());const v=og(c,d.expectedCount);v!==null&&(f.expectedCount=v)}return f}(this.serializer,e);const a=_D(this.serializer,e);a&&(t.labels=a),this.Q_(t)}X_(e){const t={};t.database=cg(this.serializer),t.removeTarget=e,this.Q_(t)}}class lO extends A0{constructor(e,t,a,o,c,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,a,o,d),this.serializer=c}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return Je(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Je(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){Je(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=pD(e.writeResults,e.commitTime),a=$n(e.commitTime);return this.listener.ra(a,t)}ia(){const e={};e.database=cg(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(a=>v0(this.serializer,a))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{}class uO extends cO{constructor(e,t,a,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=a,this.serializer=o,this.sa=!1}oa(){if(this.sa)throw new pe(re.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,a,o){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,d])=>this.connection.zo(e,lg(t,a),o,c,d)).catch(c=>{throw c.name==="FirebaseError"?(c.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new pe(re.UNKNOWN,c.toString())})}Yo(e,t,a,o,c){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([d,f])=>this.connection.Yo(e,lg(t,a),o,d,f,c)).catch(d=>{throw d.name==="FirebaseError"?(d.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new pe(re.UNKNOWN,d.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class dO{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(Da(t),this.ua=!1):ge("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rr="RemoteStore";class hO{constructor(e,t,a,o,c){this.localStore=e,this.datastore=t,this.asyncQueue=a,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=c,this.Ra.No(d=>{a.enqueueAndForget(async()=>{Vr(this)&&(ge(Rr,"Restarting streams for network reachability change."),await async function(p){const v=Me(p);v.da.add(4),await uu(v),v.Va.set("Unknown"),v.da.delete(4),await Jh(v)}(this))})}),this.Va=new dO(a,o)}}async function Jh(n){if(Vr(n))for(const e of n.Aa)await e(!0)}async function uu(n){for(const e of n.Aa)await e(!1)}function C0(n,e){const t=Me(n);t.Ea.has(e.targetId)||(t.Ea.set(e.targetId,e),sv(t)?nv(t):ul(t).N_()&&tv(t,e))}function ev(n,e){const t=Me(n),a=ul(t);t.Ea.delete(e),a.N_()&&j0(t,e),t.Ea.size===0&&(a.N_()?a.k_():Vr(t)&&t.Va.set("Unknown"))}function tv(n,e){if(n.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Se.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ul(n).Z_(e)}function j0(n,e){n.ma.Ke(e),ul(n).X_(e)}function nv(n){n.ma=new rD({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n.Ea.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),ul(n).start(),n.Va.ca()}function sv(n){return Vr(n)&&!ul(n).O_()&&n.Ea.size>0}function Vr(n){return Me(n).da.size===0}function S0(n){n.ma=void 0}async function fO(n){n.Va.set("Online")}async function mO(n){n.Ea.forEach((e,t)=>{tv(n,e)})}async function pO(n,e){S0(n),sv(n)?(n.Va.Pa(e),nv(n)):n.Va.set("Unknown")}async function gO(n,e,t){if(n.Va.set("Online"),e instanceof h0&&e.state===2&&e.cause)try{await async function(o,c){const d=c.cause;for(const f of c.targetIds)o.Ea.has(f)&&(await o.remoteSyncer.rejectListen(f,d),o.Ea.delete(f),o.ma.removeTarget(f))}(n,e)}catch(a){ge(Rr,"Failed to remove targets %s: %s ",e.targetIds.join(","),a),await Sh(n,a)}else if(e instanceof oh?n.ma.Xe(e):e instanceof d0?n.ma.ot(e):n.ma.nt(e),!t.isEqual(Se.min()))try{const a=await x0(n.localStore);t.compareTo(a)>=0&&await function(c,d){const f=c.ma.It(d);return f.targetChanges.forEach((p,v)=>{if(p.resumeToken.approximateByteSize()>0){const _=c.Ea.get(v);_&&c.Ea.set(v,_.withResumeToken(p.resumeToken,d))}}),f.targetMismatches.forEach((p,v)=>{const _=c.Ea.get(p);if(!_)return;c.Ea.set(p,_.withResumeToken(dn.EMPTY_BYTE_STRING,_.snapshotVersion)),j0(c,p);const N=new yi(_.target,p,v,_.sequenceNumber);tv(c,N)}),c.remoteSyncer.applyRemoteEvent(f)}(n,t)}catch(a){ge(Rr,"Failed to raise snapshot:",a),await Sh(n,a)}}async function Sh(n,e,t){if(!ll(e))throw e;n.da.add(1),await uu(n),n.Va.set("Offline"),t||(t=()=>x0(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{ge(Rr,"Retrying IndexedDB access"),await t(),n.da.delete(1),await Jh(n)})}function w0(n,e){return e().catch(t=>Sh(n,t,e))}async function ef(n){const e=Me(n),t=Si(e);let a=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:Fg;for(;vO(e);)try{const o=await ZD(e.localStore,a);if(o===null){e.Ia.length===0&&t.k_();break}a=o.batchId,yO(e,o)}catch(o){await Sh(e,o)}I0(e)&&R0(e)}function vO(n){return Vr(n)&&n.Ia.length<10}function yO(n,e){n.Ia.push(e);const t=Si(n);t.N_()&&t.ea&&t.ta(e.mutations)}function I0(n){return Vr(n)&&!Si(n).O_()&&n.Ia.length>0}function R0(n){Si(n).start()}async function _O(n){Si(n).ia()}async function EO(n){const e=Si(n);for(const t of n.Ia)e.ta(t.mutations)}async function bO(n,e,t){const a=n.Ia.shift(),o=$g.from(a,e,t);await w0(n,()=>n.remoteSyncer.applySuccessfulWrite(o)),await ef(n)}async function NO(n,e){e&&Si(n).ea&&await async function(a,o){if(function(d){return c0(d)&&d!==re.ABORTED}(o.code)){const c=a.Ia.shift();Si(a).L_(),await w0(a,()=>a.remoteSyncer.rejectFailedWrite(c.batchId,o)),await ef(a)}}(n,e),I0(n)&&R0(n)}async function jN(n,e){const t=Me(n);t.asyncQueue.verifyOperationInProgress(),ge(Rr,"RemoteStore received new credentials");const a=Vr(t);t.da.add(3),await uu(t),a&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await Jh(t)}async function TO(n,e){const t=Me(n);e?(t.da.delete(2),await Jh(t)):e||(t.da.add(2),await uu(t),t.Va.set("Unknown"))}function ul(n){return n.fa||(n.fa=function(t,a,o){const c=Me(t);return c.oa(),new oO(a,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)}(n.datastore,n.asyncQueue,{e_:fO.bind(null,n),n_:mO.bind(null,n),i_:pO.bind(null,n),Y_:gO.bind(null,n)}),n.Aa.push(async e=>{e?(n.fa.L_(),sv(n)?nv(n):n.Va.set("Unknown")):(await n.fa.stop(),S0(n))})),n.fa}function Si(n){return n.ga||(n.ga=function(t,a,o){const c=Me(t);return c.oa(),new lO(a,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)}(n.datastore,n.asyncQueue,{e_:()=>Promise.resolve(),n_:_O.bind(null,n),i_:NO.bind(null,n),na:EO.bind(null,n),ra:bO.bind(null,n)}),n.Aa.push(async e=>{e?(n.ga.L_(),await ef(n)):(await n.ga.stop(),n.Ia.length>0&&(ge(Rr,`Stopping write stream with ${n.Ia.length} pending writes`),n.Ia=[]))})),n.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(e,t,a,o,c){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=a,this.op=o,this.removalCallback=c,this.deferred=new $s,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(d=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,a,o,c){const d=Date.now()+a,f=new av(e,t,d,o,c);return f.start(a),f}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new pe(re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function iv(n,e){if(Da("AsyncQueue",`${e}: ${n}`),ll(n))return new pe(re.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o{static emptySet(e){return new $o(e.comparator)}constructor(e){this.comparator=e?(t,a)=>e(t,a)||Ne.comparator(t.key,a.key):(t,a)=>Ne.comparator(t.key,a.key),this.keyedMap=jc(),this.sortedSet=new Et(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,a)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof $o)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),a=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=a.getNext().key;if(!o.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const a=new $o;return a.comparator=this.comparator,a.keyedMap=e,a.sortedSet=t,a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SN{constructor(){this.pa=new Et(Ne.comparator)}track(e){const t=e.doc.key,a=this.pa.get(t);a?e.type!==0&&a.type===3?this.pa=this.pa.insert(t,e):e.type===3&&a.type!==1?this.pa=this.pa.insert(t,{type:a.type,doc:e.doc}):e.type===2&&a.type===2?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):e.type===2&&a.type===0?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):e.type===1&&a.type===0?this.pa=this.pa.remove(t):e.type===1&&a.type===2?this.pa=this.pa.insert(t,{type:1,doc:a.doc}):e.type===0&&a.type===1?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):Ae(63341,{Vt:e,ya:a}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal((t,a)=>{e.push(a)}),e}}class el{constructor(e,t,a,o,c,d,f,p,v){this.query=e,this.docs=t,this.oldDocs=a,this.docChanges=o,this.mutatedKeys=c,this.fromCache=d,this.syncStateChanged=f,this.excludesMetadataChanges=p,this.hasCachedResults=v}static fromInitialDocuments(e,t,a,o,c){const d=[];return t.forEach(f=>{d.push({type:0,doc:f})}),new el(e,t,$o.emptySet(t),d,a,o,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&$h(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,a=e.docChanges;if(t.length!==a.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==a[o].type||!t[o].doc.isEqual(a[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xO{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class AO{constructor(){this.queries=wN(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,a){const o=Me(t),c=o.queries;o.queries=wN(),c.forEach((d,f)=>{for(const p of f.Sa)p.onError(a)})})(this,new pe(re.ABORTED,"Firestore shutting down"))}}function wN(){return new Lr(n=>Xx(n),$h)}async function rv(n,e){const t=Me(n);let a=3;const o=e.query;let c=t.queries.get(o);c?!c.Da()&&e.va()&&(a=2):(c=new xO,a=e.va()?0:1);try{switch(a){case 0:c.ba=await t.onListen(o,!0);break;case 1:c.ba=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(d){const f=iv(d,`Initialization of query '${ko(e.query)}' failed`);return void e.onError(f)}t.queries.set(o,c),c.Sa.push(e),e.Fa(t.onlineState),c.ba&&e.Ma(c.ba)&&lv(t)}async function ov(n,e){const t=Me(n),a=e.query;let o=3;const c=t.queries.get(a);if(c){const d=c.Sa.indexOf(e);d>=0&&(c.Sa.splice(d,1),c.Sa.length===0?o=e.va()?0:1:!c.Da()&&e.va()&&(o=2))}switch(o){case 0:return t.queries.delete(a),t.onUnlisten(a,!0);case 1:return t.queries.delete(a),t.onUnlisten(a,!1);case 2:return t.onLastRemoteStoreUnlisten(a);default:return}}function CO(n,e){const t=Me(n);let a=!1;for(const o of e){const c=o.query,d=t.queries.get(c);if(d){for(const f of d.Sa)f.Ma(o)&&(a=!0);d.ba=o}}a&&lv(t)}function jO(n,e,t){const a=Me(n),o=a.queries.get(e);if(o)for(const c of o.Sa)c.onError(t);a.queries.delete(e)}function lv(n){n.Ca.forEach(e=>{e.next()})}var hg,IN;(IN=hg||(hg={})).xa="default",IN.Cache="cache";class cv{constructor(e,t,a){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=a||{}}Ma(e){if(!this.options.includeMetadataChanges){const a=[];for(const o of e.docChanges)o.type!==3&&a.push(o);e=new el(e.query,e.docs,e.oldDocs,a,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache||!this.va())return!0;const a=t!=="Offline";return(!this.options.Qa||!a)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}qa(e){e=el.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==hg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D0{constructor(e){this.key=e}}class O0{constructor(e){this.key=e}}class SO{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Ye(),this.mutatedKeys=Ye(),this.Za=Wx(e),this.Xa=new $o(this.Za)}get eu(){return this.Ha}tu(e,t){const a=t?t.nu:new SN,o=t?t.Xa:this.Xa;let c=t?t.mutatedKeys:this.mutatedKeys,d=o,f=!1;const p=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,v=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((_,N)=>{const C=o.get(_),j=Yh(this.query,N)?N:null,b=!!C&&this.mutatedKeys.has(C.key),M=!!j&&(j.hasLocalMutations||this.mutatedKeys.has(j.key)&&j.hasCommittedMutations);let x=!1;C&&j?C.data.isEqual(j.data)?b!==M&&(a.track({type:3,doc:j}),x=!0):this.ru(C,j)||(a.track({type:2,doc:j}),x=!0,(p&&this.Za(j,p)>0||v&&this.Za(j,v)<0)&&(f=!0)):!C&&j?(a.track({type:0,doc:j}),x=!0):C&&!j&&(a.track({type:1,doc:C}),x=!0,(p||v)&&(f=!0)),x&&(j?(d=d.add(j),c=M?c.add(_):c.delete(_)):(d=d.delete(_),c=c.delete(_)))}),this.query.limit!==null)for(;d.size>this.query.limit;){const _=this.query.limitType==="F"?d.last():d.first();d=d.delete(_.key),c=c.delete(_.key),a.track({type:1,doc:_})}return{Xa:d,nu:a,Cs:f,mutatedKeys:c}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,a,o){const c=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const d=e.nu.wa();d.sort((_,N)=>function(j,b){const M=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ae(20277,{Vt:x})}};return M(j)-M(b)}(_.type,N.type)||this.Za(_.doc,N.doc)),this.iu(a),o=o!=null&&o;const f=t&&!o?this.su():[],p=this.Ya.size===0&&this.current&&!o?1:0,v=p!==this.Ja;return this.Ja=p,d.length!==0||v?{snapshot:new el(this.query,e.Xa,c,d,e.mutatedKeys,p===0,v,!1,!!a&&a.resumeToken.approximateByteSize()>0),ou:f}:{ou:f}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new SN,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=Ye(),this.Xa.forEach(a=>{this._u(a.key)&&(this.Ya=this.Ya.add(a.key))});const t=[];return e.forEach(a=>{this.Ya.has(a)||t.push(new O0(a))}),this.Ya.forEach(a=>{e.has(a)||t.push(new D0(a))}),t}au(e){this.Ha=e.$s,this.Ya=Ye();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return el.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const uv="SyncEngine";class wO{constructor(e,t,a){this.query=e,this.targetId=t,this.view=a}}class IO{constructor(e){this.key=e,this.cu=!1}}class RO{constructor(e,t,a,o,c,d){this.localStore=e,this.remoteStore=t,this.eventManager=a,this.sharedClientState=o,this.currentUser=c,this.maxConcurrentLimboResolutions=d,this.lu={},this.hu=new Lr(f=>Xx(f),$h),this.Pu=new Map,this.Tu=new Set,this.Iu=new Et(Ne.comparator),this.Eu=new Map,this.du=new Qg,this.Au={},this.Ru=new Map,this.Vu=Jo.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function DO(n,e,t=!0){const a=U0(n);let o;const c=a.hu.get(e);return c?(a.sharedClientState.addLocalQueryTarget(c.targetId),o=c.view.uu()):o=await M0(a,e,t,!0),o}async function OO(n,e){const t=U0(n);await M0(t,e,!0,!1)}async function M0(n,e,t,a){const o=await JD(n.localStore,Ys(e)),c=o.targetId,d=n.sharedClientState.addLocalQueryTarget(c,t);let f;return a&&(f=await MO(n,e,c,d==="current",o.resumeToken)),n.isPrimaryClient&&t&&C0(n.remoteStore,o),f}async function MO(n,e,t,a,o){n.fu=(N,C,j)=>async function(M,x,L,$){let O=x.view.tu(L);O.Cs&&(O=await NN(M.localStore,x.query,!1).then(({documents:w})=>x.view.tu(w,O)));const U=$&&$.targetChanges.get(x.targetId),F=$&&$.targetMismatches.get(x.targetId)!=null,X=x.view.applyChanges(O,M.isPrimaryClient,U,F);return DN(M,x.targetId,X.ou),X.snapshot}(n,N,C,j);const c=await NN(n.localStore,e,!0),d=new SO(e,c.$s),f=d.tu(c.documents),p=cu.createSynthesizedTargetChangeForCurrentChange(t,a&&n.onlineState!=="Offline",o),v=d.applyChanges(f,n.isPrimaryClient,p);DN(n,t,v.ou);const _=new wO(e,t,d);return n.hu.set(e,_),n.Pu.has(t)?n.Pu.get(t).push(e):n.Pu.set(t,[e]),v.snapshot}async function PO(n,e,t){const a=Me(n),o=a.hu.get(e),c=a.Pu.get(o.targetId);if(c.length>1)return a.Pu.set(o.targetId,c.filter(d=>!$h(d,e))),void a.hu.delete(e);a.isPrimaryClient?(a.sharedClientState.removeLocalQueryTarget(o.targetId),a.sharedClientState.isActiveQueryTarget(o.targetId)||await ug(a.localStore,o.targetId,!1).then(()=>{a.sharedClientState.clearQueryState(o.targetId),t&&ev(a.remoteStore,o.targetId),fg(a,o.targetId)}).catch(ol)):(fg(a,o.targetId),await ug(a.localStore,o.targetId,!0))}async function kO(n,e){const t=Me(n),a=t.hu.get(e),o=t.Pu.get(a.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(a.targetId),ev(t.remoteStore,a.targetId))}async function LO(n,e,t){const a=zO(n);try{const o=await function(d,f){const p=Me(d),v=qt.now(),_=f.reduce((j,b)=>j.add(b.key),Ye());let N,C;return p.persistence.runTransaction("Locally write mutations","readwrite",j=>{let b=Oa(),M=Ye();return p.Bs.getEntries(j,_).next(x=>{b=x,b.forEach((L,$)=>{$.isValidDocument()||(M=M.add(L))})}).next(()=>p.localDocuments.getOverlayedDocuments(j,b)).next(x=>{N=x;const L=[];for(const $ of f){const O=tD($,N.get($.key).overlayedDocument);O!=null&&L.push(new Vi($.key,O,qx(O.value.mapValue),cn.exists(!0)))}return p.mutationQueue.addMutationBatch(j,v,L,f)}).next(x=>{C=x;const L=x.applyToLocalDocumentSet(N,M);return p.documentOverlayCache.saveOverlays(j,x.batchId,L)})}).then(()=>({batchId:C.batchId,changes:Jx(N)}))}(a.localStore,e);a.sharedClientState.addPendingMutation(o.batchId),function(d,f,p){let v=d.Au[d.currentUser.toKey()];v||(v=new Et(Ue)),v=v.insert(f,p),d.Au[d.currentUser.toKey()]=v}(a,o.batchId,t),await du(a,o.changes),await ef(a.remoteStore)}catch(o){const c=iv(o,"Failed to persist write");t.reject(c)}}async function P0(n,e){const t=Me(n);try{const a=await XD(t.localStore,e);e.targetChanges.forEach((o,c)=>{const d=t.Eu.get(c);d&&(Je(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.cu=!0:o.modifiedDocuments.size>0?Je(d.cu,14607):o.removedDocuments.size>0&&(Je(d.cu,42227),d.cu=!1))}),await du(t,a,e)}catch(a){await ol(a)}}function RN(n,e,t){const a=Me(n);if(a.isPrimaryClient&&t===0||!a.isPrimaryClient&&t===1){const o=[];a.hu.forEach((c,d)=>{const f=d.view.Fa(e);f.snapshot&&o.push(f.snapshot)}),function(d,f){const p=Me(d);p.onlineState=f;let v=!1;p.queries.forEach((_,N)=>{for(const C of N.Sa)C.Fa(f)&&(v=!0)}),v&&lv(p)}(a.eventManager,e),o.length&&a.lu.Y_(o),a.onlineState=e,a.isPrimaryClient&&a.sharedClientState.setOnlineState(e)}}async function VO(n,e,t){const a=Me(n);a.sharedClientState.updateQueryState(e,"rejected",t);const o=a.Eu.get(e),c=o&&o.key;if(c){let d=new Et(Ne.comparator);d=d.insert(c,Zt.newNoDocument(c,Se.min()));const f=Ye().add(c),p=new Wh(Se.min(),new Map,new Et(Ue),d,f);await P0(a,p),a.Iu=a.Iu.remove(c),a.Eu.delete(e),dv(a)}else await ug(a.localStore,e,!1).then(()=>fg(a,e,t)).catch(ol)}async function UO(n,e){const t=Me(n),a=e.batch.batchId;try{const o=await QD(t.localStore,e);L0(t,a,null),k0(t,a),t.sharedClientState.updateMutationState(a,"acknowledged"),await du(t,o)}catch(o){await ol(o)}}async function FO(n,e,t){const a=Me(n);try{const o=await function(d,f){const p=Me(d);return p.persistence.runTransaction("Reject batch","readwrite-primary",v=>{let _;return p.mutationQueue.lookupMutationBatch(v,f).next(N=>(Je(N!==null,37113),_=N.keys(),p.mutationQueue.removeMutationBatch(v,N))).next(()=>p.mutationQueue.performConsistencyCheck(v)).next(()=>p.documentOverlayCache.removeOverlaysForBatchId(v,_,f)).next(()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(v,_)).next(()=>p.localDocuments.getDocuments(v,_))})}(a.localStore,e);L0(a,e,t),k0(a,e),a.sharedClientState.updateMutationState(e,"rejected",t),await du(a,o)}catch(o){await ol(o)}}function k0(n,e){(n.Ru.get(e)||[]).forEach(t=>{t.resolve()}),n.Ru.delete(e)}function L0(n,e,t){const a=Me(n);let o=a.Au[a.currentUser.toKey()];if(o){const c=o.get(e);c&&(t?c.reject(t):c.resolve(),o=o.remove(e)),a.Au[a.currentUser.toKey()]=o}}function fg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const a of n.Pu.get(e))n.hu.delete(a),t&&n.lu.gu(a,t);n.Pu.delete(e),n.isPrimaryClient&&n.du.Hr(e).forEach(a=>{n.du.containsKey(a)||V0(n,a)})}function V0(n,e){n.Tu.delete(e.path.canonicalString());const t=n.Iu.get(e);t!==null&&(ev(n.remoteStore,t),n.Iu=n.Iu.remove(e),n.Eu.delete(t),dv(n))}function DN(n,e,t){for(const a of t)a instanceof D0?(n.du.addReference(a.key,e),HO(n,a)):a instanceof O0?(ge(uv,"Document no longer in limbo: "+a.key),n.du.removeReference(a.key,e),n.du.containsKey(a.key)||V0(n,a.key)):Ae(19791,{pu:a})}function HO(n,e){const t=e.key,a=t.path.canonicalString();n.Iu.get(t)||n.Tu.has(a)||(ge(uv,"New document in limbo: "+t),n.Tu.add(a),dv(n))}function dv(n){for(;n.Tu.size>0&&n.Iu.size<n.maxConcurrentLimboResolutions;){const e=n.Tu.values().next().value;n.Tu.delete(e);const t=new Ne(ft.fromString(e)),a=n.Vu.next();n.Eu.set(a,new IO(t)),n.Iu=n.Iu.insert(t,a),C0(n.remoteStore,new yi(Ys(Gh(t.path)),a,"TargetPurposeLimboResolution",Bh.le))}}async function du(n,e,t){const a=Me(n),o=[],c=[],d=[];a.hu.isEmpty()||(a.hu.forEach((f,p)=>{d.push(a.fu(p,e,t).then(v=>{var _;if((v||t)&&a.isPrimaryClient){const N=v?!v.fromCache:(_=t?.targetChanges.get(p.targetId))===null||_===void 0?void 0:_.current;a.sharedClientState.updateQueryState(p.targetId,N?"current":"not-current")}if(v){o.push(v);const N=Wg.Rs(p.targetId,v);c.push(N)}}))}),await Promise.all(d),a.lu.Y_(o),await async function(p,v){const _=Me(p);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",N=>le.forEach(v,C=>le.forEach(C.ds,j=>_.persistence.referenceDelegate.addReference(N,C.targetId,j)).next(()=>le.forEach(C.As,j=>_.persistence.referenceDelegate.removeReference(N,C.targetId,j)))))}catch(N){if(!ll(N))throw N;ge(Zg,"Failed to update sequence numbers: "+N)}for(const N of v){const C=N.targetId;if(!N.fromCache){const j=_.xs.get(C),b=j.snapshotVersion,M=j.withLastLimboFreeSnapshotVersion(b);_.xs=_.xs.insert(C,M)}}}(a.localStore,c))}async function qO(n,e){const t=Me(n);if(!t.currentUser.isEqual(e)){ge(uv,"User change. New user:",e.toKey());const a=await T0(t.localStore,e);t.currentUser=e,function(c,d){c.Ru.forEach(f=>{f.forEach(p=>{p.reject(new pe(re.CANCELLED,d))})}),c.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,a.removedBatchIds,a.addedBatchIds),await du(t,a.ks)}}function BO(n,e){const t=Me(n),a=t.Eu.get(e);if(a&&a.cu)return Ye().add(a.key);{let o=Ye();const c=t.Pu.get(e);if(!c)return o;for(const d of c){const f=t.hu.get(d);o=o.unionWith(f.view.eu)}return o}}function U0(n){const e=Me(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=P0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=BO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=VO.bind(null,e),e.lu.Y_=CO.bind(null,e.eventManager),e.lu.gu=jO.bind(null,e.eventManager),e}function zO(n){const e=Me(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=UO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=FO.bind(null,e),e}class wh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Zh(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return KD(this.persistence,new GD,e.initialUser,this.serializer)}Su(e){return new N0(Xg.fi,this.serializer)}bu(e){return new tO}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}wh.provider={build:()=>new wh};class GO extends wh{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){Je(this.persistence.referenceDelegate instanceof jh,46915);const a=this.persistence.referenceDelegate.garbageCollector;return new ID(a,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?Rn.withCacheSize(this.cacheSizeBytes):Rn.DEFAULT;return new N0(a=>jh.fi(a,t),this.serializer)}}class mg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=a=>RN(this.syncEngine,a,1),this.remoteStore.remoteSyncer.handleCredentialChange=qO.bind(null,this.syncEngine),await TO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new AO}()}createDatastore(e){const t=Zh(e.databaseInfo.databaseId),a=function(c){return new rO(c)}(e.databaseInfo);return function(c,d,f,p){return new uO(c,d,f,p)}(e.authCredentials,e.appCheckCredentials,a,t)}createRemoteStore(e){return function(a,o,c,d,f){return new hO(a,o,c,d,f)}(this.localStore,this.datastore,e.asyncQueue,t=>RN(this.syncEngine,t,0),function(){return AN.C()?new AN:new nO}())}createSyncEngine(e,t){return function(o,c,d,f,p,v,_){const N=new RO(o,c,d,f,p,v);return _&&(N.mu=!0),N}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(o){const c=Me(o);ge(Rr,"RemoteStore shutting down."),c.da.add(5),await uu(c),c.Ra.shutdown(),c.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}mg.provider={build:()=>new mg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):Da("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $O{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new pe(re.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(o,c){const d=Me(o),f={documents:c.map(N=>Ch(d.serializer,N))},p=await d.Yo("BatchGetDocuments",d.serializer.databaseId,ft.emptyPath(),f,c.length),v=new Map;p.forEach(N=>{const C=fD(d.serializer,N);v.set(C.key.toString(),C)});const _=[];return c.forEach(N=>{const C=v.get(N.toString());Je(!!C,55234,{key:N}),_.push(C)}),_}(this.datastore,e);return t.forEach(a=>this.recordVersion(a)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(a){this.lastTransactionError=a}this.writtenDocs.add(e.toString())}delete(e){this.write(new Xh(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,a)=>{const o=Ne.fromPath(a);this.mutations.push(new l0(o,this.precondition(o)))}),await async function(a,o){const c=Me(a),d={writes:o.map(f=>v0(c.serializer,f))};await c.zo("Commit",c.serializer.databaseId,ft.emptyPath(),d)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Ae(50498,{Uu:e.constructor.name});t=Se.min()}const a=this.readVersions.get(e.key.toString());if(a){if(!t.isEqual(a))throw new pe(re.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Se.min())?cn.exists(!1):cn.updateTime(t):cn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Se.min()))throw new pe(re.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return cn.updateTime(t)}return cn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YO{constructor(e,t,a,o,c){this.asyncQueue=e,this.datastore=t,this.options=a,this.updateFunction=o,this.deferred=c,this.Ku=a.maxAttempts,this.x_=new Jg(this.asyncQueue,"transaction_retry")}Wu(){this.Ku-=1,this.Gu()}Gu(){this.x_.y_(async()=>{const e=new $O(this.datastore),t=this.zu(e);t&&t.then(a=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(a)}).catch(o=>{this.ju(o)}))}).catch(a=>{this.ju(a)})})}zu(e){try{const t=this.updateFunction(e);return!ou(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ju(e){this.Ku>0&&this.Hu(e)?(this.Ku-=1,this.asyncQueue.enqueueAndForget(()=>(this.Gu(),Promise.resolve()))):this.deferred.reject(e)}Hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!c0(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wi="FirestoreClient";class KO{constructor(e,t,a,o,c){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=a,this.databaseInfo=o,this.user=gn.UNAUTHENTICATED,this.clientId=Dx.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(a,async d=>{ge(wi,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d}),this.appCheckCredentials.start(a,d=>(ge(wi,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new $s;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const a=iv(t,"Failed to shutdown persistence");e.reject(a)}}),e.promise}}async function Dp(n,e){n.asyncQueue.verifyOperationInProgress(),ge(wi,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let a=t.initialUser;n.setCredentialChangeListener(async o=>{a.isEqual(o)||(await T0(e.localStore,o),a=o)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function ON(n,e){n.asyncQueue.verifyOperationInProgress();const t=await QO(n);ge(wi,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(a=>jN(e.remoteStore,a)),n.setAppCheckTokenChangeListener((a,o)=>jN(e.remoteStore,o)),n._onlineComponents=e}async function QO(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ge(wi,"Using user provided OfflineComponentProvider");try{await Dp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(o){return o.name==="FirebaseError"?o.code===re.FAILED_PRECONDITION||o.code===re.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(t))throw t;Qo("Error using user provided cache. Falling back to memory cache: "+t),await Dp(n,new wh)}}else ge(wi,"Using default OfflineComponentProvider"),await Dp(n,new GO(void 0));return n._offlineComponents}async function fv(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ge(wi,"Using user provided OnlineComponentProvider"),await ON(n,n._uninitializedComponentsProvider._online)):(ge(wi,"Using default OnlineComponentProvider"),await ON(n,new mg))),n._onlineComponents}function XO(n){return fv(n).then(e=>e.syncEngine)}function WO(n){return fv(n).then(e=>e.datastore)}async function Ih(n){const e=await fv(n),t=e.eventManager;return t.onListen=DO.bind(null,e.syncEngine),t.onUnlisten=PO.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=OO.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=kO.bind(null,e.syncEngine),t}function ZO(n,e,t={}){const a=new $s;return n.asyncQueue.enqueueAndForget(async()=>function(c,d,f,p,v){const _=new hv({next:C=>{_.xu(),d.enqueueAndForget(()=>ov(c,N));const j=C.docs.has(f);!j&&C.fromCache?v.reject(new pe(re.UNAVAILABLE,"Failed to get document because the client is offline.")):j&&C.fromCache&&p&&p.source==="server"?v.reject(new pe(re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):v.resolve(C)},error:C=>v.reject(C)}),N=new cv(Gh(f.path),_,{includeMetadataChanges:!0,Qa:!0});return rv(c,N)}(await Ih(n),n.asyncQueue,e,t,a)),a.promise}function JO(n,e,t={}){const a=new $s;return n.asyncQueue.enqueueAndForget(async()=>function(c,d,f,p,v){const _=new hv({next:C=>{_.xu(),d.enqueueAndForget(()=>ov(c,N)),C.fromCache&&p.source==="server"?v.reject(new pe(re.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):v.resolve(C)},error:C=>v.reject(C)}),N=new cv(f,_,{includeMetadataChanges:!0,Qa:!0});return rv(c,N)}(await Ih(n),n.asyncQueue,e,t,a)),a.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F0(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MN=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H0(n,e,t){if(!t)throw new pe(re.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function eM(n,e,t,a){if(e===!0&&a===!0)throw new pe(re.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function PN(n){if(!Ne.isDocumentKey(n))throw new pe(re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function kN(n){if(Ne.isDocumentKey(n))throw new pe(re.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function tf(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(a){return a.constructor?a.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ae(12329,{type:typeof n})}function jn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new pe(re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=tf(n);throw new pe(re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q0="firestore.googleapis.com",LN=!0;class VN{constructor(e){var t,a;if(e.host===void 0){if(e.ssl!==void 0)throw new pe(re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=q0,this.ssl=LN}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:LN;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=b0;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<SD)throw new pe(re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}eM("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=F0((a=e.experimentalLongPollingOptions)!==null&&a!==void 0?a:{}),function(c){if(c.timeoutSeconds!==void 0){if(isNaN(c.timeoutSeconds))throw new pe(re.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (must not be NaN)`);if(c.timeoutSeconds<5)throw new pe(re.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (minimum allowed value is 5)`);if(c.timeoutSeconds>30)throw new pe(re.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(a,o){return a.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class nf{constructor(e,t,a,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=a,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new VN({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new pe(re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new pe(re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new VN(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(a){if(!a)return new r1;switch(a.type){case"firstParty":return new u1(a.sessionIndex||"0",a.iamToken||null,a.authTokenFactory||null);case"provider":return a.client;default:throw new pe(re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const a=MN.get(t);a&&(ge("ComponentProvider","Removing Datastore"),MN.delete(t),a.terminate())}(this),Promise.resolve()}}function tM(n,e,t,a={}){var o;n=jn(n,nf);const c=Pr(e),d=n._getSettings(),f=Object.assign(Object.assign({},d),{emulatorOptions:n._getEmulatorOptions()}),p=`${e}:${t}`;c&&(Tg(`https://${p}`),xg("Firestore",!0)),d.host!==q0&&d.host!==p&&Qo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const v=Object.assign(Object.assign({},d),{host:p,ssl:c,emulatorOptions:a});if(!Ti(v,f)&&(n._setSettings(v),a.mockUserToken)){let _,N;if(typeof a.mockUserToken=="string")_=a.mockUserToken,N=gn.MOCK_USER;else{_=PT(a.mockUserToken,(o=n._app)===null||o===void 0?void 0:o.options.projectId);const C=a.mockUserToken.sub||a.mockUserToken.user_id;if(!C)throw new pe(re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");N=new gn(C)}n._authCredentials=new o1(new Ix(_,N))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e,t,a){this.converter=t,this._query=a,this.type="query",this.firestore=e}withConverter(e){return new Pa(this.firestore,e,this._query)}}class un{constructor(e,t,a){this.converter=t,this._key=a,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ni(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new un(this.firestore,e,this._key)}}class Ni extends Pa{constructor(e,t,a){super(e,t,Gh(a)),this._path=a,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new un(this.firestore,null,new Ne(e))}withConverter(e){return new Ni(this.firestore,e,this._path)}}function et(n,e,...t){if(n=gt(n),H0("collection","path",e),n instanceof nf){const a=ft.fromString(e,...t);return kN(a),new Ni(n,null,a)}{if(!(n instanceof un||n instanceof Ni))throw new pe(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=n._path.child(ft.fromString(e,...t));return kN(a),new Ni(n.firestore,null,a)}}function xt(n,e,...t){if(n=gt(n),arguments.length===1&&(e=Dx.newId()),H0("doc","path",e),n instanceof nf){const a=ft.fromString(e,...t);return PN(a),new un(n,null,new Ne(a))}{if(!(n instanceof un||n instanceof Ni))throw new pe(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=n._path.child(ft.fromString(e,...t));return PN(a),new un(n.firestore,n instanceof Ni?n.converter:null,new Ne(a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UN="AsyncQueue";class FN{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new Jg(this,"async_queue_retry"),this.rc=()=>{const a=Rp();a&&ge(UN,"Visibility state changed to "+a.visibilityState),this.x_.b_()},this.sc=e;const t=Rp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=Rp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new $s;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!ll(e))throw e;ge(UN,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(a=>{throw this.Xu=a,this.ec=!1,Da("INTERNAL UNHANDLED ERROR: ",HN(a)),a}).then(a=>(this.ec=!1,a))));return this.sc=t,t}enqueueAfterDelay(e,t,a){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const o=av.createAndSchedule(this,e,t,a,c=>this.uc(c));return this.Zu.push(o),o}oc(){this.Xu&&Ae(47125,{cc:HN(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,a)=>t.targetTimeMs-a.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function HN(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qN(n){return function(t,a){if(typeof t!="object"||t===null)return!1;const o=t;for(const c of a)if(c in o&&typeof o[c]=="function")return!0;return!1}(n,["next","error","complete"])}class Qs extends nf{constructor(e,t,a,o){super(e,t,a,o),this.type="firestore",this._queue=new FN,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new FN(e),this._firestoreClient=void 0,await e}}}function nM(n,e){const t=typeof n=="object"?n:nu(),a=typeof n=="string"?n:Eh,o=Ma(t,"firestore").getImmediate({identifier:a});if(!o._initialized){const c=DT("firestore");c&&tM(o,...c)}return o}function hu(n){if(n._terminated)throw new pe(re.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||sM(n),n._firestoreClient}function sM(n){var e,t,a;const o=n._freezeSettings(),c=function(f,p,v,_){return new A1(f,p,v,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,F0(_.experimentalLongPollingOptions),_.useFetchStreams,_.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,o);n._componentsProvider||!((t=o.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((a=o.localCache)===null||a===void 0)&&a._onlineComponentProvider)&&(n._componentsProvider={_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider}),n._firestoreClient=new KO(n._authCredentials,n._appCheckCredentials,n._queue,c,n._componentsProvider&&function(f){const p=f?._online.build();return{_offline:f?._offline.build(p),_online:p}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Dr(dn.fromBase64String(e))}catch(t){throw new pe(re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Dr(dn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new pe(re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ln(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mv{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new pe(re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new pe(re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ue(this._lat,e._lat)||Ue(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(a,o){if(a.length!==o.length)return!1;for(let c=0;c<a.length;++c)if(a[c]!==o[c])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aM=/^__.*__$/;class iM{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return this.fieldMask!==null?new Vi(e,this.data,this.fieldMask,t,this.fieldTransforms):new lu(e,this.data,t,this.fieldTransforms)}}class B0{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return new Vi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function z0(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ae(40011,{Ic:n})}}class gv{constructor(e,t,a,o,c,d){this.settings=e,this.databaseId=t,this.serializer=a,this.ignoreUndefinedProperties=o,c===void 0&&this.Ec(),this.fieldTransforms=c||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new gv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const a=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:a,Rc:!1});return o.Vc(e),o}mc(e){var t;const a=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:a,Rc:!1});return o.Ec(),o}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return Rh(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(z0(this.Ic)&&aM.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class rM{constructor(e,t,a){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=a||Zh(e)}bc(e,t,a,o=!1){return new gv({Ic:e,methodName:t,wc:a,path:ln.emptyPath(),Rc:!1,yc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function mu(n){const e=n._freezeSettings(),t=Zh(n._databaseId);return new rM(n._databaseId,!!e.ignoreUndefinedProperties,t)}function vv(n,e,t,a,o,c={}){const d=n.bc(c.merge||c.mergeFields?2:0,e,t,o);_v("Data must be an object, but it was:",d,a);const f=Y0(a,d);let p,v;if(c.merge)p=new zn(d.fieldMask),v=d.fieldTransforms;else if(c.mergeFields){const _=[];for(const N of c.mergeFields){const C=pg(e,N,t);if(!d.contains(C))throw new pe(re.INVALID_ARGUMENT,`Field '${C}' is specified in your field mask but missing from your input data.`);Q0(_,C)||_.push(C)}p=new zn(_),v=d.fieldTransforms.filter(N=>p.covers(N.field))}else p=null,v=d.fieldTransforms;return new iM(new Cn(f),p,v)}class af extends sf{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof af}}class yv extends sf{_toFieldTransform(e){return new W1(e.path,new Xc)}isEqual(e){return e instanceof yv}}function G0(n,e,t,a){const o=n.bc(1,e,t);_v("Data must be an object, but it was:",o,a);const c=[],d=Cn.empty();Li(a,(p,v)=>{const _=Ev(e,p,t);v=gt(v);const N=o.mc(_);if(v instanceof af)c.push(_);else{const C=pu(v,N);C!=null&&(c.push(_),d.set(_,C))}});const f=new zn(c);return new B0(d,f,o.fieldTransforms)}function $0(n,e,t,a,o,c){const d=n.bc(1,e,t),f=[pg(e,a,t)],p=[o];if(c.length%2!=0)throw new pe(re.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let C=0;C<c.length;C+=2)f.push(pg(e,c[C])),p.push(c[C+1]);const v=[],_=Cn.empty();for(let C=f.length-1;C>=0;--C)if(!Q0(v,f[C])){const j=f[C];let b=p[C];b=gt(b);const M=d.mc(j);if(b instanceof af)v.push(j);else{const x=pu(b,M);x!=null&&(v.push(j),_.set(j,x))}}const N=new zn(v);return new B0(_,N,d.fieldTransforms)}function oM(n,e,t,a=!1){return pu(t,n.bc(a?4:3,e))}function pu(n,e){if(K0(n=gt(n)))return _v("Unsupported field value:",e,n),Y0(n,e);if(n instanceof sf)return function(a,o){if(!z0(o.Ic))throw o.gc(`${a._methodName}() can only be used with update() and set()`);if(!o.path)throw o.gc(`${a._methodName}() is not currently supported inside arrays`);const c=a._toFieldTransform(o);c&&o.fieldTransforms.push(c)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(a,o){const c=[];let d=0;for(const f of a){let p=pu(f,o.fc(d));p==null&&(p={nullValue:"NULL_VALUE"}),c.push(p),d++}return{arrayValue:{values:c}}}(n,e)}return function(a,o){if((a=gt(a))===null)return{nullValue:"NULL_VALUE"};if(typeof a=="number")return K1(o.serializer,a);if(typeof a=="boolean")return{booleanValue:a};if(typeof a=="string")return{stringValue:a};if(a instanceof Date){const c=qt.fromDate(a);return{timestampValue:Ah(o.serializer,c)}}if(a instanceof qt){const c=new qt(a.seconds,1e3*Math.floor(a.nanoseconds/1e3));return{timestampValue:Ah(o.serializer,c)}}if(a instanceof mv)return{geoPointValue:{latitude:a.latitude,longitude:a.longitude}};if(a instanceof Dr)return{bytesValue:f0(o.serializer,a._byteString)};if(a instanceof un){const c=o.databaseId,d=a.firestore._databaseId;if(!d.isEqual(c))throw o.gc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:Kg(a.firestore._databaseId||o.databaseId,a._key.path)}}if(a instanceof pv)return function(d,f){return{mapValue:{fields:{[Fx]:{stringValue:Hx},[bh]:{arrayValue:{values:d.toArray().map(v=>{if(typeof v!="number")throw f.gc("VectorValues must only contain numeric values.");return Gg(f.serializer,v)})}}}}}}(a,o);throw o.gc(`Unsupported field value: ${tf(a)}`)}(n,e)}function Y0(n,e){const t={};return Mx(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Li(n,(a,o)=>{const c=pu(o,e.Ac(a));c!=null&&(t[a]=c)}),{mapValue:{fields:t}}}function K0(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof qt||n instanceof mv||n instanceof Dr||n instanceof un||n instanceof sf||n instanceof pv)}function _v(n,e,t){if(!K0(t)||!function(o){return typeof o=="object"&&o!==null&&(Object.getPrototypeOf(o)===Object.prototype||Object.getPrototypeOf(o)===null)}(t)){const a=tf(t);throw a==="an object"?e.gc(n+" a custom object"):e.gc(n+" "+a)}}function pg(n,e,t){if((e=gt(e))instanceof fu)return e._internalPath;if(typeof e=="string")return Ev(n,e);throw Rh("Field path arguments must be of type string or ",n,!1,void 0,t)}const lM=new RegExp("[~\\*/\\[\\]]");function Ev(n,e,t){if(e.search(lM)>=0)throw Rh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new fu(...e.split("."))._internalPath}catch{throw Rh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Rh(n,e,t,a,o){const c=a&&!a.isEmpty(),d=o!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let p="";return(c||d)&&(p+=" (found",c&&(p+=` in field ${a}`),d&&(p+=` in document ${o}`),p+=")"),new pe(re.INVALID_ARGUMENT,f+n+p)}function Q0(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh{constructor(e,t,a,o,c){this._firestore=e,this._userDataWriter=t,this._key=a,this._document=o,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new un(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new cM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(rf("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class cM extends Dh{data(){return super.data()}}function rf(n,e){return typeof e=="string"?Ev(n,e):e instanceof fu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X0(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new pe(re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class bv{}class Nv extends bv{}function Oe(n,e,...t){let a=[];e instanceof bv&&a.push(e),a=a.concat(t),function(c){const d=c.filter(p=>p instanceof Tv).length,f=c.filter(p=>p instanceof of).length;if(d>1||d>0&&f>0)throw new pe(re.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(a);for(const o of a)n=o._apply(n);return n}class of extends Nv{constructor(e,t,a){super(),this._field=e,this._op=t,this._value=a,this.type="where"}static _create(e,t,a){return new of(e,t,a)}_apply(e){const t=this._parse(e);return Z0(e._query,t),new Pa(e.firestore,e.converter,rg(e._query,t))}_parse(e){const t=mu(e.firestore);return function(c,d,f,p,v,_,N){let C;if(v.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new pe(re.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){zN(N,_);const b=[];for(const M of N)b.push(BN(p,c,M));C={arrayValue:{values:b}}}else C=BN(p,c,N)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||zN(N,_),C=oM(f,d,N,_==="in"||_==="not-in");return Pt.create(v,_,C)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Ke(n,e,t){const a=e,o=rf("where",n);return of._create(o,a,t)}class Tv extends bv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Tv(e,t)}_parse(e){const t=this._queryConstraints.map(a=>a._parse(e)).filter(a=>a.getFilters().length>0);return t.length===1?t[0]:xs.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(o,c){let d=o;const f=c.getFlattenedFilters();for(const p of f)Z0(d,p),d=rg(d,p)}(e._query,t),new Pa(e.firestore,e.converter,rg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class xv extends Nv{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new xv(e,t)}_apply(e){const t=function(o,c,d){if(o.startAt!==null)throw new pe(re.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new pe(re.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Qc(c,d)}(e._query,this._field,this._direction);return new Pa(e.firestore,e.converter,function(o,c){const d=o.explicitOrderBy.concat([c]);return new cl(o.path,o.collectionGroup,d,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)}(e._query,t))}}function Qn(n,e="asc"){const t=e,a=rf("orderBy",n);return xv._create(a,t)}class Av extends Nv{constructor(e,t,a){super(),this.type=e,this._limit=t,this._limitType=a}static _create(e,t,a){return new Av(e,t,a)}_apply(e){return new Pa(e.firestore,e.converter,Th(e._query,this._limit,this._limitType))}}function W0(n){return Av._create("limit",n,"F")}function BN(n,e,t){if(typeof(t=gt(t))=="string"){if(t==="")throw new pe(re.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Qx(e)&&t.indexOf("/")!==-1)throw new pe(re.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const a=e.path.child(ft.fromString(t));if(!Ne.isDocumentKey(a))throw new pe(re.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${a}' is not because it has an odd number of segments (${a.length}).`);return sN(n,new Ne(a))}if(t instanceof un)return sN(n,t._key);throw new pe(re.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${tf(t)}.`)}function zN(n,e){if(!Array.isArray(n)||n.length===0)throw new pe(re.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Z0(n,e){const t=function(o,c){for(const d of o)for(const f of d.getFlattenedFilters())if(c.indexOf(f.op)>=0)return f.op;return null}(n.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new pe(re.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new pe(re.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class J0{convertValue(e,t="none"){switch(ji(e)){case 0:return null;case 1:return e.booleanValue;case 2:return St(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ci(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ae(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const a={};return Li(e,(o,c)=>{a[o]=this.convertValue(c,t)}),a}convertVectorValue(e){var t,a,o;const c=(o=(a=(t=e.fields)===null||t===void 0?void 0:t[bh].arrayValue)===null||a===void 0?void 0:a.values)===null||o===void 0?void 0:o.map(d=>St(d.doubleValue));return new pv(c)}convertGeoPoint(e){return new mv(St(e.latitude),St(e.longitude))}convertArray(e,t){return(e.values||[]).map(a=>this.convertValue(a,t))}convertServerTimestamp(e,t){switch(t){case"previous":const a=zh(e);return a==null?null:this.convertValue(a,t);case"estimate":return this.convertTimestamp($c(e));default:return null}}convertTimestamp(e){const t=Ai(e);return new qt(t.seconds,t.nanos)}convertDocumentKey(e,t){const a=ft.fromString(e);Je(E0(a),9688,{name:e});const o=new Yc(a.get(1),a.get(3)),c=new Ne(a.popFirst(5));return o.isEqual(t)||Da(`Document ${c} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cv(n,e,t){let a;return a=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,a}class uM extends J0{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new un(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class jv extends Dh{constructor(e,t,a,o,c,d){super(e,t,a,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new lh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const a=this._document.data.field(rf("DocumentSnapshot.get",e));if(a!==null)return this._userDataWriter.convertValue(a,t.serverTimestamps)}}}class lh extends jv{data(e={}){return super.data(e)}}class eA{constructor(e,t,a,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new Uo(o.hasPendingWrites,o.fromCache),this.query=a}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(a=>{e.call(t,new lh(this._firestore,this._userDataWriter,a.key,a,new Uo(this._snapshot.mutatedKeys.has(a.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new pe(re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(o,c){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map(f=>{const p=new lh(o._firestore,o._userDataWriter,f.doc.key,f.doc,new Uo(o._snapshot.mutatedKeys.has(f.doc.key),o._snapshot.fromCache),o.query.converter);return f.doc,{type:"added",doc:p,oldIndex:-1,newIndex:d++}})}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(f=>c||f.type!==3).map(f=>{const p=new lh(o._firestore,o._userDataWriter,f.doc.key,f.doc,new Uo(o._snapshot.mutatedKeys.has(f.doc.key),o._snapshot.fromCache),o.query.converter);let v=-1,_=-1;return f.type!==0&&(v=d.indexOf(f.doc.key),d=d.delete(f.doc.key)),f.type!==1&&(d=d.add(f.doc),_=d.indexOf(f.doc.key)),{type:dM(f.type),doc:p,oldIndex:v,newIndex:_}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function dM(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ae(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ur(n){n=jn(n,un);const e=jn(n.firestore,Qs);return ZO(hu(e),n._key).then(t=>tA(e,n,t))}class lf extends J0{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new un(this.firestore,null,t)}}function kt(n){n=jn(n,Pa);const e=jn(n.firestore,Qs),t=hu(e),a=new lf(e);return X0(n._query),JO(t,n._query).then(o=>new eA(e,a,n,o))}function cf(n,e,t){n=jn(n,un);const a=jn(n.firestore,Qs),o=Cv(n.converter,e,t);return uf(a,[vv(mu(a),"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,cn.none())])}function ka(n,e,t,...a){n=jn(n,un);const o=jn(n.firestore,Qs),c=mu(o);let d;return d=typeof(e=gt(e))=="string"||e instanceof fu?$0(c,"updateDoc",n._key,e,t,a):G0(c,"updateDoc",n._key,e),uf(o,[d.toMutation(n._key,cn.exists(!0))])}function Sv(n){return uf(jn(n.firestore,Qs),[new Xh(n._key,cn.none())])}function gu(n,e){const t=jn(n.firestore,Qs),a=xt(n),o=Cv(n.converter,e);return uf(t,[vv(mu(n.firestore),"addDoc",a._key,o,n.converter!==null,{}).toMutation(a._key,cn.exists(!1))]).then(()=>a)}function dl(n,...e){var t,a,o;n=gt(n);let c={includeMetadataChanges:!1,source:"default"},d=0;typeof e[d]!="object"||qN(e[d])||(c=e[d],d++);const f={includeMetadataChanges:c.includeMetadataChanges,source:c.source};if(qN(e[d])){const N=e[d];e[d]=(t=N.next)===null||t===void 0?void 0:t.bind(N),e[d+1]=(a=N.error)===null||a===void 0?void 0:a.bind(N),e[d+2]=(o=N.complete)===null||o===void 0?void 0:o.bind(N)}let p,v,_;if(n instanceof un)v=jn(n.firestore,Qs),_=Gh(n._key.path),p={next:N=>{e[d]&&e[d](tA(v,n,N))},error:e[d+1],complete:e[d+2]};else{const N=jn(n,Pa);v=jn(N.firestore,Qs),_=N._query;const C=new lf(v);p={next:j=>{e[d]&&e[d](new eA(v,C,N,j))},error:e[d+1],complete:e[d+2]},X0(n._query)}return function(C,j,b,M){const x=new hv(M),L=new cv(j,x,b);return C.asyncQueue.enqueueAndForget(async()=>rv(await Ih(C),L)),()=>{x.xu(),C.asyncQueue.enqueueAndForget(async()=>ov(await Ih(C),L))}}(hu(v),_,f,p)}function uf(n,e){return function(a,o){const c=new $s;return a.asyncQueue.enqueueAndForget(async()=>LO(await XO(a),o,c)),c.promise}(hu(n),e)}function tA(n,e,t){const a=t.docs.get(e._key),o=new lf(n);return new jv(n,o,e._key,a,new Uo(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hM={maxAttempts:5};function wc(n,e){if((n=gt(n)).firestore!==e)throw new pe(re.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fM{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=mu(e)}get(e){const t=wc(e,this._firestore),a=new uM(this._firestore);return this._transaction.lookup([t._key]).then(o=>{if(!o||o.length!==1)return Ae(24041);const c=o[0];if(c.isFoundDocument())return new Dh(this._firestore,a,c.key,c,t.converter);if(c.isNoDocument())return new Dh(this._firestore,a,t._key,null,t.converter);throw Ae(18433,{doc:c})})}set(e,t,a){const o=wc(e,this._firestore),c=Cv(o.converter,t,a),d=vv(this._dataReader,"Transaction.set",o._key,c,o.converter!==null,a);return this._transaction.set(o._key,d),this}update(e,t,a,...o){const c=wc(e,this._firestore);let d;return d=typeof(t=gt(t))=="string"||t instanceof fu?$0(this._dataReader,"Transaction.update",c._key,t,a,o):G0(this._dataReader,"Transaction.update",c._key,t),this._transaction.update(c._key,d),this}delete(e){const t=wc(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mM extends fM{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=wc(e,this._firestore),a=new lf(this._firestore);return super.get(e).then(o=>new jv(this._firestore,a,t._key,o._document,new Uo(!1,!1),t.converter))}}function nA(n,e,t){n=jn(n,Qs);const a=Object.assign(Object.assign({},hM),t);return function(c){if(c.maxAttempts<1)throw new pe(re.INVALID_ARGUMENT,"Max attempts must be at least 1")}(a),function(c,d,f){const p=new $s;return c.asyncQueue.enqueueAndForget(async()=>{const v=await WO(c);new YO(c.asyncQueue,v,f,d,p).Wu()}),p.promise}(hu(n),o=>e(new mM(n,o)),a)}function wt(){return new yv("serverTimestamp")}(function(e,t=!0){(function(o){rl=o})(kr),cs(new Kn("firestore",(a,{instanceIdentifier:o,options:c})=>{const d=a.getProvider("app").getImmediate(),f=new Qs(new l1(a.getProvider("auth-internal")),new d1(d,a.getProvider("app-check-internal")),function(v,_){if(!Object.prototype.hasOwnProperty.apply(v.options,["projectId"]))throw new pe(re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Yc(v.options.projectId,_)}(d,o),d);return c=Object.assign({useFetchStreams:t},c),f._setSettings(c),f},"PUBLIC").setMultipleInstances(!0)),yn(Gb,$b,e),yn(Gb,$b,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sA="firebasestorage.googleapis.com",pM="storageBucket",gM=2*60*1e3,vM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws extends ds{constructor(e,t,a=0){super(Op(e),`Firebase Storage: ${t} (${Op(e)})`),this.status_=a,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ws.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Op(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Xs;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Xs||(Xs={}));function Op(n){return"storage/"+n}function yM(){const n="An unknown error occurred, please check the error payload for server response.";return new Ws(Xs.UNKNOWN,n)}function _M(){return new Ws(Xs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function EM(){return new Ws(Xs.CANCELED,"User canceled the upload/download.")}function bM(n){return new Ws(Xs.INVALID_URL,"Invalid URL '"+n+"'.")}function NM(n){return new Ws(Xs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function GN(n){return new Ws(Xs.INVALID_ARGUMENT,n)}function aA(){return new Ws(Xs.APP_DELETED,"The Firebase app was deleted.")}function TM(n){return new Ws(Xs.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let a;try{a=Ns.makeFromUrl(e,t)}catch{return new Ns(e,"")}if(a.path==="")return a;throw NM(e)}static makeFromUrl(e,t){let a=null;const o="([A-Za-z0-9.\\-_]+)";function c(U){U.path.charAt(U.path.length-1)==="/"&&(U.path_=U.path_.slice(0,-1))}const d="(/(.*))?$",f=new RegExp("^gs://"+o+d,"i"),p={bucket:1,path:3};function v(U){U.path_=decodeURIComponent(U.path)}const _="v[A-Za-z0-9_]+",N=t.replace(/[.]/g,"\\."),C="(/([^?#]*).*)?$",j=new RegExp(`^https?://${N}/${_}/b/${o}/o${C}`,"i"),b={bucket:1,path:3},M=t===sA?"(?:storage.googleapis.com|storage.cloud.google.com)":t,x="([^?#]*)",L=new RegExp(`^https?://${M}/${o}/${x}`,"i"),O=[{regex:f,indices:p,postModify:c},{regex:j,indices:b,postModify:v},{regex:L,indices:{bucket:1,path:2},postModify:v}];for(let U=0;U<O.length;U++){const F=O[U],X=F.regex.exec(e);if(X){const w=X[F.indices.bucket];let A=X[F.indices.path];A||(A=""),a=new Ns(w,A),F.postModify(a);break}}if(a==null)throw bM(e);return a}}class xM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AM(n,e,t){let a=1,o=null,c=null,d=!1,f=0;function p(){return f===2}let v=!1;function _(...x){v||(v=!0,e.apply(null,x))}function N(x){o=setTimeout(()=>{o=null,n(j,p())},x)}function C(){c&&clearTimeout(c)}function j(x,...L){if(v){C();return}if(x){C(),_.call(null,x,...L);return}if(p()||d){C(),_.call(null,x,...L);return}a<64&&(a*=2);let O;f===1?(f=2,O=0):O=(a+Math.random())*1e3,N(O)}let b=!1;function M(x){b||(b=!0,C(),!v&&(o!==null?(x||(f=2),clearTimeout(o),N(0)):x||(f=1)))}return N(0),c=setTimeout(()=>{d=!0,M(!0)},t),M}function CM(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jM(n){return n!==void 0}function $N(n,e,t,a){if(a<e)throw GN(`Invalid value for '${n}'. Expected ${e} or greater.`);if(a>t)throw GN(`Invalid value for '${n}'. Expected ${t} or less.`)}function SM(n){const e=encodeURIComponent;let t="?";for(const a in n)if(n.hasOwnProperty(a)){const o=e(a)+"="+e(n[a]);t=t+o+"&"}return t=t.slice(0,-1),t}var Oh;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Oh||(Oh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wM(n,e){const t=n>=500&&n<600,o=[408,429].indexOf(n)!==-1,c=e.indexOf(n)!==-1;return t||o||c}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IM{constructor(e,t,a,o,c,d,f,p,v,_,N,C=!0,j=!1){this.url_=e,this.method_=t,this.headers_=a,this.body_=o,this.successCodes_=c,this.additionalRetryCodes_=d,this.callback_=f,this.errorCallback_=p,this.timeout_=v,this.progressCallback_=_,this.connectionFactory_=N,this.retry=C,this.isUsingEmulator=j,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((b,M)=>{this.resolve_=b,this.reject_=M,this.start_()})}start_(){const e=(a,o)=>{if(o){a(!1,new Xd(!1,null,!0));return}const c=this.connectionFactory_();this.pendingConnection_=c;const d=f=>{const p=f.loaded,v=f.lengthComputable?f.total:-1;this.progressCallback_!==null&&this.progressCallback_(p,v)};this.progressCallback_!==null&&c.addUploadProgressListener(d),c.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&c.removeUploadProgressListener(d),this.pendingConnection_=null;const f=c.getErrorCode()===Oh.NO_ERROR,p=c.getStatus();if(!f||wM(p,this.additionalRetryCodes_)&&this.retry){const _=c.getErrorCode()===Oh.ABORT;a(!1,new Xd(!1,null,_));return}const v=this.successCodes_.indexOf(p)!==-1;a(!0,new Xd(v,c))})},t=(a,o)=>{const c=this.resolve_,d=this.reject_,f=o.connection;if(o.wasSuccessCode)try{const p=this.callback_(f,f.getResponse());jM(p)?c(p):c()}catch(p){d(p)}else if(f!==null){const p=yM();p.serverResponse=f.getErrorText(),this.errorCallback_?d(this.errorCallback_(f,p)):d(p)}else if(o.canceled){const p=this.appDelete_?aA():EM();d(p)}else{const p=_M();d(p)}};this.canceled_?t(!1,new Xd(!1,null,!0)):this.backoffId_=AM(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&CM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Xd{constructor(e,t,a){this.wasSuccessCode=e,this.connection=t,this.canceled=!!a}}function RM(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function DM(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function OM(n,e){e&&(n["X-Firebase-GMPID"]=e)}function MM(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function PM(n,e,t,a,o,c,d=!0,f=!1){const p=SM(n.urlParams),v=n.url+p,_=Object.assign({},n.headers);return OM(_,e),RM(_,t),DM(_,c),MM(_,a),new IM(v,n.method,_,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,o,d,f)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kM(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function LM(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh{constructor(e,t){this._service=e,t instanceof Ns?this._location=t:this._location=Ns.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Mh(e,t)}get root(){const e=new Ns(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return LM(this._location.path)}get storage(){return this._service}get parent(){const e=kM(this._location.path);if(e===null)return null;const t=new Ns(this._location.bucket,e);return new Mh(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw TM(e)}}function YN(n,e){const t=e?.[pM];return t==null?null:Ns.makeFromBucketSpec(t,n)}function VM(n,e,t,a={}){n.host=`${e}:${t}`;const o=Pr(e);o&&(Tg(`https://${n.host}/b`),xg("Storage",!0)),n._isUsingEmulator=!0,n._protocol=o?"https":"http";const{mockUserToken:c}=a;c&&(n._overrideAuthToken=typeof c=="string"?c:PT(c,n.app.options.projectId))}class UM{constructor(e,t,a,o,c,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=a,this._url=o,this._firebaseVersion=c,this._isUsingEmulator=d,this._bucket=null,this._host=sA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=gM,this._maxUploadRetryTime=vM,this._requests=new Set,o!=null?this._bucket=Ns.makeFromBucketSpec(o,this._host):this._bucket=YN(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ns.makeFromBucketSpec(this._url,e):this._bucket=YN(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){$N("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){$N("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Dn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Mh(this,e)}_makeRequest(e,t,a,o,c=!0){if(this._deleted)return new xM(aA());{const d=PM(e,this._appId,a,o,t,this._firebaseVersion,c,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[a,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,a,o).getPromise()}}const KN="@firebase/storage",QN="0.13.13";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iA="storage";function FM(n=nu(),e){n=gt(n);const a=Ma(n,iA).getImmediate({identifier:e}),o=DT("storage");return o&&HM(a,...o),a}function HM(n,e,t,a={}){VM(n,e,t,a)}function qM(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),a=n.getProvider("auth-internal"),o=n.getProvider("app-check-internal");return new UM(t,a,o,e,kr)}function BM(){cs(new Kn(iA,qM,"PUBLIC").setMultipleInstances(!0)),yn(KN,QN,""),yn(KN,QN,"esm2017")}BM();const rA="@firebase/installations",wv="0.6.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oA=1e4,lA=`w:${wv}`,cA="FIS_v2",zM="https://firebaseinstallations.googleapis.com/v1",GM=60*60*1e3,$M="installations",YM="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KM={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Or=new Oi($M,YM,KM);function uA(n){return n instanceof ds&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dA({projectId:n}){return`${zM}/projects/${n}/installations`}function hA(n){return{token:n.token,requestStatus:2,expiresIn:XM(n.expiresIn),creationTime:Date.now()}}async function fA(n,e){const a=(await e.json()).error;return Or.create("request-failed",{requestName:n,serverCode:a.code,serverMessage:a.message,serverStatus:a.status})}function mA({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function QM(n,{refreshToken:e}){const t=mA(n);return t.append("Authorization",WM(e)),t}async function pA(n){const e=await n();return e.status>=500&&e.status<600?n():e}function XM(n){return Number(n.replace("s","000"))}function WM(n){return`${cA} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZM({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const a=dA(n),o=mA(n),c=e.getImmediate({optional:!0});if(c){const v=await c.getHeartbeatsHeader();v&&o.append("x-firebase-client",v)}const d={fid:t,authVersion:cA,appId:n.appId,sdkVersion:lA},f={method:"POST",headers:o,body:JSON.stringify(d)},p=await pA(()=>fetch(a,f));if(p.ok){const v=await p.json();return{fid:v.fid||t,registrationStatus:2,refreshToken:v.refreshToken,authToken:hA(v.authToken)}}else throw await fA("Create Installation",p)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gA(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JM(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eP=/^[cdef][\w-]{21}$/,gg="";function tP(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=nP(n);return eP.test(t)?t:gg}catch{return gg}}function nP(n){return JM(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function df(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vA=new Map;function yA(n,e){const t=df(n);_A(t,e),sP(t,e)}function _A(n,e){const t=vA.get(n);if(t)for(const a of t)a(e)}function sP(n,e){const t=aP();t&&t.postMessage({key:n,fid:e}),iP()}let Cr=null;function aP(){return!Cr&&"BroadcastChannel"in self&&(Cr=new BroadcastChannel("[Firebase] FID Change"),Cr.onmessage=n=>{_A(n.data.key,n.data.fid)}),Cr}function iP(){vA.size===0&&Cr&&(Cr.close(),Cr=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rP="firebase-installations-database",oP=1,Mr="firebase-installations-store";let Mp=null;function Iv(){return Mp||(Mp=FT(rP,oP,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Mr)}}})),Mp}async function Ph(n,e){const t=df(n),o=(await Iv()).transaction(Mr,"readwrite"),c=o.objectStore(Mr),d=await c.get(t);return await c.put(e,t),await o.done,(!d||d.fid!==e.fid)&&yA(n,e.fid),e}async function EA(n){const e=df(n),a=(await Iv()).transaction(Mr,"readwrite");await a.objectStore(Mr).delete(e),await a.done}async function hf(n,e){const t=df(n),o=(await Iv()).transaction(Mr,"readwrite"),c=o.objectStore(Mr),d=await c.get(t),f=e(d);return f===void 0?await c.delete(t):await c.put(f,t),await o.done,f&&(!d||d.fid!==f.fid)&&yA(n,f.fid),f}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rv(n){let e;const t=await hf(n.appConfig,a=>{const o=lP(a),c=cP(n,o);return e=c.registrationPromise,c.installationEntry});return t.fid===gg?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function lP(n){const e=n||{fid:tP(),registrationStatus:0};return bA(e)}function cP(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const o=Promise.reject(Or.create("app-offline"));return{installationEntry:e,registrationPromise:o}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},a=uP(n,t);return{installationEntry:t,registrationPromise:a}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:dP(n)}:{installationEntry:e}}async function uP(n,e){try{const t=await ZM(n,e);return Ph(n.appConfig,t)}catch(t){throw uA(t)&&t.customData.serverCode===409?await EA(n.appConfig):await Ph(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function dP(n){let e=await XN(n.appConfig);for(;e.registrationStatus===1;)await gA(100),e=await XN(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:a}=await Rv(n);return a||t}return e}function XN(n){return hf(n,e=>{if(!e)throw Or.create("installation-not-found");return bA(e)})}function bA(n){return hP(n)?{fid:n.fid,registrationStatus:0}:n}function hP(n){return n.registrationStatus===1&&n.registrationTime+oA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fP({appConfig:n,heartbeatServiceProvider:e},t){const a=mP(n,t),o=QM(n,t),c=e.getImmediate({optional:!0});if(c){const v=await c.getHeartbeatsHeader();v&&o.append("x-firebase-client",v)}const d={installation:{sdkVersion:lA,appId:n.appId}},f={method:"POST",headers:o,body:JSON.stringify(d)},p=await pA(()=>fetch(a,f));if(p.ok){const v=await p.json();return hA(v)}else throw await fA("Generate Auth Token",p)}function mP(n,{fid:e}){return`${dA(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dv(n,e=!1){let t;const a=await hf(n.appConfig,c=>{if(!NA(c))throw Or.create("not-registered");const d=c.authToken;if(!e&&vP(d))return c;if(d.requestStatus===1)return t=pP(n,e),c;{if(!navigator.onLine)throw Or.create("app-offline");const f=_P(c);return t=gP(n,f),f}});return t?await t:a.authToken}async function pP(n,e){let t=await WN(n.appConfig);for(;t.authToken.requestStatus===1;)await gA(100),t=await WN(n.appConfig);const a=t.authToken;return a.requestStatus===0?Dv(n,e):a}function WN(n){return hf(n,e=>{if(!NA(e))throw Or.create("not-registered");const t=e.authToken;return EP(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function gP(n,e){try{const t=await fP(n,e),a=Object.assign(Object.assign({},e),{authToken:t});return await Ph(n.appConfig,a),t}catch(t){if(uA(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await EA(n.appConfig);else{const a=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Ph(n.appConfig,a)}throw t}}function NA(n){return n!==void 0&&n.registrationStatus===2}function vP(n){return n.requestStatus===2&&!yP(n)}function yP(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+GM}function _P(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function EP(n){return n.requestStatus===1&&n.requestTime+oA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bP(n){const e=n,{installationEntry:t,registrationPromise:a}=await Rv(e);return a?a.catch(console.error):Dv(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NP(n,e=!1){const t=n;return await TP(t),(await Dv(t,e)).token}async function TP(n){const{registrationPromise:e}=await Rv(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xP(n){if(!n||!n.options)throw Pp("App Configuration");if(!n.name)throw Pp("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Pp(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Pp(n){return Or.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TA="installations",AP="installations-internal",CP=n=>{const e=n.getProvider("app").getImmediate(),t=xP(e),a=Ma(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:a,_delete:()=>Promise.resolve()}},jP=n=>{const e=n.getProvider("app").getImmediate(),t=Ma(e,TA).getImmediate();return{getId:()=>bP(t),getToken:o=>NP(t,o)}};function SP(){cs(new Kn(TA,CP,"PUBLIC")),cs(new Kn(AP,jP,"PRIVATE"))}SP();yn(rA,wv);yn(rA,wv,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kh="analytics",wP="firebase_id",IP="origin",RP=60*1e3,DP="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Ov="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const On=new tu("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OP={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Yn=new Oi("analytics","Analytics",OP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MP(n){if(!n.startsWith(Ov)){const e=Yn.create("invalid-gtag-resource",{gtagURL:n});return On.warn(e.message),""}return n}function xA(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function PP(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function kP(n,e){const t=PP("firebase-js-sdk-policy",{createScriptURL:MP}),a=document.createElement("script"),o=`${Ov}?l=${n}&id=${e}`;a.src=t?t?.createScriptURL(o):o,a.async=!0,document.head.appendChild(a)}function LP(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function VP(n,e,t,a,o,c){const d=a[o];try{if(d)await e[d];else{const p=(await xA(t)).find(v=>v.measurementId===o);p&&await e[p.appId]}}catch(f){On.error(f)}n("config",o,c)}async function UP(n,e,t,a,o){try{let c=[];if(o&&o.send_to){let d=o.send_to;Array.isArray(d)||(d=[d]);const f=await xA(t);for(const p of d){const v=f.find(N=>N.measurementId===p),_=v&&e[v.appId];if(_)c.push(_);else{c=[];break}}}c.length===0&&(c=Object.values(e)),await Promise.all(c),n("event",a,o||{})}catch(c){On.error(c)}}function FP(n,e,t,a){async function o(c,...d){try{if(c==="event"){const[f,p]=d;await UP(n,e,t,f,p)}else if(c==="config"){const[f,p]=d;await VP(n,e,t,a,f,p)}else if(c==="consent"){const[f,p]=d;n("consent",f,p)}else if(c==="get"){const[f,p,v]=d;n("get",f,p,v)}else if(c==="set"){const[f]=d;n("set",f)}else n(c,...d)}catch(f){On.error(f)}}return o}function HP(n,e,t,a,o){let c=function(...d){window[a].push(arguments)};return window[o]&&typeof window[o]=="function"&&(c=window[o]),window[o]=FP(c,n,e,t),{gtagCore:c,wrappedGtag:window[o]}}function qP(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(Ov)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BP=30,zP=1e3;class GP{constructor(e={},t=zP){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const AA=new GP;function $P(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function YP(n){var e;const{appId:t,apiKey:a}=n,o={method:"GET",headers:$P(a)},c=DP.replace("{app-id}",t),d=await fetch(c,o);if(d.status!==200&&d.status!==304){let f="";try{const p=await d.json();!((e=p.error)===null||e===void 0)&&e.message&&(f=p.error.message)}catch{}throw Yn.create("config-fetch-failed",{httpStatus:d.status,responseMessage:f})}return d.json()}async function KP(n,e=AA,t){const{appId:a,apiKey:o,measurementId:c}=n.options;if(!a)throw Yn.create("no-app-id");if(!o){if(c)return{measurementId:c,appId:a};throw Yn.create("no-api-key")}const d=e.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},f=new WP;return setTimeout(async()=>{f.abort()},RP),CA({appId:a,apiKey:o,measurementId:c},d,f,e)}async function CA(n,{throttleEndTimeMillis:e,backoffCount:t},a,o=AA){var c;const{appId:d,measurementId:f}=n;try{await QP(a,e)}catch(p){if(f)return On.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${f} provided in the "measurementId" field in the local Firebase config. [${p?.message}]`),{appId:d,measurementId:f};throw p}try{const p=await YP(n);return o.deleteThrottleMetadata(d),p}catch(p){const v=p;if(!XP(v)){if(o.deleteThrottleMetadata(d),f)return On.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${f} provided in the "measurementId" field in the local Firebase config. [${v?.message}]`),{appId:d,measurementId:f};throw p}const _=Number((c=v?.customData)===null||c===void 0?void 0:c.httpStatus)===503?gb(t,o.intervalMillis,BP):gb(t,o.intervalMillis),N={throttleEndTimeMillis:Date.now()+_,backoffCount:t+1};return o.setThrottleMetadata(d,N),On.debug(`Calling attemptFetch again in ${_} millis`),CA(n,N,a,o)}}function QP(n,e){return new Promise((t,a)=>{const o=Math.max(e-Date.now(),0),c=setTimeout(t,o);n.addEventListener(()=>{clearTimeout(c),a(Yn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function XP(n){if(!(n instanceof ds)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class WP{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function ZP(n,e,t,a,o){if(o&&o.global){n("event",t,a);return}else{const c=await e,d=Object.assign(Object.assign({},a),{send_to:c});n("event",t,d)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JP(){if(Ag())try{await Cg()}catch(n){return On.warn(Yn.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}else return On.warn(Yn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function ek(n,e,t,a,o,c,d){var f;const p=KP(n);p.then(j=>{t[j.measurementId]=j.appId,n.options.measurementId&&j.measurementId!==n.options.measurementId&&On.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${j.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(j=>On.error(j)),e.push(p);const v=JP().then(j=>{if(j)return a.getId()}),[_,N]=await Promise.all([p,v]);qP(c)||kP(c,_.measurementId),o("js",new Date);const C=(f=d?.config)!==null&&f!==void 0?f:{};return C[IP]="firebase",C.update=!0,N!=null&&(C[wP]=N),o("config",_.measurementId,C),_.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk{constructor(e){this.app=e}_delete(){return delete Lc[this.app.options.appId],Promise.resolve()}}let Lc={},ZN=[];const JN={};let kp="dataLayer",nk="gtag",eT,jA,tT=!1;function sk(){const n=[];if(kT()&&n.push("This is a browser extension environment."),LT()||n.push("Cookies are not available."),n.length>0){const e=n.map((a,o)=>`(${o+1}) ${a}`).join(" "),t=Yn.create("invalid-analytics-context",{errorInfo:e});On.warn(t.message)}}function ak(n,e,t){sk();const a=n.options.appId;if(!a)throw Yn.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)On.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Yn.create("no-api-key");if(Lc[a]!=null)throw Yn.create("already-exists",{id:a});if(!tT){LP(kp);const{wrappedGtag:c,gtagCore:d}=HP(Lc,ZN,JN,kp,nk);jA=c,eT=d,tT=!0}return Lc[a]=ek(n,ZN,JN,e,eT,kp,t),new tk(n)}function ik(n=nu()){n=gt(n);const e=Ma(n,kh);return e.isInitialized()?e.getImmediate():rk(n)}function rk(n,e={}){const t=Ma(n,kh);if(t.isInitialized()){const o=t.getImmediate();if(Ti(e,t.getOptions()))return o;throw Yn.create("already-initialized")}return t.initialize({options:e})}function ok(n,e,t,a){n=gt(n),ZP(jA,Lc[n.app.options.appId],e,t,a).catch(o=>On.error(o))}const nT="@firebase/analytics",sT="0.10.16";function lk(){cs(new Kn(kh,(e,{options:t})=>{const a=e.getProvider("app").getImmediate(),o=e.getProvider("installations-internal").getImmediate();return ak(a,o,t)},"PUBLIC")),cs(new Kn("analytics-internal",n,"PRIVATE")),yn(nT,sT),yn(nT,sT,"esm2017");function n(e){try{const t=e.getProvider(kh).getImmediate();return{logEvent:(a,o,c)=>ok(t,a,o,c)}}catch(t){throw Yn.create("interop-component-reg-failed",{reason:t})}}}lk();var vg,aT,ff=function(){var n=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(n&&n.responseStart>0&&n.responseStart<performance.now())return n},SA=function(n){if(document.readyState==="loading")return"loading";var e=ff();if(e){if(n<e.domInteractive)return"loading";if(e.domContentLoadedEventStart===0||n<e.domContentLoadedEventStart)return"dom-interactive";if(e.domComplete===0||n<e.domComplete)return"dom-content-loaded"}return"complete"},ck=function(n){var e=n.nodeName;return n.nodeType===1?e.toLowerCase():e.toUpperCase().replace(/^#/,"")},Mv=function(n,e){var t="";try{for(;n&&n.nodeType!==9;){var a=n,o=a.id?"#"+a.id:ck(a)+(a.classList&&a.classList.value&&a.classList.value.trim()&&a.classList.value.trim().length?"."+a.classList.value.trim().replace(/\s+/g,"."):"");if(t.length+o.length>(e||100)-1)return t||o;if(t=t?o+">"+t:o,a.id)break;n=a.parentNode}}catch{}return t},wA=-1,uk=function(){return wA},vu=function(n){addEventListener("pageshow",function(e){e.persisted&&(wA=e.timeStamp,n(e))},!0)},Pv=function(){var n=ff();return n&&n.activationStart||0},Ii=function(n,e){var t=ff(),a="navigate";return uk()>=0?a="back-forward-cache":t&&(document.prerendering||Pv()>0?a="prerender":document.wasDiscarded?a="restore":t.type&&(a=t.type.replace(/_/g,"-"))),{name:n,value:e===void 0?-1:e,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:a}},hl=function(n,e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(n)){var a=new PerformanceObserver(function(o){Promise.resolve().then(function(){e(o.getEntries())})});return a.observe(Object.assign({type:n,buffered:!0},t||{})),a}}catch{}},Ri=function(n,e,t,a){var o,c;return function(d){e.value>=0&&(d||a)&&((c=e.value-(o||0))||o===void 0)&&(o=e.value,e.delta=c,e.rating=function(f,p){return f>p[1]?"poor":f>p[0]?"needs-improvement":"good"}(e.value,t),n(e))}},kv=function(n){requestAnimationFrame(function(){return requestAnimationFrame(function(){return n()})})},mf=function(n){document.addEventListener("visibilitychange",function(){document.visibilityState==="hidden"&&n()})},Lv=function(n){var e=!1;return function(){e||(n(),e=!0)}},Fo=-1,iT=function(){return document.visibilityState!=="hidden"||document.prerendering?1/0:0},Lh=function(n){document.visibilityState==="hidden"&&Fo>-1&&(Fo=n.type==="visibilitychange"?n.timeStamp:0,dk())},rT=function(){addEventListener("visibilitychange",Lh,!0),addEventListener("prerenderingchange",Lh,!0)},dk=function(){removeEventListener("visibilitychange",Lh,!0),removeEventListener("prerenderingchange",Lh,!0)},IA=function(){return Fo<0&&(Fo=iT(),rT(),vu(function(){setTimeout(function(){Fo=iT(),rT()},0)})),{get firstHiddenTime(){return Fo}}},Vv=function(n){document.prerendering?addEventListener("prerenderingchange",function(){return n()},!0):n()},oT=[1800,3e3],hk=function(n,e){e=e||{},Vv(function(){var t,a=IA(),o=Ii("FCP"),c=hl("paint",function(d){d.forEach(function(f){f.name==="first-contentful-paint"&&(c.disconnect(),f.startTime<a.firstHiddenTime&&(o.value=Math.max(f.startTime-Pv(),0),o.entries.push(f),t(!0)))})});c&&(t=Ri(n,o,oT,e.reportAllChanges),vu(function(d){o=Ii("FCP"),t=Ri(n,o,oT,e.reportAllChanges),kv(function(){o.value=performance.now()-d.timeStamp,t(!0)})}))})},lT=[.1,.25],fk=function(n,e){(function(t,a){a=a||{},hk(Lv(function(){var o,c=Ii("CLS",0),d=0,f=[],p=function(_){_.forEach(function(N){if(!N.hadRecentInput){var C=f[0],j=f[f.length-1];d&&N.startTime-j.startTime<1e3&&N.startTime-C.startTime<5e3?(d+=N.value,f.push(N)):(d=N.value,f=[N])}}),d>c.value&&(c.value=d,c.entries=f,o())},v=hl("layout-shift",p);v&&(o=Ri(t,c,lT,a.reportAllChanges),mf(function(){p(v.takeRecords()),o(!0)}),vu(function(){d=0,c=Ii("CLS",0),o=Ri(t,c,lT,a.reportAllChanges),kv(function(){return o()})}),setTimeout(o,0))}))})(function(t){var a=function(o){var c,d={};if(o.entries.length){var f=o.entries.reduce(function(v,_){return v&&v.value>_.value?v:_});if(f&&f.sources&&f.sources.length){var p=(c=f.sources).find(function(v){return v.node&&v.node.nodeType===1})||c[0];p&&(d={largestShiftTarget:Mv(p.node),largestShiftTime:f.startTime,largestShiftValue:f.value,largestShiftSource:p,largestShiftEntry:f,loadState:SA(f.startTime)})}}return Object.assign(o,{attribution:d})}(t);n(a)},e)},RA=0,Lp=1/0,Wd=0,mk=function(n){n.forEach(function(e){e.interactionId&&(Lp=Math.min(Lp,e.interactionId),Wd=Math.max(Wd,e.interactionId),RA=Wd?(Wd-Lp)/7+1:0)})},DA=function(){return vg?RA:performance.interactionCount||0},pk=function(){"interactionCount"in performance||vg||(vg=hl("event",mk,{type:"event",buffered:!0,durationThreshold:0}))},_s=[],Vc=new Map,OA=0,gk=function(){var n=Math.min(_s.length-1,Math.floor((DA()-OA)/50));return _s[n]},MA=[],vk=function(n){if(MA.forEach(function(o){return o(n)}),n.interactionId||n.entryType==="first-input"){var e=_s[_s.length-1],t=Vc.get(n.interactionId);if(t||_s.length<10||n.duration>e.latency){if(t)n.duration>t.latency?(t.entries=[n],t.latency=n.duration):n.duration===t.latency&&n.startTime===t.entries[0].startTime&&t.entries.push(n);else{var a={id:n.interactionId,latency:n.duration,entries:[n]};Vc.set(a.id,a),_s.push(a)}_s.sort(function(o,c){return c.latency-o.latency}),_s.length>10&&_s.splice(10).forEach(function(o){return Vc.delete(o.id)})}}},Uv=function(n){var e=self.requestIdleCallback||self.setTimeout,t=-1;return n=Lv(n),document.visibilityState==="hidden"?n():(t=e(n),mf(n)),t},cT=[200,500],yk=function(n,e){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(e=e||{},Vv(function(){var t;pk();var a,o=Ii("INP"),c=function(f){Uv(function(){f.forEach(vk);var p=gk();p&&p.latency!==o.value&&(o.value=p.latency,o.entries=p.entries,a())})},d=hl("event",c,{durationThreshold:(t=e.durationThreshold)!==null&&t!==void 0?t:40});a=Ri(n,o,cT,e.reportAllChanges),d&&(d.observe({type:"first-input",buffered:!0}),mf(function(){c(d.takeRecords()),a(!0)}),vu(function(){OA=DA(),_s.length=0,Vc.clear(),o=Ii("INP"),a=Ri(n,o,cT,e.reportAllChanges)}))}))},Yo=[],vi=[],yg=0,Fv=new WeakMap,Ko=new Map,_g=-1,_k=function(n){Yo=Yo.concat(n),PA()},PA=function(){_g<0&&(_g=Uv(Ek))},Ek=function(){Ko.size>10&&Ko.forEach(function(d,f){Vc.has(f)||Ko.delete(f)});var n=_s.map(function(d){return Fv.get(d.entries[0])}),e=vi.length-50;vi=vi.filter(function(d,f){return f>=e||n.includes(d)});for(var t=new Set,a=0;a<vi.length;a++){var o=vi[a];kA(o.startTime,o.processingEnd).forEach(function(d){t.add(d)})}var c=Yo.length-1-50;Yo=Yo.filter(function(d,f){return d.startTime>yg&&f>c||t.has(d)}),_g=-1};MA.push(function(n){n.interactionId&&n.target&&!Ko.has(n.interactionId)&&Ko.set(n.interactionId,n.target)},function(n){var e,t=n.startTime+n.duration;yg=Math.max(yg,n.processingEnd);for(var a=vi.length-1;a>=0;a--){var o=vi[a];if(Math.abs(t-o.renderTime)<=8){(e=o).startTime=Math.min(n.startTime,e.startTime),e.processingStart=Math.min(n.processingStart,e.processingStart),e.processingEnd=Math.max(n.processingEnd,e.processingEnd),e.entries.push(n);break}}e||(e={startTime:n.startTime,processingStart:n.processingStart,processingEnd:n.processingEnd,renderTime:t,entries:[n]},vi.push(e)),(n.interactionId||n.entryType==="first-input")&&Fv.set(n,e),PA()});var kA=function(n,e){for(var t,a=[],o=0;t=Yo[o];o++)if(!(t.startTime+t.duration<n)){if(t.startTime>e)break;a.push(t)}return a},bk=function(n,e){aT||(aT=hl("long-animation-frame",_k)),yk(function(t){var a=function(o){var c=o.entries[0],d=Fv.get(c),f=c.processingStart,p=d.processingEnd,v=d.entries.sort(function(x,L){return x.processingStart-L.processingStart}),_=kA(c.startTime,p),N=o.entries.find(function(x){return x.target}),C=N&&N.target||Ko.get(c.interactionId),j=[c.startTime+c.duration,p].concat(_.map(function(x){return x.startTime+x.duration})),b=Math.max.apply(Math,j),M={interactionTarget:Mv(C),interactionTargetElement:C,interactionType:c.name.startsWith("key")?"keyboard":"pointer",interactionTime:c.startTime,nextPaintTime:b,processedEventEntries:v,longAnimationFrameEntries:_,inputDelay:f-c.startTime,processingDuration:p-f,presentationDelay:Math.max(b-p,0),loadState:SA(c.startTime)};return Object.assign(o,{attribution:M})}(t);n(a)},e)},uT=[2500,4e3],Vp={},Nk=function(n,e){(function(t,a){a=a||{},Vv(function(){var o,c=IA(),d=Ii("LCP"),f=function(_){a.reportAllChanges||(_=_.slice(-1)),_.forEach(function(N){N.startTime<c.firstHiddenTime&&(d.value=Math.max(N.startTime-Pv(),0),d.entries=[N],o())})},p=hl("largest-contentful-paint",f);if(p){o=Ri(t,d,uT,a.reportAllChanges);var v=Lv(function(){Vp[d.id]||(f(p.takeRecords()),p.disconnect(),Vp[d.id]=!0,o(!0))});["keydown","click"].forEach(function(_){addEventListener(_,function(){return Uv(v)},{once:!0,capture:!0})}),mf(v),vu(function(_){d=Ii("LCP"),o=Ri(t,d,uT,a.reportAllChanges),kv(function(){d.value=performance.now()-_.timeStamp,Vp[d.id]=!0,o(!0)})})}})})(function(t){var a=function(o){var c={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:o.value};if(o.entries.length){var d=ff();if(d){var f=d.activationStart||0,p=o.entries[o.entries.length-1],v=p.url&&performance.getEntriesByType("resource").filter(function(b){return b.name===p.url})[0],_=Math.max(0,d.responseStart-f),N=Math.max(_,v?(v.requestStart||v.startTime)-f:0),C=Math.max(N,v?v.responseEnd-f:0),j=Math.max(C,p.startTime-f);c={element:Mv(p.element),timeToFirstByte:_,resourceLoadDelay:N-_,resourceLoadDuration:C-N,elementRenderDelay:j-C,navigationEntry:d,lcpEntry:p},p.url&&(c.url=p.url),v&&(c.lcpResourceEntry=v)}}return Object.assign(o,{attribution:c})}(t);n(a)},e)};const dT="@firebase/performance",Eg="0.7.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LA=Eg,Tk="FB-PERF-TRACE-START",xk="FB-PERF-TRACE-STOP",bg="FB-PERF-TRACE-MEASURE",VA="_wt_",UA="_fp",FA="_fcp",HA="_fid",qA="_lcp",Ak="lcp_element",BA="_inp",Ck="inp_interactionTarget",zA="_cls",jk="cls_largestShiftTarget",GA="@firebase/performance/config",$A="@firebase/performance/configexpire",Sk="performance",YA="Performance";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wk={"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."},vn=new Oi(Sk,YA,wk);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Di=new tu(YA);Di.logLevel=ze.INFO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Up,KA;class zt{constructor(e){if(this.window=e,!e)throw vn.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay),this.onLCP=Nk,this.onINP=bk,this.onCLS=fk}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){!this.performance||!this.performance.mark||this.performance.mark(e)}measure(e,t,a){!this.performance||!this.performance.measure||this.performance.measure(e,t,a)}getEntriesByType(e){return!this.performance||!this.performance.getEntriesByType?[]:this.performance.getEntriesByType(e)}getEntriesByName(e){return!this.performance||!this.performance.getEntriesByName?[]:this.performance.getEntriesByName(e)}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return!fetch||!Promise||!LT()?(Di.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1):Ag()?!0:(Di.info("IndexedDB is not supported by current browser"),!1)}setupObserver(e,t){if(!this.PerformanceObserver)return;new this.PerformanceObserver(o=>{for(const c of o.getEntries())t(c)}).observe({entryTypes:[e]})}static getInstance(){return Up===void 0&&(Up=new zt(KA)),Up}}function Ik(n){KA=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let QA;function Rk(n){const e=n.getId();return e.then(t=>{QA=t}),e}function Hv(){return QA}function Dk(n){const e=n.getToken();return e.then(t=>{}),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hT(n,e){const t=n.length-e.length;if(t<0||t>1)throw vn.create("invalid String merger input");const a=[];for(let o=0;o<n.length;o++)a.push(n.charAt(o)),e.length>o&&a.push(e.charAt(o));return a.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fp;class Gn{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=hT("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=hT("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return Fp===void 0&&(Fp=new Gn),Fp}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Uc;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.VISIBLE=1]="VISIBLE",n[n.HIDDEN=2]="HIDDEN"})(Uc||(Uc={}));const Ok=["firebase_","google_","ga_"],Mk=new RegExp("^[a-zA-Z]\\w*$"),Pk=40,kk=100;function Lk(){const n=zt.getInstance().navigator;return n?.serviceWorker?n.serviceWorker.controller?2:3:1}function Vk(){switch(zt.getInstance().document.visibilityState){case"visible":return Uc.VISIBLE;case"hidden":return Uc.HIDDEN;default:return Uc.UNKNOWN}}function Uk(){const e=zt.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function Fk(n){return n.length===0||n.length>Pk?!1:!Ok.some(t=>n.startsWith(t))&&!!n.match(Mk)}function Hk(n){return n.length!==0&&n.length<=kk}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XA(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.appId;if(!t)throw vn.create("no app id");return t}function qk(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.projectId;if(!t)throw vn.create("no project id");return t}function Bk(n){var e;const t=(e=n.options)===null||e===void 0?void 0:e.apiKey;if(!t)throw vn.create("no api key");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zk="0.0.1",ys={loggingEnabled:!0},Gk="FIREBASE_INSTALLATIONS_AUTH";function $k(n,e){const t=Yk();return t?(fT(t),Promise.resolve()):Xk(n,e).then(fT).then(a=>Kk(a),()=>{})}function Yk(){const n=zt.getInstance().localStorage;if(!n)return;const e=n.getItem($A);if(!e||!Wk(e))return;const t=n.getItem(GA);if(t)try{return JSON.parse(t)}catch{return}}function Kk(n){const e=zt.getInstance().localStorage;!n||!e||(e.setItem(GA,JSON.stringify(n)),e.setItem($A,String(Date.now()+Gn.getInstance().configTimeToLive*60*60*1e3)))}const Qk="Could not fetch config, will use default configs";function Xk(n,e){return Dk(n.installations).then(t=>{const a=qk(n.app),o=Bk(n.app),c=`https://firebaseremoteconfig.googleapis.com/v1/projects/${a}/namespaces/fireperf:fetch?key=${o}`,d=new Request(c,{method:"POST",headers:{Authorization:`${Gk} ${t}`},body:JSON.stringify({app_instance_id:e,app_instance_id_token:t,app_id:XA(n.app),app_version:LA,sdk_version:zk})});return fetch(d).then(f=>{if(f.ok)return f.json();throw vn.create("RC response not ok")})}).catch(()=>{Di.info(Qk)})}function fT(n){if(!n)return n;const e=Gn.getInstance(),t=n.entries||{};return t.fpr_enabled!==void 0?e.loggingEnabled=String(t.fpr_enabled)==="true":e.loggingEnabled=ys.loggingEnabled,t.fpr_log_source?e.logSource=Number(t.fpr_log_source):ys.logSource&&(e.logSource=ys.logSource),t.fpr_log_endpoint_url?e.logEndPointUrl=t.fpr_log_endpoint_url:ys.logEndPointUrl&&(e.logEndPointUrl=ys.logEndPointUrl),t.fpr_log_transport_key?e.transportKey=t.fpr_log_transport_key:ys.transportKey&&(e.transportKey=ys.transportKey),t.fpr_vc_network_request_sampling_rate!==void 0?e.networkRequestsSamplingRate=Number(t.fpr_vc_network_request_sampling_rate):ys.networkRequestsSamplingRate!==void 0&&(e.networkRequestsSamplingRate=ys.networkRequestsSamplingRate),t.fpr_vc_trace_sampling_rate!==void 0?e.tracesSamplingRate=Number(t.fpr_vc_trace_sampling_rate):ys.tracesSamplingRate!==void 0&&(e.tracesSamplingRate=ys.tracesSamplingRate),e.logTraceAfterSampling=mT(e.tracesSamplingRate),e.logNetworkAfterSampling=mT(e.networkRequestsSamplingRate),n}function Wk(n){return Number(n)>Date.now()}function mT(n){return Math.random()<=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qv=1,Hp;function WA(n){return qv=2,Hp=Hp||Jk(n),Hp}function Zk(){return qv===3}function Jk(n){return e2().then(()=>Rk(n.installations)).then(e=>$k(n,e)).then(()=>pT(),()=>pT())}function e2(){const n=zt.getInstance().document;return new Promise(e=>{if(n&&n.readyState!=="complete"){const t=()=>{n.readyState==="complete"&&(n.removeEventListener("readystatechange",t),e())};n.addEventListener("readystatechange",t)}else e()})}function pT(){qv=3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZA=10*1e3,t2=5.5*1e3,n2=1e3,JA=3;let ch=JA,jr=[],gT=!1;function s2(){gT||(Bv(t2),gT=!0)}function Bv(n){setTimeout(()=>{ch<=0||(jr.length>0&&eC(),Bv(ZA))},n)}function eC(){const n=jr.splice(0,n2),e=n.map(a=>({source_extension_json_proto3:a.message,event_time_ms:String(a.eventTime)})),t={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Gn.getInstance().logSource,log_event:e};a2(t).then(()=>{ch=JA}).catch(()=>{jr=[...n,...jr],ch--,Di.info(`Tries left: ${ch}.`),Bv(ZA)})}function a2(n){const e=Gn.getInstance().getFlTransportFullUrl(),t=JSON.stringify(n);return navigator.sendBeacon&&navigator.sendBeacon(e,t)?Promise.resolve():fetch(e,{method:"POST",body:t,keepalive:!0}).then()}function i2(n){if(!n.eventTime||!n.message)throw vn.create("invalid cc log");jr=[...jr,n]}function r2(n){return(...e)=>{const t=n(...e);i2({message:t,eventTime:Date.now()})}}function o2(){for(;jr.length>0;)eC()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fc;function tC(n,e){Fc||(Fc={send:r2(u2),flush:o2}),Fc.send(n,e)}function Zd(n){const e=Gn.getInstance();!e.instrumentationEnabled&&n.isAuto||!e.dataCollectionEnabled&&!n.isAuto||zt.getInstance().requiredApisAvailable()&&(Zk()?qp(n):WA(n.performanceController).then(()=>qp(n),()=>qp(n)))}function l2(){Fc&&Fc.flush()}function qp(n){if(!Hv())return;const e=Gn.getInstance();!e.loggingEnabled||!e.logTraceAfterSampling||tC(n,1)}function c2(n){const e=Gn.getInstance();if(!e.instrumentationEnabled)return;const t=n.url,a=e.logEndPointUrl.split("?")[0],o=e.flTransportEndpointUrl.split("?")[0];t===a||t===o||!e.loggingEnabled||!e.logNetworkAfterSampling||tC(n,0)}function u2(n,e){return e===0?d2(n):h2(n)}function d2(n){const e={url:n.url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},t={application_info:nC(n.performanceController.app),network_request_metric:e};return JSON.stringify(t)}function h2(n){const e={name:n.name,is_auto:n.isAuto,client_start_time_us:n.startTimeUs,duration_us:n.durationUs};Object.keys(n.counters).length!==0&&(e.counters=n.counters);const t=n.getAttributes();Object.keys(t).length!==0&&(e.custom_attributes=t);const a={application_info:nC(n.performanceController.app),trace_metric:e};return JSON.stringify(a)}function nC(n){return{google_app_id:XA(n),app_instance_id:Hv(),web_app_info:{sdk_version:LA,page_url:zt.getInstance().getUrl(),service_worker_status:Lk(),visibility_state:Vk(),effective_connection_type:Uk()},application_process_state:0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vT(n,e){const t=e;if(!t||t.responseStart===void 0)return;const a=zt.getInstance().getTimeOrigin(),o=Math.floor((t.startTime+a)*1e3),c=t.responseStart?Math.floor((t.responseStart-t.startTime)*1e3):void 0,d=Math.floor((t.responseEnd-t.startTime)*1e3),f=t.name&&t.name.split("?")[0],p={performanceController:n,url:f,responsePayloadBytes:t.transferSize,startTimeUs:o,timeToResponseInitiatedUs:c,timeToResponseCompletedUs:d};c2(p)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f2=100,m2="_",p2=[UA,FA,HA,qA,zA,BA];function g2(n,e){return n.length===0||n.length>f2?!1:e&&e.startsWith(VA)&&p2.indexOf(n)>-1||!n.startsWith(m2)}function v2(n){const e=Math.floor(n);return e<n&&Di.info(`Metric value should be an Integer, setting the value as : ${e}.`),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,t,a=!1,o){this.performanceController=e,this.name=t,this.isAuto=a,this.state=1,this.customAttributes={},this.counters={},this.api=zt.getInstance(),this.randomId=Math.floor(Math.random()*1e6),this.isAuto||(this.traceStartMark=`${Tk}-${this.randomId}-${this.name}`,this.traceStopMark=`${xk}-${this.randomId}-${this.name}`,this.traceMeasure=o||`${bg}-${this.randomId}-${this.name}`,o&&this.calculateTraceMetrics())}start(){if(this.state!==1)throw vn.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(this.state!==2)throw vn.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Zd(this)}record(e,t,a){if(e<=0)throw vn.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw vn.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(t*1e3),this.startTimeUs=Math.floor(e*1e3),a&&a.attributes&&(this.customAttributes=Object.assign({},a.attributes)),a&&a.metrics)for(const o of Object.keys(a.metrics))isNaN(Number(a.metrics[o]))||(this.counters[o]=Math.floor(Number(a.metrics[o])));Zd(this)}incrementMetric(e,t=1){this.counters[e]===void 0?this.putMetric(e,t):this.putMetric(e,this.counters[e]+t)}putMetric(e,t){if(g2(e,this.name))this.counters[e]=v2(t??0);else throw vn.create("invalid custom metric name",{customMetricName:e})}getMetric(e){return this.counters[e]||0}putAttribute(e,t){const a=Fk(e),o=Hk(t);if(a&&o){this.customAttributes[e]=t;return}if(!a)throw vn.create("invalid attribute name",{attributeName:e});if(!o)throw vn.create("invalid attribute value",{attributeValue:t})}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){this.customAttributes[e]!==void 0&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),t=e&&e[0];t&&(this.durationUs=Math.floor(t.duration*1e3),this.startTimeUs=Math.floor((t.startTime+this.api.getTimeOrigin())*1e3))}static createOobTrace(e,t,a,o,c){const d=zt.getInstance().getUrl();if(!d)return;const f=new Jc(e,VA+d,!0),p=Math.floor(zt.getInstance().getTimeOrigin()*1e3);f.setStartTime(p),t&&t[0]&&(f.setDuration(Math.floor(t[0].duration*1e3)),f.putMetric("domInteractive",Math.floor(t[0].domInteractive*1e3)),f.putMetric("domContentLoadedEventEnd",Math.floor(t[0].domContentLoadedEventEnd*1e3)),f.putMetric("loadEventEnd",Math.floor(t[0].loadEventEnd*1e3)));const v="first-paint",_="first-contentful-paint";if(a){const N=a.find(j=>j.name===v);N&&N.startTime&&f.putMetric(UA,Math.floor(N.startTime*1e3));const C=a.find(j=>j.name===_);C&&C.startTime&&f.putMetric(FA,Math.floor(C.startTime*1e3)),c&&f.putMetric(HA,Math.floor(c*1e3))}this.addWebVitalMetric(f,qA,Ak,o.lcp),this.addWebVitalMetric(f,zA,jk,o.cls),this.addWebVitalMetric(f,BA,Ck,o.inp),Zd(f),l2()}static addWebVitalMetric(e,t,a,o){o&&(e.putMetric(t,Math.floor(o.value*1e3)),o.elementAttribution&&e.putAttribute(a,o.elementAttribution))}static createUserTimingTrace(e,t){const a=new Jc(e,t,!1,t);Zd(a)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uh={},yT=!1,sC;function _T(n){Hv()&&(setTimeout(()=>_2(n),0),setTimeout(()=>y2(n),0),setTimeout(()=>E2(n),0))}function y2(n){const e=zt.getInstance(),t=e.getEntriesByType("resource");for(const a of t)vT(n,a);e.setupObserver("resource",a=>vT(n,a))}function _2(n){const e=zt.getInstance();"onpagehide"in window?e.document.addEventListener("pagehide",()=>Bp(n)):e.document.addEventListener("unload",()=>Bp(n)),e.document.addEventListener("visibilitychange",()=>{e.document.visibilityState==="hidden"&&Bp(n)}),e.onFirstInputDelay&&e.onFirstInputDelay(t=>{sC=t}),e.onLCP(t=>{var a;uh.lcp={value:t.value,elementAttribution:(a=t.attribution)===null||a===void 0?void 0:a.element}}),e.onCLS(t=>{var a;uh.cls={value:t.value,elementAttribution:(a=t.attribution)===null||a===void 0?void 0:a.largestShiftTarget}}),e.onINP(t=>{var a;uh.inp={value:t.value,elementAttribution:(a=t.attribution)===null||a===void 0?void 0:a.interactionTarget}})}function E2(n){const e=zt.getInstance(),t=e.getEntriesByType("measure");for(const a of t)ET(n,a);e.setupObserver("measure",a=>ET(n,a))}function ET(n,e){const t=e.name;t.substring(0,bg.length)!==bg&&Jc.createUserTimingTrace(n,t)}function Bp(n){if(!yT){yT=!0;const e=zt.getInstance(),t=e.getEntriesByType("navigation"),a=e.getEntriesByType("paint");setTimeout(()=>{Jc.createOobTrace(n,t,a,uh,sC)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b2{constructor(e,t){this.app=e,this.installations=t,this.initialized=!1}_init(e){this.initialized||(e?.dataCollectionEnabled!==void 0&&(this.dataCollectionEnabled=e.dataCollectionEnabled),e?.instrumentationEnabled!==void 0&&(this.instrumentationEnabled=e.instrumentationEnabled),zt.getInstance().requiredApisAvailable()?Cg().then(t=>{t&&(s2(),WA(this).then(()=>_T(this),()=>_T(this)),this.initialized=!0)}).catch(t=>{Di.info(`Environment doesn't support IndexedDB: ${t}`)}):Di.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){Gn.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return Gn.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){Gn.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return Gn.getInstance().dataCollectionEnabled}}const N2="[DEFAULT]";function T2(n=nu()){return n=gt(n),Ma(n,"performance").getImmediate()}const x2=(n,{options:e})=>{const t=n.getProvider("app").getImmediate(),a=n.getProvider("installations-internal").getImmediate();if(t.name!==N2)throw vn.create("FB not default");if(typeof window>"u")throw vn.create("no window");Ik(window);const o=new b2(t,a);return o._init(e),o};function A2(){cs(new Kn("performance",x2,"PUBLIC")),yn(dT,Eg),yn(dT,Eg,"esm2017")}A2();const C2={apiKey:"AIzaSyCbU834quCY8hjSffRwljJLgZrcxK8i2F4",authDomain:"liquidacionapp-62962.firebaseapp.com",projectId:"liquidacionapp-62962",storageBucket:"liquidacionapp-62962.firebasestorage.app",messagingSenderId:"851382130132",appId:"1:851382130132:web:eaba38fab449f14fb5b241"},yu=HT(C2);typeof window<"u"&&ik(yu);typeof window<"u"&&T2(yu);const Hc=n1(yu),Te=nM(yu);FM(yu);const Es={ADMIN:"admin",CONTADOR:"contador",CLIENTE:"cliente"},ht={MANAGE_INVENTORY:"canManageInventory",CREATE_MOVEMENTS:"canCreateMovements",VIEW_ALL_MOVEMENTS:"canViewAllMovements",MANAGE_VEHICLES:"canManageVehicles",MANAGE_MAINTENANCE:"canManageMaintenance",MANAGE_SUPPLIERS:"canManageSuppliers",VIEW_REPORTS:"canViewReports",EXPORT_REPORTS:"canExportReports",MODIFY_SETTINGS:"canModifySettings"},j2="contacto.evert@gmail.com",aC=n=>{switch(n){case Es.ADMIN:return{[ht.MANAGE_INVENTORY]:!0,[ht.CREATE_MOVEMENTS]:!0,[ht.VIEW_ALL_MOVEMENTS]:!0,[ht.MANAGE_VEHICLES]:!0,[ht.MANAGE_MAINTENANCE]:!0,[ht.MANAGE_SUPPLIERS]:!0,[ht.VIEW_REPORTS]:!0,[ht.EXPORT_REPORTS]:!0,[ht.MODIFY_SETTINGS]:!0};case Es.CONTADOR:return{[ht.MANAGE_INVENTORY]:!0,[ht.CREATE_MOVEMENTS]:!0,[ht.VIEW_ALL_MOVEMENTS]:!0,[ht.MANAGE_VEHICLES]:!1,[ht.MANAGE_MAINTENANCE]:!0,[ht.MANAGE_SUPPLIERS]:!1,[ht.VIEW_REPORTS]:!0,[ht.EXPORT_REPORTS]:!0,[ht.MODIFY_SETTINGS]:!1};case Es.CLIENTE:default:return{[ht.MANAGE_INVENTORY]:!1,[ht.CREATE_MOVEMENTS]:!0,[ht.VIEW_ALL_MOVEMENTS]:!1,[ht.MANAGE_VEHICLES]:!1,[ht.MANAGE_MAINTENANCE]:!1,[ht.MANAGE_SUPPLIERS]:!1,[ht.VIEW_REPORTS]:!1,[ht.EXPORT_REPORTS]:!1,[ht.MODIFY_SETTINGS]:!1}}},S2=n=>n===j2?Es.ADMIN:Es.CLIENTE,tl=()=>"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/invitations",w2=()=>{const n="ABCDEFGHIJKLMNPQRSTUVWXYZ123456789";let e="";for(let t=0;t<8;t++)e+=n.charAt(Math.floor(Math.random()*n.length));return e},I2=async(n,e)=>{try{const t=await pf(e);if(!t.success||t.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden crear invitaciones"};let a,o=!1,c=0;for(;!o&&c<10;){a=w2();const p=Oe(et(Te,tl()),Ke("code","==",a));(await kt(p)).empty&&(o=!0),c++}if(!o)return{success:!1,error:"No se pudo generar un código único"};const d=xt(et(Te,tl())),f={code:a,targetEmail:n.email.toLowerCase(),targetRole:n.role||Es.CLIENTE,targetName:n.name||"",status:"pending",appContext:"combustibles",expiresAt:new Date(Date.now()+7*24*60*60*1e3),createdAt:wt(),createdBy:e,usedAt:null,usedBy:null};return await cf(d,f),console.log("🎫 Invitación creada:",{code:a,email:n.email,role:n.role}),{success:!0,invitation:{id:d.id,code:a,...f}}}catch(t){return console.error("Error creating invitation:",t),{success:!1,error:t.message}}},iC=async n=>{try{const e=Oe(et(Te,tl()),Ke("code","==",n.toUpperCase()),Ke("status","==","pending")),t=await kt(e);if(t.empty)return{success:!1,error:"Código de invitación inválido o expirado"};const a=t.docs[0],o=a.data(),c=new Date,d=o.expiresAt.toDate();return c>d?{success:!1,error:"Código de invitación expirado"}:{success:!0,invitation:{id:a.id,...o}}}catch(e){return console.error("Error validating invitation:",e),{success:!1,error:e.message}}},R2=async(n,e)=>{try{const t=xt(Te,tl(),n);return await ka(t,{status:"used",usedAt:wt(),usedBy:e}),{success:!0}}catch(t){return console.error("Error marking invitation as used:",t),{success:!1,error:t.message}}},D2=async n=>{try{const e=await pf(n);if(!e.success||e.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden ver invitaciones"};const t=Oe(et(Te,tl())),a=await kt(t),o=[];return a.forEach(c=>{o.push({id:c.id,...c.data()})}),o.sort((c,d)=>{const f=c.createdAt?.toDate()||new Date(0);return(d.createdAt?.toDate()||new Date(0))-f}),{success:!0,invitations:o}}catch(e){return console.error("Error getting invitations:",e),{success:!1,error:e.message}}},O2=async(n,e)=>{try{const t=await pf(e);if(!t.success||t.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden cancelar invitaciones"};const a=xt(Te,tl(),n);return await ka(a,{status:"cancelled",cancelledAt:wt(),cancelledBy:e}),{success:!0}}catch(t){return console.error("Error cancelling invitation:",t),{success:!1,error:t.message}}},M2=n=>aC(n.targetRole),rC=async(n,e={})=>{const t=xt(Te,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n.uid);try{const a=await Ur(t);if(a.exists())return{success:!0,userData:a.data(),isNewUser:!1};{const o=S2(n.email),c={uid:n.uid,email:n.email,displayName:n.displayName||"",photoURL:n.photoURL||"",role:o,emailVerified:n.emailVerified,combustiblesPermissions:aC(o),createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),...e};return await cf(t,c),{success:!0,userData:c,isNewUser:!0}}}catch(a){return console.error("Error creating/updating user profile:",a),{success:!1,error:a.message}}},bT=async(n,e,t={})=>{const a=xt(Te,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n.uid);try{const o=await Ur(a);if(o.exists())return{success:!0,userData:o.data(),isNewUser:!1};const c=await iC(e);if(!c.success)return c;const d=c.invitation;if(d.targetEmail!==n.email.toLowerCase())return{success:!1,error:"El código de invitación no corresponde a este email"};const f={uid:n.uid,email:n.email,displayName:n.displayName||d.targetName||"",photoURL:n.photoURL||"",role:d.targetRole,emailVerified:n.emailVerified,combustiblesPermissions:M2(d),invitationUsed:d.id,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),...t};return await cf(a,f),await R2(d.id,n.uid),console.log("👤 Usuario creado con invitación:",{email:n.email,role:d.targetRole,invitationCode:d.code}),{success:!0,userData:f,isNewUser:!0}}catch(o){return console.error("Error creating user profile with invitation:",o),{success:!1,error:o.message}}},pf=async n=>{try{const e=xt(Te,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",n),t=await Ur(e);return t.exists()?{success:!0,userData:t.data()}:{success:!1,error:"Usuario no encontrado"}}catch(e){return console.error("Error fetching user profile:",e),{success:!1,error:e.message}}},oC=Y.createContext(),Zs=()=>{const n=Y.useContext(oC);if(n===void 0)throw new Error("useCombustibles must be used within a CombustiblesProvider");return n},P2=({children:n})=>{const[e,t]=Y.useState(null),[a,o]=Y.useState(null),[c,d]=Y.useState(!0),[f,p]=Y.useState(null),[v,_]=Y.useState([]),[N,C]=Y.useState([]),[j,b]=Y.useState([]),[M,x]=Y.useState([]);Y.useEffect(()=>{const R=zI(Hc,async I=>{try{if(d(!0),I){t(I);let P=await pf(I.uid);P.success||(P=await rC(I,{provider:"existing_account",appContext:"combustibles"})),P.success?o(P.userData):p("Error cargando perfil de usuario")}else t(null),o(null),_([]),C([]),b([]),x([])}catch(P){console.error("Error en autenticación:",P),p("Error de autenticación")}finally{d(!1)}});return()=>R()},[]);const A={user:e,userProfile:a,loading:c,error:f,hasPermission:R=>a?.combustiblesPermissions?.[R]||!1,isAdmin:()=>a?.role==="admin",isCounterOrAbove:()=>a?.role==="admin"||a?.role==="contador",inventory:v,movements:N,vehicles:j,suppliers:M,setInventory:_,setMovements:C,setVehicles:b,setSuppliers:x,refreshInventory:async()=>{console.log("Refrescando inventario...")},refreshMovements:async()=>{console.log("Refrescando movimientos...")},refreshVehicles:async()=>{console.log("Refrescando vehículos...")},refreshSuppliers:async()=>{console.log("Refrescando proveedores...")}};return r.jsx(oC.Provider,{value:A,children:n})},k2=({children:n,currentView:e,onViewChange:t})=>{const{userProfile:a,isAdmin:o,isCounterOrAbove:c}=Zs(),[d,f]=Y.useState(!1),p=[{id:"dashboard",name:"Dashboard",icon:"📊",description:"Vista general",requiredPermission:null},{id:"inventory",name:"Inventario",icon:"🛢️",description:"Gestión de stock",requiredPermission:"canManageInventory"},{id:"movements",name:"Movimientos",icon:"📈",description:"Entradas y salidas",requiredPermission:"canCreateMovements"},{id:"vehicles",name:"Vehículos",icon:"🚜",description:"Maquinaria forestal",requiredPermission:null},{id:"maintenance",name:"Mantenimiento",icon:"🔧",description:"Cambios de aceite y baterías",requiredPermission:"canManageMaintenance"},{id:"products",name:"Productos",icon:"🛢️",description:"Tipos de combustibles",requiredPermission:null},{id:"suppliers",name:"Proveedores",icon:"🏪",description:"Gestión de proveedores",requiredPermission:"canManageSuppliers"},{id:"reports",name:"Reportes",icon:"📋",description:"Análisis y reportes",requiredPermission:"canViewReports"},{id:"admin",name:"Administración",icon:"⚙️",description:"Gestión de usuarios",requiredPermission:"admin"}],v=j=>{t(j),f(!1)},_=j=>j?j==="admin"?o():a?.combustiblesPermissions?.[j]||!1:!0,N=p.filter(j=>_(j.requiredPermission)),C=async()=>{try{await GI(Hc)}catch(j){console.error("Error al cerrar sesión:",j)}};return r.jsxs("div",{className:"dashboard-layout",children:[r.jsx("header",{className:"dashboard-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"sidebar-toggle",onClick:()=>f(!d),children:"☰"}),r.jsxs("div",{className:"header-title",children:[r.jsx("h1",{children:"⛽ Gestión de Combustibles"}),r.jsx("span",{className:"subtitle",children:"Forestech Colombia"})]}),r.jsxs("div",{className:"header-user",children:[r.jsxs("div",{className:"user-info",children:[r.jsx("span",{className:"user-name",children:a?.displayName||a?.email}),r.jsx("span",{className:"user-role",children:a?.role})]}),r.jsx("div",{className:"user-avatar",children:a?.photoURL?r.jsx("img",{src:a.photoURL,alt:"Avatar"}):r.jsx("div",{className:"avatar-placeholder",children:(a?.displayName||a?.email||"U").charAt(0).toUpperCase()})}),r.jsx("button",{className:"logout-button",onClick:C,title:"Cerrar sesión",children:"🚪"})]})]})}),r.jsxs("div",{className:"dashboard-body",children:[r.jsxs("aside",{className:`dashboard-sidebar ${d?"open":""}`,children:[r.jsx("nav",{className:"sidebar-nav",children:N.map(j=>r.jsxs("button",{className:`nav-item ${e===j.id?"active":""}`,onClick:()=>v(j.id),children:[r.jsx("span",{className:"nav-icon",children:j.icon}),r.jsxs("div",{className:"nav-content",children:[r.jsx("span",{className:"nav-name",children:j.name}),r.jsx("span",{className:"nav-description",children:j.description})]})]},j.id))}),r.jsx("div",{className:"sidebar-footer",children:r.jsxs("div",{className:"user-permissions",children:[r.jsx("h4",{children:"Permisos Activos:"}),r.jsxs("div",{className:"permission-list",children:[o()&&r.jsx("span",{className:"permission admin",children:"👑 Administrador"}),c()&&r.jsx("span",{className:"permission counter",children:"📊 Gestión Operativa"}),_("canManageInventory")&&r.jsx("span",{className:"permission",children:"🛢️ Inventario"}),_("canManageVehicles")&&r.jsx("span",{className:"permission",children:"🚜 Vehículos"})]})]})})]}),r.jsx("main",{className:"dashboard-main",children:r.jsx("div",{className:"main-content",children:n})})]}),d&&r.jsx("div",{className:"sidebar-overlay",onClick:()=>f(!1)})]})},An={DIESEL:"diesel",GASOLINE:"gasoline",ACPM:"acpm",LUBRICANTS:"lubricants",TWO_STROKE:"two_stroke",MIXED:"mixed"},nl={[An.DIESEL]:{name:"Diésel",description:"Combustible para maquinaria pesada",unit:"galones",category:"Combustible",color:"#fbbf24",icon:"🚛",density:.85,priceUnit:"COP/galón"},[An.GASOLINE]:{name:"Gasolina",description:"Combustible para vehículos livianos",unit:"galones",category:"Combustible",color:"#ef4444",icon:"⛽",density:.75,priceUnit:"COP/galón"},[An.ACPM]:{name:"ACPM",description:"Aceite Combustible Para Motor",unit:"galones",category:"Combustible",color:"#8b5cf6",icon:"🚜",density:.85,priceUnit:"COP/galón"},[An.LUBRICANTS]:{name:"Lubricantes",description:"Aceites y lubricantes para mantenimiento",unit:"litros",category:"Mantenimiento",color:"#06b6d4",icon:"🛢️",density:.9,priceUnit:"COP/litro"},[An.TWO_STROKE]:{name:"Mezcla 2T",description:"Mezcla para motores de 2 tiempos (motosierras)",unit:"litros",category:"Especializado",color:"#10b981",icon:"🪚",density:.78,priceUnit:"COP/litro"},[An.MIXED]:{name:"Mixto",description:"Compatible con múltiples tipos de combustible",unit:"galones",category:"Flexible",color:"#64748b",icon:"🔄",density:.8,priceUnit:"COP/galón"}},xn={CRITICAL:"critical",LOW:"low",MEDIUM:"medium",HIGH:"high",FULL:"full"},Ho={[xn.CRITICAL]:{label:"Crítico",color:"#dc2626",icon:"🚨",threshold:.1},[xn.LOW]:{label:"Bajo",color:"#ea580c",icon:"⚠️",threshold:.25},[xn.MEDIUM]:{label:"Medio",color:"#ca8a04",icon:"📊",threshold:.5},[xn.HIGH]:{label:"Alto",color:"#16a34a",icon:"✅",threshold:.75},[xn.FULL]:{label:"Completo",color:"#059669",icon:"🟢",threshold:1}},lC=(n,e)=>{if(e===0)return xn.CRITICAL;const t=n/e;return t<Ho[xn.CRITICAL].threshold?xn.CRITICAL:t<Ho[xn.LOW].threshold?xn.LOW:t<Ho[xn.MEDIUM].threshold?xn.MEDIUM:t<Ho[xn.HIGH].threshold?xn.HIGH:xn.FULL},sl="combustibles_inventory",L2=async(n,e)=>{try{const t=nl[n.fuelType];if(!t)return{success:!1,error:"Tipo de combustible no válido"};const a=Oe(et(Te,sl),Ke("fuelType","==",n.fuelType),Ke("location","==",n.location));if(!(await kt(a)).empty)return{success:!1,error:`Ya existe ${t.name} en ${n.location}`};const c={fuelType:n.fuelType,name:t.name,description:n.description||t.description,currentStock:Number(n.currentStock)||0,maxCapacity:Number(n.maxCapacity),minThreshold:Number(n.minThreshold)||n.maxCapacity*.15,unit:t.unit,location:n.location,pricePerUnit:Number(n.pricePerUnit)||0,supplier:n.supplier||"",status:n.status||"active",createdAt:new Date,createdBy:e,lastUpdated:new Date,updatedBy:e};return{success:!0,data:{id:(await gu(et(Te,sl),c)).id,...c},message:`${t.name} agregado al inventario exitosamente`}}catch(t){return console.error("Error creating inventory item:",t),{success:!1,error:t.message}}},cC=async()=>{try{const n=Oe(et(Te,sl),Qn("fuelType","asc")),e=await kt(n),t=[];return e.forEach(a=>{const o=a.data();t.push({id:a.id,...o,stockLevel:lC(o.currentStock,o.maxCapacity),stockPercentage:Math.round(o.currentStock/o.maxCapacity*100),needsRestock:o.currentStock<=o.minThreshold})}),{success:!0,data:t}}catch(n){return console.error("Error fetching inventory items:",n),{success:!1,error:n.message}}},V2=async(n,e,t)=>{try{const a=xt(Te,sl,n);if(!(await Ur(a)).exists())return{success:!1,error:"Item no encontrado"};const c={...e,lastUpdated:new Date,updatedBy:t};return delete c.id,delete c.createdAt,delete c.createdBy,await ka(a,c),{success:!0,message:"Item actualizado exitosamente",data:{id:n,...c}}}catch(a){return console.error("Error updating inventory item:",a),{success:!1,error:a.message}}},U2=async n=>{try{const e=xt(Te,sl,n);return(await Ur(e)).exists()?(await Sv(e),{success:!0,message:"Item eliminado exitosamente"}):{success:!1,error:"Item no encontrado"}}catch(e){return console.error("Error deleting inventory item:",e),{success:!1,error:e.message}}},uC=n=>{const e=Oe(et(Te,sl),Qn("fuelType","asc"));return dl(e,t=>{const a=[];t.forEach(o=>{const c=o.data();a.push({id:o.id,...c,stockLevel:lC(c.currentStock,c.maxCapacity),stockPercentage:Math.round(c.currentStock/c.maxCapacity*100),needsRestock:c.currentStock<=c.minThreshold})}),n(a)},t=>{console.error("Error in inventory subscription:",t),n(null,t)})},F2=async()=>{try{const n=await cC();if(!n.success)return n;const e=n.data,t={totalItems:e.length,activeItems:e.filter(a=>a.status==="active").length,lowStockItems:e.filter(a=>a.needsRestock).length,totalValue:e.reduce((a,o)=>a+o.currentStock*o.pricePerUnit,0),averageStockLevel:e.length>0?Math.round(e.reduce((a,o)=>a+o.stockPercentage,0)/e.length):0,byFuelType:{}};return e.forEach(a=>{t.byFuelType[a.fuelType]||(t.byFuelType[a.fuelType]={count:0,totalStock:0,totalCapacity:0,totalValue:0}),t.byFuelType[a.fuelType].count++,t.byFuelType[a.fuelType].totalStock+=a.currentStock,t.byFuelType[a.fuelType].totalCapacity+=a.maxCapacity,t.byFuelType[a.fuelType].totalValue+=a.currentStock*a.pricePerUnit}),{success:!0,data:t}}catch(n){return console.error("Error calculating inventory stats:",n),{success:!1,error:n.message}}},fl="combustibles_movements",NT="combustibles_inventory",be={ENTRADA:"entrada",SALIDA:"salida",TRANSFERENCIA:"transferencia",AJUSTE:"ajuste"},$e={PENDIENTE:"pendiente",COMPLETADO:"completado",CANCELADO:"cancelado"},H2=async n=>{try{$2(n);const e={...n,createdAt:wt(),updatedAt:wt(),status:$e.PENDIENTE,totalValue:hC(n),effectiveDate:n.effectiveDate||wt()},t=await nA(Te,async a=>{const o=xt(et(Te,fl));return a.set(o,e),await fC(a,e,o.id),o.id});return console.log("✅ Movimiento creado exitosamente:",t),t}catch(e){throw console.error("❌ Error al crear movimiento:",e),new Error(`Error al crear movimiento: ${e.message}`)}},q2=async(n={})=>{try{let e=et(Te,fl);n.type&&(e=Oe(e,Ke("type","==",n.type))),n.status&&(e=Oe(e,Ke("status","==",n.status))),n.fuelType&&(e=Oe(e,Ke("fuelType","==",n.fuelType))),n.vehicleId&&(e=Oe(e,Ke("vehicleId","==",n.vehicleId))),e=Oe(e,Qn("createdAt","desc"));const t=await kt(e),a=[];return t.forEach(o=>{a.push({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate?.()||o.data().createdAt,updatedAt:o.data().updatedAt?.toDate?.()||o.data().updatedAt,effectiveDate:o.data().effectiveDate?.toDate?.()||o.data().effectiveDate})}),a}catch(e){throw console.error("❌ Error al obtener movimientos:",e),new Error(`Error al obtener movimientos: ${e.message}`)}},B2=async n=>{try{if(!n)throw new Error("ID de movimiento requerido");const e=xt(Te,fl,n),t=await Ur(e);return t.exists()?{id:t.id,...t.data(),createdAt:t.data().createdAt?.toDate?.()||t.data().createdAt,updatedAt:t.data().updatedAt?.toDate?.()||t.data().updatedAt,effectiveDate:t.data().effectiveDate?.toDate?.()||t.data().effectiveDate}:null}catch(e){throw console.error("❌ Error al obtener movimiento:",e),new Error(`Error al obtener movimiento: ${e.message}`)}},dC=async(n,e)=>{try{if(!n)throw new Error("ID de movimiento requerido");const t={...e,updatedAt:wt(),...e.quantity||e.unitPrice?{totalValue:hC(e)}:{}},a=xt(Te,fl,n);await ka(a,t),console.log("✅ Movimiento actualizado exitosamente")}catch(t){throw console.error("❌ Error al actualizar movimiento:",t),new Error(`Error al actualizar movimiento: ${t.message}`)}},zv=(n,e={})=>{try{let t=et(Te,fl);return e.type&&(t=Oe(t,Ke("type","==",e.type))),e.status&&(t=Oe(t,Ke("status","==",e.status))),t=Oe(t,Qn("createdAt","desc")),dl(t,a=>{const o=[];a.forEach(c=>{o.push({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt,effectiveDate:c.data().effectiveDate?.toDate?.()||c.data().effectiveDate})}),n(o)},a=>{console.error("❌ Error en suscripción de movimientos:",a),n([],a)})}catch(t){throw console.error("❌ Error al configurar suscripción:",t),new Error(`Error en suscripción: ${t.message}`)}},z2=async n=>{try{const e=await B2(n);if(!e)throw new Error("Movimiento no encontrado");if(e.status!==$e.PENDIENTE)throw new Error("Solo se pueden aprobar movimientos pendientes");await nA(Te,async t=>{const a=xt(Te,fl,n);t.update(a,{status:$e.COMPLETADO,approvedAt:wt(),updatedAt:wt()}),await fC(t,e,n)}),console.log("✅ Movimiento aprobado exitosamente")}catch(e){throw console.error("❌ Error al aprobar movimiento:",e),new Error(`Error al aprobar movimiento: ${e.message}`)}},G2=async(n={})=>{try{const e=await q2(n),t={totalMovements:e.length,byType:{},byStatus:{},byFuelType:{},totalValue:0,totalQuantity:0,averageValue:0,thisMonth:0,lastMonth:0,thisWeek:0},a=new Date,o=new Date(a.getFullYear(),a.getMonth(),1),c=new Date(a.getFullYear(),a.getMonth()-1,1),d=new Date(a.setDate(a.getDate()-a.getDay()));return e.forEach(f=>{t.byType[f.type]=(t.byType[f.type]||0)+1,t.byStatus[f.status]=(t.byStatus[f.status]||0)+1,t.byFuelType[f.fuelType]=(t.byFuelType[f.fuelType]||0)+1,t.totalValue+=f.totalValue||0,t.totalQuantity+=f.quantity||0;const p=new Date(f.createdAt);p>=o&&t.thisMonth++,p>=c&&p<o&&t.lastMonth++,p>=d&&t.thisWeek++}),t.averageValue=t.totalMovements>0?t.totalValue/t.totalMovements:0,t}catch(e){throw console.error("❌ Error al calcular estadísticas:",e),new Error(`Error al calcular estadísticas: ${e.message}`)}},$2=n=>{const e=["type","fuelType","quantity","unitPrice"];for(const t of e)if(!n[t])throw new Error(`Campo requerido: ${t}`);if(!Object.values(be).includes(n.type))throw new Error("Tipo de movimiento inválido");if(n.quantity<=0)throw new Error("La cantidad debe ser mayor a cero");if(n.unitPrice<0)throw new Error("El precio unitario no puede ser negativo");if(n.type===be.SALIDA&&!n.vehicleId)throw new Error("Las salidas deben tener un vehículo asociado");if(n.type===be.TRANSFERENCIA&&!n.destinationLocation)throw new Error("Las transferencias deben tener una ubicación destino")},hC=n=>(n.quantity||0)*(n.unitPrice||0),fC=async(n,e,t)=>{try{const a=Oe(et(Te,NT),Ke("fuelType","==",e.fuelType),Ke("location","==",e.location||"principal")),o=await kt(a);if(o.empty)throw new Error(`No se encontró inventario para ${e.fuelType} en ${e.location||"ubicación principal"}`);const c=o.docs[0],d=c.data(),f=xt(Te,NT,c.id);let p=d.currentStock;switch(e.type){case be.ENTRADA:p+=e.quantity;break;case be.SALIDA:if(p-=e.quantity,p<0)throw new Error("Stock insuficiente para realizar la salida");break;case be.AJUSTE:p+=e.quantity,p<0&&(p=0);break;case be.TRANSFERENCIA:if(p-=e.quantity,p<0)throw new Error("Stock insuficiente para realizar la transferencia");break}n.update(f,{currentStock:p,lastMovement:{movementId:t,type:e.type,quantity:e.quantity,date:wt()},updatedAt:wt()})}catch(a){throw console.error("❌ Error al actualizar inventario:",a),a}},Y2=[{vehicleId:"AL-001",name:"Apoyo Logístico",type:"apoyo_logistico",brand:"Forestech",model:"Logística",year:2023,fuelType:Re.DIESEL,fuelCapacity:80,enginePower:150,status:ve.ACTIVO,currentLocation:"Base Central",description:"Vehículo para apoyo logístico general",estimatedConsumptionPerHour:4.5},{vehicleId:"ASP-001",name:"Asperjadora",type:"asperjadora",brand:"Jacto",model:"PJ600",year:2022,fuelType:Re.GASOLINA,fuelCapacity:25,enginePower:80,status:ve.ACTIVO,currentLocation:"Sector Fumigación",description:"Asperjadora para control fitosanitario",estimatedConsumptionPerHour:2.8},{vehicleId:"MB-AUS-001",name:"Motobomba Austria-Casino",type:"motobomba",brand:"Honda",model:"WB30X",year:2021,fuelType:Re.GASOLINA,fuelCapacity:15,enginePower:120,status:ve.ACTIVO,currentLocation:"Campamento Austria-Casino",description:"Motobomba para sector Austria-Casino",estimatedConsumptionPerHour:3.2},{vehicleId:"CAM-AM-001",name:"Camioneta Toyota Amarilla",type:fe.CAMION,brand:"Toyota",model:"Hilux",year:2020,fuelType:Re.DIESEL,fuelCapacity:80,enginePower:150,status:ve.ACTIVO,currentLocation:"Área Administrativa",description:"Camioneta Toyota color amarillo para transporte",plateNumber:"FOR-001",estimatedConsumptionPerHour:5},{vehicleId:"CAM-AZ-001",name:"Camioneta Toyota Azul",type:fe.CAMION,brand:"Toyota",model:"Hilux",year:2019,fuelType:Re.DIESEL,fuelCapacity:80,enginePower:150,status:ve.ACTIVO,currentLocation:"Sector Norte",description:"Camioneta Toyota color azul para transporte",plateNumber:"FOR-002",estimatedConsumptionPerHour:5},{vehicleId:"CAM-GR-001",name:"Camioneta Toyota Gris",type:fe.CAMION,brand:"Toyota",model:"Hilux",year:2021,fuelType:Re.DIESEL,fuelCapacity:80,enginePower:150,status:ve.ACTIVO,currentLocation:"Sector Sur",description:"Camioneta Toyota color gris para transporte",plateNumber:"FOR-003",estimatedConsumptionPerHour:5},{vehicleId:"MB-ATA-001",name:"Motobomba Campamento Atabapo",type:"motobomba",brand:"Honda",model:"WB20X",year:2022,fuelType:Re.GASOLINA,fuelCapacity:12,enginePower:100,status:ve.ACTIVO,currentLocation:"Campamento Atabapo",description:"Motobomba para suministro de agua - Atabapo",estimatedConsumptionPerHour:2.8},{vehicleId:"MB-ILU-001",name:"Motobomba Campamento Ilusión",type:"motobomba",brand:"Honda",model:"WB20X",year:2022,fuelType:Re.GASOLINA,fuelCapacity:12,enginePower:100,status:ve.ACTIVO,currentLocation:"Campamento Ilusión",description:"Motobomba para suministro de agua - Ilusión",estimatedConsumptionPerHour:2.8},{vehicleId:"MB-VIV-001",name:"Motobomba Riego Vivero",type:"motobomba",brand:"Honda",model:"WB15X",year:2023,fuelType:Re.GASOLINA,fuelCapacity:10,enginePower:80,status:ve.ACTIVO,currentLocation:"Vivero Principal",description:"Motobomba dedicada al riego del vivero",estimatedConsumptionPerHour:2.4},{vehicleId:"MB-TER-001",name:"Motobomba Campamento Terquedad",type:"motobomba",brand:"Honda",model:"WB20X",year:2021,fuelType:Re.GASOLINA,fuelCapacity:12,enginePower:100,status:ve.ACTIVO,currentLocation:"Campamento Terquedad",description:"Motobomba para suministro de agua - Terquedad",estimatedConsumptionPerHour:2.8},{vehicleId:"MB-BAR-001",name:"Motobomba Campamento Barquereña",type:"motobomba",brand:"Honda",model:"WB30X",year:2022,fuelType:Re.GASOLINA,fuelCapacity:15,enginePower:120,status:ve.ACTIVO,currentLocation:"Campamento Barquereña",description:"Motobomba para suministro de agua - Barquereña",estimatedConsumptionPerHour:3.2},{vehicleId:"FUM-001",name:"Fumigadoras Motorizadas",type:"fumigadora",brand:"Stihl",model:"SR450",year:2022,fuelType:Re.GASOLINA,fuelCapacity:5,enginePower:45,status:ve.ACTIVO,currentLocation:"Almacén Fitosanitario",description:"Fumigadoras motorizadas para aplicación de productos",estimatedConsumptionPerHour:1.5},{vehicleId:"CQ-001",name:"Control Químico",type:"control_quimico",brand:"Jacto",model:"PJH",year:2023,fuelType:Re.GASOLINA,fuelCapacity:20,enginePower:60,status:ve.ACTIVO,currentLocation:"Sector Control",description:"Equipo especializado para control químico",estimatedConsumptionPerHour:2},{vehicleId:"GUA-001",name:"Guadañas",type:"guadana",brand:"Stihl",model:"FS250",year:2022,fuelType:Re.GASOLINA,fuelCapacity:2,enginePower:25,status:ve.ACTIVO,currentLocation:"Almacén Herramientas",description:"Guadañas para mantenimiento y limpieza",estimatedConsumptionPerHour:.8},{vehicleId:"HID-001",name:"Hidrolavadora",type:"hidrolavadora",brand:"Karcher",model:"HD7/18",year:2021,fuelType:Re.GASOLINA,fuelCapacity:8,enginePower:70,status:ve.ACTIVO,currentLocation:"Taller Principal",description:"Hidrolavadora para limpieza de equipos",estimatedConsumptionPerHour:2.2},{vehicleId:"MOT-HON-001",name:"Moto Honda XTZ 150",type:"motocicleta",brand:"Honda",model:"XTZ150",year:2020,fuelType:Re.GASOLINA,fuelCapacity:12,enginePower:15,status:ve.ACTIVO,currentLocation:"Base Central",description:"Motocicleta Honda para transporte rápido",plateNumber:"MOT-001",estimatedConsumptionPerHour:1.2},{vehicleId:"MOT-YAM-001",name:"Moto XTZ Yamaha 125",type:"motocicleta",brand:"Yamaha",model:"XTZ125",year:2021,fuelType:Re.GASOLINA,fuelCapacity:10,enginePower:12,status:ve.ACTIVO,currentLocation:"Sector Este",description:"Motocicleta Yamaha para supervisión",plateNumber:"MOT-002",estimatedConsumptionPerHour:1},{vehicleId:"MB-EST-001",name:"Motobomba Estacionaria",type:"motobomba",brand:"Honda",model:"WB40X",year:2022,fuelType:Re.DIESEL,fuelCapacity:25,enginePower:200,status:ve.ACTIVO,currentLocation:"Planta de Tratamiento",description:"Motobomba estacionaria de alta capacidad",estimatedConsumptionPerHour:4.8},{vehicleId:"MS-001",name:"Motosierra",type:fe.MOTOSIERRA,brand:"Stihl",model:"MS361",year:2023,fuelType:Re.GASOLINA,fuelCapacity:1.5,enginePower:35,status:ve.ACTIVO,currentLocation:"Almacén Forestal",description:"Motosierra profesional para actividades forestales",estimatedConsumptionPerHour:1.2},{vehicleId:"PE-001",name:"Planta Eléctrica",type:"planta_electrica",brand:"Caterpillar",model:"C15",year:2020,fuelType:Re.DIESEL,fuelCapacity:200,enginePower:400,status:ve.ACTIVO,currentLocation:"Subestación Principal",description:"Planta eléctrica de respaldo principal",estimatedConsumptionPerHour:12},{vehicleId:"CRH-001",name:"Control Rodamiento Hormigas",type:"control_hormigas",brand:"Forestech",model:"CRH-Pro",year:2023,fuelType:Re.GASOLINA,fuelCapacity:15,enginePower:50,status:ve.ACTIVO,currentLocation:"Sector Protección",description:"Equipo especializado para control de hormigas cortadoras",estimatedConsumptionPerHour:1.8},{vehicleId:"TR1",name:"Tractor TR1",type:fe.TRACTOR,brand:"John Deere",model:"6120M",year:2021,fuelType:Re.DIESEL,fuelCapacity:280,enginePower:120,status:ve.ACTIVO,currentLocation:"Sector Norte",description:"Tractor principal para trabajos pesados",estimatedConsumptionPerHour:8.5,hasHourMeter:!0,currentHours:1250,lastHourMeterReading:1250,lastHourMeterDate:new Date().toISOString()},{vehicleId:"TR2",name:"Tractor TR2",type:fe.TRACTOR,brand:"John Deere",model:"6130M",year:2022,fuelType:Re.DIESEL,fuelCapacity:280,enginePower:130,status:ve.ACTIVO,currentLocation:"Sector Central",description:"Tractor secundario para trabajos medianos",estimatedConsumptionPerHour:9,hasHourMeter:!0,currentHours:950,lastHourMeterReading:950,lastHourMeterDate:new Date().toISOString()},{vehicleId:"TR3",name:"Tractor TR3",type:fe.TRACTOR,brand:"John Deere",model:"6110M",year:2020,fuelType:Re.DIESEL,fuelCapacity:260,enginePower:110,status:ve.ACTIVO,currentLocation:"Sector Sur",description:"Tractor de apoyo para trabajos livianos",estimatedConsumptionPerHour:7.8,hasHourMeter:!0,currentHours:1580,lastHourMeterReading:1580,lastHourMeterDate:new Date().toISOString()},{vehicleId:"VOL-001",name:"Volqueta",type:fe.VOLQUETA,brand:"Chevrolet",model:"NPR",year:2019,fuelType:Re.DIESEL,fuelCapacity:120,enginePower:180,status:ve.ACTIVO,currentLocation:"Patio de Materiales",description:"Volqueta para transporte de materiales",plateNumber:"VOL-001",estimatedConsumptionPerHour:6.5}],K2=()=>Y2.map(n=>({...n,createdAt:new Date,updatedAt:new Date,totalFuelConsumed:0,totalHoursWorked:n.hasHourMeter?n.currentHours:0,totalMovements:0,lastMovementDate:null})),Vh="combustibles_vehicles",fe={EXCAVADORA:"excavadora",BULLDOZER:"bulldozer",CARGADOR:"cargador",CAMION:"camion",GRUA:"grua",MOTOSIERRA:"motosierra",TRACTOR:"tractor",VOLQUETA:"volqueta",OTROS:"otros"},ve={ACTIVO:"activo",MANTENIMIENTO:"mantenimiento",INACTIVO:"inactivo",REPARACION:"reparacion"},Re={DIESEL:"Diesel",GASOLINA:"Gasolina",ACPM:"ACPM",MIXTO:"Mixto"},mC=async(n={})=>{try{await X2();let e=et(Te,Vh);n.type&&(e=Oe(e,Ke("type","==",n.type))),n.status&&(e=Oe(e,Ke("status","==",n.status))),n.fuelType&&(e=Oe(e,Ke("fuelType","==",n.fuelType))),n.location&&(e=Oe(e,Ke("currentLocation","==",n.location))),e=Oe(e,Qn("vehicleId","asc"));const t=await kt(e),a=[];return t.forEach(o=>{a.push({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate?.()||o.data().createdAt,updatedAt:o.data().updatedAt?.toDate?.()||o.data().updatedAt,lastMovementDate:o.data().lastMovementDate?.toDate?.()||o.data().lastMovementDate,lastMaintenanceDate:o.data().lastMaintenanceDate?.toDate?.()||o.data().lastMaintenanceDate})}),a}catch(e){throw console.error("❌ Error al obtener vehículos:",e),new Error(`Error al obtener vehículos: ${e.message}`)}},pC=(n,e={})=>{try{let t=et(Te,Vh);return e.type&&(t=Oe(t,Ke("type","==",e.type))),e.status&&(t=Oe(t,Ke("status","==",e.status))),t=Oe(t,Qn("vehicleId","asc")),dl(t,a=>{const o=[];a.forEach(c=>{o.push({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt,lastMovementDate:c.data().lastMovementDate?.toDate?.()||c.data().lastMovementDate,lastMaintenanceDate:c.data().lastMaintenanceDate?.toDate?.()||c.data().lastMaintenanceDate})}),n(o)},a=>{console.error("❌ Error en suscripción de vehículos:",a),n([],a)})}catch(t){throw console.error("❌ Error al configurar suscripción:",t),new Error(`Error en suscripción: ${t.message}`)}},Q2=async(n={})=>{try{const e=await mC(n),t={totalVehicles:e.length,byType:{},byStatus:{},byFuelType:{},totalFuelConsumed:0,totalHoursWorked:0,averageConsumption:0,mostActiveVehicle:null,leastActiveVehicle:null};let a=0,o=1/0;return e.forEach(c=>{t.byType[c.type]=(t.byType[c.type]||0)+1,t.byStatus[c.status]=(t.byStatus[c.status]||0)+1,t.byFuelType[c.fuelType]=(t.byFuelType[c.fuelType]||0)+1,t.totalFuelConsumed+=c.totalFuelConsumed||0,t.totalHoursWorked+=c.totalHoursWorked||0;const d=c.totalMovements||0;d>a&&(a=d,t.mostActiveVehicle=c),d<o&&d>0&&(o=d,t.leastActiveVehicle=c)}),t.totalHoursWorked>0&&(t.averageConsumption=t.totalFuelConsumed/t.totalHoursWorked),t}catch(e){throw console.error("❌ Error al calcular estadísticas:",e),new Error(`Error al calcular estadísticas: ${e.message}`)}},X2=async()=>{try{const n=Oe(et(Te,Vh),W0(1));if(!(await kt(n)).empty)return console.log("✅ Vehículos ya existen en Firebase"),{success:!0,created:0,message:"Vehículos ya inicializados"};console.log("🚀 Inicializando vehículos predefinidos...");const t=K2();let a=0,o=0;for(const c of t)try{const d={...c,createdAt:wt(),updatedAt:wt(),totalFuelConsumed:0,totalHoursWorked:0,totalMovements:0,lastMovementDate:null};await gu(et(Te,Vh),d),a++,console.log(`✅ Creado: ${c.vehicleId} - ${c.name}`)}catch(d){o++,console.error(`❌ Error creando ${c.vehicleId}:`,d.message)}return console.log(`🎉 Inicialización completada: ${a} creados, ${o} errores`),{success:o===0,created:a,errors:o,total:t.length}}catch(n){return console.error("❌ Error en inicialización de vehículos:",n),{success:!1,error:n.message}}},Aa={ACPM:"ACPM",GASOLINA:"GASOLINA",ACEITE_HIDRAULICO:"ACEITE_HIDRAULICO",ACEITE_MOTOR_20W50:"ACEITE_MOTOR_20W50",GRASA_ROJA:"GRASA_ROJA",VALVULINA:"VALVULINA",LIQUIDO_FRENOS:"LIQUIDO_FRENOS",MISTURA_LIGA:"MISTURA_LIGA",ACEITE_TRACTORES_15W40:"ACEITE_TRACTORES_15W40"},gC={[Aa.ACPM]:{name:"ACPM",displayName:"ACPM 🚛",category:"Combustible",unit:"gal",defaultPrice:12500,color:"#FF6B35",icon:"🚛",description:"Combustible diesel para vehículos pesados"},[Aa.GASOLINA]:{name:"GASOLINA",displayName:"Gasolina 🚗",category:"Combustible",unit:"gal",defaultPrice:14200,color:"#4CAF50",icon:"🚗",description:"Gasolina corriente para vehículos livianos"},[Aa.ACEITE_HIDRAULICO]:{name:"ACEITE_HIDRAULICO",displayName:"Aceite Hidráulico 🔧",category:"Aceite",unit:"L",defaultPrice:28e3,color:"#2196F3",icon:"🔧",description:"Aceite hidráulico para sistemas de maquinaria"},[Aa.ACEITE_MOTOR_20W50]:{name:"ACEITE_MOTOR_20W50",displayName:"Aceite Motor 20W50 🛢️",category:"Aceite",unit:"L",defaultPrice:35e3,color:"#FF9800",icon:"🛢️",description:"Aceite multigrado para motores"},[Aa.GRASA_ROJA]:{name:"GRASA_ROJA",displayName:"Grasa Roja 🟥",category:"Lubricante",unit:"kg",defaultPrice:12e3,color:"#F44336",icon:"🟥",description:"Grasa lubricante multipropósito"},[Aa.VALVULINA]:{name:"VALVULINA",displayName:"Valvulina ⚙️",category:"Aceite",unit:"L",defaultPrice:25e3,color:"#9C27B0",icon:"⚙️",description:"Aceite para transmisiones y diferenciales"},[Aa.LIQUIDO_FRENOS]:{name:"LIQUIDO_FRENOS",displayName:"Líquido para Frenos 🛑",category:"Fluido",unit:"L",defaultPrice:18e3,color:"#E91E63",icon:"🛑",description:"Líquido de frenos DOT 3/4"},[Aa.MISTURA_LIGA]:{name:"MISTURA_LIGA",displayName:"Mistura o Liga 🌿",category:"Combustible",unit:"L",defaultPrice:8500,color:"#4CAF50",icon:"🌿",description:"Mezcla de combustible para equipos menores"},[Aa.ACEITE_TRACTORES_15W40]:{name:"ACEITE_TRACTORES_15W40",displayName:"Aceite Tractores 15W40 🚜",category:"Aceite",unit:"L",defaultPrice:32e3,color:"#795548",icon:"🚜",description:"Aceite especializado para tractores"}},qs={COMBUSTIBLE:"Combustible",ACEITE:"Aceite",LUBRICANTE:"Lubricante",FLUIDO:"Fluido"},TT=()=>Object.values(gC),xT="combustibles_products",W2=async()=>{try{console.log("🔄 Verificando productos existentes...");const n=Oe(et(Te,xT),W0(1));if(!(await kt(n)).empty){console.log("✅ Productos ya existen en Firebase");return}console.log("📦 Creando productos predefinidos...");const t=Object.values(gC).map(async o=>{const c={name:o.name,displayName:o.displayName,category:o.category,unit:o.unit,defaultPrice:o.defaultPrice,color:o.color,icon:o.icon,description:o.description,isActive:!0,createdAt:new Date,updatedAt:new Date,createdBy:"system-initialization"},d=xt(et(Te,xT));return await cf(d,c),console.log(`✅ Producto creado: ${o.displayName}`),{id:d.id,...c}}),a=await Promise.all(t);return console.log(`🎉 ${a.length} productos inicializados correctamente`),a}catch(n){throw console.error("❌ Error inicializando productos:",n),n}},Z2=async()=>{try{await W2()}catch(n){console.error("❌ Error en inicialización automática:",n)}},al="combustibles_products",zp=async n=>{try{const e={...n,createdAt:wt(),updatedAt:wt()},t=await gu(et(Te,al),e);return console.log("Product created with ID:",t.id),t.id}catch(e){throw console.error("Error creating product:",e),e}},J2=async(n,e)=>{try{const t=xt(Te,al,n);await ka(t,{...e,updatedAt:wt()}),console.log("Product updated successfully")}catch(t){throw console.error("Error updating product:",t),t}},eL=async n=>{try{await Sv(xt(Te,al,n)),console.log("Product deleted successfully")}catch(e){throw console.error("Error deleting product:",e),e}},tL=async()=>{try{await Z2(),console.log("🔍 Obteniendo productos activos...");const n=Oe(et(Te,al),Ke("isActive","==",!0),Qn("name")),t=(await kt(n)).docs.map(a=>({id:a.id,...a.data()}));return console.log(`✅ Productos activos obtenidos: ${t.length}`),t}catch(n){if(console.error("❌ Error obteniendo productos activos:",n),n.code==="failed-precondition"||n.message.includes("index")){console.warn("⚠️ Índice no disponible, usando consulta alternativa...");try{const e=Oe(et(Te,al),Ke("isActive","==",!0)),o=(await kt(e)).docs.map(c=>({id:c.id,...c.data()})).sort((c,d)=>(c.name||"").localeCompare(d.name||""));return console.log(`✅ Productos activos obtenidos (ordenamiento en cliente): ${o.length}`),o}catch(e){throw console.error("❌ Error en consulta alternativa:",e),e}}throw n}},vC=(n,e)=>{try{const t=Oe(et(Te,al),Qn("name"));return dl(t,a=>{const o=a.docs.map(c=>({id:c.id,...c.data()}));n(o)},a=>{console.error("Error in products subscription:",a),e(a)})}catch(t){return console.error("Error setting up products subscription:",t),e(t),()=>{}}},_u="combustibles_maintenance",yC="combustibles_vehicles",me={OIL_CHANGE:"oil_change",BATTERY_CHANGE:"battery_change",FILTER_CHANGE:"filter_change",GENERAL_MAINTENANCE:"general_maintenance"},Pe={COMPLETED:"completado",PENDING:"pendiente",CANCELLED:"cancelado"},qo={NEW:"nueva",USED:"usada",REPAIRED:"reparada"},Gv={OIL_CHANGE_HOURS:250,BATTERY_LIFETIME_MONTHS:24},_C=async n=>{try{sL(n);const e={...n,createdAt:wt(),updatedAt:wt(),status:n.status||Pe.COMPLETED,createdBy:n.createdBy||"system"};n.type===me.OIL_CHANGE&&(e.nextChangeHours=gf(n.currentHours)),n.type===me.BATTERY_CHANGE&&(e.nextBatteryChange=xC(n.date));const t=await gu(et(Te,_u),e);return n.vehicleId&&n.currentHours&&await AC(n.vehicleId,n.currentHours),console.log("✅ Mantenimiento creado exitosamente:",t.id),t.id}catch(e){throw console.error("❌ Error al crear mantenimiento:",e),new Error(`Error al crear mantenimiento: ${e.message}`)}},EC=async(n={})=>{try{let e=et(Te,_u);n.type&&(e=Oe(e,Ke("type","==",n.type))),n.vehicleId&&(e=Oe(e,Ke("vehicleId","==",n.vehicleId))),n.status&&(e=Oe(e,Ke("status","==",n.status))),n.dateFrom&&(e=Oe(e,Ke("date",">=",new Date(n.dateFrom)))),n.dateTo&&(e=Oe(e,Ke("date","<=",new Date(n.dateTo)))),e=Oe(e,Qn("date","desc"));const t=await kt(e),a=[];return t.forEach(o=>{a.push({id:o.id,...o.data()})}),a}catch(e){throw console.error("❌ Error al obtener mantenimientos:",e),new Error(`Error al obtener mantenimientos: ${e.message}`)}},bC=async(n,e)=>{try{aL(e);const t=xt(Te,_u,n),a={...e,updatedAt:wt()};e.currentHours&&e.type===me.OIL_CHANGE&&(a.nextChangeHours=gf(e.currentHours)),await ka(t,a),e.vehicleId&&e.currentHours&&await AC(e.vehicleId,e.currentHours),console.log("✅ Mantenimiento actualizado exitosamente:",n)}catch(t){throw console.error("❌ Error al actualizar mantenimiento:",t),new Error(`Error al actualizar mantenimiento: ${t.message}`)}},nL=async n=>{try{const e=xt(Te,_u,n);await Sv(e),console.log("✅ Mantenimiento eliminado exitosamente:",n)}catch(e){throw console.error("❌ Error al eliminar mantenimiento:",e),new Error(`Error al eliminar mantenimiento: ${e.message}`)}},NC=async(n={})=>{try{const e=await EC(n),t={total:e.length,byType:{},byStatus:{},byVehicle:{},totalCost:0,averageCost:0,upcomingCount:0,overdueCount:0};let a=0;return e.forEach(o=>{t.byType[o.type]=(t.byType[o.type]||0)+1,t.byStatus[o.status]=(t.byStatus[o.status]||0)+1,t.byVehicle[o.vehicleId]=(t.byVehicle[o.vehicleId]||0)+1,o.cost&&(a+=parseFloat(o.cost)),o.nextChangeDate&&(new Date(o.nextChangeDate)>new Date?t.upcomingCount++:t.overdueCount++)}),t.totalCost=a,t.averageCost=t.total>0?a/t.total:0,t}catch(e){throw console.error("❌ Error al obtener estadísticas de mantenimiento:",e),new Error(`Error al obtener estadísticas de mantenimiento: ${e.message}`)}},$v=(n,e={})=>{try{let t=et(Te,_u);return e.type&&(t=Oe(t,Ke("type","==",e.type))),e.vehicleId&&(t=Oe(t,Ke("vehicleId","==",e.vehicleId))),e.status&&(t=Oe(t,Ke("status","==",e.status))),t=Oe(t,Qn("date","desc")),dl(t,o=>{const c=[];o.forEach(d=>{c.push({id:d.id,...d.data()})}),n(c,null)},o=>{console.error("❌ Error en suscripción de mantenimientos:",o),n([],o)})}catch(t){return console.error("❌ Error al suscribirse a mantenimientos:",t),n([],t),()=>{}}},TC=async()=>{try{const n=Oe(et(Te,yC),Ke("status","in",["activo","mantenimiento"]),Qn("name","asc")),e=await kt(n),t=[];return e.forEach(a=>{t.push({id:a.id,...a.data()})}),t}catch(n){throw console.error("❌ Error al obtener vehículos para mantenimiento:",n),new Error(`Error al obtener vehículos para mantenimiento: ${n.message}`)}},gf=n=>parseInt(n)+Gv.OIL_CHANGE_HOURS,xC=n=>{const e=new Date(n);return e.setMonth(e.getMonth()+Gv.BATTERY_LIFETIME_MONTHS),e},AC=async(n,e)=>{try{const t=Oe(et(Te,yC),Ke("vehicleId","==",n)),a=await kt(t);if(!a.empty){const o=a.docs[0],c=o.data();if(c.hasHourMeter&&c.type==="tractor"){const d=parseInt(c.currentHours)||0,f=parseInt(e)||0;f>d&&(await ka(o.ref,{currentHours:f,lastHourMeterDate:wt(),updatedAt:wt()}),console.log(`✅ Horómetro actualizado para ${n}: ${d} → ${f}`))}}}catch(t){console.error("❌ Error al actualizar horómetro del vehículo:",t)}},sL=n=>{const e=[];if(n.type||e.push("El tipo de mantenimiento es obligatorio"),n.vehicleId||e.push("El vehículo es obligatorio"),n.date||e.push("La fecha es obligatoria"),n.type===me.OIL_CHANGE&&((!n.quantity||n.quantity<=0)&&e.push("La cantidad de aceite es obligatoria y debe ser mayor a 0"),(!n.currentHours||n.currentHours<0)&&e.push("La lectura del horómetro es obligatoria")),n.type===me.BATTERY_CHANGE&&(n.batteryType||e.push("El tipo de batería es obligatorio"),(!n.cost||n.cost<=0)&&e.push("El costo de la batería es obligatorio")),e.length>0)throw new Error(e.join(", "))},aL=n=>{const e=[];if(n.type&&!Object.values(me).includes(n.type)&&e.push("Tipo de mantenimiento inválido"),n.status&&!Object.values(Pe).includes(n.status)&&e.push("Estado de mantenimiento inválido"),n.batteryStatus&&!Object.values(qo).includes(n.batteryStatus)&&e.push("Estado de batería inválido"),e.length>0)throw new Error(e.join(", "))},iL=Object.freeze(Object.defineProperty({__proto__:null,BATTERY_STATUS:qo,MAINTENANCE_CONSTANTS:Gv,MAINTENANCE_STATUS:Pe,MAINTENANCE_TYPES:me,calculateNextBatteryChange:xC,calculateNextOilChange:gf,createMaintenanceRecord:_C,deleteMaintenanceRecord:nL,getAllMaintenanceRecords:EC,getMaintenanceStats:NC,getVehiclesForMaintenance:TC,subscribeToMaintenance:$v,updateMaintenanceRecord:bC},Symbol.toStringTag,{value:"Module"})),AT=()=>{const[n,e]=Y.useState({totalFuel:0,activeVehicles:0,pendingMovements:0,lowStockAlerts:0,totalProducts:0,totalMaintenance:0,upcomingMaintenance:0,overdueMaintenance:0}),[t,a]=Y.useState([]),[o,c]=Y.useState([]),[d,f]=Y.useState([]),[p,v]=Y.useState(!0),[_,N]=Y.useState(null),[C,j]=Y.useState({inventory:!1,movements:!1,vehicles:!1,products:!1,maintenance:!1});Y.useEffect(()=>{v(!0),N(null);const x=uC(F=>{const X=F.reduce((A,R)=>A+(R.currentStock||0),0),w=F.filter(A=>(A.currentStock||0)<(A.minThreshold||0)).length;e(A=>({...A,totalFuel:X,lowStockAlerts:w})),j(A=>({...A,inventory:!0}))}),L=zv(F=>{const X=F.filter(A=>A.status==="pending").length,w=F.sort((A,R)=>R.date.toMillis()-A.date.toMillis()).slice(0,5);e(A=>({...A,pendingMovements:X})),a(w),j(A=>({...A,movements:!0}))},F=>{console.error("Error loading movements:",F),N("Error cargando movimientos")}),$=pC(F=>{const X=F.filter(w=>w.status==="active").length;e(w=>({...w,activeVehicles:X})),j(w=>({...w,vehicles:!0}))},F=>{console.error("Error loading vehicles:",F),N("Error cargando vehículos")}),O=vC(F=>{const X=F.length;c(F),e(w=>({...w,totalProducts:X})),j(w=>({...w,products:!0}))},F=>{console.error("Error loading products:",F),j(X=>({...X,products:!0}))}),U=$v(F=>{const X=F.length,w=F.filter(R=>R.nextChangeDate?new Date(R.nextChangeDate)>new Date:!1).length,A=F.filter(R=>R.nextChangeDate?new Date(R.nextChangeDate)<new Date:!1).length;f(F),e(R=>({...R,totalMaintenance:X,upcomingMaintenance:w,overdueMaintenance:A})),j(R=>({...R,maintenance:!0}))},F=>{console.error("Error loading maintenance:",F),j(X=>({...X,maintenance:!0}))});return()=>{x(),L(),$(),O(),U()}},[]),Y.useEffect(()=>{Object.values(C).every(L=>L)&&v(!1)},[C]);const b=Y.useMemo(()=>x=>new Intl.NumberFormat("es-CO").format(x),[]),M=x=>{switch(x.type){case"entry":return`Entrada de ${x.quantity} ${x.unit} de ${x.fuelType}.`;case"exit":return`Salida de ${x.quantity} ${x.unit} para vehículo ${x.vehicleId||"N/A"}.`;case"transfer":return`Transferencia de ${x.quantity} ${x.unit} de ${x.fromLocation} a ${x.toLocation}.`;case"adjustment":return`Ajuste de inventario: ${x.quantity} ${x.unit} de ${x.fuelType}.`;default:return"Movimiento registrado."}};return p?r.jsxs("div",{className:"dashboard-main",children:[r.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),r.jsx("p",{className:"dashboard-subtitle",children:"Cargando datos en tiempo real..."}),r.jsx("div",{className:"loading-spinner-container",children:r.jsx("div",{className:"loading-spinner"})})]}):_?r.jsxs("div",{className:"dashboard-main",children:[r.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),r.jsxs("div",{className:"error-message",children:[r.jsxs("p",{children:["⚠️ ",_]}),r.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]})]}):r.jsxs("div",{className:"dashboard-main",children:[r.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),r.jsx("p",{className:"dashboard-subtitle",children:"Resumen general del estado de combustibles y maquinaria."}),r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon fuel-icon",children:"🛢️"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Combustible Total"}),r.jsxs("h2",{children:[b(n.totalFuel)," gal"]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon vehicle-icon",children:"🚜"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Vehículos Activos"}),r.jsx("h2",{children:b(n.activeVehicles)})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon movement-icon",children:"🔄"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Movimientos Pendientes"}),r.jsx("h2",{children:b(n.pendingMovements)})]})]}),r.jsxs("div",{className:`stat-card ${n.lowStockAlerts>0?"alert":""}`,children:[r.jsx("div",{className:"stat-icon alert-icon",children:"⚠️"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Alertas de Stock"}),r.jsx("h2",{children:b(n.lowStockAlerts)})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon maintenance-icon",children:"🔧"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Mantenimientos"}),r.jsx("h2",{children:b(n.totalMaintenance)})]})]}),r.jsxs("div",{className:`stat-card ${n.overdueMaintenance>0?"alert":""}`,children:[r.jsx("div",{className:"stat-icon maintenance-alert-icon",children:"⏰"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Mantenimientos Vencidos"}),r.jsx("h2",{children:b(n.overdueMaintenance)})]})]})]}),r.jsxs("div",{className:"dashboard-content",children:[r.jsxs("div",{className:"dashboard-widget",children:[r.jsx("h3",{children:"Actividad Reciente"}),t.length>0?r.jsx("ul",{children:t.map(x=>r.jsxs("li",{children:[r.jsx("span",{className:`movement-type-badge ${x.type}`,children:x.type}),M(x),r.jsx("span",{className:"movement-date",children:x.date.toDate().toLocaleDateString()})]},x.id))}):r.jsx("p",{children:"No hay movimientos recientes."})]}),r.jsxs("div",{className:"dashboard-widget",children:[r.jsx("h3",{children:"🔧 Mantenimientos Recientes"}),d.length>0?r.jsx("ul",{children:d.slice(0,5).map(x=>r.jsxs("li",{children:[r.jsx("span",{className:`maintenance-type-badge ${x.type}`,children:x.type==="oil_change"?"🛢️":x.type==="battery_change"?"🔋":x.type==="filter_change"?"🔧":"⚙️"}),r.jsxs("span",{className:"maintenance-description",children:[x.type==="oil_change"?"Cambio de aceite":x.type==="battery_change"?"Cambio de batería":x.type==="filter_change"?"Cambio de filtros":"Mantenimiento general"," para ",x.vehicleName]}),r.jsx("span",{className:"maintenance-date",children:x.date?new Date(x.date).toLocaleDateString():"N/A"})]},x.id))}):r.jsx("p",{children:"No hay mantenimientos registrados."})]}),r.jsxs("div",{className:"dashboard-widget",children:[r.jsx("h3",{children:"📦 Stock por Tipo de Producto"}),o.length>0?r.jsxs("div",{className:"products-summary",children:[o.slice(0,6).map(x=>r.jsxs("div",{className:"product-summary-item",children:[r.jsx("div",{className:"product-icon",style:{color:x.color},children:x.icon}),r.jsxs("div",{className:"product-info",children:[r.jsx("span",{className:"product-name",children:x.displayName}),r.jsxs("div",{className:"product-stats",children:[r.jsxs("span",{className:"stock-value",children:[b(x.currentStock||0)," ",x.unit]}),r.jsx("span",{className:`stock-status ${(x.currentStock||0)===0?"empty":(x.currentStock||0)<=(x.minThreshold||0)?"low":"normal"}`,children:(x.currentStock||0)===0?"🔴 Sin stock":(x.currentStock||0)<=(x.minThreshold||0)?"🟡 Stock bajo":"🟢 Normal"})]})]})]},x.id)),o.length>6&&r.jsx("div",{className:"view-all-products",children:r.jsxs("span",{children:["+",o.length-6," productos más"]})})]}):r.jsxs("div",{className:"no-products",children:[r.jsx("p",{children:"No hay productos registrados."}),r.jsx("small",{children:"Ve a la sección Productos para crear los primeros tipos de combustible."})]})]})]})]})},rL=({items:n,onEdit:e,onDelete:t,canManage:a})=>{const[o,c]=Y.useState("name"),[d,f]=Y.useState("asc"),p=b=>new Intl.NumberFormat("es-CO").format(b),v=b=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(b),_=b=>{const x=new Date-new Date(b.seconds?b.seconds*1e3:b),L=Math.floor(x/(1e3*60*60)),$=Math.floor(L/24);return $>0?`${$}d`:L>0?`${L}h`:"ahora"},N=b=>{o===b?f(d==="asc"?"desc":"asc"):(c(b),f("asc"))},C=[...n].sort((b,M)=>{let x=b[o],L=M[o];return o==="lastUpdated"&&(x=new Date(x.seconds?x.seconds*1e3:x),L=new Date(L.seconds?L.seconds*1e3:L)),x<L?d==="asc"?-1:1:x>L?d==="asc"?1:-1:0}),j=b=>o!==b?"↕️":d==="asc"?"↑":"↓";return r.jsxs("div",{className:"inventory-table-container",children:[r.jsx("div",{className:"table-wrapper",children:r.jsxs("table",{className:"inventory-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{onClick:()=>N("name"),className:"sortable",children:["Combustible ",j("name")]}),r.jsxs("th",{onClick:()=>N("location"),className:"sortable",children:["Ubicación ",j("location")]}),r.jsxs("th",{onClick:()=>N("currentStock"),className:"sortable",children:["Stock Actual ",j("currentStock")]}),r.jsxs("th",{onClick:()=>N("stockPercentage"),className:"sortable",children:["Nivel ",j("stockPercentage")]}),r.jsxs("th",{onClick:()=>N("pricePerUnit"),className:"sortable",children:["Precio ",j("pricePerUnit")]}),r.jsx("th",{children:"Valor Total"}),r.jsxs("th",{onClick:()=>N("status"),className:"sortable",children:["Estado ",j("status")]}),r.jsxs("th",{onClick:()=>N("lastUpdated"),className:"sortable",children:["Actualizado ",j("lastUpdated")]}),a&&r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:C.map(b=>{const M=nl[b.fuelType],x=Ho[b.stockLevel],L=b.currentStock*b.pricePerUnit;return r.jsxs("tr",{className:b.needsRestock?"needs-restock":"",children:[r.jsx("td",{className:"fuel-cell",children:r.jsxs("div",{className:"fuel-info",children:[r.jsx("span",{className:"fuel-icon",style:{color:M?.color},children:M?.icon}),r.jsxs("div",{children:[r.jsx("div",{className:"fuel-name",children:M?.name}),r.jsx("div",{className:"fuel-type",children:b.fuelType})]})]})}),r.jsx("td",{children:b.location}),r.jsxs("td",{className:"stock-cell",children:[r.jsxs("div",{className:"stock-info",children:[r.jsx("span",{className:"stock-amount",children:p(b.currentStock)}),r.jsxs("span",{className:"stock-unit",children:["/ ",p(b.maxCapacity)," ",b.unit]})]}),b.needsRestock&&r.jsx("div",{className:"restock-indicator",children:"⚠️ Bajo mínimo"})]}),r.jsx("td",{className:"level-cell",children:r.jsxs("div",{className:"level-info",children:[r.jsxs("div",{className:"level-badge",style:{backgroundColor:x?.color,color:"white"},children:[b.stockPercentage,"%"]}),r.jsx("div",{className:"level-bar",children:r.jsx("div",{className:"level-fill",style:{width:`${b.stockPercentage}%`,backgroundColor:x?.color}})})]})}),r.jsx("td",{className:"price-cell",children:r.jsxs("div",{className:"price-info",children:[r.jsx("span",{className:"price-amount",children:v(b.pricePerUnit)}),r.jsxs("span",{className:"price-unit",children:["/ ",b.unit]})]})}),r.jsx("td",{className:"value-cell",children:r.jsx("span",{className:"total-value",children:v(L)})}),r.jsx("td",{className:"status-cell",children:r.jsxs("span",{className:`status-badge ${b.status}`,children:[r.jsx("span",{className:"status-dot"}),b.status==="active"?"Activo":b.status==="inactive"?"Inactivo":b.status==="maintenance"?"Mantenimiento":b.status]})}),r.jsx("td",{className:"updated-cell",children:r.jsx("span",{className:"time-ago",children:_(b.lastUpdated)})}),a&&r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(b),title:"Editar",children:"✏️"}),r.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>t(b),title:"Eliminar",children:"🗑️"})]})})]},b.id)})})]})}),r.jsxs("div",{className:"table-footer",children:[r.jsxs("div",{className:"table-info",children:[C.length," items ordenados por ",o,"(",d==="asc"?"ascendente":"descendente",")"]}),r.jsxs("div",{className:"table-legend",children:[r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot critical"}),"Crítico"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot low"}),"Bajo"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot normal"}),"Normal"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot high"}),"Alto"]})]})]})]})},oL=({items:n,onEdit:e,onDelete:t,canManage:a})=>{const o=f=>new Intl.NumberFormat("es-CO").format(f),c=f=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(f),d=f=>{const v=new Date-new Date(f.seconds?f.seconds*1e3:f),_=Math.floor(v/(1e3*60*60)),N=Math.floor(_/24);return N>0?`hace ${N} día${N>1?"s":""}`:_>0?`hace ${_} hora${_>1?"s":""}`:"hace unos minutos"};return r.jsx("div",{className:"inventory-cards-grid",children:n.map(f=>{const p=nl[f.fuelType],v=Ho[f.stockLevel],_=f.currentStock*f.pricePerUnit;return r.jsxs("div",{className:"inventory-card",children:[r.jsxs("div",{className:"card-header",children:[r.jsxs("div",{className:"fuel-info",children:[r.jsx("span",{className:"fuel-icon",style:{color:p?.color},children:p?.icon}),r.jsxs("div",{className:"fuel-details",children:[r.jsx("h3",{children:p?.name}),r.jsx("p",{className:"location",children:f.location})]})]}),r.jsx("div",{className:"stock-status",children:r.jsxs("span",{className:"status-badge",style:{backgroundColor:v?.color,color:"white"},children:[v?.icon," ",v?.label]})})]}),r.jsxs("div",{className:"stock-progress",children:[r.jsxs("div",{className:"progress-header",children:[r.jsxs("span",{className:"stock-text",children:[o(f.currentStock)," / ",o(f.maxCapacity)," ",f.unit]}),r.jsxs("span",{className:"percentage",children:[f.stockPercentage,"%"]})]}),r.jsx("div",{className:"progress-bar",children:r.jsx("div",{className:"progress-fill",style:{width:`${f.stockPercentage}%`,backgroundColor:v?.color}})}),f.needsRestock&&r.jsxs("div",{className:"restock-warning",children:["⚠️ Bajo nivel mínimo (",o(f.minThreshold)," ",f.unit,")"]})]}),r.jsxs("div",{className:"card-metrics",children:[r.jsxs("div",{className:"metric",children:[r.jsxs("span",{className:"metric-label",children:["Precio por ",f.unit,":"]}),r.jsx("span",{className:"metric-value",children:c(f.pricePerUnit)})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Valor total:"}),r.jsx("span",{className:"metric-value",children:c(_)})]}),f.supplier&&r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Proveedor:"}),r.jsx("span",{className:"metric-value",children:f.supplier})]})]}),r.jsxs("div",{className:"card-footer",children:[r.jsxs("div",{className:"status-info",children:[r.jsx("span",{className:`status-dot ${f.status}`}),r.jsx("span",{className:"status-text",children:f.status==="active"?"Activo":f.status==="inactive"?"Inactivo":f.status==="maintenance"?"Mantenimiento":f.status})]}),r.jsxs("div",{className:"last-update",children:["Actualizado ",d(f.lastUpdated)]})]}),a&&r.jsxs("div",{className:"card-actions",children:[r.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>e(f),title:"Editar combustible",children:"✏️ Editar"}),r.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>t(f),title:"Eliminar combustible",children:"🗑️ Eliminar"})]}),f.description&&f.description!==p?.description&&r.jsx("div",{className:"card-description",children:r.jsx("p",{children:f.description})})]},f.id)})})},lL=({item:n,onClose:e,onSuccess:t})=>{const{userProfile:a}=Zs(),o=!!n,[c,d]=Y.useState({fuelType:"",location:"",currentStock:"",maxCapacity:"",minThreshold:"",pricePerUnit:"",supplier:"",description:"",status:"active"}),[f,p]=Y.useState({}),[v,_]=Y.useState(!1);Y.useEffect(()=>{o&&n&&d({fuelType:n.fuelType||"",location:n.location||"",currentStock:n.currentStock||"",maxCapacity:n.maxCapacity||"",minThreshold:n.minThreshold||"",pricePerUnit:n.pricePerUnit||"",supplier:n.supplier||"",description:n.description||"",status:n.status||"active"})},[o,n]),Y.useEffect(()=>{if(c.maxCapacity&&!c.minThreshold){const M=Math.round(Number(c.maxCapacity)*.15);d(x=>({...x,minThreshold:M}))}},[c.maxCapacity]);const N=M=>{const{name:x,value:L}=M.target;d($=>({...$,[x]:L})),f[x]&&p($=>({...$,[x]:null}))},C=()=>{const M={};c.fuelType||(M.fuelType="Tipo de combustible es requerido"),c.location||(M.location="Ubicación es requerida"),c.maxCapacity||(M.maxCapacity="Capacidad máxima es requerida");const x=Number(c.currentStock),L=Number(c.maxCapacity),$=Number(c.minThreshold),O=Number(c.pricePerUnit);return c.currentStock&&(isNaN(x)||x<0)&&(M.currentStock="Stock actual debe ser un número válido mayor o igual a 0"),c.maxCapacity&&(isNaN(L)||L<=0)&&(M.maxCapacity="Capacidad máxima debe ser un número válido mayor a 0"),c.minThreshold&&(isNaN($)||$<0)&&(M.minThreshold="Umbral mínimo debe ser un número válido mayor o igual a 0"),c.pricePerUnit&&(isNaN(O)||O<0)&&(M.pricePerUnit="Precio debe ser un número válido mayor o igual a 0"),x>L&&(M.currentStock="Stock actual no puede ser mayor a la capacidad máxima"),$>L&&(M.minThreshold="Umbral mínimo no puede ser mayor a la capacidad máxima"),p(M),Object.keys(M).length===0},j=async M=>{if(M.preventDefault(),!!C()){_(!0);try{let x;o?x=await V2(n.id,{location:c.location,currentStock:Number(c.currentStock)||0,maxCapacity:Number(c.maxCapacity),minThreshold:Number(c.minThreshold)||Number(c.maxCapacity)*.15,pricePerUnit:Number(c.pricePerUnit)||0,supplier:c.supplier,description:c.description,status:c.status},a.uid):x=await L2({fuelType:c.fuelType,location:c.location,currentStock:Number(c.currentStock)||0,maxCapacity:Number(c.maxCapacity),minThreshold:Number(c.minThreshold)||Number(c.maxCapacity)*.15,pricePerUnit:Number(c.pricePerUnit)||0,supplier:c.supplier,description:c.description,status:c.status},a.uid),x.success?(alert(x.message),t()):alert(`Error: ${x.error}`)}catch(x){console.error("Error saving inventory item:",x),alert("Error inesperado al guardar el item")}finally{_(!1)}}},b=nl[c.fuelType];return r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-content inventory-modal",onClick:M=>M.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h2",{children:o?"✏️ Editar Combustible":"➕ Agregar Nuevo Combustible"}),r.jsx("button",{className:"modal-close",onClick:e,children:"✕"})]}),r.jsxs("form",{onSubmit:j,className:"modal-form",children:[r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"fuelType",children:["Tipo de Combustible *",b&&r.jsxs("span",{className:"fuel-preview",children:[b.icon," ",b.name]})]}),r.jsxs("select",{id:"fuelType",name:"fuelType",value:c.fuelType,onChange:N,disabled:o,className:f.fuelType?"error":"",required:!0,children:[r.jsx("option",{value:"",children:"Seleccionar tipo..."}),Object.entries(An).map(([M,x])=>{const L=nl[x];return r.jsxs("option",{value:x,children:[L.icon," ",L.name," (",L.unit,")"]},M)})]}),f.fuelType&&r.jsx("span",{className:"error-text",children:f.fuelType})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"location",children:"Ubicación / Tanque *"}),r.jsx("input",{type:"text",id:"location",name:"location",value:c.location,onChange:N,placeholder:"ej. Tanque Principal, Depósito A, Bodega Norte",className:f.location?"error":"",required:!0}),f.location&&r.jsx("span",{className:"error-text",children:f.location})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"currentStock",children:["Stock Actual ",b&&`(${b.unit})`]}),r.jsx("input",{type:"number",id:"currentStock",name:"currentStock",value:c.currentStock,onChange:N,placeholder:"0",min:"0",step:"0.01",className:f.currentStock?"error":""}),f.currentStock&&r.jsx("span",{className:"error-text",children:f.currentStock})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"maxCapacity",children:["Capacidad Máxima * ",b&&`(${b.unit})`]}),r.jsx("input",{type:"number",id:"maxCapacity",name:"maxCapacity",value:c.maxCapacity,onChange:N,placeholder:"1000",min:"1",step:"0.01",className:f.maxCapacity?"error":"",required:!0}),f.maxCapacity&&r.jsx("span",{className:"error-text",children:f.maxCapacity})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"minThreshold",children:["Umbral Mínimo ",b&&`(${b.unit})`,r.jsx("span",{className:"field-hint",children:"Para alertas de stock bajo"})]}),r.jsx("input",{type:"number",id:"minThreshold",name:"minThreshold",value:c.minThreshold,onChange:N,placeholder:"Auto: 15% de capacidad máxima",min:"0",step:"0.01",className:f.minThreshold?"error":""}),f.minThreshold&&r.jsx("span",{className:"error-text",children:f.minThreshold}),c.maxCapacity&&r.jsxs("span",{className:"field-hint",children:["Sugerido: ",Math.round(Number(c.maxCapacity)*.15)," ",b?.unit||"unidades"]})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"pricePerUnit",children:["Precio por ",b?.unit||"Unidad"]}),r.jsx("input",{type:"number",id:"pricePerUnit",name:"pricePerUnit",value:c.pricePerUnit,onChange:N,placeholder:"12000",min:"0",step:"0.01",className:f.pricePerUnit?"error":""}),f.pricePerUnit&&r.jsx("span",{className:"error-text",children:f.pricePerUnit})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"supplier",children:"Proveedor Principal"}),r.jsx("input",{type:"text",id:"supplier",name:"supplier",value:c.supplier,onChange:N,placeholder:"ej. Petrobras, Terpel, Mobil"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"status",children:"Estado"}),r.jsxs("select",{id:"status",name:"status",value:c.status,onChange:N,children:[r.jsx("option",{value:"active",children:"Activo"}),r.jsx("option",{value:"inactive",children:"Inactivo"}),r.jsx("option",{value:"maintenance",children:"Mantenimiento"})]})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{htmlFor:"description",children:"Descripción / Notas"}),r.jsx("textarea",{id:"description",name:"description",value:c.description,onChange:N,placeholder:"Información adicional sobre este combustible...",rows:"3"})]})]}),b&&c.maxCapacity&&r.jsxs("div",{className:"form-preview",children:[r.jsx("h4",{children:"📊 Vista Previa"}),r.jsxs("div",{className:"preview-card",children:[r.jsxs("div",{className:"preview-header",children:[r.jsxs("span",{style:{color:b.color},children:[b.icon," ",b.name]}),r.jsx("span",{children:c.location})]}),r.jsxs("div",{className:"preview-capacity",children:[c.currentStock||0," / ",c.maxCapacity," ",b.unit,c.currentStock&&c.maxCapacity&&r.jsxs("span",{className:"preview-percentage",children:["(",Math.round(Number(c.currentStock)/Number(c.maxCapacity)*100),"%)"]})]}),c.pricePerUnit&&r.jsxs("div",{className:"preview-value",children:["Valor total: ",new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format((Number(c.currentStock)||0)*Number(c.pricePerUnit))]})]})]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:e,className:"btn btn-secondary",children:"Cancelar"}),r.jsx("button",{type:"submit",className:"btn btn-primary",disabled:v,children:v?"Guardando...":o?"Actualizar":"Crear"})]})]})]})})},CT=(n,e=[])=>{if(!n||!n.fuelType||!n.quantity)return{isValid:!1,error:"Datos de movimiento incompletos",availableStock:0,requiredStock:0};const{fuelType:t,quantity:a,type:o,sourceLocation:c}=n,d=parseFloat(a)||0;if(o!=="outbound"&&o!=="transfer")return{isValid:!0,message:"Movimiento no requiere validación de stock",availableStock:0,requiredStock:d};const f=e.filter(_=>_.fuelType===t&&_.location===c&&_.status==="active").reduce((_,N)=>_+(parseFloat(N.quantity)||0),0),p=f>=d,v=f-d;return{isValid:p,availableStock:f,requiredStock:d,remainingStock:v,fuelType:t,location:c,error:p?null:`Stock insuficiente. Disponible: ${f}, Requerido: ${d}`,warning:v<f*.2&&v>=0?"Stock quedará bajo después del movimiento":null}},Mn=n=>typeof n!="number"||isNaN(n)?"$0":new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),Ge=(n,e=2)=>typeof n!="number"||isNaN(n)?"0":new Intl.NumberFormat("es-CO",{minimumFractionDigits:e,maximumFractionDigits:e}).format(n),Nr=(n,e=1)=>typeof n!="number"||isNaN(n)?"0%":`${(n*100).toFixed(e)}%`,cL=({stats:n})=>r.jsxs("div",{className:"inventory-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:"💰"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Valor Total"}),r.jsx("div",{className:"stat-value",children:Mn(n.totalValue)}),r.jsxs("div",{className:"stat-subtitle",children:[Ge(n.totalItems)," tipos de combustible"]})]})]}),r.jsxs("div",{className:"stat-card success",children:[r.jsx("div",{className:"stat-icon",children:"✅"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Items Activos"}),r.jsx("div",{className:"stat-value",children:n.activeItems}),r.jsxs("div",{className:"stat-subtitle",children:[Math.round(n.activeItems/n.totalItems*100),"% del total"]})]})]}),r.jsxs("div",{className:`stat-card ${n.lowStockItems>0?"warning":"info"}`,children:[r.jsx("div",{className:"stat-icon",children:n.lowStockItems>0?"⚠️":"📊"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Stock Bajo"}),r.jsx("div",{className:"stat-value",children:n.lowStockItems}),r.jsx("div",{className:"stat-subtitle",children:n.lowStockItems>0?"Requieren atención":"Niveles normales"})]})]}),r.jsxs("div",{className:"stat-card info",children:[r.jsx("div",{className:"stat-icon",children:"📈"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Nivel Promedio"}),r.jsxs("div",{className:"stat-value",children:[n.averageStockLevel,"%"]}),r.jsx("div",{className:"stat-subtitle",children:"Capacidad promedio utilizada"})]})]})]}),r.jsxs("div",{className:"fuel-type-summary",children:[r.jsx("h4",{children:"📊 Resumen por Tipo de Combustible"}),r.jsx("div",{className:"fuel-types-grid",children:Object.entries(n.byFuelType).map(([e,t])=>{const a=nl[e],o=t.totalCapacity>0?Math.round(t.totalStock/t.totalCapacity*100):0;return r.jsxs("div",{className:"fuel-type-card",children:[r.jsxs("div",{className:"fuel-header",children:[r.jsx("span",{className:"fuel-icon",style:{color:a?.color||"#6b7280"},children:a?.icon||"⛽"}),r.jsxs("div",{className:"fuel-info",children:[r.jsx("h5",{children:a?.name||e}),r.jsxs("span",{className:"fuel-count",children:[t.count," ubicaciones"]})]})]}),r.jsxs("div",{className:"fuel-metrics",children:[r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Stock Total:"}),r.jsxs("span",{className:"metric-value",children:[Ge(t.totalStock)," ",a?.unit||"unidades"]})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Capacidad:"}),r.jsxs("span",{className:"metric-value",children:[Ge(t.totalCapacity)," ",a?.unit||"unidades"]})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Utilización:"}),r.jsxs("span",{className:`metric-value ${o<25?"low":o>75?"high":"normal"}`,children:[o,"%"]})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Valor:"}),r.jsx("span",{className:"metric-value",children:Mn(t.totalValue)})]})]}),r.jsx("div",{className:"progress-bar",children:r.jsx("div",{className:"progress-fill",style:{width:`${o}%`,backgroundColor:a?.color||"#6b7280"}})})]},e)})}),Object.keys(n.byFuelType).length===0&&r.jsx("div",{className:"empty-fuel-types",children:r.jsx("p",{children:"No hay tipos de combustible registrados en el inventario."})})]})]}),uL=()=>{const{hasPermission:n}=Zs(),[e,t]=Y.useState([]),[a,o]=Y.useState(null),[c,d]=Y.useState(!0),[f,p]=Y.useState(null),[v,_]=Y.useState("cards"),[N,C]=Y.useState(!1),[j,b]=Y.useState(null),[M,x]=Y.useState("all"),[L,$]=Y.useState("");Y.useEffect(()=>{let A=null;return(()=>{A=uC((I,P)=>{if(P){console.error("Error in inventory subscription:",P),p("Error cargando inventario en tiempo real");return}t(I||[]),d(!1)})})(),()=>{A&&A()}},[]),Y.useEffect(()=>{(async()=>{const R=await F2();R.success&&o(R.data)})()},[e]);const O=e.filter(A=>{if(M==="active"&&A.status!=="active"||M==="low-stock"&&!A.needsRestock)return!1;if(L){const R=L.toLowerCase();return A.name.toLowerCase().includes(R)||A.location.toLowerCase().includes(R)||A.fuelType.toLowerCase().includes(R)}return!0}),U=A=>{if(!n("canManageInventory")){alert("No tienes permisos para editar items de inventario");return}b(A),C(!0)},F=async A=>{if(!n("canManageInventory")){alert("No tienes permisos para eliminar items de inventario");return}if(!window.confirm(`¿Estás seguro de eliminar ${A.name} de ${A.location}?

Esta acción no se puede deshacer.`))return;d(!0);const I=await U2(A.id);I.success?alert("Item eliminado exitosamente"):(p(I.error),alert(`Error al eliminar: ${I.error}`)),d(!1)},X=()=>{C(!1),b(null)},w=()=>{X()};return c&&e.length===0?r.jsxs("div",{className:"inventory-loading",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando inventario..."})]}):r.jsxs("div",{className:"inventory-main",children:[r.jsxs("div",{className:"inventory-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h2",{children:"🛢️ Gestión de Inventario"}),r.jsx("p",{children:"Control de stock de combustibles en tiempo real"})]}),r.jsx("div",{className:"inventory-info",children:r.jsxs("span",{className:"info-text",children:["💡 Los combustibles se agregan automáticamente desde la pestaña ",r.jsx("strong",{children:"Movimientos"})]})})]}),a&&r.jsx(cL,{stats:a}),r.jsxs("div",{className:"inventory-controls",children:[r.jsxs("div",{className:"search-filters",children:[r.jsx("input",{type:"text",placeholder:"Buscar por nombre, ubicación o tipo...",value:L,onChange:A=>$(A.target.value),className:"search-input"}),r.jsxs("select",{value:M,onChange:A=>x(A.target.value),className:"filter-select",children:[r.jsx("option",{value:"all",children:"Todos los items"}),r.jsx("option",{value:"active",children:"Solo activos"}),r.jsx("option",{value:"low-stock",children:"Stock bajo"})]})]}),r.jsxs("div",{className:"view-toggle",children:[r.jsx("button",{className:`toggle-btn ${v==="cards"?"active":""}`,onClick:()=>_("cards"),children:"📱 Cards"}),r.jsx("button",{className:`toggle-btn ${v==="table"?"active":""}`,onClick:()=>_("table"),children:"📊 Tabla"})]})]}),f&&r.jsxs("div",{className:"error-banner",children:[r.jsxs("span",{children:["⚠️ ",f]}),r.jsx("button",{onClick:()=>p(null),children:"✕"})]}),r.jsx("div",{className:"inventory-content",children:O.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"📦"}),r.jsx("h3",{children:"No hay items de inventario"}),r.jsx("p",{children:L||M!=="all"?"No se encontraron items con los filtros aplicados":"Ve a la pestaña Movimientos para crear una ENTRADA de combustible"})]}):r.jsx(r.Fragment,{children:v==="cards"?r.jsx(oL,{items:O,onEdit:U,onDelete:F,canManage:n("canManageInventory")}):r.jsx(rL,{items:O,onEdit:U,onDelete:F,canManage:n("canManageInventory")})})}),O.length>0&&r.jsx("div",{className:"results-footer",children:r.jsxs("p",{children:["Mostrando ",O.length," de ",e.length," items",L&&` · Filtro: "${L}"`,M!=="all"&&` · Estado: ${M}`]})}),N&&r.jsx(lL,{item:j,onClose:X,onSuccess:w})]})},dL=({stats:n,filters:e})=>{if(!n)return null;const t=(d,f)=>f===0?d>0?100:0:((d-f)/f*100).toFixed(1),a=d=>{switch(d){case be.ENTRADA:return"#10b981";case be.SALIDA:return"#ef4444";case be.TRANSFERENCIA:return"#3b82f6";case be.AJUSTE:return"#f59e0b";default:return"#6b7280"}},o=d=>{switch(d){case be.ENTRADA:return"📥";case be.SALIDA:return"📤";case be.TRANSFERENCIA:return"🔄";case be.AJUSTE:return"⚖️";default:return"📋"}},c=t(n.thisMonth,n.lastMonth);return r.jsxs("div",{className:"movements-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:"📊"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Ge(n.totalMovements)}),r.jsx("div",{className:"stat-label",children:"Total Movimientos"}),r.jsxs("div",{className:"stat-trend",children:[r.jsxs("span",{className:`trend ${c>=0?"positive":"negative"}`,children:[c>=0?"📈":"📉"," ",Math.abs(c),"%"]}),r.jsx("span",{className:"trend-label",children:"vs mes anterior"})]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"💰"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Mn(n.totalValue)}),r.jsx("div",{className:"stat-label",children:"Valor Total"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",Mn(n.averageValue)]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"⛽"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Ge(n.totalQuantity)}),r.jsx("div",{className:"stat-label",children:"Galones Total"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",Ge(n.totalQuantity/(n.totalMovements||1))," gal/mov"]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"📅"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Ge(n.thisWeek)}),r.jsx("div",{className:"stat-label",children:"Esta Semana"}),r.jsxs("div",{className:"stat-secondary",children:[Ge(n.thisMonth)," este mes"]})]})]})]}),r.jsxs("div",{className:"stats-breakdown",children:[r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"📋 Por Tipo de Movimiento"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([d,f])=>{const p=(f/n.totalMovements*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:o(d)}),r.jsx("span",{className:"breakdown-label",children:d.charAt(0).toUpperCase()+d.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:f}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:a(d)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"⚡ Por Estado"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([d,f])=>{const p=(f/n.totalMovements*100).toFixed(1),v=N=>{switch(N){case $e.COMPLETADO:return"#10b981";case $e.PENDIENTE:return"#f59e0b";case $e.CANCELADO:return"#ef4444";default:return"#6b7280"}},_=N=>{switch(N){case $e.COMPLETADO:return"✅";case $e.PENDIENTE:return"⏳";case $e.CANCELADO:return"❌";default:return"❓"}};return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:_(d)}),r.jsx("span",{className:"breakdown-label",children:d.charAt(0).toUpperCase()+d.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:f}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:v(d)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"⛽ Por Tipo de Combustible"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byFuelType).map(([d,f])=>{const p=(f/n.totalMovements*100).toFixed(1),v=_=>{switch(_?.toLowerCase()){case"diesel":return"🚛";case"gasolina":return"🚗";case"acpm":return"🚚";case"lubricante":return"🛢️";default:return"⛽"}};return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:v(d)}),r.jsx("span",{className:"breakdown-label",children:d})]}),r.jsx("div",{className:"breakdown-value",children:f}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:"#059669"}})}),r.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]})]}),(e.type||e.status||e.fuelType||e.vehicleId)&&r.jsxs("div",{className:"active-filters",children:[r.jsx("h4",{children:"🔍 Filtros Activos"}),r.jsxs("div",{className:"filters-list",children:[e.type&&r.jsxs("span",{className:"filter-tag",children:["Tipo: ",e.type]}),e.status&&r.jsxs("span",{className:"filter-tag",children:["Estado: ",e.status]}),e.fuelType&&r.jsxs("span",{className:"filter-tag",children:["Combustible: ",e.fuelType]}),e.vehicleId&&r.jsxs("span",{className:"filter-tag",children:["Vehículo: ",e.vehicleId]})]})]})]})},hL=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:a,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:f})=>{const[p,v]=Y.useState(!1),_=[{value:"Diesel",label:"Diesel 🚛"},{value:"Gasolina",label:"Gasolina 🚗"},{value:"ACPM",label:"ACPM 🚚"},{value:"Lubricante",label:"Lubricante 🛢️"}],N=[{value:"all",label:"Todos los períodos"},{value:"today",label:"Hoy"},{value:"week",label:"Esta semana"},{value:"month",label:"Este mes"},{value:"quarter",label:"Este trimestre"},{value:"year",label:"Este año"}],C=Object.values(n).filter(M=>M&&M!==""&&M!=="all").length,j=(M,x)=>{e({[M]:x})},b=M=>{e(M)};return r.jsxs("div",{className:"movements-filters",children:[r.jsxs("div",{className:"filters-main",children:[r.jsx("div",{className:"search-section",children:r.jsxs("div",{className:"search-box",children:[r.jsx("span",{className:"search-icon",children:"🔍"}),r.jsx("input",{type:"text",placeholder:"Buscar por combustible, vehículo, referencia...",value:a,onChange:M=>o(M.target.value),className:"search-input"}),a&&r.jsx("button",{className:"search-clear",onClick:()=>o(""),title:"Limpiar búsqueda",children:"✕"})]})}),r.jsxs("div",{className:"filters-controls",children:[r.jsxs("div",{className:"quick-filters",children:[r.jsx("button",{className:`quick-filter ${n.type===be.ENTRADA?"active":""}`,onClick:()=>b({type:be.ENTRADA}),children:"📥 Entradas"}),r.jsx("button",{className:`quick-filter ${n.type===be.SALIDA?"active":""}`,onClick:()=>b({type:be.SALIDA}),children:"📤 Salidas"}),r.jsx("button",{className:`quick-filter ${n.status===$e.PENDIENTE?"active":""}`,onClick:()=>b({status:$e.PENDIENTE}),children:"⏳ Pendientes"})]}),r.jsxs("button",{className:`btn-advanced-filters ${p?"active":""}`,onClick:()=>v(!p),children:["🎛️ Filtros",C>0&&r.jsx("span",{className:"filters-count",children:C})]}),r.jsxs("div",{className:"view-modes",children:[r.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),title:"Vista en tarjetas",children:"🎴"}),r.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),title:"Vista en tabla",children:"📋"})]})]})]}),p&&r.jsxs("div",{className:"filters-advanced",children:[r.jsxs("div",{className:"filters-grid",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Movimiento"}),r.jsxs("select",{value:n.type,onChange:M=>j("type",M.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los tipos"}),r.jsx("option",{value:be.ENTRADA,children:"📥 Entrada"}),r.jsx("option",{value:be.SALIDA,children:"📤 Salida"}),r.jsx("option",{value:be.TRANSFERENCIA,children:"🔄 Transferencia"}),r.jsx("option",{value:be.AJUSTE,children:"⚖️ Ajuste"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:n.status,onChange:M=>j("status",M.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los estados"}),r.jsx("option",{value:$e.PENDIENTE,children:"⏳ Pendiente"}),r.jsx("option",{value:$e.COMPLETADO,children:"✅ Completado"}),r.jsx("option",{value:$e.CANCELADO,children:"❌ Cancelado"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Combustible"}),r.jsxs("select",{value:n.fuelType,onChange:M=>j("fuelType",M.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los combustibles"}),_.map(M=>r.jsx("option",{value:M.value,children:M.label},M.value))]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Período"}),r.jsx("select",{value:n.dateRange,onChange:M=>j("dateRange",M.target.value),className:"filter-select",children:N.map(M=>r.jsx("option",{value:M.value,children:M.label},M.value))})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Vehículo/Equipo"}),r.jsx("input",{type:"text",placeholder:"ID del vehículo...",value:n.vehicleId,onChange:M=>j("vehicleId",M.target.value),className:"filter-input"})]})]}),r.jsxs("div",{className:"filters-actions",children:[r.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:C===0,children:"🗑️ Limpiar Filtros"}),r.jsxs("div",{className:"filters-info",children:[r.jsxs("span",{className:"results-count",children:[f," resultado",f!==1?"s":""]}),C>0&&r.jsxs("span",{className:"active-filters-text",children:["(",C," filtro",C!==1?"s":""," activo",C!==1?"s":"",")"]})]})]})]}),r.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:r.jsx("small",{children:"💡 Atajos: Ctrl+F (buscar), Ctrl+1 (entradas), Ctrl+2 (salidas), Ctrl+3 (pendientes)"})})]})},fL=({movements:n,onEdit:e,onView:t,onApprove:a,onReject:o,userRole:c})=>{const d=b=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(b),f=b=>b?(b instanceof Date?b:new Date(b)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Sin fecha",p=b=>{if(!b)return"";const M=new Date,x=b instanceof Date?b:new Date(b),L=Math.abs(M-x),$=Math.ceil(L/(1e3*60*60*24));return $===1?"hace 1 día":$<7?`hace ${$} días`:$<30?`hace ${Math.ceil($/7)} semanas`:$<365?`hace ${Math.ceil($/30)} meses`:`hace ${Math.ceil($/365)} años`},v=b=>{switch(b){case be.ENTRADA:return"movement-entrada";case be.SALIDA:return"movement-salida";case be.TRANSFERENCIA:return"movement-transferencia";case be.AJUSTE:return"movement-ajuste";default:return"movement-default"}},_=b=>{switch(b){case $e.COMPLETADO:return"status-completado";case $e.PENDIENTE:return"status-pendiente";case $e.CANCELADO:return"status-cancelado";default:return"status-default"}},N=b=>{switch(b){case be.ENTRADA:return"📥";case be.SALIDA:return"📤";case be.TRANSFERENCIA:return"🔄";case be.AJUSTE:return"⚖️";default:return"📋"}},C=b=>{switch(b?.toLowerCase()){case"diesel":return"🚛";case"gasolina":return"🚗";case"acpm":return"🚚";case"lubricante":return"🛢️";default:return"⛽"}},j=b=>{switch(b){case $e.COMPLETADO:return"✅";case $e.PENDIENTE:return"⏳";case $e.CANCELADO:return"❌";default:return"❓"}};return r.jsx("div",{className:"movements-cards",children:n.map(b=>r.jsxs("div",{className:`movement-card ${v(b.type)}`,children:[r.jsxs("div",{className:"card-header",children:[r.jsxs("div",{className:"movement-type",children:[r.jsx("span",{className:"type-icon",children:N(b.type)}),r.jsx("span",{className:"type-label",children:b.type.charAt(0).toUpperCase()+b.type.slice(1)})]}),r.jsxs("div",{className:`status-badge ${_(b.status)}`,children:[r.jsx("span",{className:"status-icon",children:j(b.status)}),r.jsx("span",{className:"status-label",children:b.status.charAt(0).toUpperCase()+b.status.slice(1)})]})]}),r.jsxs("div",{className:"card-content",children:[r.jsxs("div",{className:"fuel-info",children:[r.jsx("span",{className:"fuel-icon",children:C(b.fuelType)}),r.jsx("span",{className:"fuel-type",children:b.fuelType}),r.jsxs("span",{className:"quantity",children:[b.quantity," galones"]})]}),r.jsxs("div",{className:"value-info",children:[r.jsx("div",{className:"total-value",children:d(b.totalValue)}),r.jsxs("div",{className:"unit-price",children:[d(b.unitPrice),"/galón"]})]}),b.vehicleId&&r.jsxs("div",{className:"vehicle-info",children:[r.jsx("span",{className:"vehicle-icon",children:"🚜"}),r.jsxs("span",{className:"vehicle-id",children:["Vehículo: ",b.vehicleId]})]}),b.location&&r.jsxs("div",{className:"location-info",children:[r.jsx("span",{className:"location-icon",children:"📍"}),r.jsx("span",{className:"location",children:b.location})]}),b.description&&r.jsx("div",{className:"description",children:r.jsx("p",{children:b.description})}),b.reference&&r.jsxs("div",{className:"reference",children:[r.jsx("span",{className:"reference-label",children:"Ref:"}),r.jsx("span",{className:"reference-value",children:b.reference})]})]}),r.jsxs("div",{className:"card-footer",children:[r.jsxs("div",{className:"date-info",children:[r.jsx("div",{className:"created-date",children:f(b.createdAt)}),r.jsx("div",{className:"relative-time",children:p(b.createdAt)})]}),r.jsxs("div",{className:"card-actions",children:[c==="admin"&&b.status===$e.PENDIENTE&&r.jsxs("div",{className:"admin-actions",children:[r.jsx("button",{className:"btn-approve",onClick:()=>a(b.id),title:"Aprobar movimiento",children:"✓ Aprobar"}),r.jsx("button",{className:"btn-reject",onClick:()=>o(b.id),title:"Rechazar movimiento",children:"✗ Rechazar"})]}),r.jsxs("div",{className:"user-actions",children:[r.jsx("button",{className:"btn-view",onClick:()=>t(b),title:"Ver detalles",children:"👁️ Ver"}),e&&b.status===$e.PENDIENTE&&r.jsx("button",{className:"btn-edit",onClick:()=>e(b),title:"Editar movimiento",children:"✏️ Editar"})]})]})]}),b.status===$e.PENDIENTE&&r.jsx("div",{className:"urgency-indicator",children:r.jsx("div",{className:"urgency-pulse"})}),b.type===be.AJUSTE&&r.jsx("div",{className:"adjustment-badge",children:r.jsx("span",{children:"Ajuste"})}),b.type===be.TRANSFERENCIA&&b.destinationLocation&&r.jsxs("div",{className:"transfer-info",children:[r.jsx("span",{className:"transfer-arrow",children:"→"}),r.jsx("span",{className:"destination",children:b.destinationLocation})]})]},b.id))})},mL=({movements:n,onEdit:e,onView:t,onApprove:a,onReject:o,userRole:c})=>{const[d,f]=Y.useState("createdAt"),[p,v]=Y.useState("desc"),_=O=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(O),N=O=>O?(O instanceof Date?O:new Date(O)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):"Sin fecha",C=O=>{switch(O){case be.ENTRADA:return"📥";case be.SALIDA:return"📤";case be.TRANSFERENCIA:return"🔄";case be.AJUSTE:return"⚖️";default:return"📋"}},j=O=>{switch(O?.toLowerCase()){case"diesel":return"🚛";case"gasolina":return"🚗";case"acpm":return"🚚";case"lubricante":return"🛢️";default:return"⛽"}},b=O=>{switch(O){case $e.COMPLETADO:return"✅";case $e.PENDIENTE:return"⏳";case $e.CANCELADO:return"❌";default:return"❓"}},M=O=>{switch(O){case $e.COMPLETADO:return"status-completado";case $e.PENDIENTE:return"status-pendiente";case $e.CANCELADO:return"status-cancelado";default:return"status-default"}},x=O=>{d===O?v(p==="asc"?"desc":"asc"):(f(O),v("asc"))},L=[...n].sort((O,U)=>{let F=O[d],X=U[d];return(d.includes("Date")||d.includes("At"))&&(F=new Date(F),X=new Date(X)),typeof F=="number"&&typeof X=="number"?p==="asc"?F-X:X-F:typeof F=="string"&&typeof X=="string"?p==="asc"?F.localeCompare(X):X.localeCompare(F):F instanceof Date&&X instanceof Date?p==="asc"?F-X:X-F:0}),$=O=>d!==O?"↕️":p==="asc"?"↑":"↓";return r.jsxs("div",{className:"movements-table-container",children:[r.jsx("div",{className:"table-wrapper",children:r.jsxs("table",{className:"movements-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{className:"sortable",onClick:()=>x("type"),children:["Tipo ",$("type")]}),r.jsxs("th",{className:"sortable",onClick:()=>x("fuelType"),children:["Combustible ",$("fuelType")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>x("quantity"),children:["Cantidad ",$("quantity")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>x("unitPrice"),children:["Precio/Gal ",$("unitPrice")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>x("totalValue"),children:["Valor Total ",$("totalValue")]}),r.jsx("th",{children:"Vehículo"}),r.jsx("th",{children:"Ubicación"}),r.jsxs("th",{className:"sortable",onClick:()=>x("status"),children:["Estado ",$("status")]}),r.jsxs("th",{className:"sortable",onClick:()=>x("createdAt"),children:["Fecha ",$("createdAt")]}),r.jsx("th",{className:"actions-column",children:"Acciones"})]})}),r.jsx("tbody",{children:L.map(O=>r.jsxs("tr",{className:`movement-row ${O.status===$e.PENDIENTE?"pending-row":""}`,children:[r.jsx("td",{className:"type-cell",children:r.jsxs("div",{className:"type-content",children:[r.jsx("span",{className:"type-icon",children:C(O.type)}),r.jsx("span",{className:"type-text",children:O.type.charAt(0).toUpperCase()+O.type.slice(1)})]})}),r.jsx("td",{className:"fuel-cell",children:r.jsxs("div",{className:"fuel-content",children:[r.jsx("span",{className:"fuel-icon",children:j(O.fuelType)}),r.jsx("span",{className:"fuel-text",children:O.fuelType})]})}),r.jsxs("td",{className:"quantity-cell text-right",children:[r.jsx("span",{className:"quantity-value",children:O.quantity}),r.jsx("span",{className:"quantity-unit",children:"gal"})]}),r.jsx("td",{className:"price-cell text-right",children:_(O.unitPrice)}),r.jsx("td",{className:"value-cell text-right",children:r.jsx("strong",{children:_(O.totalValue)})}),r.jsx("td",{className:"vehicle-cell",children:O.vehicleId?r.jsxs("span",{className:"vehicle-id",children:["🚜 ",O.vehicleId]}):r.jsx("span",{className:"no-vehicle",children:"-"})}),r.jsx("td",{className:"location-cell",children:r.jsxs("span",{className:"location-text",children:["📍 ",O.location||"Principal"]})}),r.jsx("td",{className:"status-cell",children:r.jsxs("div",{className:`status-badge ${M(O.status)}`,children:[r.jsx("span",{className:"status-icon",children:b(O.status)}),r.jsx("span",{className:"status-text",children:O.status.charAt(0).toUpperCase()+O.status.slice(1)})]})}),r.jsx("td",{className:"date-cell",children:r.jsxs("div",{className:"date-content",children:[r.jsx("span",{className:"date-value",children:N(O.createdAt)}),O.reference&&r.jsxs("span",{className:"reference-small",children:["#",O.reference]})]})}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn-action btn-view",onClick:()=>t(O),title:"Ver detalles",children:"👁️"}),c==="admin"&&O.status===$e.PENDIENTE&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"btn-action btn-approve",onClick:()=>a(O.id),title:"Aprobar movimiento",children:"✓"}),r.jsx("button",{className:"btn-action btn-reject",onClick:()=>o(O.id),title:"Rechazar movimiento",children:"✗"})]}),e&&O.status===$e.PENDIENTE&&r.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(O),title:"Editar movimiento",children:"✏️"})]})})]},O.id))})]})}),r.jsxs("div",{className:"table-info",children:[r.jsxs("div",{className:"table-summary",children:[r.jsxs("span",{className:"total-rows",children:[n.length," movimiento",n.length!==1?"s":""]}),d&&r.jsxs("span",{className:"sort-info",children:["Ordenado por ",d," (",p==="asc"?"ascendente":"descendente",")"]})]}),r.jsxs("div",{className:"table-legend",children:[r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"⏳"})," Pendiente"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"✅"})," Completado"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"❌"})," Cancelado"]})]})]})]})},pL=({movements:n,viewMode:e,onEdit:t,onView:a,userRole:o})=>e==="table"?r.jsx(mL,{movements:n,onEdit:t,onView:a,userRole:o}):r.jsx(fL,{movements:n,onEdit:t,onView:a,userRole:o}),zs="combustibles_suppliers",gL=async(n,e)=>{try{const t=Oe(et(Te,zs),Ke("name","==",n.name.trim()));if(!(await kt(t)).empty)return{success:!1,error:`Ya existe un proveedor con el nombre "${n.name}"`};if(n.taxId){const d=Oe(et(Te,zs),Ke("taxId","==",n.taxId.trim()));if(!(await kt(d)).empty)return{success:!1,error:`Ya existe un proveedor con el NIT/Documento "${n.taxId}"`}}const o={name:n.name.trim(),taxId:n.taxId?.trim()||"",type:n.type||"proveedor",category:n.category||"combustibles",contactPerson:n.contactPerson?.trim()||"",phone:n.phone?.trim()||"",email:n.email?.trim()||"",address:n.address?.trim()||"",city:n.city?.trim()||"",state:n.state?.trim()||"Colombia",fuelTypes:n.fuelTypes||[],paymentTerms:n.paymentTerms||"contado",creditLimit:Number(n.creditLimit)||0,priceList:n.priceList||{},rating:Number(n.rating)||5,evaluationNotes:n.evaluationNotes||"",status:n.status||"active",isPreferred:n.isPreferred||!1,totalOrders:0,totalPurchased:0,lastOrderDate:null,averageDeliveryTime:0,createdAt:new Date,createdBy:e,lastUpdated:new Date,updatedBy:e};return{success:!0,data:{id:(await gu(et(Te,zs),o)).id,...o},message:`Proveedor "${o.name}" creado exitosamente`}}catch(t){return console.error("Error creating supplier:",t),{success:!1,error:t.message}}},CC=async()=>{try{const n=Oe(et(Te,zs),Qn("name","asc"));return{success:!0,data:(await kt(n)).docs.map(a=>({id:a.id,...a.data()}))}}catch(n){return console.error("Error getting suppliers:",n),{success:!1,error:n.message}}},vL=n=>{const e=Oe(et(Te,zs),Qn("name","asc"));return dl(e,t=>{const a=t.docs.map(o=>({id:o.id,...o.data()}));n(a)})},yL=async(n,e,t)=>{try{const a=await Ur(xt(Te,zs,n));if(!a.exists())return{success:!1,error:"Proveedor no encontrado"};if(e.name&&e.name.trim()!==a.data().name){const c=Oe(et(Te,zs),Ke("name","==",e.name.trim()));if(!(await kt(c)).empty)return{success:!1,error:`Ya existe un proveedor con el nombre "${e.name}"`}}if(e.taxId&&e.taxId.trim()!==a.data().taxId){const c=Oe(et(Te,zs),Ke("taxId","==",e.taxId.trim()));if(!(await kt(c)).empty)return{success:!1,error:`Ya existe un proveedor con el NIT/Documento "${e.taxId}"`}}const o={...e,lastUpdated:new Date,updatedBy:t};return o.name&&(o.name=o.name.trim()),o.taxId&&(o.taxId=o.taxId.trim()),o.contactPerson&&(o.contactPerson=o.contactPerson.trim()),o.phone&&(o.phone=o.phone.trim()),o.email&&(o.email=o.email.trim()),await ka(xt(Te,zs,n),o),{success:!0,message:"Proveedor actualizado exitosamente"}}catch(a){return console.error("Error updating supplier:",a),{success:!1,error:a.message}}},_L=async(n,e)=>{try{return await ka(xt(Te,zs,n),{status:"inactive",lastUpdated:new Date,updatedBy:e}),{success:!0,message:"Proveedor desactivado exitosamente"}}catch(t){return console.error("Error deleting supplier:",t),{success:!1,error:t.message}}},EL=async()=>{try{const n=await CC();if(!n.success)return n;const e=n.data,t={total:e.length,active:e.filter(a=>a.status==="active").length,inactive:e.filter(a=>a.status==="inactive").length,suspended:e.filter(a=>a.status==="suspended").length,preferred:e.filter(a=>a.isPreferred).length,averageRating:e.length>0?e.reduce((a,o)=>a+(o.rating||0),0)/e.length:0,byCategory:{},byType:{}};return e.forEach(a=>{const o=a.category||"sin_categoria";t.byCategory[o]=(t.byCategory[o]||0)+1}),e.forEach(a=>{const o=a.type||"sin_tipo";t.byType[o]=(t.byType[o]||0)+1}),{success:!0,data:t}}catch(n){return console.error("Error getting suppliers stats:",n),{success:!1,error:n.message}}},bL=({isOpen:n,onClose:e,movement:t,mode:a,onSuccess:o})=>{const[c,d]=Y.useState({type:"",fuelType:"",quantity:"",unitPrice:"",location:"Principal",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16)}),[f,p]=Y.useState(!1),[v,_]=Y.useState(""),[N,C]=Y.useState({}),[j,b]=Y.useState([]),[M,x]=Y.useState(!1),[L,$]=Y.useState([]),[O,U]=Y.useState(""),[F,X]=Y.useState([]),[w,A]=Y.useState([]),R=["Principal","Bodega Norte","Bodega Sur","Campo Operativo","Estación Móvil"];Y.useEffect(()=>{(async()=>{if(n){x(!0);try{console.log("🔄 Cargando datos para formulario de movimientos...");const[B,J,ce,ye]=await Promise.all([mC(),cC(),CC(),tL()]);console.log("📊 Datos cargados:",{vehicles:B?.length||0,inventory:J?.success?J.data?.length||0:"Error",suppliers:ce?.success?ce.data?.length||0:"Error",products:ye?.length||0}),b(B),$(J.success?J.data:[]),X(ce.success?ce.data:[]),A(ye),console.log("✅ Datos cargados exitosamente")}catch(B){console.error("❌ Error al cargar datos:",B)}finally{x(!1)}}})()},[n]),Y.useEffect(()=>{t&&(a==="edit"||a==="view")?d({type:t.type||"",fuelType:t.fuelType||"",quantity:t.quantity?.toString()||"",unitPrice:t.unitPrice?.toString()||"",location:t.location||"Principal",vehicleId:t.vehicleId||"",destinationLocation:t.destinationLocation||"",description:t.description||"",reference:t.reference||"",effectiveDate:t.effectiveDate?new Date(t.effectiveDate).toISOString().slice(0,16):new Date().toISOString().slice(0,16)}):a==="create"&&d({type:"",fuelType:"",quantity:"",unitPrice:"",location:"Principal",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16)}),_(""),C({})},[t,a,n]),Y.useEffect(()=>{if(c.fuelType&&!c.unitPrice&&w.length>0){const ae=w.find(B=>B.name===c.fuelType||B.displayName===c.fuelType);ae&&ae.defaultPrice&&d(B=>({...B,unitPrice:ae.defaultPrice.toString()}))}},[c.fuelType,w]),Y.useEffect(()=>{if(U(""),(c.type===be.SALIDA||c.type===be.TRANSFERENCIA)&&c.fuelType&&c.location&&c.quantity&&L.length>0){const ae={type:c.type===be.SALIDA?"outbound":"transfer",fuelType:c.fuelType,quantity:c.quantity,sourceLocation:c.location},B=CT(ae,L);B.isValid?B.warning&&U(`⚠️ ${B.warning}`):U(`🚫 ${B.error}`)}},[c.type,c.fuelType,c.location,c.quantity,L]);const I=(ae,B)=>{d(ae==="type"?J=>({...J,[ae]:B,location:B===be.ENTRADA?"":"Principal"}):J=>({...J,[ae]:B})),N[ae]&&C(J=>({...J,[ae]:""}))},P=()=>{const ae={};if(c.type||(ae.type="Tipo de movimiento requerido"),c.fuelType||(ae.fuelType="Tipo de combustible requerido"),c.quantity?parseFloat(c.quantity)<=0&&(ae.quantity="La cantidad debe ser mayor a cero"):ae.quantity="Cantidad requerida",c.unitPrice?parseFloat(c.unitPrice)<0&&(ae.unitPrice="El precio no puede ser negativo"):ae.unitPrice="Precio unitario requerido",c.type===be.ENTRADA&&!c.location&&(ae.location="Las entradas requieren un proveedor"),c.type===be.SALIDA&&!c.vehicleId&&(ae.vehicleId="Las salidas requieren un vehículo"),c.type===be.TRANSFERENCIA&&!c.destinationLocation&&(ae.destinationLocation="Las transferencias requieren una ubicación destino"),(c.type===be.SALIDA||c.type===be.TRANSFERENCIA)&&c.fuelType&&c.location&&c.quantity&&L.length>0){const B={type:c.type===be.SALIDA?"outbound":"transfer",fuelType:c.fuelType,quantity:c.quantity,sourceLocation:c.location},J=CT(B,L);J.isValid||(ae.quantity=J.error)}return C(ae),Object.keys(ae).length===0},V=async ae=>{if(ae.preventDefault(),!P()){_("Por favor corrige los errores en el formulario");return}p(!0),_("");try{const B={...c,quantity:parseFloat(c.quantity),unitPrice:parseFloat(c.unitPrice),effectiveDate:new Date(c.effectiveDate)};a==="create"?await H2(B):a==="edit"&&await dC(t.id,B),o()}catch(B){console.error("Error al guardar movimiento:",B),_(B.message||"Error al guardar el movimiento")}finally{p(!1)}},k=(parseFloat(c.quantity)||0)*(parseFloat(c.unitPrice)||0),Le=()=>{switch(a){case"create":return"➕ Nuevo Movimiento";case"edit":return"✏️ Editar Movimiento";case"view":return"👁️ Detalles del Movimiento";default:return"Movimiento"}};return n?r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-content movement-modal",onClick:ae=>ae.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:Le()}),r.jsx("button",{className:"modal-close",onClick:e,children:"✕"})]}),a==="create"&&r.jsx("div",{style:{padding:"10px",background:"#f0f0f0",borderBottom:"1px solid #ddd"},children:r.jsx("button",{onClick:()=>{console.log("🔍 Debug - Estado actual:",{products:w.length,vehicles:j.length,suppliers:F.length,inventory:L.length,loadingVehicles:M}),alert(`Productos: ${w.length}, Vehículos: ${j.length}, Proveedores: ${F.length}`)},style:{background:"#007bff",color:"white",border:"none",padding:"5px 10px",borderRadius:"4px",cursor:"pointer"},children:"🔍 Debug Datos"})}),r.jsxs("div",{className:"modal-body",children:[v&&r.jsxs("div",{className:"error-message",children:[r.jsx("span",{className:"error-icon",children:"⚠️"}),v]}),r.jsxs("form",{onSubmit:V,className:"movement-form",children:[r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Tipo de Movimiento *"}),r.jsxs("select",{value:c.type,onChange:ae=>I("type",ae.target.value),disabled:a==="view",className:N.type?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar tipo..."}),r.jsx("option",{value:be.ENTRADA,children:"📥 Entrada"}),r.jsx("option",{value:be.SALIDA,children:"📤 Salida"}),r.jsx("option",{value:be.TRANSFERENCIA,children:"🔄 Transferencia"}),r.jsx("option",{value:be.AJUSTE,children:"⚖️ Ajuste"})]}),N.type&&r.jsx("span",{className:"field-error",children:N.type})]}),a==="view"&&t&&r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado"}),r.jsx("div",{className:"status-display",children:r.jsxs("span",{className:`status-badge status-${t.status}`,children:[t.status===$e.COMPLETADO&&"✅",t.status===$e.PENDIENTE&&"⏳",t.status===$e.CANCELADO&&"❌",t.status.charAt(0).toUpperCase()+t.status.slice(1)]})})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Tipo de Combustible *"}),r.jsxs("select",{value:c.fuelType,onChange:ae=>I("fuelType",ae.target.value),disabled:a==="view",className:N.fuelType?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar producto/combustible..."}),w.map(ae=>r.jsxs("option",{value:ae.name,children:[ae.icon," ",ae.displayName]},ae.id))]}),N.fuelType&&r.jsx("span",{className:"field-error",children:N.fuelType})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Cantidad (galones) *"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:c.quantity,onChange:ae=>I("quantity",ae.target.value),disabled:a==="view",placeholder:"0.00",className:N.quantity?"error":""}),N.quantity&&r.jsx("span",{className:"field-error",children:N.quantity}),O&&!N.quantity&&r.jsx("div",{className:"stock-warning",children:O})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Precio Unitario (COP) *"}),r.jsx("input",{type:"number",step:"1",min:"0",value:c.unitPrice,onChange:ae=>I("unitPrice",ae.target.value),disabled:a==="view",placeholder:"0",className:N.unitPrice?"error":""}),N.unitPrice&&r.jsx("span",{className:"field-error",children:N.unitPrice})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Valor Total"}),r.jsx("div",{className:"total-value-display",children:Mn(k)})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:c.type===be.ENTRADA?"Proveedor *":"Ubicación"}),c.type===be.ENTRADA?r.jsxs("select",{value:c.location,onChange:ae=>I("location",ae.target.value),disabled:a==="view",className:N.location?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar proveedor..."}),F.filter(ae=>ae.status==="active").map(ae=>r.jsxs("option",{value:ae.name,children:["🏪 ",ae.name," - ",ae.city]},ae.id))]}):r.jsx("select",{value:c.location,onChange:ae=>I("location",ae.target.value),disabled:a==="view",children:R.map(ae=>r.jsxs("option",{value:ae,children:["📍 ",ae]},ae))}),N.location&&r.jsx("span",{className:"field-error",children:N.location})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{children:["Vehículo/Equipo ",c.type===be.SALIDA&&"*"]}),c.type===be.SALIDA?M?r.jsxs("div",{className:"loading-vehicles",children:[r.jsx("span",{className:"loading-spinner small"}),"Cargando vehículos..."]}):r.jsxs("select",{value:c.vehicleId,onChange:ae=>I("vehicleId",ae.target.value),disabled:a==="view",className:N.vehicleId?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar vehículo destino..."}),j.map(ae=>r.jsxs("option",{value:ae.vehicleId,children:["🚜 ",ae.vehicleId," - ",ae.name," (",ae.type,")"]},ae.id))]}):r.jsx("input",{type:"text",value:c.vehicleId,onChange:ae=>I("vehicleId",ae.target.value),disabled:a==="view",placeholder:"ID del vehículo o equipo",className:N.vehicleId?"error":""}),N.vehicleId&&r.jsx("span",{className:"field-error",children:N.vehicleId})]})]}),c.type===be.TRANSFERENCIA&&r.jsx("div",{className:"form-row",children:r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Ubicación Destino *"}),r.jsxs("select",{value:c.destinationLocation,onChange:ae=>I("destinationLocation",ae.target.value),disabled:a==="view",className:N.destinationLocation?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar destino..."}),R.filter(ae=>ae!==c.location).map(ae=>r.jsxs("option",{value:ae,children:["📍 ",ae]},ae))]}),N.destinationLocation&&r.jsx("span",{className:"field-error",children:N.destinationLocation})]})}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Fecha Efectiva"}),r.jsx("input",{type:"datetime-local",value:c.effectiveDate,onChange:ae=>I("effectiveDate",ae.target.value),disabled:a==="view"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Referencia"}),r.jsx("input",{type:"text",value:c.reference,onChange:ae=>I("reference",ae.target.value),disabled:a==="view",placeholder:"Factura, orden, etc."})]})]}),r.jsx("div",{className:"form-row",children:r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{children:"Descripción"}),r.jsx("textarea",{value:c.description,onChange:ae=>I("description",ae.target.value),disabled:a==="view",placeholder:"Detalles adicionales del movimiento...",rows:"3"})]})}),a==="view"&&t&&r.jsx("div",{className:"movement-details",children:r.jsxs("div",{className:"details-section",children:[r.jsx("h4",{children:"📋 Información del Sistema"}),r.jsxs("div",{className:"details-grid",children:[r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"ID:"}),r.jsx("span",{children:t.id})]}),r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"Creado:"}),r.jsx("span",{children:new Date(t.createdAt).toLocaleString("es-CO")})]}),t.updatedAt&&r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"Actualizado:"}),r.jsx("span",{children:new Date(t.updatedAt).toLocaleString("es-CO")})]}),t.approvedAt&&r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"Aprobado:"}),r.jsx("span",{children:new Date(t.approvedAt).toLocaleString("es-CO")})]})]})]})})]})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-cancel",onClick:e,children:a==="view"?"Cerrar":"Cancelar"}),a!=="view"&&r.jsx("button",{type:"submit",className:"btn-primary",onClick:V,disabled:f,children:f?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"loading-spinner small"}),"Guardando..."]}):a==="create"?"Crear Movimiento":"Actualizar Movimiento"})]})]})}):null},NL=()=>{const{user:n,userProfile:e}=Zs(),[t,a]=Y.useState([]),[o,c]=Y.useState(null),[d,f]=Y.useState(!0),[p,v]=Y.useState(null),[_,N]=Y.useState({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),[C,j]=Y.useState("cards"),[b,M]=Y.useState(""),[x,L]=Y.useState(!1),[$,O]=Y.useState(null),[U,F]=Y.useState("create");Y.useEffect(()=>{if(!n)return;f(!0);const J=zv((ce,ye)=>{if(ye){console.error("Error en suscripción de movimientos:",ye),v("Error al cargar movimientos"),f(!1);return}a(ce),v(null),f(!1)},_);return()=>J()},[n,_]),Y.useEffect(()=>{n&&(async()=>{try{const ce=await G2(_);c(ce)}catch(ce){console.error("Error al cargar estadísticas:",ce)}})()},[n,t,_]);const X=t.filter(J=>{if(!b)return!0;const ce=b.toLowerCase();return J.fuelType?.toLowerCase().includes(ce)||J.type?.toLowerCase().includes(ce)||J.location?.toLowerCase().includes(ce)||J.vehicleId?.toLowerCase().includes(ce)||J.description?.toLowerCase().includes(ce)||J.reference?.toLowerCase().includes(ce)}),w=()=>{O(null),F("create"),L(!0)},A=J=>{O(J),F("edit"),L(!0)},R=J=>{O(J),F("view"),L(!0)},I=()=>{L(!1),O(null)},P=J=>{N(ce=>({...ce,...J}))},V=()=>{N({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),M("")},k=async J=>{if(window.confirm("¿Estás seguro de que quieres aprobar este movimiento? Esta acción actualizará el inventario."))try{await z2(J),alert("Movimiento aprobado y stock actualizado.")}catch(ce){console.error("Error al aprobar movimiento:",ce),alert(`Error al aprobar movimiento: ${ce.message}`)}},Le=async J=>{if(window.confirm("¿Estás seguro de que quieres rechazar este movimiento?"))try{await dC(J,{status:$e.CANCELADO}),alert("Movimiento rechazado.")}catch(ce){console.error("Error al rechazar movimiento:",ce),alert(`Error al rechazar movimiento: ${ce.message}`)}},ae=e?.role==="admin"||e?.role==="contador"||e?.role==="cliente",B=e?.role==="admin";return d?r.jsx("div",{className:"movements-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando movimientos..."})]})}):p?r.jsx("div",{className:"movements-main",children:r.jsxs("div",{className:"error-container",children:[r.jsx("div",{className:"error-icon",children:"⚠️"}),r.jsx("h3",{children:"Error al cargar movimientos"}),r.jsx("p",{children:p}),r.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):r.jsxs("div",{className:"movements-main",children:[r.jsxs("div",{className:"movements-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h2",{children:"📊 Movimientos de Combustibles"}),r.jsx("p",{children:"Gestiona entradas, salidas, transferencias y ajustes de inventario"})]}),ae&&r.jsx("button",{className:"btn-create-movement",onClick:w,children:"➕ Nuevo Movimiento"})]}),o&&r.jsx(dL,{stats:o,filters:_}),r.jsx(hL,{filters:_,onFilterChange:P,onClearFilters:V,searchTerm:b,onSearchChange:M,viewMode:C,onViewModeChange:j,totalResults:X.length}),X.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"📋"}),r.jsx("h3",{children:t.length===0?"No hay movimientos registrados":"No se encontraron movimientos"}),r.jsx("p",{children:t.length===0?"Comienza creando tu primer movimiento de combustible":"Intenta ajustar los filtros de búsqueda"}),t.length===0&&ae&&r.jsx("button",{className:"btn-create-first",onClick:w,children:"➕ Crear Primer Movimiento"})]}):r.jsx(pL,{movements:X,viewMode:C,onEdit:B?A:null,onView:R,onApprove:k,onReject:Le,userRole:n?.role}),x&&r.jsx(bL,{isOpen:x,onClose:I,movement:$,mode:U,onSuccess:()=>{I()}})]})},TL=({stats:n,filters:e})=>{if(!n)return null;const t=N=>`${Ge(N)} gal`,a=N=>`${Ge(N)} hrs`,o=N=>`${N.toFixed(2)} gal/hr`,c=N=>{switch(N){case fe.EXCAVADORA:return"#059669";case fe.BULLDOZER:return"#dc2626";case fe.CARGADOR:return"#2563eb";case fe.CAMION:return"#7c3aed";case fe.GRUA:return"#ea580c";case fe.MOTOSIERRA:return"#16a34a";case fe.TRACTOR:return"#ca8a04";case fe.VOLQUETA:return"#9333ea";default:return"#6b7280"}},d=N=>{switch(N){case fe.EXCAVADORA:return"🚚";case fe.BULLDOZER:return"🚜";case fe.CARGADOR:return"🏗️";case fe.CAMION:return"🚛";case fe.GRUA:return"🏗️";case fe.MOTOSIERRA:return"🪚";case fe.TRACTOR:return"🚜";case fe.VOLQUETA:return"🚛";default:return"🚗"}},f=N=>{switch(N){case ve.ACTIVO:return"#10b981";case ve.MANTENIMIENTO:return"#f59e0b";case ve.INACTIVO:return"#6b7280";case ve.REPARACION:return"#ef4444";default:return"#6b7280"}},p=N=>{switch(N){case ve.ACTIVO:return"✅";case ve.MANTENIMIENTO:return"🔧";case ve.INACTIVO:return"⏸️";case ve.REPARACION:return"🔴";default:return"❓"}},v=N=>{switch(N){case Re.DIESEL:return"🚛";case Re.GASOLINA:return"🚗";case Re.ACPM:return"🚚";case Re.MIXTO:return"⛽";default:return"⛽"}},_=n.totalVehicles>0?((n.byStatus[ve.ACTIVO]||0)/n.totalVehicles*100).toFixed(1):0;return r.jsxs("div",{className:"vehicles-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:"🚜"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Ge(n.totalVehicles)}),r.jsx("div",{className:"stat-label",children:"Total Vehículos"}),r.jsx("div",{className:"stat-trend",children:r.jsxs("span",{className:`trend ${_>=80?"positive":"warning"}`,children:[_>=80?"📈":"⚠️"," ",_,"% activos"]})})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"⛽"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:t(n.totalFuelConsumed)}),r.jsx("div",{className:"stat-label",children:"Combustible Consumido"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",o(n.averageConsumption||0)]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"⏰"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:a(n.totalHoursWorked)}),r.jsx("div",{className:"stat-label",children:"Horas Trabajadas"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",a(n.totalHoursWorked/(n.totalVehicles||1))]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"🏆"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:n.mostActiveVehicle?n.mostActiveVehicle.vehicleId:"N/A"}),r.jsx("div",{className:"stat-label",children:"Más Activo"}),r.jsx("div",{className:"stat-secondary",children:n.mostActiveVehicle?`${n.mostActiveVehicle.totalMovements||0} movimientos`:"Sin datos"})]})]})]}),r.jsxs("div",{className:"stats-breakdown",children:[r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"🚜 Por Tipo de Vehículo"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([N,C])=>{const j=(C/n.totalVehicles*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:d(N)}),r.jsx("span",{className:"breakdown-label",children:N.charAt(0).toUpperCase()+N.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:C}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${j}%`,backgroundColor:c(N)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[j,"%"]})]},N)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"⚡ Por Estado"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([N,C])=>{const j=(C/n.totalVehicles*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:p(N)}),r.jsx("span",{className:"breakdown-label",children:N.charAt(0).toUpperCase()+N.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:C}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${j}%`,backgroundColor:f(N)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[j,"%"]})]},N)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"⛽ Por Tipo de Combustible"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byFuelType).map(([N,C])=>{const j=(C/n.totalVehicles*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:v(N)}),r.jsx("span",{className:"breakdown-label",children:N})]}),r.jsx("div",{className:"breakdown-value",children:C}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${j}%`,backgroundColor:"#059669"}})}),r.jsxs("div",{className:"breakdown-percentage",children:[j,"%"]})]},N)})})]})]}),(n.totalFuelConsumed>0||n.totalHoursWorked>0)&&r.jsxs("div",{className:"performance-metrics",children:[r.jsx("h4",{children:"📊 Métricas de Rendimiento"}),r.jsxs("div",{className:"metrics-grid",children:[r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:"⚡"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Eficiencia de Flota"}),r.jsxs("div",{className:"metric-value",children:[_,"%"]}),r.jsxs("div",{className:"metric-description",children:[n.byStatus[ve.ACTIVO]||0," de ",n.totalVehicles," activos"]})]})]}),n.averageConsumption>0&&r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:"📈"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Consumo Promedio"}),r.jsx("div",{className:"metric-value",children:o(n.averageConsumption)}),r.jsx("div",{className:"metric-description",children:"Por vehículo por hora trabajada"})]})]}),n.mostActiveVehicle&&r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:"🏆"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Mayor Utilización"}),r.jsx("div",{className:"metric-value",children:n.mostActiveVehicle.vehicleId}),r.jsxs("div",{className:"metric-description",children:[t(n.mostActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]}),n.leastActiveVehicle&&r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:"📉"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Menor Utilización"}),r.jsx("div",{className:"metric-value",children:n.leastActiveVehicle.vehicleId}),r.jsxs("div",{className:"metric-description",children:[t(n.leastActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]})]})]}),(e.type||e.status||e.fuelType||e.location)&&r.jsxs("div",{className:"active-filters",children:[r.jsx("h4",{children:"🔍 Filtros Activos"}),r.jsxs("div",{className:"filters-list",children:[e.type&&r.jsxs("span",{className:"filter-tag",children:["Tipo: ",e.type]}),e.status&&r.jsxs("span",{className:"filter-tag",children:["Estado: ",e.status]}),e.fuelType&&r.jsxs("span",{className:"filter-tag",children:["Combustible: ",e.fuelType]}),e.location&&r.jsxs("span",{className:"filter-tag",children:["Ubicación: ",e.location]})]})]})]})},xL=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:a,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:f})=>{const[p,v]=Y.useState(!1),_=["Oficina Principal","Bodega Norte","Bodega Sur","Campo Operativo","Taller Mecánico","Proyecto A","Proyecto B","En Reparación","Otros"],N=Object.values(n).filter(b=>b&&b!==""&&b!=="all").length,C=(b,M)=>{e({[b]:M})},j=b=>{e(b)};return r.jsxs("div",{className:"vehicles-filters",children:[r.jsxs("div",{className:"filters-main",children:[r.jsx("div",{className:"search-section",children:r.jsxs("div",{className:"search-box",children:[r.jsx("span",{className:"search-icon",children:"🔍"}),r.jsx("input",{type:"text",placeholder:"Buscar por ID, nombre, marca, modelo, ubicación...",value:a,onChange:b=>o(b.target.value),className:"search-input"}),a&&r.jsx("button",{className:"search-clear",onClick:()=>o(""),title:"Limpiar búsqueda",children:"✕"})]})}),r.jsxs("div",{className:"filters-controls",children:[r.jsxs("div",{className:"quick-filters",children:[r.jsx("button",{className:`quick-filter ${n.status===ve.ACTIVO?"active":""}`,onClick:()=>j({status:ve.ACTIVO}),children:"✅ Activos"}),r.jsx("button",{className:`quick-filter ${n.status===ve.MANTENIMIENTO?"active":""}`,onClick:()=>j({status:ve.MANTENIMIENTO}),children:"🔧 Mantenimiento"}),r.jsx("button",{className:`quick-filter ${n.type===fe.EXCAVADORA?"active":""}`,onClick:()=>j({type:fe.EXCAVADORA}),children:"🚚 Excavadoras"}),r.jsx("button",{className:`quick-filter ${n.type===fe.TRACTOR?"active":""}`,onClick:()=>j({type:fe.TRACTOR}),children:"🚜 Tractores"})]}),r.jsxs("button",{className:`btn-advanced-filters ${p?"active":""}`,onClick:()=>v(!p),children:["🎛️ Filtros",N>0&&r.jsx("span",{className:"filters-count",children:N})]}),r.jsxs("div",{className:"view-modes",children:[r.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),title:"Vista en tarjetas",children:"🎴"}),r.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),title:"Vista en tabla",children:"📋"})]})]})]}),p&&r.jsxs("div",{className:"filters-advanced",children:[r.jsxs("div",{className:"filters-grid",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Vehículo"}),r.jsxs("select",{value:n.type,onChange:b=>C("type",b.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los tipos"}),r.jsx("option",{value:fe.EXCAVADORA,children:"🚚 Excavadora"}),r.jsx("option",{value:fe.BULLDOZER,children:"🚜 Bulldozer"}),r.jsx("option",{value:fe.CARGADOR,children:"🏗️ Cargador"}),r.jsx("option",{value:fe.CAMION,children:"🚛 Camión"}),r.jsx("option",{value:fe.GRUA,children:"🏗️ Grúa"}),r.jsx("option",{value:fe.MOTOSIERRA,children:"🪚 Motosierra"}),r.jsx("option",{value:fe.TRACTOR,children:"🚜 Tractor"}),r.jsx("option",{value:fe.VOLQUETA,children:"🚛 Volqueta"}),r.jsx("option",{value:fe.OTROS,children:"🚗 Otros"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:n.status,onChange:b=>C("status",b.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los estados"}),r.jsx("option",{value:ve.ACTIVO,children:"✅ Activo"}),r.jsx("option",{value:ve.MANTENIMIENTO,children:"🔧 Mantenimiento"}),r.jsx("option",{value:ve.INACTIVO,children:"⏸️ Inactivo"}),r.jsx("option",{value:ve.REPARACION,children:"🔴 Reparación"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Combustible"}),r.jsxs("select",{value:n.fuelType,onChange:b=>C("fuelType",b.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los combustibles"}),r.jsx("option",{value:Re.DIESEL,children:"🚛 Diesel"}),r.jsx("option",{value:Re.GASOLINA,children:"🚗 Gasolina"}),r.jsx("option",{value:Re.ACPM,children:"🚚 ACPM"}),r.jsx("option",{value:Re.MIXTO,children:"⛽ Mixto"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Ubicación Actual"}),r.jsxs("select",{value:n.location,onChange:b=>C("location",b.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todas las ubicaciones"}),_.map(b=>r.jsxs("option",{value:b,children:["📍 ",b]},b))]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Mantenimiento"}),r.jsxs("select",{value:n.maintenance,onChange:b=>C("maintenance",b.target.value),className:"filter-select",children:[r.jsx("option",{value:"all",children:"Todos"}),r.jsx("option",{value:"due",children:"Mantenimiento debido"}),r.jsx("option",{value:"overdue",children:"Mantenimiento vencido"}),r.jsx("option",{value:"recent",children:"Mantenimiento reciente"})]})]})]}),r.jsxs("div",{className:"filters-actions",children:[r.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:N===0,children:"🗑️ Limpiar Filtros"}),r.jsxs("div",{className:"filters-info",children:[r.jsxs("span",{className:"results-count",children:[f," resultado",f!==1?"s":""]}),N>0&&r.jsxs("span",{className:"active-filters-text",children:["(",N," filtro",N!==1?"s":""," activo",N!==1?"s":"",")"]})]})]})]}),N>0&&r.jsx("div",{className:"active-filters-summary",children:r.jsxs("div",{className:"summary-content",children:[r.jsx("span",{className:"summary-label",children:"Filtros activos:"}),r.jsxs("div",{className:"summary-tags",children:[n.type&&r.jsxs("span",{className:"summary-tag",onClick:()=>C("type",""),children:["Tipo: ",n.type," ✕"]}),n.status&&r.jsxs("span",{className:"summary-tag",onClick:()=>C("status",""),children:["Estado: ",n.status," ✕"]}),n.fuelType&&r.jsxs("span",{className:"summary-tag",onClick:()=>C("fuelType",""),children:["Combustible: ",n.fuelType," ✕"]}),n.location&&r.jsxs("span",{className:"summary-tag",onClick:()=>C("location",""),children:["Ubicación: ",n.location," ✕"]}),n.maintenance!=="all"&&r.jsxs("span",{className:"summary-tag",onClick:()=>C("maintenance","all"),children:["Mantenimiento: ",n.maintenance," ✕"]})]})]})}),r.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:r.jsx("small",{children:"💡 Atajos: Ctrl+F (buscar), Ctrl+1 (activos), Ctrl+2 (mantenimiento), Ctrl+T (tractores)"})})]})},AL=({vehicles:n,onEdit:e,onView:t,onMaintenance:a})=>{const o=x=>new Intl.NumberFormat("es-CO").format(x),c=x=>`${o(x)} gal`,d=x=>`${o(x)} hrs`,f=x=>x?(x instanceof Date?x:new Date(x)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric"}):"Sin fecha",p=x=>{if(!x)return"";const L=new Date,$=x instanceof Date?x:new Date(x),O=Math.abs(L-$),U=Math.ceil(O/(1e3*60*60*24));return U===1?"hace 1 día":U<7?`hace ${U} días`:U<30?`hace ${Math.ceil(U/7)} semanas`:U<365?`hace ${Math.ceil(U/30)} meses`:`hace ${Math.ceil(U/365)} años`},v=x=>{switch(x){case fe.EXCAVADORA:return"vehicle-excavadora";case fe.BULLDOZER:return"vehicle-bulldozer";case fe.CARGADOR:return"vehicle-cargador";case fe.CAMION:return"vehicle-camion";case fe.GRUA:return"vehicle-grua";case fe.MOTOSIERRA:return"vehicle-motosierra";case fe.TRACTOR:return"vehicle-tractor";case fe.VOLQUETA:return"vehicle-volqueta";default:return"vehicle-default"}},_=x=>{switch(x){case ve.ACTIVO:return"status-activo";case ve.MANTENIMIENTO:return"status-mantenimiento";case ve.INACTIVO:return"status-inactivo";case ve.REPARACION:return"status-reparacion";default:return"status-default"}},N=x=>{switch(x){case fe.EXCAVADORA:return"🚚";case fe.BULLDOZER:return"🚜";case fe.CARGADOR:return"🏗️";case fe.CAMION:return"🚛";case fe.GRUA:return"🏗️";case fe.MOTOSIERRA:return"🪚";case fe.TRACTOR:return"🚜";case fe.VOLQUETA:return"🚛";default:return"🚗"}},C=x=>{switch(x){case Re.DIESEL:return"🚛";case Re.GASOLINA:return"🚗";case Re.ACPM:return"🚚";case Re.MIXTO:return"⛽";default:return"⛽"}},j=x=>{switch(x){case ve.ACTIVO:return"✅";case ve.MANTENIMIENTO:return"🔧";case ve.INACTIVO:return"⏸️";case ve.REPARACION:return"🔴";default:return"❓"}},b=x=>!x.totalHoursWorked||x.totalHoursWorked===0?x.estimatedConsumptionPerHour||0:x.totalFuelConsumed/x.totalHoursWorked,M=x=>x.lastMaintenanceDate?Math.floor((new Date-new Date(x.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return r.jsx("div",{className:"vehicles-cards",children:n.map(x=>r.jsxs("div",{className:`vehicle-card ${v(x.type)}`,children:[r.jsx("div",{className:"card-header",children:r.jsxs("div",{className:"vehicle-info",children:[r.jsxs("div",{className:"vehicle-id-section",children:[r.jsx("span",{className:"vehicle-icon",children:N(x.type)}),r.jsxs("div",{className:"vehicle-details",children:[r.jsx("span",{className:"vehicle-id",children:x.vehicleId}),r.jsx("span",{className:"vehicle-name",children:x.name})]})]}),r.jsxs("div",{className:`status-badge ${_(x.status)}`,children:[r.jsx("span",{className:"status-icon",children:j(x.status)}),r.jsx("span",{className:"status-label",children:x.status.charAt(0).toUpperCase()+x.status.slice(1)})]})]})}),r.jsxs("div",{className:"card-content",children:[r.jsxs("div",{className:"basic-info",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Tipo:"}),r.jsxs("span",{className:"info-value",children:[N(x.type)," ",x.type.charAt(0).toUpperCase()+x.type.slice(1)]})]}),x.brand&&x.model&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Marca/Modelo:"}),r.jsxs("span",{className:"info-value",children:[x.brand," ",x.model]})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Combustible:"}),r.jsxs("span",{className:"info-value",children:[C(x.fuelType)," ",x.fuelType]})]}),x.currentLocation&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Ubicación:"}),r.jsxs("span",{className:"info-value",children:["📍 ",x.currentLocation]})]})]}),r.jsxs("div",{className:"consumption-metrics",children:[r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:"⛽"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-value",children:c(x.totalFuelConsumed||0)}),r.jsx("div",{className:"metric-label",children:"Consumido"})]})]}),r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:"⏰"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-value",children:d(x.totalHoursWorked||0)}),r.jsx("div",{className:"metric-label",children:"Trabajadas"})]})]}),r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:"📊"}),r.jsxs("div",{className:"metric-content",children:[r.jsxs("div",{className:"metric-value",children:[b(x).toFixed(1)," gal/hr"]}),r.jsx("div",{className:"metric-label",children:"Consumo"})]})]}),r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:"🔄"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-value",children:x.totalMovements||0}),r.jsx("div",{className:"metric-label",children:"Movimientos"})]})]})]}),(x.enginePower||x.fuelCapacity||x.year)&&r.jsxs("div",{className:"technical-specs",children:[x.enginePower&&r.jsxs("div",{className:"spec-item",children:[r.jsx("span",{className:"spec-icon",children:"⚡"}),r.jsxs("span",{className:"spec-value",children:[x.enginePower," HP"]})]}),x.fuelCapacity&&r.jsxs("div",{className:"spec-item",children:[r.jsx("span",{className:"spec-icon",children:"🛢️"}),r.jsxs("span",{className:"spec-value",children:[x.fuelCapacity," gal"]})]}),x.year&&r.jsxs("div",{className:"spec-item",children:[r.jsx("span",{className:"spec-icon",children:"📅"}),r.jsx("span",{className:"spec-value",children:x.year})]})]}),x.description&&r.jsx("div",{className:"description",children:r.jsx("p",{children:x.description})})]}),r.jsxs("div",{className:"card-footer",children:[r.jsxs("div",{className:"date-info",children:[x.lastMovementDate&&r.jsxs("div",{className:"date-item",children:[r.jsx("span",{className:"date-label",children:"Último movimiento:"}),r.jsx("span",{className:"date-value",children:f(x.lastMovementDate)}),r.jsx("span",{className:"date-relative",children:p(x.lastMovementDate)})]}),x.lastMaintenanceDate&&r.jsxs("div",{className:"date-item",children:[r.jsx("span",{className:"date-label",children:"Último mantenimiento:"}),r.jsx("span",{className:"date-value",children:f(x.lastMaintenanceDate)}),r.jsx("span",{className:"date-relative",children:p(x.lastMaintenanceDate)})]})]}),r.jsxs("div",{className:"card-actions",children:[r.jsx("button",{className:"btn-view",onClick:()=>t(x),title:"Ver detalles",children:"👁️"}),e&&x.status!==ve.REPARACION&&r.jsx("button",{className:"btn-edit",onClick:()=>e(x),title:"Editar vehículo",children:"✏️"}),a&&r.jsx("button",{className:"btn-maintenance",onClick:()=>a(x),title:"Registrar mantenimiento",children:"🔧"})]})]}),x.status===ve.MANTENIMIENTO&&r.jsx("div",{className:"maintenance-indicator",children:r.jsx("div",{className:"maintenance-pulse"})}),M(x)&&x.status===ve.ACTIVO&&r.jsx("div",{className:"maintenance-due-badge",children:r.jsx("span",{children:"Mantenimiento Debido"})}),x.status===ve.REPARACION&&r.jsx("div",{className:"repair-badge",children:r.jsx("span",{children:"En Reparación"})}),x.totalHoursWorked>0&&r.jsxs("div",{className:"efficiency-indicator",children:[r.jsx("div",{className:"efficiency-bar",children:r.jsx("div",{className:"efficiency-fill",style:{width:`${Math.min(x.totalHoursWorked/2e3*100,100)}%`}})}),r.jsxs("span",{className:"efficiency-label",children:[(x.totalHoursWorked/2e3*100).toFixed(1),"% utilización anual"]})]})]},x.id))})},CL=({vehicles:n,onEdit:e,onView:t,onMaintenance:a})=>{const[o,c]=Y.useState("vehicleId"),[d,f]=Y.useState("asc"),p=F=>new Intl.NumberFormat("es-CO").format(F),v=F=>`${p(F)} gal`,_=F=>`${p(F)} hrs`,N=F=>F?(F instanceof Date?F:new Date(F)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-",C=F=>{switch(F){case fe.EXCAVADORA:return"🚚";case fe.BULLDOZER:return"🚜";case fe.CARGADOR:return"🏗️";case fe.CAMION:return"🚛";case fe.GRUA:return"🏗️";case fe.MOTOSIERRA:return"🪚";case fe.TRACTOR:return"🚜";case fe.VOLQUETA:return"🚛";default:return"🚗"}},j=F=>{switch(F){case Re.DIESEL:return"🚛";case Re.GASOLINA:return"🚗";case Re.ACPM:return"🚚";case Re.MIXTO:return"⛽";default:return"⛽"}},b=F=>{switch(F){case ve.ACTIVO:return"✅";case ve.MANTENIMIENTO:return"🔧";case ve.INACTIVO:return"⏸️";case ve.REPARACION:return"🔴";default:return"❓"}},M=F=>{switch(F){case ve.ACTIVO:return"status-activo";case ve.MANTENIMIENTO:return"status-mantenimiento";case ve.INACTIVO:return"status-inactivo";case ve.REPARACION:return"status-reparacion";default:return"status-default"}},x=F=>{o===F?f(d==="asc"?"desc":"asc"):(c(F),f("asc"))},L=[...n].sort((F,X)=>{let w=F[o],A=X[o];return(o.includes("Date")||o.includes("At"))&&(w=new Date(w||0),A=new Date(A||0)),typeof w=="number"&&typeof A=="number"?d==="asc"?w-A:A-w:typeof w=="string"&&typeof A=="string"?d==="asc"?w.localeCompare(A):A.localeCompare(w):w instanceof Date&&A instanceof Date?d==="asc"?w-A:A-w:!w&&!A?0:w?A?0:d==="asc"?-1:1:d==="asc"?1:-1}),$=F=>o!==F?"↕️":d==="asc"?"↑":"↓",O=F=>!F.totalHoursWorked||F.totalHoursWorked===0?F.estimatedConsumptionPerHour||0:F.totalFuelConsumed/F.totalHoursWorked,U=F=>F.lastMaintenanceDate?Math.floor((new Date-new Date(F.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return r.jsxs("div",{className:"vehicles-table-container",children:[r.jsx("div",{className:"table-wrapper",children:r.jsxs("table",{className:"vehicles-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{className:"sortable",onClick:()=>x("vehicleId"),children:["ID Vehículo ",$("vehicleId")]}),r.jsxs("th",{className:"sortable",onClick:()=>x("name"),children:["Nombre ",$("name")]}),r.jsxs("th",{className:"sortable",onClick:()=>x("type"),children:["Tipo ",$("type")]}),r.jsx("th",{children:"Marca/Modelo"}),r.jsxs("th",{className:"sortable",onClick:()=>x("fuelType"),children:["Combustible ",$("fuelType")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>x("totalFuelConsumed"),children:["Consumido ",$("totalFuelConsumed")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>x("totalHoursWorked"),children:["Horas ",$("totalHoursWorked")]}),r.jsx("th",{className:"text-right",children:"Consumo/Hr"}),r.jsx("th",{children:"Ubicación"}),r.jsxs("th",{className:"sortable",onClick:()=>x("status"),children:["Estado ",$("status")]}),r.jsxs("th",{className:"sortable",onClick:()=>x("lastMovementDate"),children:["Último Mov. ",$("lastMovementDate")]}),r.jsx("th",{className:"actions-column",children:"Acciones"})]})}),r.jsx("tbody",{children:L.map(F=>r.jsxs("tr",{className:`vehicle-row ${F.status===ve.MANTENIMIENTO?"maintenance-row":""} ${U(F)?"needs-maintenance":""}`,children:[r.jsx("td",{className:"vehicle-id-cell",children:r.jsxs("div",{className:"id-content",children:[r.jsx("span",{className:"vehicle-icon",children:C(F.type)}),r.jsx("span",{className:"vehicle-id",children:F.vehicleId})]})}),r.jsx("td",{className:"name-cell",children:r.jsx("span",{className:"vehicle-name",children:F.name})}),r.jsx("td",{className:"type-cell",children:r.jsx("span",{className:"type-text",children:F.type.charAt(0).toUpperCase()+F.type.slice(1)})}),r.jsx("td",{className:"brand-model-cell",children:F.brand&&F.model?r.jsxs("span",{className:"brand-model",children:[F.brand," ",F.model]}):r.jsx("span",{className:"no-data",children:"-"})}),r.jsx("td",{className:"fuel-cell",children:r.jsxs("div",{className:"fuel-content",children:[r.jsx("span",{className:"fuel-icon",children:j(F.fuelType)}),r.jsx("span",{className:"fuel-text",children:F.fuelType})]})}),r.jsx("td",{className:"consumption-cell text-right",children:r.jsx("span",{className:"consumption-value",children:v(F.totalFuelConsumed||0)})}),r.jsx("td",{className:"hours-cell text-right",children:r.jsx("span",{className:"hours-value",children:_(F.totalHoursWorked||0)})}),r.jsx("td",{className:"rate-cell text-right",children:r.jsxs("span",{className:"rate-value",children:[O(F).toFixed(1)," gal/hr"]})}),r.jsx("td",{className:"location-cell",children:r.jsxs("span",{className:"location-text",children:["📍 ",F.currentLocation||"Sin ubicación"]})}),r.jsx("td",{className:"status-cell",children:r.jsxs("div",{className:`status-badge ${M(F.status)}`,children:[r.jsx("span",{className:"status-icon",children:b(F.status)}),r.jsx("span",{className:"status-text",children:F.status.charAt(0).toUpperCase()+F.status.slice(1)})]})}),r.jsx("td",{className:"date-cell",children:r.jsxs("div",{className:"date-content",children:[r.jsx("span",{className:"date-value",children:N(F.lastMovementDate)}),U(F)&&r.jsx("span",{className:"maintenance-warning",children:"⚠️"})]})}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn-action btn-view",onClick:()=>t(F),title:"Ver detalles",children:"👁️"}),e&&F.status!==ve.REPARACION&&r.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(F),title:"Editar vehículo",children:"✏️"}),a&&r.jsx("button",{className:"btn-action btn-maintenance",onClick:()=>a(F),title:"Registrar mantenimiento",children:"🔧"})]})})]},F.id))})]})}),r.jsxs("div",{className:"table-info",children:[r.jsxs("div",{className:"table-summary",children:[r.jsxs("span",{className:"total-rows",children:[n.length," vehículo",n.length!==1?"s":""]}),o&&r.jsxs("span",{className:"sort-info",children:["Ordenado por ",o," (",d==="asc"?"ascendente":"descendente",")"]})]}),r.jsxs("div",{className:"table-legend",children:[r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"✅"})," Activo"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"🔧"})," Mantenimiento"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"⏸️"})," Inactivo"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"🔴"})," Reparación"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"⚠️"})," Mantto. Debido"]})]})]})]})},jL=({vehicles:n,viewMode:e,onEdit:t,onView:a,onMaintenance:o})=>e==="table"?r.jsx(CL,{vehicles:n,onEdit:t,onView:a,onMaintenance:o}):r.jsx(AL,{vehicles:n,onEdit:t,onView:a,onMaintenance:o}),an={HARVESTING:"harvesting",TRANSPORT:"transport",MAINTENANCE:"maintenance",SUPPORT:"support"},rn={CHAINSAW:"chainsaw",HARVESTER:"harvester",FORWARDER:"forwarder",SKIDDER:"skidder",LOG_TRUCK:"log_truck",PICKUP_TRUCK:"pickup_truck",CAR:"car",MOTORCYCLE:"motorcycle",ATV:"atv",BULLDOZER:"bulldozer",EXCAVATOR:"excavator",GRADER:"grader",LOADER:"loader",WATER_PUMP:"water_pump",FIRE_PUMP:"fire_pump",GENERATOR:"generator",COMPRESSOR:"compressor"},SL={[rn.CHAINSAW]:{name:"Motosierra",category:an.HARVESTING,fuelType:"two_stroke",avgConsumption:2.5,icon:"🪚",color:"#dc2626",description:"Herramienta para corte de árboles"},[rn.HARVESTER]:{name:"Cosechadora Forestal",category:an.HARVESTING,fuelType:"diesel",avgConsumption:25,icon:"🚜",color:"#059669",description:"Máquina para corte y procesamiento de árboles"},[rn.FORWARDER]:{name:"Forwarder",category:an.HARVESTING,fuelType:"diesel",avgConsumption:20,icon:"🚚",color:"#0891b2",description:"Transporte de troncos dentro del bosque"},[rn.LOG_TRUCK]:{name:"Camión Maderero",category:an.TRANSPORT,fuelType:"acpm",avgConsumption:3.5,icon:"🚚",color:"#ea580c",description:"Transporte de madera a destino"},[rn.PICKUP_TRUCK]:{name:"Camioneta",category:an.TRANSPORT,fuelType:"gasoline",avgConsumption:8,icon:"🚐",color:"#2563eb",description:"Transporte de personal y herramientas"},[rn.CAR]:{name:"Automóvil",category:an.TRANSPORT,fuelType:"gasoline",avgConsumption:12,icon:"🚗",color:"#3b82f6",description:"Vehículo liviano para transporte ejecutivo"},[rn.MOTORCYCLE]:{name:"Motocicleta",category:an.TRANSPORT,fuelType:"gasoline",avgConsumption:25,icon:"🏍️",color:"#6366f1",description:"Transporte ágil para terrenos difíciles"},[rn.ATV]:{name:"Cuatrimoto",category:an.TRANSPORT,fuelType:"gasoline",avgConsumption:15,icon:"🏍️",color:"#84cc16",description:"Vehículo todo terreno para supervisión"},[rn.SKIDDER]:{name:"Skidder",category:an.HARVESTING,fuelType:"diesel",avgConsumption:22,icon:"🚜",color:"#f59e0b",description:"Arrastre de troncos desde el lugar de corte"},[rn.BULLDOZER]:{name:"Bulldozer",category:an.MAINTENANCE,fuelType:"diesel",avgConsumption:30,icon:"🚜",color:"#f97316",description:"Construcción y mantenimiento de caminos"},[rn.EXCAVATOR]:{name:"Excavadora",category:an.MAINTENANCE,fuelType:"diesel",avgConsumption:28,icon:"🏗️",color:"#eab308",description:"Excavación y movimiento de tierra"},[rn.GRADER]:{name:"Motoniveladora",category:an.MAINTENANCE,fuelType:"diesel",avgConsumption:25,icon:"🚜",color:"#a3a3a3",description:"Nivelación y mantenimiento de vías"},[rn.LOADER]:{name:"Cargador Frontal",category:an.MAINTENANCE,fuelType:"diesel",avgConsumption:24,icon:"🚜",color:"#71717a",description:"Carga y descarga de materiales"},[rn.WATER_PUMP]:{name:"Motobomba de Agua",category:an.SUPPORT,fuelType:"gasoline",avgConsumption:3.5,icon:"💧",color:"#0891b2",description:"Bombeo de agua para operaciones"},[rn.FIRE_PUMP]:{name:"Motobomba Contra Incendios",category:an.SUPPORT,fuelType:"gasoline",avgConsumption:4.2,icon:"🔥",color:"#dc2626",description:"Equipo de emergencia contra incendios"},[rn.GENERATOR]:{name:"Generador Eléctrico",category:an.SUPPORT,fuelType:"gasoline",avgConsumption:2.8,icon:"⚡",color:"#7c3aed",description:"Suministro de energía eléctrica"},[rn.COMPRESSOR]:{name:"Compresor de Aire",category:an.SUPPORT,fuelType:"gasoline",avgConsumption:2.5,icon:"💨",color:"#64748b",description:"Suministro de aire comprimido"}},wL=({isOpen:n,onClose:e,vehicle:t,onSave:a,mode:o="create",userRole:c})=>{const d=()=>({vehicleId:t?.vehicleId||"",name:t?.name||"",type:t?.type||fe.EXCAVADORA,brand:t?.brand||"",model:t?.model||"",year:t?.year||new Date().getFullYear(),fuelType:t?.fuelType||Re.DIESEL,fuelCapacity:t?.fuelCapacity||0,enginePower:t?.enginePower||0,status:t?.status||ve.ACTIVO,currentLocation:t?.currentLocation||"",description:t?.description||"",estimatedConsumptionPerHour:t?.estimatedConsumptionPerHour||0,serialNumber:t?.serialNumber||"",plateNumber:t?.plateNumber||"",hasHourMeter:t?.hasHourMeter||!1,currentHours:t?.currentHours||0,lastMaintenanceDate:t?.lastMaintenanceDate?new Date(t.lastMaintenanceDate).toISOString().split("T")[0]:"",nextMaintenanceDate:t?.nextMaintenanceDate?new Date(t.nextMaintenanceDate).toISOString().split("T")[0]:"",purchaseDate:t?.purchaseDate?new Date(t.purchaseDate).toISOString().split("T")[0]:"",warrantyExpiration:t?.warrantyExpiration?new Date(t.warrantyExpiration).toISOString().split("T")[0]:""}),[f,p]=Y.useState(d()),[v,_]=Y.useState({}),[N,C]=Y.useState(!1),[j,b]=Y.useState(""),[M,x]=Y.useState(!1);Y.useEffect(()=>{n&&(p(d()),_({}))},[n,t]);const L=A=>{const{name:R,value:I,type:P}=A.target,V=P==="number"?parseFloat(I)||0:I;p(k=>({...k,[R]:V})),v[R]&&_(k=>({...k,[R]:null}))},$=()=>{const A={};f.vehicleId.trim()?f.vehicleId.length<3&&(A.vehicleId="El ID debe tener al menos 3 caracteres"):A.vehicleId="El ID del vehículo es obligatorio",f.name.trim()?f.name.length<2&&(A.name="El nombre debe tener al menos 2 caracteres"):A.name="El nombre del vehículo es obligatorio",f.fuelCapacity<=0?A.fuelCapacity="La capacidad de combustible debe ser mayor a 0":f.fuelCapacity>1e3&&(A.fuelCapacity="La capacidad no puede ser mayor a 1000 galones"),f.enginePower<0?A.enginePower="La potencia no puede ser negativa":f.enginePower>1e3&&(A.enginePower="La potencia no puede ser mayor a 1000 HP"),f.estimatedConsumptionPerHour<0?A.estimatedConsumptionPerHour="El consumo no puede ser negativo":f.estimatedConsumptionPerHour>50&&(A.estimatedConsumptionPerHour="El consumo no puede ser mayor a 50 gal/hr");const R=new Date().getFullYear();if(f.year<1990?A.year="El año no puede ser anterior a 1990":f.year>R+1&&(A.year=`El año no puede ser mayor a ${R+1}`),f.lastMaintenanceDate&&f.nextMaintenanceDate){const I=new Date(f.lastMaintenanceDate);new Date(f.nextMaintenanceDate)<=I&&(A.nextMaintenanceDate="La próxima fecha debe ser posterior al último mantenimiento")}return f.purchaseDate&&new Date(f.purchaseDate)>new Date&&(A.purchaseDate="La fecha de compra no puede ser futura"),_(A),Object.keys(A).length===0},O=async A=>{if(A.preventDefault(),!!$()){C(!0);try{const R={...f,lastMaintenanceDate:f.lastMaintenanceDate||null,nextMaintenanceDate:f.nextMaintenanceDate||null,purchaseDate:f.purchaseDate||null,warrantyExpiration:f.warrantyExpiration||null};await a(R),e()}catch(R){console.error("Error guardando vehículo:",R),_({general:"Error al guardar el vehículo. Intenta nuevamente."})}finally{C(!1)}}},U=A=>{switch(A){case fe.EXCAVADORA:return"🚚";case fe.BULLDOZER:return"🚜";case fe.CARGADOR:return"🏗️";case fe.CAMION:return"🚛";case fe.GRUA:return"🏗️";case fe.MOTOSIERRA:return"🪚";case fe.TRACTOR:return"🚜";case fe.VOLQUETA:return"🚛";default:return"🚗"}},F=A=>{switch(A){case Re.DIESEL:return"🚛";case Re.GASOLINA:return"🚗";case Re.ACPM:return"🚚";case Re.MIXTO:return"⛽";default:return"⛽"}},X=o==="view",w=c==="admin"||c==="supervisor";return n?r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-content vehicle-modal",onClick:A=>A.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("div",{className:"modal-title",children:[r.jsx("span",{className:"title-icon",children:o==="create"?"➕":o==="edit"?"✏️":"👁️"}),r.jsxs("div",{className:"title-text",children:[r.jsxs("h3",{children:[o==="create"&&"Crear Nuevo Vehículo",o==="edit"&&"Editar Vehículo",o==="view"&&"Detalles del Vehículo"]}),r.jsxs("p",{children:[o==="create"&&"Registra un nuevo vehículo en la flota",o==="edit"&&"Modifica la información del vehículo",o==="view"&&"Información completa del vehículo"]})]})]}),r.jsx("button",{className:"btn-close",onClick:e,type:"button",children:"✕"})]}),r.jsxs("form",{onSubmit:O,className:"modal-form",children:[r.jsxs("div",{className:"form-content",children:[r.jsxs("div",{className:"vehicle-preview",children:[r.jsxs("div",{className:"preview-header",children:[r.jsx("span",{className:"preview-icon",children:U(f.type)}),r.jsxs("div",{className:"preview-info",children:[r.jsx("span",{className:"preview-id",children:f.vehicleId||"ID-000"}),r.jsx("span",{className:"preview-name",children:f.name||"Nombre del vehículo"})]}),r.jsxs("div",{className:"preview-fuel",children:[r.jsx("span",{className:"fuel-icon",children:F(f.fuelType)}),r.jsx("span",{className:"fuel-text",children:f.fuelType})]})]}),r.jsxs("div",{className:"preview-specs",children:[f.enginePower>0&&r.jsxs("span",{className:"spec",children:["⚡ ",f.enginePower," HP"]}),f.fuelCapacity>0&&r.jsxs("span",{className:"spec",children:["🛢️ ",f.fuelCapacity," gal"]}),f.year&&r.jsxs("span",{className:"spec",children:["📅 ",f.year]})]})]}),v.general&&r.jsxs("div",{className:"error-message general-error",children:["⚠️ ",v.general]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📋 Información Básica"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"vehicleId",children:"ID del Vehículo *"}),r.jsx("input",{type:"text",id:"vehicleId",name:"vehicleId",value:f.vehicleId,onChange:L,placeholder:"Ej: EXC-001",className:v.vehicleId?"error":"",disabled:X||o==="edit"&&!w,maxLength:20}),v.vehicleId&&r.jsx("span",{className:"error-text",children:v.vehicleId})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"name",children:"Nombre del Vehículo *"}),r.jsx("input",{type:"text",id:"name",name:"name",value:f.name,onChange:L,placeholder:"Ej: Excavadora Principal",className:v.name?"error":"",disabled:X||o==="edit"&&!w,maxLength:100}),v.name&&r.jsx("span",{className:"error-text",children:v.name})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"type",children:"Tipo de Vehículo"}),M?r.jsxs("div",{className:"custom-type-input",children:[r.jsx("input",{type:"text",placeholder:"Ej: Montacargas, Grúa Torre, etc.",value:j,onChange:A=>b(A.target.value),onKeyDown:A=>{A.key==="Enter"?(A.preventDefault(),j.trim()&&(p(R=>({...R,type:j.trim()})),x(!1),b(""))):A.key==="Escape"&&(x(!1),b(""))},autoFocus:!0}),r.jsx("button",{type:"button",className:"btn-confirm-custom",onClick:()=>{j.trim()&&(p(A=>({...A,type:j.trim()})),x(!1),b(""))},title:"Confirmar tipo personalizado",children:"✓"}),r.jsx("button",{type:"button",className:"btn-cancel-custom",onClick:()=>{x(!1),b("")},title:"Cancelar",children:"✕"})]}):r.jsxs("div",{className:"select-with-button",children:[r.jsx("select",{id:"type",name:"type",value:f.type,onChange:L,disabled:X||o==="edit"&&!w,children:Object.entries(SL).map(([A,R])=>r.jsxs("option",{value:A,children:[R.icon," ",R.name]},A))}),r.jsx("button",{type:"button",className:"btn-add-custom",onClick:()=>x(!0),disabled:X||o==="edit"&&!w,title:"Agregar tipo personalizado",children:"➕"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"status",children:"Estado"}),r.jsx("select",{id:"status",name:"status",value:f.status,onChange:L,disabled:X||o==="edit"&&!w,children:Object.values(ve).map(A=>r.jsx("option",{value:A,children:A.charAt(0).toUpperCase()+A.slice(1)},A))})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"🔧 Especificaciones Técnicas"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"brand",children:"Marca"}),r.jsx("input",{type:"text",id:"brand",name:"brand",value:f.brand,onChange:L,placeholder:"Ej: Caterpillar",disabled:X||o==="edit"&&!w,maxLength:50})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"model",children:"Modelo"}),r.jsx("input",{type:"text",id:"model",name:"model",value:f.model,onChange:L,placeholder:"Ej: 320D",disabled:X||o==="edit"&&!w,maxLength:50})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"year",children:"Año"}),r.jsx("input",{type:"number",id:"year",name:"year",value:f.year,onChange:L,min:"1990",max:new Date().getFullYear()+1,className:v.year?"error":"",disabled:X||o==="edit"&&!w}),v.year&&r.jsx("span",{className:"error-text",children:v.year})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"serialNumber",children:"Número de Serie"}),r.jsx("input",{type:"text",id:"serialNumber",name:"serialNumber",value:f.serialNumber,onChange:L,placeholder:"Ej: ABC123456789",disabled:X||o==="edit"&&!w,maxLength:50})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"plateNumber",children:"Placa"}),r.jsx("input",{type:"text",id:"plateNumber",name:"plateNumber",value:f.plateNumber,onChange:L,placeholder:"Ej: ABC123",disabled:X||o==="edit"&&!w,maxLength:10})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"enginePower",children:"Potencia del Motor (HP)"}),r.jsx("input",{type:"number",id:"enginePower",name:"enginePower",value:f.enginePower,onChange:L,min:"0",max:"1000",step:"0.1",className:v.enginePower?"error":"",disabled:X||o==="edit"&&!w}),v.enginePower&&r.jsx("span",{className:"error-text",children:v.enginePower})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"⛽ Información de Combustible"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"fuelType",children:"Tipo de Combustible"}),r.jsx("select",{id:"fuelType",name:"fuelType",value:f.fuelType,onChange:L,disabled:X||o==="edit"&&!w,children:Object.values(Re).map(A=>r.jsxs("option",{value:A,children:[F(A)," ",A.charAt(0).toUpperCase()+A.slice(1)]},A))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"fuelCapacity",children:"Capacidad de Combustible (gal) *"}),r.jsx("input",{type:"number",id:"fuelCapacity",name:"fuelCapacity",value:f.fuelCapacity,onChange:L,min:"0",max:"1000",step:"0.1",className:v.fuelCapacity?"error":"",disabled:X||o==="edit"&&!w}),v.fuelCapacity&&r.jsx("span",{className:"error-text",children:v.fuelCapacity})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"estimatedConsumptionPerHour",children:"Consumo Estimado (gal/hr)"}),r.jsx("input",{type:"number",id:"estimatedConsumptionPerHour",name:"estimatedConsumptionPerHour",value:f.estimatedConsumptionPerHour,onChange:L,min:"0",max:"50",step:"0.1",className:v.estimatedConsumptionPerHour?"error":"",disabled:X||o==="edit"&&!w}),v.estimatedConsumptionPerHour&&r.jsx("span",{className:"error-text",children:v.estimatedConsumptionPerHour})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"currentLocation",children:"Ubicación Actual"}),r.jsx("input",{type:"text",id:"currentLocation",name:"currentLocation",value:f.currentLocation,onChange:L,placeholder:"Ej: Sector Norte - Lote 15",disabled:X||o==="edit"&&!w,maxLength:100})]})]})]}),(f.type===fe.TRACTOR||f.hasHourMeter)&&r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"⏰ Sistema de Horómetro"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"hasHourMeter",children:[r.jsx("input",{type:"checkbox",id:"hasHourMeter",name:"hasHourMeter",checked:f.hasHourMeter,onChange:A=>p(R=>({...R,hasHourMeter:A.target.checked,...f.type===fe.TRACTOR?{hasHourMeter:!0}:{}})),disabled:X||o==="edit"&&!w||f.type===fe.TRACTOR})," ","Tiene Sistema de Horómetro",f.type===fe.TRACTOR&&r.jsx("span",{className:"auto-enabled",children:" (Automático para tractores)"})]}),r.jsx("small",{className:"field-help",children:"Los tractores TR1, TR2, TR3 requieren control de horómetro para reportes de consumo"})]}),f.hasHourMeter&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"currentHours",children:"Lectura Actual del Horómetro (horas)"}),r.jsx("input",{type:"number",id:"currentHours",name:"currentHours",value:f.currentHours,onChange:L,min:"0",max:"50000",step:"0.1",placeholder:"Ej: 1250.5",disabled:X||o==="edit"&&!w}),r.jsx("small",{className:"field-help",children:"Ingrese la lectura actual mostrada en el horómetro del vehículo"})]}),f.currentHours>0&&r.jsx("div",{className:"form-group",children:r.jsxs("div",{className:"hour-meter-info",children:[r.jsx("h5",{children:"📊 Información del Horómetro"}),r.jsxs("div",{className:"info-grid",children:[r.jsxs("div",{className:"info-item",children:[r.jsx("span",{className:"info-label",children:"Lectura actual:"}),r.jsxs("span",{className:"info-value",children:[f.currentHours," horas"]})]}),o==="edit"&&t?.totalHoursWorked&&r.jsxs("div",{className:"info-item",children:[r.jsx("span",{className:"info-label",children:"Horas trabajadas totales:"}),r.jsxs("span",{className:"info-value",children:[t.totalHoursWorked," horas"]})]}),r.jsxs("div",{className:"info-item",children:[r.jsx("span",{className:"info-label",children:"Próximo mantenimiento:"}),r.jsxs("span",{className:"info-value",children:[250-f.currentHours%250," horas (",(f.currentHours+(250-f.currentHours%250)).toFixed(1),"h)"]})]})]})]})})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📅 Fechas Importantes"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"purchaseDate",children:"Fecha de Compra"}),r.jsx("input",{type:"date",id:"purchaseDate",name:"purchaseDate",value:f.purchaseDate,onChange:L,max:new Date().toISOString().split("T")[0],className:v.purchaseDate?"error":"",disabled:X||o==="edit"&&!w}),v.purchaseDate&&r.jsx("span",{className:"error-text",children:v.purchaseDate})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"warrantyExpiration",children:"Vencimiento de Garantía"}),r.jsx("input",{type:"date",id:"warrantyExpiration",name:"warrantyExpiration",value:f.warrantyExpiration,onChange:L,disabled:X||o==="edit"&&!w})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"lastMaintenanceDate",children:"Último Mantenimiento"}),r.jsx("input",{type:"date",id:"lastMaintenanceDate",name:"lastMaintenanceDate",value:f.lastMaintenanceDate,onChange:L,disabled:X||o==="edit"&&!w})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nextMaintenanceDate",children:"Próximo Mantenimiento"}),r.jsx("input",{type:"date",id:"nextMaintenanceDate",name:"nextMaintenanceDate",value:f.nextMaintenanceDate,onChange:L,className:v.nextMaintenanceDate?"error":"",disabled:X||o==="edit"&&!w}),v.nextMaintenanceDate&&r.jsx("span",{className:"error-text",children:v.nextMaintenanceDate})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📝 Descripción y Notas"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"description",children:"Descripción"}),r.jsx("textarea",{id:"description",name:"description",value:f.description,onChange:L,placeholder:"Información adicional sobre el vehículo...",rows:"3",maxLength:"500",disabled:X||o==="edit"&&!w}),r.jsxs("span",{className:"char-count",children:[f.description.length,"/500 caracteres"]})]})]})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:N,children:o==="view"?"Cerrar":"Cancelar"}),!X&&w&&r.jsx("button",{type:"submit",className:"btn-primary",disabled:N,children:N?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"loading-spinner"}),"Guardando..."]}):r.jsx(r.Fragment,{children:o==="create"?"➕ Crear Vehículo":"💾 Guardar Cambios"})})]})]})]})}):null},Oo={PREVENTIVO:"preventivo",CORRECTIVO:"correctivo",PREDICTIVO:"predictivo",EMERGENCIA:"emergencia"},fi={PROGRAMADO:"programado",EN_PROCESO:"en_proceso",COMPLETADO:"completado",CANCELADO:"cancelado"},Mo={BAJA:"baja",MEDIA:"media",ALTA:"alta",CRITICA:"critica"},IL=({isOpen:n,onClose:e,vehicle:t,maintenance:a,onSave:o,mode:c="create",userRole:d})=>{const f=()=>({vehicleId:t?.vehicleId||"",vehicleName:t?.name||"",type:a?.type||Oo.PREVENTIVO,title:a?.title||"",description:a?.description||"",priority:a?.priority||Mo.MEDIA,status:a?.status||fi.PROGRAMADO,scheduledDate:a?.scheduledDate?new Date(a.scheduledDate).toISOString().split("T")[0]:"",startDate:a?.startDate?new Date(a.startDate).toISOString().split("T")[0]:"",completedDate:a?.completedDate?new Date(a.completedDate).toISOString().split("T")[0]:"",estimatedHours:a?.estimatedHours||0,actualHours:a?.actualHours||0,estimatedCost:a?.estimatedCost||0,actualCost:a?.actualCost||0,technician:a?.technician||"",workshop:a?.workshop||"",parts:a?.parts||[],notes:a?.notes||"",nextMaintenanceKm:a?.nextMaintenanceKm||0,nextMaintenanceHours:a?.nextMaintenanceHours||0,nextMaintenanceDate:a?.nextMaintenanceDate?new Date(a.nextMaintenanceDate).toISOString().split("T")[0]:""}),[p,v]=Y.useState(f()),[_,N]=Y.useState({}),[C,j]=Y.useState(!1),[b,M]=Y.useState({name:"",quantity:1,cost:0});Y.useEffect(()=>{n&&(v(f()),N({}))},[n,a,t]);const x=V=>{const{name:k,value:Le,type:ae}=V.target,B=ae==="number"?parseFloat(Le)||0:Le;v(J=>({...J,[k]:B})),_[k]&&N(J=>({...J,[k]:null}))},L=V=>{const{name:k,value:Le,type:ae}=V.target,B=ae==="number"?parseFloat(Le)||0:Le;M(J=>({...J,[k]:B}))},$=()=>{if(!b.name.trim())return;const V={id:Date.now().toString(),name:b.name.trim(),quantity:b.quantity,cost:b.cost,total:b.quantity*b.cost};v(k=>({...k,parts:[...k.parts,V]})),M({name:"",quantity:1,cost:0})},O=V=>{v(k=>({...k,parts:k.parts.filter(Le=>Le.id!==V)}))},U=()=>{const V={};if(p.title.trim()||(V.title="El título del mantenimiento es obligatorio"),p.description.trim()||(V.description="La descripción es obligatoria"),p.scheduledDate||(V.scheduledDate="La fecha programada es obligatoria"),p.startDate&&p.completedDate){const k=new Date(p.startDate);new Date(p.completedDate)<k&&(V.completedDate="La fecha de finalización debe ser posterior al inicio")}return p.scheduledDate&&p.startDate&&(new Date(p.scheduledDate),new Date(p.startDate)),p.estimatedHours<0&&(V.estimatedHours="Las horas estimadas no pueden ser negativas"),p.actualHours<0&&(V.actualHours="Las horas reales no pueden ser negativas"),p.estimatedCost<0&&(V.estimatedCost="El costo estimado no puede ser negativo"),p.actualCost<0&&(V.actualCost="El costo real no puede ser negativo"),p.status===fi.COMPLETADO&&!p.completedDate&&(V.completedDate="La fecha de finalización es obligatoria para mantenimientos completados"),p.status===fi.EN_PROCESO&&!p.startDate&&(V.startDate="La fecha de inicio es obligatoria para mantenimientos en proceso"),N(V),Object.keys(V).length===0},F=async V=>{if(V.preventDefault(),!!U()){j(!0);try{const k=p.parts.reduce((J,ce)=>J+ce.total,0),Le=p.estimatedCost+k,ae=p.actualCost+k,B={...p,vehicleId:t.id,vehicleName:t.name,totalPartsCost:k,totalEstimatedCost:Le,totalActualCost:ae,scheduledDate:p.scheduledDate||null,startDate:p.startDate||null,completedDate:p.completedDate||null,nextMaintenanceDate:p.nextMaintenanceDate||null,createdAt:a?.createdAt||new Date,updatedAt:new Date};await o(B),e()}catch(k){console.error("Error guardando mantenimiento:",k),N({general:"Error al guardar el mantenimiento. Intenta nuevamente."})}finally{j(!1)}}},X=V=>{switch(V){case Oo.PREVENTIVO:return"🔧";case Oo.CORRECTIVO:return"🛠️";case Oo.PREDICTIVO:return"📊";case Oo.EMERGENCIA:return"🚨";default:return"⚙️"}},w=V=>{switch(V){case Mo.BAJA:return"priority-low";case Mo.MEDIA:return"priority-medium";case Mo.ALTA:return"priority-high";case Mo.CRITICA:return"priority-critical";default:return"priority-medium"}},A=V=>{switch(V){case fi.PROGRAMADO:return"status-scheduled";case fi.EN_PROCESO:return"status-in-progress";case fi.COMPLETADO:return"status-completed";case fi.CANCELADO:return"status-cancelled";default:return"status-scheduled"}},R=()=>p.parts.reduce((V,k)=>V+k.total,0),I=c==="view",P=d==="admin"||d==="supervisor";return n?r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-content maintenance-modal",onClick:V=>V.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("div",{className:"modal-title",children:[r.jsx("span",{className:"title-icon",children:c==="create"?"➕":c==="edit"?"✏️":"👁️"}),r.jsxs("div",{className:"title-text",children:[r.jsxs("h3",{children:[c==="create"&&"Registrar Mantenimiento",c==="edit"&&"Editar Mantenimiento",c==="view"&&"Detalles del Mantenimiento"]}),r.jsxs("p",{children:["Vehículo: ",t?.vehicleId," - ",t?.name]})]})]}),r.jsx("button",{className:"btn-close",onClick:e,type:"button",children:"✕"})]}),r.jsxs("form",{onSubmit:F,className:"modal-form",children:[r.jsxs("div",{className:"form-content",children:[_.general&&r.jsxs("div",{className:"error-message general-error",children:["⚠️ ",_.general]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📋 Información del Mantenimiento"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"type",children:"Tipo de Mantenimiento"}),r.jsx("select",{id:"type",name:"type",value:p.type,onChange:x,disabled:I||c==="edit"&&!P,children:Object.values(Oo).map(V=>r.jsxs("option",{value:V,children:[X(V)," ",V.charAt(0).toUpperCase()+V.slice(1)]},V))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"priority",children:"Prioridad"}),r.jsx("select",{id:"priority",name:"priority",value:p.priority,onChange:x,className:w(p.priority),disabled:I||c==="edit"&&!P,children:Object.values(Mo).map(V=>r.jsx("option",{value:V,children:V.charAt(0).toUpperCase()+V.slice(1)},V))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"status",children:"Estado"}),r.jsx("select",{id:"status",name:"status",value:p.status,onChange:x,className:A(p.status),disabled:I||c==="edit"&&!P,children:Object.values(fi).map(V=>r.jsx("option",{value:V,children:V.charAt(0).toUpperCase()+V.slice(1).replace("_"," ")},V))})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{htmlFor:"title",children:"Título del Mantenimiento *"}),r.jsx("input",{type:"text",id:"title",name:"title",value:p.title,onChange:x,placeholder:"Ej: Cambio de aceite y filtros",className:_.title?"error":"",disabled:I||c==="edit"&&!P,maxLength:100}),_.title&&r.jsx("span",{className:"error-text",children:_.title})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📅 Programación"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"scheduledDate",children:"Fecha Programada *"}),r.jsx("input",{type:"date",id:"scheduledDate",name:"scheduledDate",value:p.scheduledDate,onChange:x,className:_.scheduledDate?"error":"",disabled:I||c==="edit"&&!P}),_.scheduledDate&&r.jsx("span",{className:"error-text",children:_.scheduledDate})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"startDate",children:"Fecha de Inicio"}),r.jsx("input",{type:"date",id:"startDate",name:"startDate",value:p.startDate,onChange:x,className:_.startDate?"error":"",disabled:I||c==="edit"&&!P}),_.startDate&&r.jsx("span",{className:"error-text",children:_.startDate})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"completedDate",children:"Fecha de Finalización"}),r.jsx("input",{type:"date",id:"completedDate",name:"completedDate",value:p.completedDate,onChange:x,className:_.completedDate?"error":"",disabled:I||c==="edit"&&!P}),_.completedDate&&r.jsx("span",{className:"error-text",children:_.completedDate})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nextMaintenanceDate",children:"Próximo Mantenimiento"}),r.jsx("input",{type:"date",id:"nextMaintenanceDate",name:"nextMaintenanceDate",value:p.nextMaintenanceDate,onChange:x,disabled:I||c==="edit"&&!P})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"💰 Recursos y Costos"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"technician",children:"Técnico Responsable"}),r.jsx("input",{type:"text",id:"technician",name:"technician",value:p.technician,onChange:x,placeholder:"Nombre del técnico",disabled:I||c==="edit"&&!P,maxLength:100})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"workshop",children:"Taller/Ubicación"}),r.jsx("input",{type:"text",id:"workshop",name:"workshop",value:p.workshop,onChange:x,placeholder:"Taller donde se realiza",disabled:I||c==="edit"&&!P,maxLength:100})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"estimatedHours",children:"Horas Estimadas"}),r.jsx("input",{type:"number",id:"estimatedHours",name:"estimatedHours",value:p.estimatedHours,onChange:x,min:"0",step:"0.5",className:_.estimatedHours?"error":"",disabled:I||c==="edit"&&!P}),_.estimatedHours&&r.jsx("span",{className:"error-text",children:_.estimatedHours})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"actualHours",children:"Horas Reales"}),r.jsx("input",{type:"number",id:"actualHours",name:"actualHours",value:p.actualHours,onChange:x,min:"0",step:"0.5",className:_.actualHours?"error":"",disabled:I||c==="edit"&&!P}),_.actualHours&&r.jsx("span",{className:"error-text",children:_.actualHours})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"estimatedCost",children:"Costo Estimado (COP)"}),r.jsx("input",{type:"number",id:"estimatedCost",name:"estimatedCost",value:p.estimatedCost,onChange:x,min:"0",step:"1000",className:_.estimatedCost?"error":"",disabled:I||c==="edit"&&!P}),_.estimatedCost&&r.jsx("span",{className:"error-text",children:_.estimatedCost})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"actualCost",children:"Costo Real (COP)"}),r.jsx("input",{type:"number",id:"actualCost",name:"actualCost",value:p.actualCost,onChange:x,min:"0",step:"1000",className:_.actualCost?"error":"",disabled:I||c==="edit"&&!P}),_.actualCost&&r.jsx("span",{className:"error-text",children:_.actualCost})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"🔧 Partes y Repuestos"}),!I&&P&&r.jsx("div",{className:"parts-form",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"partName",children:"Nombre de la Parte"}),r.jsx("input",{type:"text",id:"partName",name:"name",value:b.name,onChange:L,placeholder:"Ej: Filtro de aceite",maxLength:100})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"partQuantity",children:"Cantidad"}),r.jsx("input",{type:"number",id:"partQuantity",name:"quantity",value:b.quantity,onChange:L,min:"1",step:"1"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"partCost",children:"Costo Unitario (COP)"}),r.jsx("input",{type:"number",id:"partCost",name:"cost",value:b.cost,onChange:L,min:"0",step:"1000"})]}),r.jsx("div",{className:"form-group",children:r.jsx("button",{type:"button",className:"btn-add-part",onClick:$,disabled:!b.name.trim(),children:"➕ Agregar"})})]})}),p.parts.length>0&&r.jsx("div",{className:"parts-list",children:r.jsxs("table",{className:"parts-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Parte"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Costo Unit."}),r.jsx("th",{children:"Total"}),!I&&P&&r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:p.parts.map(V=>r.jsxs("tr",{children:[r.jsx("td",{children:V.name}),r.jsx("td",{children:V.quantity}),r.jsxs("td",{children:["$",V.cost.toLocaleString("es-CO")]}),r.jsxs("td",{children:["$",V.total.toLocaleString("es-CO")]}),!I&&P&&r.jsx("td",{children:r.jsx("button",{type:"button",className:"btn-remove-part",onClick:()=>O(V.id),title:"Eliminar parte",children:"🗑️"})})]},V.id))}),r.jsx("tfoot",{children:r.jsxs("tr",{className:"total-row",children:[r.jsx("td",{colSpan:"3",children:r.jsx("strong",{children:"Total Partes:"})}),r.jsx("td",{children:r.jsxs("strong",{children:["$",R().toLocaleString("es-CO")]})}),!I&&P&&r.jsx("td",{})]})})]})})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"🔄 Próximo Mantenimiento"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nextMaintenanceKm",children:"Próximo Mantenimiento (Km)"}),r.jsx("input",{type:"number",id:"nextMaintenanceKm",name:"nextMaintenanceKm",value:p.nextMaintenanceKm,onChange:x,min:"0",step:"1000",placeholder:"0 = No aplica",disabled:I||c==="edit"&&!P})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nextMaintenanceHours",children:"Próximo Mantenimiento (Horas)"}),r.jsx("input",{type:"number",id:"nextMaintenanceHours",name:"nextMaintenanceHours",value:p.nextMaintenanceHours,onChange:x,min:"0",step:"100",placeholder:"0 = No aplica",disabled:I||c==="edit"&&!P})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📝 Descripción y Notas"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"description",children:"Descripción del Trabajo *"}),r.jsx("textarea",{id:"description",name:"description",value:p.description,onChange:x,placeholder:"Describe el trabajo a realizar o realizado...",rows:"3",maxLength:"500",className:_.description?"error":"",disabled:I||c==="edit"&&!P}),_.description&&r.jsx("span",{className:"error-text",children:_.description})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"notes",children:"Notas Adicionales"}),r.jsx("textarea",{id:"notes",name:"notes",value:p.notes,onChange:x,placeholder:"Observaciones, recomendaciones, problemas encontrados...",rows:"3",maxLength:"500",disabled:I||c==="edit"&&!P}),r.jsxs("span",{className:"char-count",children:[p.notes.length,"/500 caracteres"]})]})]}),r.jsxs("div",{className:"cost-summary",children:[r.jsx("h4",{children:"💰 Resumen de Costos"}),r.jsxs("div",{className:"cost-grid",children:[r.jsxs("div",{className:"cost-item",children:[r.jsx("span",{className:"cost-label",children:"Mano de Obra:"}),r.jsxs("span",{className:"cost-value",children:["$",p.actualCost.toLocaleString("es-CO")]})]}),r.jsxs("div",{className:"cost-item",children:[r.jsx("span",{className:"cost-label",children:"Partes:"}),r.jsxs("span",{className:"cost-value",children:["$",R().toLocaleString("es-CO")]})]}),r.jsxs("div",{className:"cost-item total-cost",children:[r.jsx("span",{className:"cost-label",children:"Total:"}),r.jsxs("span",{className:"cost-value",children:["$",(p.actualCost+R()).toLocaleString("es-CO")]})]})]})]})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:C,children:c==="view"?"Cerrar":"Cancelar"}),!I&&P&&r.jsx("button",{type:"submit",className:"btn-primary",disabled:C,children:C?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"loading-spinner"}),"Guardando..."]}):r.jsx(r.Fragment,{children:c==="create"?"➕ Registrar Mantenimiento":"💾 Guardar Cambios"})})]})]})]})}):null},RL=()=>{const{user:n,userProfile:e}=Zs(),[t,a]=Y.useState([]),[o,c]=Y.useState(null),[d,f]=Y.useState(!0),[p,v]=Y.useState(null),[_,N]=Y.useState({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),[C,j]=Y.useState("cards"),[b,M]=Y.useState(""),[x,L]=Y.useState(!1),[$,O]=Y.useState(!1),[U,F]=Y.useState(null),[X,w]=Y.useState("create");Y.useEffect(()=>{if(!n)return;f(!0);const ye=pC((q,ne)=>{if(ne){console.error("Error en suscripción de vehículos:",ne),v("Error al cargar vehículos"),f(!1);return}a(q),v(null),f(!1)},_);return()=>ye()},[n,_]),Y.useEffect(()=>{n&&(async()=>{try{const q=await Q2(_);c(q)}catch(q){console.error("Error al cargar estadísticas:",q)}})()},[n,t,_]);const A=t.filter(ye=>{if(!b)return!0;const q=b.toLowerCase();return ye.vehicleId?.toLowerCase().includes(q)||ye.name?.toLowerCase().includes(q)||ye.type?.toLowerCase().includes(q)||ye.brand?.toLowerCase().includes(q)||ye.model?.toLowerCase().includes(q)||ye.currentLocation?.toLowerCase().includes(q)||ye.description?.toLowerCase().includes(q)}),R=()=>{F(null),w("create"),L(!0)},I=ye=>{F(ye),w("edit"),L(!0)},P=ye=>{F(ye),w("view"),L(!0)},V=ye=>{F(ye),O(!0)},k=()=>{L(!1),O(!1),F(null)},Le=ye=>{N(q=>({...q,...ye}))},ae=()=>{N({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),M("")},B=e?.role==="admin"||e?.role==="contador"||e?.role==="cliente",J=e?.role==="admin",ce=e?.role==="admin"||e?.role==="contador";return d?r.jsx("div",{className:"vehicles-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando vehículos..."})]})}):p?r.jsx("div",{className:"vehicles-main",children:r.jsxs("div",{className:"error-container",children:[r.jsx("div",{className:"error-icon",children:"⚠️"}),r.jsx("h3",{children:"Error al cargar vehículos"}),r.jsx("p",{children:p}),r.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):r.jsxs("div",{className:"vehicles-main",children:[r.jsxs("div",{className:"vehicles-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h2",{children:"🚜 Gestión de Vehículos"}),r.jsx("p",{children:"Administra la maquinaria y vehículos forestales"})]}),B&&r.jsx("button",{className:"btn-create-vehicle",onClick:R,children:"➕ Nuevo Vehículo"})]}),o&&r.jsx(TL,{stats:o,filters:_}),r.jsx(xL,{filters:_,onFilterChange:Le,onClearFilters:ae,searchTerm:b,onSearchChange:M,viewMode:C,onViewModeChange:j,totalResults:A.length}),A.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"🚜"}),r.jsx("h3",{children:t.length===0?"No hay vehículos registrados":"No se encontraron vehículos"}),r.jsx("p",{children:t.length===0?"Comienza registrando tu primer vehículo o maquinaria forestal":"Intenta ajustar los filtros de búsqueda"}),t.length===0&&B&&r.jsx("button",{className:"btn-create-first",onClick:R,children:"➕ Registrar Primer Vehículo"})]}):r.jsx(jL,{vehicles:A,viewMode:C,onEdit:J?I:null,onView:P,onMaintenance:ce?V:null,userRole:n?.role}),x&&r.jsx(wL,{isOpen:x,onClose:k,vehicle:U,mode:X,onSuccess:()=>{k()}}),$&&r.jsx(IL,{isOpen:$,onClose:k,vehicle:U,onSuccess:()=>{k()}})]})},DL="modulepreload",OL=function(n){return"/combustibles/"+n},jT={},ML=function(e,t,a){let o=Promise.resolve();if(t&&t.length>0){let v=function(_){return Promise.all(_.map(N=>Promise.resolve(N).then(C=>({status:"fulfilled",value:C}),C=>({status:"rejected",reason:C}))))};var d=v;document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),p=f?.nonce||f?.getAttribute("nonce");o=v(t.map(_=>{if(_=OL(_),_ in jT)return;jT[_]=!0;const N=_.endsWith(".css"),C=N?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_}"]${C}`))return;const j=document.createElement("link");if(j.rel=N?"stylesheet":DL,N||(j.as="script"),j.crossOrigin="",j.href=_,p&&j.setAttribute("nonce",p),document.head.appendChild(j),N)return new Promise((b,M)=>{j.addEventListener("load",b),j.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${_}`)))})}))}function c(f){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=f,window.dispatchEvent(p),!p.defaultPrevented)throw f}return o.then(f=>{for(const p of f||[])p.status==="rejected"&&c(p.reason);return e().catch(c)})},PL=({stats:n})=>{if(!n)return null;const e=c=>{switch(c){case me.OIL_CHANGE:return"🛢️";case me.BATTERY_CHANGE:return"🔋";case me.FILTER_CHANGE:return"🔧";case me.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}},t=c=>{switch(c){case me.OIL_CHANGE:return"Cambios de Aceite";case me.BATTERY_CHANGE:return"Cambios de Batería";case me.FILTER_CHANGE:return"Cambios de Filtros";case me.GENERAL_MAINTENANCE:return"Mantenimientos Generales";default:return c}},a=c=>{switch(c){case Pe.COMPLETED:return"#10b981";case Pe.PENDING:return"#f59e0b";case Pe.CANCELLED:return"#ef4444";default:return"#6b7280"}},o=c=>{switch(c){case Pe.COMPLETED:return"Completados";case Pe.PENDING:return"Pendientes";case Pe.CANCELLED:return"Cancelados";default:return c}};return r.jsxs("div",{className:"maintenance-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:"🔧"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:Ge(n.total)}),r.jsx("p",{children:"Total Mantenimientos"})]})]}),r.jsxs("div",{className:"stat-card success",children:[r.jsx("div",{className:"stat-icon",children:"💰"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:Mn(n.totalCost)}),r.jsx("p",{children:"Costo Total"})]})]}),r.jsxs("div",{className:"stat-card warning",children:[r.jsx("div",{className:"stat-icon",children:"⏰"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:Ge(n.upcomingCount)}),r.jsx("p",{children:"Próximos"})]})]}),r.jsxs("div",{className:"stat-card danger",children:[r.jsx("div",{className:"stat-icon",children:"⚠️"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:Ge(n.overdueCount)}),r.jsx("p",{children:"Vencidos"})]})]})]}),Object.keys(n.byType).length>0&&r.jsxs("div",{className:"stats-breakdown",children:[r.jsx("h3",{children:"📊 Desglose por Tipo"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byType).map(([c,d])=>r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:e(c)}),r.jsx("span",{className:"breakdown-label",children:t(c)})]}),r.jsx("div",{className:"breakdown-value",children:Ge(d)}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${d/n.total*100}%`,backgroundColor:"#3b82f6"}})}),r.jsxs("div",{className:"breakdown-percentage",children:[(d/n.total*100).toFixed(1),"%"]})]},c))})]}),Object.keys(n.byStatus).length>0&&r.jsxs("div",{className:"stats-breakdown",children:[r.jsx("h3",{children:"📈 Desglose por Estado"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(n.byStatus).map(([c,d])=>r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:a(c)}}),r.jsx("span",{className:"breakdown-label",children:o(c)})]}),r.jsx("div",{className:"breakdown-value",children:Ge(d)}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${d/n.total*100}%`,backgroundColor:a(c)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[(d/n.total*100).toFixed(1),"%"]})]},c))})]}),r.jsxs("div",{className:"stats-insights",children:[r.jsx("h3",{children:"💡 Insights"}),r.jsxs("div",{className:"insights-grid",children:[r.jsxs("div",{className:"insight-item",children:[r.jsx("span",{className:"insight-label",children:"Costo Promedio:"}),r.jsx("span",{className:"insight-value",children:Mn(n.averageCost)})]}),n.overdueCount>0&&r.jsxs("div",{className:"insight-item alert",children:[r.jsx("span",{className:"insight-label",children:"⚠️ Mantenimientos Vencidos:"}),r.jsxs("span",{className:"insight-value",children:[Ge(n.overdueCount)," requieren atención"]})]}),n.upcomingCount>0&&r.jsxs("div",{className:"insight-item info",children:[r.jsx("span",{className:"insight-label",children:"⏰ Próximos Mantenimientos:"}),r.jsxs("span",{className:"insight-value",children:[Ge(n.upcomingCount)," programados"]})]})]})]})]})},kL=({filters:n,onFilterChange:e,onClearFilters:t,searchTerm:a,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:f})=>{const p=j=>{switch(j){case me.OIL_CHANGE:return"Cambio de Aceite";case me.BATTERY_CHANGE:return"Cambio de Batería";case me.FILTER_CHANGE:return"Cambio de Filtros";case me.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return j}},v=j=>{switch(j){case Pe.COMPLETED:return"Completado";case Pe.PENDING:return"Pendiente";case Pe.CANCELLED:return"Cancelado";default:return j}},_=(j,b)=>{e({[j]:b})},N=j=>{e(j)},C=()=>Object.values(n).some(j=>j!=="")||a;return r.jsx("div",{className:"maintenance-filters",children:r.jsxs("div",{className:"filters-main",children:[r.jsx("div",{className:"search-section",children:r.jsxs("div",{className:"search-box",children:[r.jsx("span",{className:"search-icon",children:"🔍"}),r.jsx("input",{type:"text",className:"search-input",placeholder:"Buscar mantenimientos...",value:a,onChange:j=>o(j.target.value)}),a&&r.jsx("button",{className:"search-clear",onClick:()=>o(""),children:"×"})]})}),r.jsxs("div",{className:"filters-controls",children:[r.jsxs("div",{className:"quick-filters",children:[r.jsx("button",{className:`quick-filter ${C()?"":"active"}`,onClick:()=>t(),children:"Todos"}),r.jsx("button",{className:`quick-filter ${n.type===me.OIL_CHANGE?"active":""}`,onClick:()=>N({type:me.OIL_CHANGE}),children:"🛢️ Aceite"}),r.jsx("button",{className:`quick-filter ${n.type===me.BATTERY_CHANGE?"active":""}`,onClick:()=>N({type:me.BATTERY_CHANGE}),children:"🔋 Baterías"}),r.jsx("button",{className:`quick-filter ${n.status===Pe.PENDING?"active":""}`,onClick:()=>N({status:Pe.PENDING}),children:"⏰ Pendientes"})]}),r.jsxs("button",{className:`btn-advanced-filters ${C()?"active":""}`,onClick:()=>document.querySelector(".filters-advanced").classList.toggle("show"),children:["🔧 Filtros Avanzados",C()&&r.jsx("span",{className:"filters-count",children:Object.values(n).filter(j=>j!=="").length})]}),r.jsxs("div",{className:"view-modes",children:[r.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),children:"📋 Cards"}),r.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),children:"📊 Tabla"})]})]}),r.jsxs("div",{className:"filters-advanced",children:[r.jsxs("div",{className:"filters-grid",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Mantenimiento"}),r.jsxs("select",{value:n.type,onChange:j=>_("type",j.target.value),children:[r.jsx("option",{value:"",children:"Todos los tipos"}),r.jsx("option",{value:me.OIL_CHANGE,children:p(me.OIL_CHANGE)}),r.jsx("option",{value:me.BATTERY_CHANGE,children:p(me.BATTERY_CHANGE)}),r.jsx("option",{value:me.FILTER_CHANGE,children:p(me.FILTER_CHANGE)}),r.jsx("option",{value:me.GENERAL_MAINTENANCE,children:p(me.GENERAL_MAINTENANCE)})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:n.status,onChange:j=>_("status",j.target.value),children:[r.jsx("option",{value:"",children:"Todos los estados"}),r.jsx("option",{value:Pe.COMPLETED,children:v(Pe.COMPLETED)}),r.jsx("option",{value:Pe.PENDING,children:v(Pe.PENDING)}),r.jsx("option",{value:Pe.CANCELLED,children:v(Pe.CANCELLED)})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Fecha Desde"}),r.jsx("input",{type:"date",value:n.dateFrom,onChange:j=>_("dateFrom",j.target.value)})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Fecha Hasta"}),r.jsx("input",{type:"date",value:n.dateTo,onChange:j=>_("dateTo",j.target.value)})]})]}),r.jsx("div",{className:"filters-actions",children:r.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:!C(),children:"🗑️ Limpiar Filtros"})})]}),r.jsxs("div",{className:"filters-info",children:[r.jsxs("div",{className:"results-count",children:[f," mantenimiento",f!==1?"s":""," encontrado",f!==1?"s":""]}),C()&&r.jsxs("div",{className:"active-filters",children:[r.jsx("span",{className:"filters-label",children:"Filtros activos:"}),r.jsxs("div",{className:"filter-tags",children:[n.type&&r.jsxs("span",{className:"filter-tag",children:["Tipo: ",p(n.type),r.jsx("button",{onClick:()=>_("type",""),children:"×"})]}),n.status&&r.jsxs("span",{className:"filter-tag",children:["Estado: ",v(n.status),r.jsx("button",{onClick:()=>_("status",""),children:"×"})]}),n.dateFrom&&r.jsxs("span",{className:"filter-tag",children:["Desde: ",n.dateFrom,r.jsx("button",{onClick:()=>_("dateFrom",""),children:"×"})]}),n.dateTo&&r.jsxs("span",{className:"filter-tag",children:["Hasta: ",n.dateTo,r.jsx("button",{onClick:()=>_("dateTo",""),children:"×"})]}),a&&r.jsxs("span",{className:"filter-tag",children:['Búsqueda: "',a,'"',r.jsx("button",{onClick:()=>o(""),children:"×"})]})]})]})]})]})})},LL=({maintenanceRecords:n,onEdit:e,onView:t,onDelete:a,userRole:o})=>{const c=b=>b?new Date(b).toLocaleDateString("es-CO",{year:"numeric",month:"short",day:"numeric"}):"N/A",d=b=>{if(!b)return"";const M=new Date,x=new Date(b),L=Math.abs(M-x),$=Math.ceil(L/(1e3*60*60*24));return $===0?"Hoy":$===1?"Ayer":$<7?`Hace ${$} días`:$<30?`Hace ${Math.floor($/7)} semanas`:`Hace ${Math.floor($/30)} meses`},f=b=>{switch(b){case me.OIL_CHANGE:return"maintenance-oil-change";case me.BATTERY_CHANGE:return"maintenance-battery-change";case me.FILTER_CHANGE:return"maintenance-filter-change";case me.GENERAL_MAINTENANCE:return"maintenance-general";default:return"maintenance-general"}},p=b=>{switch(b){case Pe.COMPLETED:return"status-completado";case Pe.PENDING:return"status-pendiente";case Pe.CANCELLED:return"status-cancelado";default:return"status-unknown"}},v=b=>{switch(b){case me.OIL_CHANGE:return"🛢️";case me.BATTERY_CHANGE:return"🔋";case me.FILTER_CHANGE:return"🔧";case me.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}},_=b=>{switch(b){case me.OIL_CHANGE:return"Cambio de Aceite";case me.BATTERY_CHANGE:return"Cambio de Batería";case me.FILTER_CHANGE:return"Cambio de Filtros";case me.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return b}},N=b=>{switch(b){case Pe.COMPLETED:return"✅";case Pe.PENDING:return"⏰";case Pe.CANCELLED:return"❌";default:return"❓"}},C=b=>{switch(b){case Pe.COMPLETED:return"Completado";case Pe.PENDING:return"Pendiente";case Pe.CANCELLED:return"Cancelado";default:return b}},j=o==="admin"||o==="supervisor";return r.jsx("div",{className:"maintenance-cards",children:n.map(b=>r.jsxs("div",{className:`maintenance-card ${f(b.type)}`,children:[r.jsxs("div",{className:"card-header",children:[r.jsxs("div",{className:"maintenance-type",children:[r.jsx("span",{className:"type-icon",children:v(b.type)}),r.jsx("span",{className:"type-label",children:_(b.type)})]}),r.jsxs("div",{className:`status-badge ${p(b.status)}`,children:[N(b.status)," ",C(b.status)]})]}),r.jsxs("div",{className:"card-content",children:[r.jsxs("div",{className:"vehicle-info",children:[r.jsx("span",{className:"vehicle-icon",children:"🚜"}),r.jsxs("div",{className:"vehicle-details",children:[r.jsx("div",{className:"vehicle-name",children:b.vehicleName}),r.jsx("div",{className:"vehicle-id",children:b.vehicleId})]})]}),r.jsxs("div",{className:"date-info",children:[r.jsx("div",{className:"created-date",children:c(b.date)}),r.jsx("div",{className:"relative-time",children:d(b.date)})]}),b.type===me.OIL_CHANGE&&r.jsxs("div",{className:"oil-change-info",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Cantidad:"}),r.jsxs("span",{className:"info-value",children:[Ge(b.quantity)," galones"]})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Horómetro:"}),r.jsxs("span",{className:"info-value",children:[Ge(b.currentHours)," horas"]})]}),b.nextChangeHours&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Próximo cambio:"}),r.jsxs("span",{className:"info-value",children:[Ge(b.nextChangeHours)," horas"]})]}),b.filters&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Filtros:"}),r.jsx("span",{className:"info-value",children:b.filters})]})]}),b.type===me.BATTERY_CHANGE&&r.jsxs("div",{className:"battery-change-info",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Tipo:"}),r.jsx("span",{className:"info-value",children:b.batteryType})]}),b.brand&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Marca:"}),r.jsx("span",{className:"info-value",children:b.brand})]}),b.model&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Modelo:"}),r.jsx("span",{className:"info-value",children:b.model})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Estado:"}),r.jsx("span",{className:"info-value",children:b.batteryStatus})]}),b.cost&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Costo:"}),r.jsx("span",{className:"info-value",children:Mn(b.cost)})]})]}),b.notes&&r.jsxs("div",{className:"notes-section",children:[r.jsx("span",{className:"notes-label",children:"Notas:"}),r.jsx("p",{className:"notes-text",children:b.notes})]})]}),r.jsx("div",{className:"card-footer",children:r.jsxs("div",{className:"card-actions",children:[r.jsx("button",{className:"btn-view",onClick:()=>t(b),title:"Ver detalles",children:"👁️ Ver"}),j&&e&&r.jsx("button",{className:"btn-edit",onClick:()=>e(b),title:"Editar",children:"✏️ Editar"}),j&&a&&r.jsx("button",{className:"btn-delete",onClick:()=>a(b.id),title:"Eliminar",children:"🗑️ Eliminar"})]})})]},b.id))})},VL=({maintenanceRecords:n,onEdit:e,onView:t,onDelete:a,userRole:o})=>{const[c,d]=Y.useState("date"),[f,p]=Y.useState("desc"),v=O=>O?new Date(O).toLocaleDateString("es-CO",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A",_=O=>{switch(O){case me.OIL_CHANGE:return"🛢️";case me.BATTERY_CHANGE:return"🔋";case me.FILTER_CHANGE:return"🔧";case me.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}},N=O=>{switch(O){case me.OIL_CHANGE:return"Cambio de Aceite";case me.BATTERY_CHANGE:return"Cambio de Batería";case me.FILTER_CHANGE:return"Cambio de Filtros";case me.GENERAL_MAINTENANCE:return"Mantenimiento General";default:return O}},C=O=>{switch(O){case Pe.COMPLETED:return"✅";case Pe.PENDING:return"⏰";case Pe.CANCELLED:return"❌";default:return"❓"}},j=O=>{switch(O){case Pe.COMPLETED:return"Completado";case Pe.PENDING:return"Pendiente";case Pe.CANCELLED:return"Cancelado";default:return O}},b=O=>{switch(O){case Pe.COMPLETED:return"status-completado";case Pe.PENDING:return"status-pendiente";case Pe.CANCELLED:return"status-cancelado";default:return"status-unknown"}},M=O=>{c===O?p(f==="asc"?"desc":"asc"):(d(O),p("asc"))},x=O=>c!==O?"↕️":f==="asc"?"↑":"↓",L=[...n].sort((O,U)=>{let F=O[c],X=U[c];return c==="date"&&(F=new Date(F),X=new Date(X)),["quantity","currentHours","nextChangeHours","cost"].includes(c)&&(F=parseFloat(F)||0,X=parseFloat(X)||0),typeof F=="string"&&(F=F.toLowerCase(),X=X.toLowerCase()),f==="asc"?F>X?1:-1:F<X?1:-1}),$=o==="admin"||o==="supervisor";return r.jsxs("div",{className:"maintenance-table-container",children:[r.jsx("div",{className:"table-wrapper",children:r.jsxs("table",{className:"maintenance-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{className:"sortable",onClick:()=>M("type"),children:["Tipo ",x("type")]}),r.jsxs("th",{className:"sortable",onClick:()=>M("vehicleName"),children:["Vehículo ",x("vehicleName")]}),r.jsxs("th",{className:"sortable",onClick:()=>M("date"),children:["Fecha ",x("date")]}),r.jsx("th",{children:"Detalles"}),r.jsxs("th",{className:"sortable",onClick:()=>M("status"),children:["Estado ",x("status")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>M("cost"),children:["Costo ",x("cost")]}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:L.map(O=>r.jsxs("tr",{className:"maintenance-row",children:[r.jsx("td",{className:"type-cell",children:r.jsxs("div",{className:"type-content",children:[r.jsx("span",{className:"type-icon",children:_(O.type)}),r.jsx("span",{className:"type-name",children:N(O.type)})]})}),r.jsx("td",{className:"vehicle-cell",children:r.jsxs("div",{className:"vehicle-info",children:[r.jsx("div",{className:"vehicle-name",children:O.vehicleName}),r.jsx("div",{className:"vehicle-id",children:O.vehicleId})]})}),r.jsx("td",{className:"date-cell",children:r.jsx("div",{className:"date-content",children:r.jsx("div",{className:"date-value",children:v(O.date)})})}),r.jsxs("td",{className:"details-cell",children:[O.type===me.OIL_CHANGE&&r.jsxs("div",{className:"oil-details",children:[r.jsxs("div",{children:["Qty: ",Ge(O.quantity)," gal"]}),r.jsxs("div",{children:["Hrs: ",Ge(O.currentHours)]}),O.filters&&r.jsxs("div",{children:["Filtros: ",O.filters]})]}),O.type===me.BATTERY_CHANGE&&r.jsxs("div",{className:"battery-details",children:[r.jsx("div",{children:O.batteryType}),O.brand&&r.jsx("div",{children:O.brand}),r.jsxs("div",{children:["Estado: ",O.batteryStatus]})]}),O.notes&&r.jsx("div",{className:"notes-small",children:O.notes})]}),r.jsx("td",{className:"status-cell",children:r.jsxs("div",{className:`status-badge ${b(O.status)}`,children:[C(O.status)," ",j(O.status)]})}),r.jsx("td",{className:"cost-cell text-right",children:O.cost?Mn(O.cost):"N/A"}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn-action btn-view",onClick:()=>t(O),title:"Ver detalles",children:"👁️"}),$&&e&&r.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(O),title:"Editar",children:"✏️"}),$&&a&&r.jsx("button",{className:"btn-action btn-delete",onClick:()=>a(O.id),title:"Eliminar",children:"🗑️"})]})})]},O.id))})]})}),r.jsxs("div",{className:"table-info",children:[r.jsx("div",{className:"table-summary",children:r.jsxs("span",{className:"total-rows",children:[n.length," mantenimiento",n.length!==1?"s":""," en total"]})}),r.jsxs("div",{className:"table-legend",children:[r.jsxs("div",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot oil-change"}),r.jsx("span",{children:"Cambio de Aceite"})]}),r.jsxs("div",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot battery-change"}),r.jsx("span",{children:"Cambio de Batería"})]}),r.jsxs("div",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot filter-change"}),r.jsx("span",{children:"Cambio de Filtros"})]}),r.jsxs("div",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot general"}),r.jsx("span",{children:"Mantenimiento General"})]})]})]})]})},UL=({maintenanceRecords:n,viewMode:e,onEdit:t,onView:a,onDelete:o,userRole:c})=>!n||n.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"🔧"}),r.jsx("h3",{children:"No hay mantenimientos registrados"}),r.jsx("p",{children:"Comienza creando el primer mantenimiento para tu flota de vehículos."})]}):r.jsx("div",{className:"maintenance-list",children:e==="cards"?r.jsx(LL,{maintenanceRecords:n,onEdit:t,onView:a,onDelete:o,userRole:c}):r.jsx(VL,{maintenanceRecords:n,onEdit:t,onView:a,onDelete:o,userRole:c})}),FL=({isOpen:n,onClose:e,onSuccess:t,maintenance:a,mode:o="create",userRole:c})=>{const d=()=>({type:a?.type||me.OIL_CHANGE,vehicleId:a?.vehicleId||"",vehicleName:a?.vehicleName||"",date:a?.date?new Date(a.date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],status:a?.status||Pe.COMPLETED,quantity:a?.quantity||0,currentHours:a?.currentHours||0,nextChangeHours:a?.nextChangeHours||0,filters:a?.filters||"",batteryType:a?.batteryType||"",brand:a?.brand||"",model:a?.model||"",batteryStatus:a?.batteryStatus||qo.NEW,notes:a?.notes||"",cost:a?.cost||0}),[f,p]=Y.useState(d()),[v,_]=Y.useState({}),[N,C]=Y.useState(!1),[j,b]=Y.useState([]),[M,x]=Y.useState(null);Y.useEffect(()=>{n&&(async()=>{try{const A=await TC();b(A)}catch(A){console.error("Error al cargar vehículos:",A)}})()},[n]),Y.useEffect(()=>{if(n&&(p(d()),_({}),a?.vehicleId)){const w=j.find(A=>A.vehicleId===a.vehicleId);x(w)}},[n,a,j]),Y.useEffect(()=>{if(f.type===me.OIL_CHANGE&&f.currentHours>0){const w=gf(f.currentHours);p(A=>({...A,nextChangeHours:w}))}},[f.currentHours,f.type]);const L=(w,A)=>{const R=typeof A=="number"?parseFloat(A)||0:A;p(I=>({...I,[w]:R})),v[w]&&_(I=>({...I,[w]:null}))},$=w=>{const A=j.find(R=>R.vehicleId===w);x(A),p(R=>({...R,vehicleId:w,vehicleName:A?A.name:""})),A&&A.hasHourMeter&&A.currentHours&&p(R=>({...R,currentHours:A.currentHours}))},O=()=>{const w={};return f.type||(w.type="El tipo de mantenimiento es obligatorio"),f.vehicleId||(w.vehicleId="El vehículo es obligatorio"),f.date||(w.date="La fecha es obligatoria"),f.type===me.OIL_CHANGE&&((!f.quantity||f.quantity<=0)&&(w.quantity="La cantidad de aceite es obligatoria y debe ser mayor a 0"),(!f.currentHours||f.currentHours<0)&&(w.currentHours="La lectura del horómetro es obligatoria")),f.type===me.BATTERY_CHANGE&&(f.batteryType||(w.batteryType="El tipo de batería es obligatorio"),(!f.cost||f.cost<=0)&&(w.cost="El costo de la batería es obligatorio")),_(w),Object.keys(w).length===0},U=async w=>{if(w.preventDefault(),!!O()){C(!0);try{const A={...f,date:new Date(f.date),createdBy:c||"user"};o==="create"?(await _C(A),console.log("✅ Mantenimiento creado exitosamente")):o==="edit"&&(await bC(a.id,A),console.log("✅ Mantenimiento actualizado exitosamente")),t()}catch(A){console.error("❌ Error al guardar mantenimiento:",A),alert("Error al guardar mantenimiento: "+A.message)}finally{C(!1)}}},F=()=>{switch(o){case"create":return"Crear Mantenimiento";case"edit":return"Editar Mantenimiento";case"view":return"Ver Mantenimiento";default:return"Mantenimiento"}},X=w=>{switch(w){case me.OIL_CHANGE:return"🛢️";case me.BATTERY_CHANGE:return"🔋";case me.FILTER_CHANGE:return"🔧";case me.GENERAL_MAINTENANCE:return"⚙️";default:return"🔧"}};return n?r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content maintenance-modal",children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h2",{children:F()}),r.jsx("button",{className:"modal-close",onClick:e,children:"×"})]}),r.jsx("div",{className:"modal-body",children:r.jsxs("form",{onSubmit:U,className:"maintenance-form",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Tipo de Mantenimiento *"}),r.jsxs("select",{value:f.type,onChange:w=>L("type",w.target.value),disabled:o==="view",children:[r.jsxs("option",{value:me.OIL_CHANGE,children:[X(me.OIL_CHANGE)," Cambio de Aceite"]}),r.jsxs("option",{value:me.BATTERY_CHANGE,children:[X(me.BATTERY_CHANGE)," Cambio de Batería"]}),r.jsxs("option",{value:me.FILTER_CHANGE,children:[X(me.FILTER_CHANGE)," Cambio de Filtros"]}),r.jsxs("option",{value:me.GENERAL_MAINTENANCE,children:[X(me.GENERAL_MAINTENANCE)," Mantenimiento General"]})]}),v.type&&r.jsx("span",{className:"error-text",children:v.type})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Vehículo *"}),r.jsxs("select",{value:f.vehicleId,onChange:w=>$(w.target.value),disabled:o==="view",children:[r.jsx("option",{value:"",children:"Seleccionar vehículo"}),j.map(w=>r.jsxs("option",{value:w.vehicleId,children:[w.vehicleId," - ",w.name," (",w.type,")"]},w.vehicleId))]}),v.vehicleId&&r.jsx("span",{className:"error-text",children:v.vehicleId})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Fecha *"}),r.jsx("input",{type:"date",value:f.date,onChange:w=>L("date",w.target.value),disabled:o==="view"}),v.date&&r.jsx("span",{className:"error-text",children:v.date})]}),f.type===me.OIL_CHANGE&&r.jsxs("div",{className:"maintenance-section",children:[r.jsx("h3",{children:"🛢️ Información del Cambio de Aceite"}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Cantidad (galones) *"}),r.jsx("input",{type:"number",step:"0.1",value:f.quantity,onChange:w=>L("quantity",w.target.value),disabled:o==="view"}),v.quantity&&r.jsx("span",{className:"error-text",children:v.quantity})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Horómetro Actual *"}),r.jsx("input",{type:"number",value:f.currentHours,onChange:w=>L("currentHours",w.target.value),disabled:o==="view"}),v.currentHours&&r.jsx("span",{className:"error-text",children:v.currentHours})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Próximo Cambio (horas)"}),r.jsx("input",{type:"number",value:f.nextChangeHours,disabled:!0,className:"readonly-input"}),r.jsx("small",{children:"Calculado automáticamente: actual + 250 horas"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Filtros o Extras"}),r.jsx("textarea",{value:f.filters,onChange:w=>L("filters",w.target.value),disabled:o==="view",placeholder:"Especificar filtros cambiados o extras..."})]})]}),f.type===me.BATTERY_CHANGE&&r.jsxs("div",{className:"maintenance-section",children:[r.jsx("h3",{children:"🔋 Información del Cambio de Batería"}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Tipo de Batería *"}),r.jsx("input",{type:"text",value:f.batteryType,onChange:w=>L("batteryType",w.target.value),disabled:o==="view",placeholder:"Ej: 12V 60Ah"}),v.batteryType&&r.jsx("span",{className:"error-text",children:v.batteryType})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado *"}),r.jsxs("select",{value:f.batteryStatus,onChange:w=>L("batteryStatus",w.target.value),disabled:o==="view",children:[r.jsx("option",{value:qo.NEW,children:"Nueva"}),r.jsx("option",{value:qo.USED,children:"Usada"}),r.jsx("option",{value:qo.REPAIRED,children:"Reparada"})]})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Marca"}),r.jsx("input",{type:"text",value:f.brand,onChange:w=>L("brand",w.target.value),disabled:o==="view",placeholder:"Ej: Bosch, Exide"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Modelo"}),r.jsx("input",{type:"text",value:f.model,onChange:w=>L("model",w.target.value),disabled:o==="view",placeholder:"Ej: S4 005"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Costo *"}),r.jsx("input",{type:"number",step:"1000",value:f.cost,onChange:w=>L("cost",w.target.value),disabled:o==="view",placeholder:"0"}),v.cost&&r.jsx("span",{className:"error-text",children:v.cost})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Notas Adicionales"}),r.jsx("textarea",{value:f.notes,onChange:w=>L("notes",w.target.value),disabled:o==="view",placeholder:"Observaciones adicionales...",rows:"3"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:f.status,onChange:w=>L("status",w.target.value),disabled:o==="view",children:[r.jsx("option",{value:Pe.COMPLETED,children:"Completado"}),r.jsx("option",{value:Pe.PENDING,children:"Pendiente"}),r.jsx("option",{value:Pe.CANCELLED,children:"Cancelado"})]})]})]})}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn btn-secondary",onClick:e,disabled:N,children:"Cancelar"}),o!=="view"&&r.jsx("button",{type:"submit",className:"btn btn-primary",onClick:U,disabled:N,children:N?"Guardando...":o==="create"?"Crear":"Actualizar"})]})]})}):null},HL=()=>{const{user:n,userProfile:e}=Zs(),[t,a]=Y.useState([]),[o,c]=Y.useState(null),[d,f]=Y.useState(!0),[p,v]=Y.useState(null),[_,N]=Y.useState({type:"",status:"",vehicleId:"",dateFrom:"",dateTo:""}),[C,j]=Y.useState("cards"),[b,M]=Y.useState(""),[x,L]=Y.useState(!1),[$,O]=Y.useState(null),[U,F]=Y.useState("create");Y.useEffect(()=>{if(!n)return;f(!0);const B=$v((J,ce)=>{if(ce){console.error("Error en suscripción de mantenimientos:",ce),v("Error al cargar mantenimientos"),f(!1);return}a(J),v(null),f(!1)},_);return()=>B()},[n,_]),Y.useEffect(()=>{n&&(async()=>{try{const J=await NC(_);c(J)}catch(J){console.error("Error al cargar estadísticas:",J)}})()},[n,t,_]);const X=t.filter(B=>{if(!b)return!0;const J=b.toLowerCase();return B.vehicleName?.toLowerCase().includes(J)||B.type?.toLowerCase().includes(J)||B.status?.toLowerCase().includes(J)||B.notes?.toLowerCase().includes(J)}),w=e?.combustiblesPermissions?.canManageMaintenance||!1,A=()=>{O(null),F("create"),L(!0)},R=B=>{O(B),F("edit"),L(!0)},I=B=>{O(B),F("view"),L(!0)},P=()=>{L(!1),O(null)},V=()=>{L(!1),O(null)},k=B=>{N(J=>({...J,...B}))},Le=()=>{N({type:"",status:"",vehicleId:"",dateFrom:"",dateTo:""}),M("")},ae=async B=>{if(!w){alert("No tienes permisos para eliminar mantenimientos");return}if(window.confirm("¿Estás seguro de que quieres eliminar este mantenimiento?"))try{const{deleteMaintenanceRecord:J}=await ML(async()=>{const{deleteMaintenanceRecord:ce}=await Promise.resolve().then(()=>iL);return{deleteMaintenanceRecord:ce}},void 0);await J(B),console.log("✅ Mantenimiento eliminado exitosamente")}catch(J){console.error("❌ Error al eliminar mantenimiento:",J),alert("Error al eliminar mantenimiento: "+J.message)}};return n?r.jsxs("div",{className:"maintenance-main",children:[r.jsxs("div",{className:"maintenance-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h2",{children:"🔧 Mantenimiento de Vehículos"}),r.jsx("p",{children:"Gestión de cambios de aceite, filtros y baterías"})]}),r.jsx("div",{className:"header-actions",children:w&&r.jsx("button",{className:"btn-create-maintenance",onClick:A,children:"➕ Crear Mantenimiento"})})]}),d&&r.jsxs("div",{className:"maintenance-loading",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando mantenimientos..."})]}),p&&r.jsxs("div",{className:"error-banner",children:[r.jsxs("span",{children:["❌ ",p]}),r.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]}),o&&r.jsx(PL,{stats:o}),r.jsx(kL,{filters:_,onFilterChange:k,onClearFilters:Le,searchTerm:b,onSearchChange:M,viewMode:C,onViewModeChange:j,totalResults:X.length}),!d&&!p&&r.jsx(UL,{maintenanceRecords:X,viewMode:C,onEdit:w?R:null,onView:I,onDelete:w?ae:null,userRole:e?.role}),x&&r.jsx(FL,{isOpen:x,onClose:P,onSuccess:V,maintenance:$,mode:U,userRole:e?.role})]}):r.jsx("div",{className:"maintenance-main",children:r.jsxs("div",{className:"auth-required",children:[r.jsx("h2",{children:"🔐 Autenticación Requerida"}),r.jsx("p",{children:"Debes iniciar sesión para acceder al módulo de mantenimiento."})]})})},qL=({isOpen:n,onClose:e,product:t,mode:a="create",onSave:o,userRole:c})=>{const[d,f]=Y.useState({name:"",displayName:"",category:qs.COMBUSTIBLE,unit:"gal",defaultPrice:0,color:"#FF6B35",icon:"🛢️",description:"",isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3}),[p,v]=Y.useState({}),[_,N]=Y.useState(!1),C=[{value:"gal",label:"Galones (gal)"},{value:"L",label:"Litros (L)"},{value:"kg",label:"Kilogramos (kg)"},{value:"und",label:"Unidades (und)"}],j={[qs.COMBUSTIBLE]:["🛢️","🚛","🚗","⛽","🌿"],[qs.ACEITE]:["🛢️","⚙️","🔧","🚜","🏭"],[qs.LUBRICANTE]:["🟥","🟡","🔵","⚫","🟤"],[qs.FLUIDO]:["🛑","💧","🔴","🟢","🔵"]},b=["#FF6B35","#4CAF50","#2196F3","#FF9800","#F44336","#9C27B0","#E91E63","#795548","#607D8B","#3F51B5"];Y.useEffect(()=>{f(t&&(a==="edit"||a==="view")?{name:t.name||"",displayName:t.displayName||"",category:t.category||qs.COMBUSTIBLE,unit:t.unit||"gal",defaultPrice:t.defaultPrice||0,color:t.color||"#FF6B35",icon:t.icon||"🛢️",description:t.description||"",isActive:t.isActive!==void 0?t.isActive:!0,currentStock:t.currentStock||0,minThreshold:t.minThreshold||10,maxCapacity:t.maxCapacity||1e3}:{name:"",displayName:"",category:qs.COMBUSTIBLE,unit:"gal",defaultPrice:0,color:"#FF6B35",icon:"🛢️",description:"",isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3}),v({})},[t,a,n]);const M=O=>{const{name:U,value:F,type:X,checked:w}=O.target;f(A=>({...A,[U]:X==="checkbox"?w:F})),p[U]&&v(A=>({...A,[U]:""}))},x=()=>{const O={};return d.name.trim()||(O.name="El nombre es requerido"),d.displayName.trim()||(O.displayName="El nombre de visualización es requerido"),d.category||(O.category="La categoría es requerida"),d.unit||(O.unit="La unidad es requerida"),d.defaultPrice<0&&(O.defaultPrice="El precio debe ser mayor o igual a 0"),d.currentStock<0&&(O.currentStock="El stock debe ser mayor o igual a 0"),d.minThreshold<0&&(O.minThreshold="El umbral mínimo debe ser mayor o igual a 0"),d.maxCapacity<=0&&(O.maxCapacity="La capacidad máxima debe ser mayor a 0"),d.minThreshold>=d.maxCapacity&&(O.minThreshold="El umbral mínimo debe ser menor que la capacidad máxima"),v(O),Object.keys(O).length===0},L=async O=>{if(O.preventDefault(),!!x()){N(!0);try{await o({...d,defaultPrice:parseFloat(d.defaultPrice),currentStock:parseFloat(d.currentStock),minThreshold:parseFloat(d.minThreshold),maxCapacity:parseFloat(d.maxCapacity)}),e()}catch(U){console.error("Error saving product:",U),v({submit:"Error al guardar el producto"})}finally{N(!1)}}};if(!n)return null;const $=["admin","supervisor"].includes(c)&&a!=="view";return r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content product-modal",children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("h2",{children:[a==="create"&&"➕ Crear Producto",a==="edit"&&"✏️ Editar Producto",a==="view"&&"👁️ Ver Producto"]}),r.jsx("button",{className:"modal-close",onClick:e,children:"✕"})]}),r.jsxs("form",{onSubmit:L,className:"modal-body",children:[r.jsx("div",{className:"product-preview",children:r.jsxs("div",{className:"preview-card",children:[r.jsx("div",{className:"preview-icon",style:{color:d.color},children:d.icon}),r.jsxs("div",{className:"preview-info",children:[r.jsx("h3",{children:d.displayName||"Nombre del producto"}),r.jsx("p",{className:"preview-category",children:d.category}),r.jsx("p",{className:"preview-description",children:d.description}),r.jsxs("div",{className:"preview-price",children:["$",new Intl.NumberFormat("es-CO").format(d.defaultPrice)," / ",d.unit]})]})]})}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"📝 Información Básica"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Nombre Interno *"}),r.jsx("input",{type:"text",name:"name",value:d.name,onChange:M,disabled:!$,placeholder:"Ej: ACPM, GASOLINA"}),p.name&&r.jsx("span",{className:"error",children:p.name})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Nombre de Visualización *"}),r.jsx("input",{type:"text",name:"displayName",value:d.displayName,onChange:M,disabled:!$,placeholder:"Ej: ACPM 🚛, Gasolina 🚗"}),p.displayName&&r.jsx("span",{className:"error",children:p.displayName})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Categoría *"}),r.jsx("select",{name:"category",value:d.category,onChange:M,disabled:!$,children:Object.values(qs).map(O=>r.jsx("option",{value:O,children:O},O))}),p.category&&r.jsx("span",{className:"error",children:p.category})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Descripción"}),r.jsx("textarea",{name:"description",value:d.description,onChange:M,disabled:!$,placeholder:"Descripción del producto...",rows:"3"})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"⚙️ Configuración"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Unidad de Medida *"}),r.jsx("select",{name:"unit",value:d.unit,onChange:M,disabled:!$,children:C.map(O=>r.jsx("option",{value:O.value,children:O.label},O.value))}),p.unit&&r.jsx("span",{className:"error",children:p.unit})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Precio por Defecto"}),r.jsx("input",{type:"number",name:"defaultPrice",value:d.defaultPrice,onChange:M,disabled:!$,min:"0",step:"0.01"}),p.defaultPrice&&r.jsx("span",{className:"error",children:p.defaultPrice})]}),r.jsx("div",{className:"form-group",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",name:"isActive",checked:d.isActive,onChange:M,disabled:!$}),"Producto Activo"]})})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"📊 Stock y Umbrales"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Stock Actual"}),r.jsx("input",{type:"number",name:"currentStock",value:d.currentStock,onChange:M,disabled:!$,min:"0",step:"0.01"}),p.currentStock&&r.jsx("span",{className:"error",children:p.currentStock})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Umbral Mínimo"}),r.jsx("input",{type:"number",name:"minThreshold",value:d.minThreshold,onChange:M,disabled:!$,min:"0",step:"0.01"}),p.minThreshold&&r.jsx("span",{className:"error",children:p.minThreshold})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Capacidad Máxima"}),r.jsx("input",{type:"number",name:"maxCapacity",value:d.maxCapacity,onChange:M,disabled:!$,min:"1",step:"0.01"}),p.maxCapacity&&r.jsx("span",{className:"error",children:p.maxCapacity})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"🎨 Apariencia"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Icono"}),r.jsx("div",{className:"icon-selector",children:j[d.category]?.map(O=>r.jsx("button",{type:"button",className:`icon-option ${d.icon===O?"selected":""}`,onClick:()=>f(U=>({...U,icon:O})),disabled:!$,children:O},O))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Color"}),r.jsx("div",{className:"color-selector",children:b.map(O=>r.jsx("button",{type:"button",className:`color-option ${d.color===O?"selected":""}`,style:{backgroundColor:O},onClick:()=>f(U=>({...U,color:O})),disabled:!$},O))})]})]})]}),p.submit&&r.jsx("div",{className:"error-message",children:p.submit})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:_,children:a==="view"?"Cerrar":"Cancelar"}),$&&r.jsx("button",{type:"submit",className:"btn-primary",onClick:L,disabled:_,children:_?"Guardando...":"Guardar"})]})]})})},BL=({products:n})=>{const[e,t]=Y.useState([]),[a,o]=Y.useState(!0);Y.useEffect(()=>{const b=zv(M=>{t(M),o(!1)},M=>{console.error("Error loading movements for stats:",M),o(!1)});return()=>b()},[]);const c=()=>n.map(M=>{const x=e.filter(X=>X.fuelType===M.name||X.fuelType===M.displayName),L=x.filter(X=>X.type==="entrada"),$=x.filter(X=>X.type==="salida"),O=L.reduce((X,w)=>X+(w.quantity||0),0),U=$.reduce((X,w)=>X+(w.quantity||0),0),F=(M.currentStock||0)*(M.defaultPrice||0);return{...M,totalEntries:O,totalExits:U,totalValue:F,entriesCount:L.length,exitsCount:$.length,stockStatus:d(M)}}),d=b=>{const M=b.currentStock||0,x=b.minThreshold||0,L=b.maxCapacity||1e3;return M===0?"empty":M<=x?"low":M>=L*.9?"high":"normal"},f=b=>{const M={};return Object.values(qs).forEach(x=>{const L=b.filter($=>$.category===x);M[x]={totalProducts:L.length,totalStock:L.reduce(($,O)=>$+(O.currentStock||0),0),totalValue:L.reduce(($,O)=>$+O.totalValue,0),totalEntries:L.reduce(($,O)=>$+O.totalEntries,0),totalExits:L.reduce(($,O)=>$+O.totalExits,0),lowStockCount:L.filter($=>$.stockStatus==="low"||$.stockStatus==="empty").length}}),M};if(a)return r.jsxs("div",{className:"products-stats loading",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando estadísticas..."})]});const p=c(),v=f(p),_=n.length,N=n.filter(b=>b.isActive).length,C=p.reduce((b,M)=>b+M.totalValue,0),j=p.filter(b=>b.stockStatus==="low"||b.stockStatus==="empty").length;return r.jsxs("div",{className:"products-stats",children:[r.jsx("h2",{children:"📊 Estadísticas de Productos"}),r.jsxs("div",{className:"stats-general",children:[r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"📦"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:Ge(_)}),r.jsx("p",{children:"Total Productos"})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"✅"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:Ge(N)}),r.jsx("p",{children:"Productos Activos"})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"💰"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:Mn(C)}),r.jsx("p",{children:"Valor Total Stock"})]})]}),r.jsxs("div",{className:`stat-card ${j>0?"alert":""}`,children:[r.jsx("div",{className:"stat-icon",children:"⚠️"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:Ge(j)}),r.jsx("p",{children:"Stock Bajo"})]})]})]}),r.jsxs("div",{className:"stats-categories",children:[r.jsx("h3",{children:"📈 Por Categoría"}),r.jsx("div",{className:"categories-grid",children:Object.entries(v).map(([b,M])=>r.jsxs("div",{className:"category-card",children:[r.jsx("h4",{children:b}),r.jsxs("div",{className:"category-stats",children:[r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Productos:"}),r.jsx("span",{children:Ge(M.totalProducts)})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Stock Total:"}),r.jsxs("span",{children:[Ge(M.totalStock)," unidades"]})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Valor:"}),r.jsx("span",{children:Mn(M.totalValue)})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Entradas:"}),r.jsx("span",{className:"positive",children:Ge(M.totalEntries)})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Salidas:"}),r.jsx("span",{className:"negative",children:Ge(M.totalExits)})]}),M.lowStockCount>0&&r.jsxs("div",{className:"stat-row alert",children:[r.jsx("span",{children:"Stock Bajo:"}),r.jsx("span",{children:Ge(M.lowStockCount)})]})]})]},b))})]}),r.jsxs("div",{className:"stats-top-products",children:[r.jsx("h3",{children:"🏆 Top Productos por Stock"}),r.jsx("div",{className:"top-products-list",children:p.sort((b,M)=>(M.currentStock||0)-(b.currentStock||0)).slice(0,5).map((b,M)=>r.jsxs("div",{className:"top-product-item",children:[r.jsxs("div",{className:"rank",children:["#",M+1]}),r.jsx("div",{className:"product-icon",style:{color:b.color},children:b.icon}),r.jsxs("div",{className:"product-info",children:[r.jsx("span",{className:"product-name",children:b.displayName}),r.jsxs("span",{className:"product-stock",children:[Ge(b.currentStock||0)," ",b.unit]})]}),r.jsx("div",{className:"product-value",children:Mn(b.totalValue)})]},b.id))})]}),j>0&&r.jsxs("div",{className:"stats-alerts",children:[r.jsx("h3",{children:"⚠️ Alertas de Stock"}),r.jsx("div",{className:"alerts-list",children:p.filter(b=>b.stockStatus==="low"||b.stockStatus==="empty").map(b=>r.jsxs("div",{className:`alert-item ${b.stockStatus}`,children:[r.jsx("div",{className:"alert-icon",children:b.stockStatus==="empty"?"🔴":"🟡"}),r.jsxs("div",{className:"alert-info",children:[r.jsx("span",{className:"alert-product",children:b.displayName}),r.jsxs("span",{className:"alert-stock",children:["Stock: ",Ge(b.currentStock||0)," ",b.unit,b.stockStatus==="empty"&&" - ¡SIN STOCK!",b.stockStatus==="low"&&` - Mínimo: ${b.minThreshold}`]})]})]},b.id))})]})]})},zL=({userProfile:n})=>{const[e,t]=Y.useState([]),[a,o]=Y.useState(!0),[c,d]=Y.useState(null),[f,p]=Y.useState(!1),[v,_]=Y.useState(null),[N,C]=Y.useState("create"),[j,b]=Y.useState(""),[M,x]=Y.useState(""),[L,$]=Y.useState(!0),O=["admin","supervisor"].includes(n?.role);Y.useEffect(()=>{o(!0);const I=vC(P=>{t(P),o(!1),d(null)},P=>{console.error("Error loading products:",P),d("Error cargando productos"),o(!1)});return()=>I()},[]),Y.useEffect(()=>{(async()=>{if(console.log("🔍 Debug - Inicializando productos:",{productsLength:e.length,loading:a,canManageProducts:O}),e.length===0&&!a&&O)try{console.log("🚀 Creando productos predefinidos...");const P=TT();console.log("📦 Productos predefinidos:",P);for(const V of P)console.log("➕ Creando producto:",V.name),await zp({name:V.name,displayName:V.displayName,category:V.category,unit:V.unit,defaultPrice:V.defaultPrice,color:V.color,icon:V.icon,description:V.description,isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3});console.log("✅ Productos predefinidos creados exitosamente")}catch(P){console.error("❌ Error inicializando productos:",P)}else console.log("ℹ️ No se inicializan productos:",{reason:e.length>0?"Ya existen productos":a?"Está cargando":O?"Otra razón":"Sin permisos"})})()},[e.length,a,O]);const U=()=>{_(null),C("create"),p(!0)},F=I=>{_(I),C("edit"),p(!0)},X=I=>{_(I),C("view"),p(!0)},w=async I=>{if(window.confirm("¿Estás seguro de que deseas eliminar este producto?"))try{await eL(I)}catch(P){console.error("Error deleting product:",P),alert("Error al eliminar el producto")}},A=async I=>{try{N==="create"?await zp(I):N==="edit"&&await J2(v.id,I),p(!1)}catch(P){throw console.error("Error saving product:",P),P}},R=e.filter(I=>{const P=I.displayName?.toLowerCase().includes(j.toLowerCase())||I.name?.toLowerCase().includes(j.toLowerCase()),V=!M||I.category===M;return P&&V});return a?r.jsx("div",{className:"products-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando productos..."})]})}):c?r.jsx("div",{className:"products-main",children:r.jsxs("div",{className:"error-container",children:[r.jsxs("p",{children:["⚠️ ",c]}),r.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]})}):r.jsxs("div",{className:"products-main",children:[r.jsxs("div",{className:"products-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h1",{children:"🛢️ Gestión de Productos"}),r.jsx("p",{children:"Administra los tipos de combustibles y productos disponibles"})]}),O&&r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{className:"btn-primary",onClick:U,children:"➕ Agregar Producto"}),r.jsx("button",{className:"btn-secondary",onClick:async()=>{try{console.log("🧪 Forzando creación de productos predefinidos...");const I=TT();for(const P of I)await zp({name:P.name,displayName:P.displayName,category:P.category,unit:P.unit,defaultPrice:P.defaultPrice,color:P.color,icon:P.icon,description:P.description,isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3});alert("Productos predefinidos creados exitosamente")}catch(I){console.error("Error:",I),alert("Error creando productos: "+I.message)}},style:{marginLeft:"10px"},children:"🧪 Crear Predefinidos"})]})]}),L&&r.jsx(BL,{products:e}),r.jsxs("div",{className:"products-filters",children:[r.jsx("div",{className:"filter-group",children:r.jsx("input",{type:"text",placeholder:"🔍 Buscar productos...",value:j,onChange:I=>b(I.target.value),className:"search-input"})}),r.jsx("div",{className:"filter-group",children:r.jsxs("select",{value:M,onChange:I=>x(I.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"🏷️ Todas las categorías"}),Object.values(qs).map(I=>r.jsx("option",{value:I,children:I},I))]})}),r.jsx("div",{className:"filter-group",children:r.jsx("button",{className:`toggle-btn ${L?"active":""}`,onClick:()=>$(!L),children:"📊 Estadísticas"})})]}),r.jsx("div",{className:"products-grid",children:R.map(I=>r.jsxs("div",{className:"product-card",children:[r.jsx("div",{className:"product-icon",style:{color:I.color},children:I.icon}),r.jsxs("div",{className:"product-info",children:[r.jsx("h3",{children:I.displayName}),r.jsx("p",{className:"product-category",children:I.category}),r.jsx("p",{className:"product-description",children:I.description}),r.jsxs("div",{className:"product-stats",children:[r.jsxs("div",{className:"stat",children:[r.jsx("span",{className:"stat-label",children:"Stock:"}),r.jsxs("span",{className:"stat-value",children:[I.currentStock||0," ",I.unit]})]}),r.jsxs("div",{className:"stat",children:[r.jsx("span",{className:"stat-label",children:"Precio:"}),r.jsxs("span",{className:"stat-value",children:["$",new Intl.NumberFormat("es-CO").format(I.defaultPrice||0)]})]})]}),r.jsx("div",{className:`product-status ${I.isActive?"active":"inactive"}`,children:I.isActive?"✅ Activo":"❌ Inactivo"})]}),r.jsxs("div",{className:"product-actions",children:[r.jsx("button",{className:"btn-secondary",onClick:()=>X(I),children:"👁️ Ver"}),O&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"btn-primary",onClick:()=>F(I),children:"✏️ Editar"}),r.jsx("button",{className:"btn-danger",onClick:()=>w(I.id),children:"🗑️ Eliminar"})]})]})]},I.id))}),R.length===0&&r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"📦"}),r.jsx("h3",{children:"No hay productos"}),r.jsx("p",{children:j||M?"No se encontraron productos con los filtros aplicados.":"Aún no hay productos registrados."}),O&&!j&&!M&&r.jsx("button",{className:"btn-primary",onClick:U,children:"➕ Crear primer producto"})]}),r.jsx(qL,{isOpen:f,onClose:()=>p(!1),product:v,mode:N,onSave:A,userRole:n?.role})]})},GL=({suppliers:n,onEdit:e,onDelete:t,hasEditPermission:a,hasDeletePermission:o})=>{const[c,d]=Y.useState("name"),[f,p]=Y.useState("asc"),v=L=>{c===L?p(f==="asc"?"desc":"asc"):(d(L),p("asc"))},_=[...n].sort((L,$)=>{let O=L[c],U=$[c];switch(c){case"rating":O=O||0,U=U||0;break;case"totalOrders":case"totalPurchased":O=O||0,U=U||0;break;case"createdAt":case"lastOrderDate":O=O?O.toDate?O.toDate():new Date(O):new Date(0),U=U?U.toDate?U.toDate():new Date(U):new Date(0);break;default:O=(O||"").toString().toLowerCase(),U=(U||"").toString().toLowerCase()}return O<U?f==="asc"?-1:1:O>U?f==="asc"?1:-1:0}),N=L=>{switch(L){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},C=L=>{switch(L){case"active":return"Activo";case"inactive":return"Inactivo";case"suspended":return"Suspendido";default:return"Desconocido"}},j=L=>L?(L.toDate?L.toDate():new Date(L)).toLocaleDateString("es-CO"):"-",b=L=>{const $=[];for(let O=1;O<=5;O++)$.push(r.jsx("span",{className:`star ${O<=L?"filled":""}`,children:"★"},O));return r.jsx("div",{className:"rating-stars",children:$})},M=L=>!L||L.length===0?r.jsx("span",{className:"no-data",children:"-"}):r.jsxs("div",{className:"fuel-types-cell",children:[L.slice(0,2).map($=>r.jsx("span",{className:"fuel-badge-sm",children:An[$]||$},$)),L.length>2&&r.jsxs("span",{className:"fuel-badge-sm more",title:L.slice(2).map($=>An[$]||$).join(", "),children:["+",L.length-2]})]}),x=L=>c!==L?"icon-chevrons-up-down":f==="asc"?"icon-chevron-up":"icon-chevron-down";return r.jsxs("div",{className:"suppliers-table-container",children:[r.jsxs("div",{className:"table-wrapper",children:[r.jsxs("table",{className:"suppliers-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{className:`sortable ${c==="name"?"active":""}`,onClick:()=>v("name"),children:[r.jsx("span",{children:"Proveedor"}),r.jsx("i",{className:x("name")})]}),r.jsxs("th",{className:`sortable ${c==="status"?"active":""}`,onClick:()=>v("status"),children:[r.jsx("span",{children:"Estado"}),r.jsx("i",{className:x("status")})]}),r.jsxs("th",{className:`sortable ${c==="category"?"active":""}`,onClick:()=>v("category"),children:[r.jsx("span",{children:"Categoría"}),r.jsx("i",{className:x("category")})]}),r.jsx("th",{children:r.jsx("span",{children:"Combustibles"})}),r.jsx("th",{children:r.jsx("span",{children:"Contacto"})}),r.jsxs("th",{className:`sortable ${c==="rating"?"active":""}`,onClick:()=>v("rating"),children:[r.jsx("span",{children:"Rating"}),r.jsx("i",{className:x("rating")})]}),r.jsxs("th",{className:`sortable ${c==="totalOrders"?"active":""}`,onClick:()=>v("totalOrders"),children:[r.jsx("span",{children:"Órdenes"}),r.jsx("i",{className:x("totalOrders")})]}),r.jsxs("th",{className:`sortable ${c==="totalPurchased"?"active":""}`,onClick:()=>v("totalPurchased"),children:[r.jsx("span",{children:"Total Comprado"}),r.jsx("i",{className:x("totalPurchased")})]}),r.jsxs("th",{className:`sortable ${c==="createdAt"?"active":""}`,onClick:()=>v("createdAt"),children:[r.jsx("span",{children:"Creado"}),r.jsx("i",{className:x("createdAt")})]}),r.jsx("th",{className:"actions-column",children:r.jsx("span",{children:"Acciones"})})]})}),r.jsx("tbody",{children:_.map(L=>r.jsxs("tr",{className:`supplier-row ${L.status}`,children:[r.jsx("td",{className:"supplier-info-cell",children:r.jsxs("div",{className:"supplier-main-info",children:[r.jsxs("div",{className:"supplier-name",children:[L.name,L.isPreferred&&r.jsx("span",{className:"preferred-badge",title:"Proveedor Preferido",children:r.jsx("i",{className:"icon-star"})})]}),L.taxId&&r.jsxs("div",{className:"supplier-tax-id",children:["NIT: ",L.taxId]}),L.type&&r.jsx("div",{className:"supplier-type",children:L.type.charAt(0).toUpperCase()+L.type.slice(1)})]})}),r.jsx("td",{className:"status-cell",children:r.jsxs("div",{className:"status-display",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:N(L.status)}}),r.jsx("span",{className:"status-label",children:C(L.status)})]})}),r.jsx("td",{className:"category-cell",children:r.jsx("span",{className:"category-label",children:L.category?.charAt(0).toUpperCase()+L.category?.slice(1)||"-"})}),r.jsx("td",{className:"fuel-types-cell",children:M(L.fuelTypes)}),r.jsx("td",{className:"contact-cell",children:r.jsxs("div",{className:"contact-info",children:[L.contactPerson&&r.jsxs("div",{className:"contact-person",children:[r.jsx("i",{className:"icon-user"}),r.jsx("span",{children:L.contactPerson})]}),L.phone&&r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-phone"}),r.jsx("a",{href:`tel:${L.phone}`,children:L.phone})]}),L.email&&r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-mail"}),r.jsx("a",{href:`mailto:${L.email}`,children:L.email})]}),L.city&&r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-map-pin"}),r.jsx("span",{children:L.city})]})]})}),r.jsx("td",{className:"rating-cell",children:r.jsxs("div",{className:"rating-display",children:[b(L.rating||0),r.jsx("span",{className:"rating-value",children:(L.rating||0).toFixed(1)})]})}),r.jsx("td",{className:"orders-cell",children:r.jsx("span",{className:"orders-count",children:L.totalOrders||0})}),r.jsx("td",{className:"purchased-cell",children:r.jsx("span",{className:"purchased-amount",children:Mn(L.totalPurchased||0)})}),r.jsx("td",{className:"date-cell",children:r.jsx("span",{className:"date-value",children:j(L.createdAt)})}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[a&&r.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(L),title:"Editar proveedor",children:r.jsx("i",{className:"icon-edit"})}),o&&L.status==="active"&&r.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>t(L.id,L.name),title:"Desactivar proveedor",children:r.jsx("i",{className:"icon-x-circle"})}),r.jsxs("div",{className:"quick-actions",children:[L.phone&&r.jsx("a",{href:`tel:${L.phone}`,className:"quick-action-btn",title:"Llamar",children:r.jsx("i",{className:"icon-phone"})}),L.email&&r.jsx("a",{href:`mailto:${L.email}`,className:"quick-action-btn",title:"Enviar email",children:r.jsx("i",{className:"icon-mail"})})]})]})})]},L.id))})]}),_.length===0&&r.jsxs("div",{className:"table-empty-state",children:[r.jsx("i",{className:"icon-truck"}),r.jsx("p",{children:"No hay proveedores para mostrar"})]})]}),r.jsxs("div",{className:"table-footer",children:[r.jsx("div",{className:"table-info",children:r.jsxs("span",{children:["Mostrando ",_.length," proveedor",_.length!==1?"es":""]})}),r.jsx("div",{className:"table-actions",children:r.jsxs("span",{className:"sort-info",children:["Ordenado por: ",c==="name"?"Nombre":c==="status"?"Estado":c==="category"?"Categoría":c==="rating"?"Rating":c==="totalOrders"?"Órdenes":c==="totalPurchased"?"Total Comprado":c==="createdAt"?"Fecha de Creación":c," (",f==="asc"?"Ascendente":"Descendente",")"]})})]})]})},$L=({suppliers:n,onEdit:e,onDelete:t,hasEditPermission:a,hasDeletePermission:o})=>{const c=j=>{switch(j){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},d=j=>{switch(j){case"active":return"Activo";case"inactive":return"Inactivo";case"suspended":return"Suspendido";default:return"Desconocido"}},f=j=>{switch(j){case"combustibles":return"⛽";case"lubricantes":return"🛢️";case"aditivos":return"🧪";default:return"📦"}},p=j=>{switch(j){case"proveedor":return"Proveedor";case"distribuidor":return"Distribuidor";case"mayorista":return"Mayorista";default:return"Sin especificar"}},v=j=>j?(j.toDate?j.toDate():new Date(j)).toLocaleDateString("es-CO"):"No disponible",_=j=>{const b=[];for(let M=1;M<=5;M++)b.push(r.jsx("span",{className:`star ${M<=j?"filled":""}`,children:"★"},M));return r.jsx("div",{className:"rating-stars",children:b})},N=j=>!j||j.length===0?r.jsx("span",{className:"no-fuels",children:"Sin combustibles especificados"}):r.jsxs("div",{className:"fuel-types",children:[j.slice(0,3).map(b=>r.jsx("span",{className:"fuel-badge",title:An[b],children:An[b]||b},b)),j.length>3&&r.jsxs("span",{className:"fuel-badge more",title:`+${j.length-3} más`,children:["+",j.length-3]})]}),C=j=>{const b=[];return j.phone&&b.push(r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-phone"}),r.jsx("span",{children:j.phone})]},"phone")),j.email&&b.push(r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-mail"}),r.jsx("span",{children:j.email})]},"email")),j.city&&b.push(r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-map-pin"}),r.jsx("span",{children:j.city})]},"city")),b.length>0?b:r.jsxs("div",{className:"contact-item no-contact",children:[r.jsx("i",{className:"icon-info-circle"}),r.jsx("span",{children:"Sin información de contacto"})]})};return r.jsx("div",{className:"suppliers-cards",children:n.map(j=>r.jsxs("div",{className:`supplier-card ${j.status}`,children:[r.jsxs("div",{className:"card-header",children:[r.jsx("div",{className:"header-left",children:r.jsxs("div",{className:"supplier-info",children:[r.jsxs("h3",{className:"supplier-name",children:[j.name,j.isPreferred&&r.jsx("span",{className:"preferred-badge",title:"Proveedor Preferido",children:r.jsx("i",{className:"icon-star"})})]}),j.taxId&&r.jsxs("div",{className:"supplier-tax-id",children:["NIT: ",j.taxId]})]})}),r.jsx("div",{className:"header-right",children:r.jsxs("div",{className:"supplier-status",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:c(j.status)}}),r.jsx("span",{className:"status-label",children:d(j.status)})]})})]}),r.jsxs("div",{className:"card-content",children:[r.jsxs("div",{className:"supplier-meta",children:[r.jsxs("div",{className:"meta-item",children:[r.jsx("span",{className:"meta-icon",children:f(j.category)}),r.jsx("span",{className:"meta-label",children:j.category?.charAt(0).toUpperCase()+j.category?.slice(1)||"Sin categoría"})]}),r.jsxs("div",{className:"meta-item",children:[r.jsx("i",{className:"icon-building meta-icon"}),r.jsx("span",{className:"meta-label",children:p(j.type)})]})]}),j.contactPerson&&r.jsxs("div",{className:"contact-person",children:[r.jsx("i",{className:"icon-user"}),r.jsx("span",{children:j.contactPerson})]}),r.jsx("div",{className:"contact-info",children:C(j)}),r.jsxs("div",{className:"fuel-types-section",children:[r.jsx("div",{className:"section-label",children:"Combustibles Suministrados:"}),N(j.fuelTypes)]}),r.jsxs("div",{className:"rating-section",children:[r.jsxs("div",{className:"rating-display",children:[_(j.rating||0),r.jsxs("span",{className:"rating-value",children:[(j.rating||0).toFixed(1),"/5"]})]}),j.evaluationNotes&&r.jsxs("div",{className:"evaluation-notes",title:j.evaluationNotes,children:[r.jsx("i",{className:"icon-message-square"}),r.jsx("span",{children:"Con evaluación"})]})]}),j.paymentTerms&&r.jsxs("div",{className:"payment-terms",children:[r.jsx("i",{className:"icon-credit-card"}),r.jsxs("span",{children:["Términos: ",j.paymentTerms==="contado"?"Contado":j.paymentTerms==="30dias"?"30 días":j.paymentTerms==="60dias"?"60 días":j.paymentTerms==="90dias"?"90 días":j.paymentTerms]})]}),r.jsxs("div",{className:"supplier-stats",children:[r.jsxs("div",{className:"stat-item",children:[r.jsx("span",{className:"stat-label",children:"Órdenes:"}),r.jsx("span",{className:"stat-value",children:j.totalOrders||0})]}),r.jsxs("div",{className:"stat-item",children:[r.jsx("span",{className:"stat-label",children:"Total Comprado:"}),r.jsx("span",{className:"stat-value",children:Mn(j.totalPurchased||0)})]}),j.lastOrderDate&&r.jsxs("div",{className:"stat-item",children:[r.jsx("span",{className:"stat-label",children:"Última Orden:"}),r.jsx("span",{className:"stat-value",children:v(j.lastOrderDate)})]})]})]}),r.jsxs("div",{className:"card-footer",children:[r.jsx("div",{className:"footer-info",children:r.jsxs("span",{className:"created-date",children:["Creado: ",v(j.createdAt)]})}),r.jsxs("div",{className:"card-actions",children:[a&&r.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(j),title:"Editar proveedor",children:[r.jsx("i",{className:"icon-edit"}),"Editar"]}),o&&j.status==="active"&&r.jsxs("button",{className:"btn btn-sm btn-danger",onClick:()=>t(j.id,j.name),title:"Desactivar proveedor",children:[r.jsx("i",{className:"icon-x-circle"}),"Desactivar"]}),r.jsxs("div",{className:"quick-actions",children:[j.phone&&r.jsx("a",{href:`tel:${j.phone}`,className:"quick-action-btn",title:"Llamar",children:r.jsx("i",{className:"icon-phone"})}),j.email&&r.jsx("a",{href:`mailto:${j.email}`,className:"quick-action-btn",title:"Enviar email",children:r.jsx("i",{className:"icon-mail"})})]})]})]})]},j.id))})},YL=({supplier:n,onClose:e,onSuccess:t,onError:a})=>{const{userProfile:o}=Zs(),c=!!n,[d,f]=Y.useState({name:"",taxId:"",type:"proveedor",category:"combustibles",contactPerson:"",phone:"",email:"",address:"",city:"",state:"Colombia",fuelTypes:[],paymentTerms:"contado",creditLimit:"",priceList:{},rating:5,evaluationNotes:"",status:"active",isPreferred:!1}),[p,v]=Y.useState(!1),[_,N]=Y.useState({}),[C,j]=Y.useState("basic");Y.useEffect(()=>{c&&n&&f({name:n.name||"",taxId:n.taxId||"",type:n.type||"proveedor",category:n.category||"combustibles",contactPerson:n.contactPerson||"",phone:n.phone||"",email:n.email||"",address:n.address||"",city:n.city||"",state:n.state||"Colombia",fuelTypes:n.fuelTypes||[],paymentTerms:n.paymentTerms||"contado",creditLimit:n.creditLimit||"",priceList:n.priceList||{},rating:n.rating||5,evaluationNotes:n.evaluationNotes||"",status:n.status||"active",isPreferred:n.isPreferred||!1})},[c,n]);const b=(U,F)=>{f(X=>({...X,[U]:F})),_[U]&&N(X=>({...X,[U]:null}))},M=U=>{f(F=>({...F,fuelTypes:F.fuelTypes.includes(U)?F.fuelTypes.filter(X=>X!==U):[...F.fuelTypes,U]}))},x=(U,F)=>{f(X=>({...X,priceList:{...X.priceList,[U]:parseFloat(F)||0}}))},L=()=>{const U={};return d.name.trim()||(U.name="El nombre del proveedor es requerido"),d.category||(U.category="La categoría es requerida"),d.type||(U.type="El tipo de proveedor es requerido"),d.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.email)&&(U.email="El formato del email no es válido"),d.phone&&!/^[\d\s\-+()]+$/.test(d.phone)&&(U.phone="El formato del teléfono no es válido"),d.creditLimit&&(isNaN(d.creditLimit)||parseFloat(d.creditLimit)<0)&&(U.creditLimit="El límite de crédito debe ser un número positivo"),(d.rating<1||d.rating>5)&&(U.rating="El rating debe estar entre 1 y 5"),d.fuelTypes.forEach(F=>{d.priceList[F]&&(isNaN(d.priceList[F])||parseFloat(d.priceList[F])<0)&&(U[`price_${F}`]=`El precio de ${An[F]} debe ser un número positivo`)}),N(U),Object.keys(U).length===0},$=async U=>{if(U.preventDefault(),!!L()){v(!0);try{const F={...d,creditLimit:parseFloat(d.creditLimit)||0,rating:parseFloat(d.rating)||5,priceList:Object.fromEntries(Object.entries(d.priceList).filter(([w,A])=>d.fuelTypes.includes(w)&&A>0))};let X;c?X=await yL(n.id,F,o?.email):X=await gL(F,o?.email),X.success?t():a(X.error||"Error al guardar proveedor")}catch(F){console.error("Error saving supplier:",F),a("Error inesperado al guardar proveedor")}finally{v(!1)}}},O=[{id:"basic",label:"Información Básica",icon:"icon-info"},{id:"contact",label:"Contacto",icon:"icon-phone"},{id:"products",label:"Productos",icon:"icon-package"},{id:"commercial",label:"Comercial",icon:"icon-credit-card"}];return r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-container large",onClick:U=>U.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("h2",{children:[r.jsx("i",{className:"icon-truck"}),c?"Editar Proveedor":"Nuevo Proveedor"]}),r.jsx("button",{className:"modal-close",onClick:e,children:r.jsx("i",{className:"icon-x"})})]}),r.jsxs("form",{onSubmit:$,children:[r.jsx("div",{className:"modal-tabs",children:O.map(U=>r.jsxs("button",{type:"button",className:`tab-button ${C===U.id?"active":""}`,onClick:()=>j(U.id),children:[r.jsx("i",{className:U.icon}),U.label]},U.id))}),r.jsxs("div",{className:"modal-body",children:[C==="basic"&&r.jsx("div",{className:"tab-content",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"required",children:"Nombre del Proveedor"}),r.jsx("input",{type:"text",value:d.name,onChange:U=>b("name",U.target.value),placeholder:"Ingresa el nombre del proveedor",className:_.name?"error":""}),_.name&&r.jsx("span",{className:"error-message",children:_.name})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"NIT / Documento"}),r.jsx("input",{type:"text",value:d.taxId,onChange:U=>b("taxId",U.target.value),placeholder:"123456789-0",className:_.taxId?"error":""}),_.taxId&&r.jsx("span",{className:"error-message",children:_.taxId})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"required",children:"Tipo de Proveedor"}),r.jsxs("select",{value:d.type,onChange:U=>b("type",U.target.value),className:_.type?"error":"",children:[r.jsx("option",{value:"proveedor",children:"Proveedor"}),r.jsx("option",{value:"distribuidor",children:"Distribuidor"}),r.jsx("option",{value:"mayorista",children:"Mayorista"})]}),_.type&&r.jsx("span",{className:"error-message",children:_.type})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"required",children:"Categoría"}),r.jsxs("select",{value:d.category,onChange:U=>b("category",U.target.value),className:_.category?"error":"",children:[r.jsx("option",{value:"combustibles",children:"Combustibles"}),r.jsx("option",{value:"lubricantes",children:"Lubricantes"}),r.jsx("option",{value:"aditivos",children:"Aditivos"})]}),_.category&&r.jsx("span",{className:"error-message",children:_.category})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:d.status,onChange:U=>b("status",U.target.value),children:[r.jsx("option",{value:"active",children:"Activo"}),r.jsx("option",{value:"inactive",children:"Inactivo"}),r.jsx("option",{value:"suspended",children:"Suspendido"})]})]}),r.jsx("div",{className:"form-group checkbox",children:r.jsxs("label",{className:"checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:d.isPreferred,onChange:U=>b("isPreferred",U.target.checked)}),r.jsx("span",{className:"checkbox-mark"}),"Proveedor Preferido"]})})]})}),C==="contact"&&r.jsx("div",{className:"tab-content",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Persona de Contacto"}),r.jsx("input",{type:"text",value:d.contactPerson,onChange:U=>b("contactPerson",U.target.value),placeholder:"Nombre del contacto principal"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Teléfono"}),r.jsx("input",{type:"tel",value:d.phone,onChange:U=>b("phone",U.target.value),placeholder:"+57 300 123 4567",className:_.phone?"error":""}),_.phone&&r.jsx("span",{className:"error-message",children:_.phone})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Email"}),r.jsx("input",{type:"email",value:d.email,onChange:U=>b("email",U.target.value),placeholder:"contacto@proveedor.com",className:_.email?"error":""}),_.email&&r.jsx("span",{className:"error-message",children:_.email})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Ciudad"}),r.jsx("input",{type:"text",value:d.city,onChange:U=>b("city",U.target.value),placeholder:"Bogotá"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado/País"}),r.jsx("input",{type:"text",value:d.state,onChange:U=>b("state",U.target.value),placeholder:"Colombia"})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{children:"Dirección"}),r.jsx("textarea",{value:d.address,onChange:U=>b("address",U.target.value),placeholder:"Dirección completa del proveedor",rows:"3"})]})]})}),C==="products"&&r.jsxs("div",{className:"tab-content",children:[r.jsxs("div",{className:"section",children:[r.jsx("h3",{children:"Tipos de Combustible que Suministra"}),r.jsx("div",{className:"fuel-types-grid",children:Object.entries(An).map(([U,F])=>r.jsx("div",{className:"fuel-type-item",children:r.jsxs("label",{className:"checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:d.fuelTypes.includes(U),onChange:()=>M(U)}),r.jsx("span",{className:"checkbox-mark"}),F]})},U))})]}),d.fuelTypes.length>0&&r.jsxs("div",{className:"section",children:[r.jsx("h3",{children:"Precios por Litro (Opcional)"}),r.jsx("div",{className:"prices-grid",children:d.fuelTypes.map(U=>r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:An[U]}),r.jsxs("div",{className:"input-with-currency",children:[r.jsx("span",{className:"currency-symbol",children:"$"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:d.priceList[U]||"",onChange:F=>x(U,F.target.value),placeholder:"0.00",className:_[`price_${U}`]?"error":""})]}),_[`price_${U}`]&&r.jsx("span",{className:"error-message",children:_[`price_${U}`]})]},U))})]})]}),C==="commercial"&&r.jsx("div",{className:"tab-content",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Términos de Pago"}),r.jsxs("select",{value:d.paymentTerms,onChange:U=>b("paymentTerms",U.target.value),children:[r.jsx("option",{value:"contado",children:"Contado"}),r.jsx("option",{value:"30dias",children:"30 días"}),r.jsx("option",{value:"60dias",children:"60 días"}),r.jsx("option",{value:"90dias",children:"90 días"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Límite de Crédito"}),r.jsxs("div",{className:"input-with-currency",children:[r.jsx("span",{className:"currency-symbol",children:"$"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:d.creditLimit,onChange:U=>b("creditLimit",U.target.value),placeholder:"0.00",className:_.creditLimit?"error":""})]}),_.creditLimit&&r.jsx("span",{className:"error-message",children:_.creditLimit})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Rating"}),r.jsxs("div",{className:"rating-input",children:[r.jsx("input",{type:"range",min:"1",max:"5",step:"0.1",value:d.rating,onChange:U=>b("rating",parseFloat(U.target.value)),className:_.rating?"error":""}),r.jsxs("div",{className:"rating-display",children:[r.jsx("span",{className:"rating-value",children:d.rating.toFixed(1)}),r.jsx("div",{className:"rating-stars",children:[1,2,3,4,5].map(U=>r.jsx("span",{className:`star ${U<=Math.round(d.rating)?"filled":""}`,children:"★"},U))})]})]}),_.rating&&r.jsx("span",{className:"error-message",children:_.rating})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{children:"Notas de Evaluación"}),r.jsx("textarea",{value:d.evaluationNotes,onChange:U=>b("evaluationNotes",U.target.value),placeholder:"Comentarios sobre el desempeño del proveedor...",rows:"4"})]})]})})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn btn-secondary",onClick:e,disabled:p,children:"Cancelar"}),r.jsx("button",{type:"submit",className:"btn btn-primary",disabled:p,children:p?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"loading-spinner small"}),c?"Actualizando...":"Creando..."]}):r.jsxs(r.Fragment,{children:[r.jsx("i",{className:"icon-save"}),c?"Actualizar Proveedor":"Crear Proveedor"]})})]})]})]})})},KL=({stats:n,suppliersCount:e,totalSuppliers:t})=>{if(!n)return null;const a=d=>{switch(d){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},o=d=>{switch(d){case"combustibles":return"⛽";case"lubricantes":return"🛢️";case"aditivos":return"🧪";default:return"📦"}},c=d=>{switch(d){case"proveedor":return"🏪";case"distribuidor":return"🚛";case"mayorista":return"🏭";default:return"🏢"}};return r.jsxs("div",{className:"suppliers-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-truck"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Ge(n.total)}),r.jsx("div",{className:"stat-label",children:"Total Proveedores"}),t!==e&&r.jsxs("div",{className:"stat-sublabel",children:[Ge(e)," mostrados"]})]})]}),r.jsxs("div",{className:"stat-card success",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-check-circle"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Ge(n.active)}),r.jsx("div",{className:"stat-label",children:"Activos"}),r.jsx("div",{className:"stat-sublabel",children:Nr(n.total>0?n.active/n.total:0)})]})]}),r.jsxs("div",{className:"stat-card warning",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-star"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Ge(n.preferred)}),r.jsx("div",{className:"stat-label",children:"Preferidos"}),r.jsx("div",{className:"stat-sublabel",children:Nr(n.active>0?n.preferred/n.active:0)})]})]}),r.jsxs("div",{className:"stat-card info",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-award"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:n.averageRating.toFixed(1)}),r.jsx("div",{className:"stat-label",children:"Rating Promedio"}),r.jsx("div",{className:"stat-sublabel",children:r.jsx("div",{className:"rating-stars",children:[1,2,3,4,5].map(d=>r.jsx("span",{className:`star ${d<=Math.round(n.averageRating)?"filled":""}`,children:"★"},d))})})]})]})]}),r.jsxs("div",{className:"stats-details",children:[r.jsxs("div",{className:"stats-section",children:[r.jsx("h3",{children:"Estado de Proveedores"}),r.jsxs("div",{className:"stats-breakdown",children:[r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:a("active")}}),"Activos"]}),r.jsx("div",{className:"breakdown-value",children:n.active}),r.jsx("div",{className:"breakdown-percentage",children:Nr(n.total>0?n.active/n.total:0)})]}),n.inactive>0&&r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:a("inactive")}}),"Inactivos"]}),r.jsx("div",{className:"breakdown-value",children:n.inactive}),r.jsx("div",{className:"breakdown-percentage",children:Nr(n.total>0?n.inactive/n.total:0)})]}),n.suspended>0&&r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:a("suspended")}}),"Suspendidos"]}),r.jsx("div",{className:"breakdown-value",children:n.suspended}),r.jsx("div",{className:"breakdown-percentage",children:Nr(n.total>0?n.suspended/n.total:0)})]})]})]}),Object.keys(n.byCategory).length>0&&r.jsxs("div",{className:"stats-section",children:[r.jsx("h3",{children:"Por Categoría"}),r.jsx("div",{className:"stats-breakdown",children:Object.entries(n.byCategory).sort(([,d],[,f])=>f-d).map(([d,f])=>r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"category-icon",children:o(d)}),d.charAt(0).toUpperCase()+d.slice(1).replace("_"," ")]}),r.jsx("div",{className:"breakdown-value",children:f}),r.jsx("div",{className:"breakdown-percentage",children:Nr(n.total>0?f/n.total:0)})]},d))})]}),Object.keys(n.byType).length>0&&r.jsxs("div",{className:"stats-section",children:[r.jsx("h3",{children:"Por Tipo"}),r.jsx("div",{className:"stats-breakdown",children:Object.entries(n.byType).sort(([,d],[,f])=>f-d).map(([d,f])=>r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"type-icon",children:c(d)}),d.charAt(0).toUpperCase()+d.slice(1)]}),r.jsx("div",{className:"breakdown-value",children:f}),r.jsx("div",{className:"breakdown-percentage",children:Nr(n.total>0?f/n.total:0)})]},d))})]})]}),r.jsxs("div",{className:"stats-insights",children:[r.jsx("h3",{children:"Información Rápida"}),r.jsxs("div",{className:"insights-grid",children:[r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Nivel de Satisfacción"}),r.jsx("div",{className:"insight-value",children:n.averageRating>=4.5?"Excelente":n.averageRating>=4?"Muy Bueno":n.averageRating>=3.5?"Bueno":n.averageRating>=3?"Regular":"Necesita Mejora"})]}),r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Estado General"}),r.jsx("div",{className:"insight-value",children:n.active/n.total>=.9?"Excelente":n.active/n.total>=.8?"Bueno":n.active/n.total>=.7?"Regular":"Revisar"})]}),r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Proveedores Preferidos"}),r.jsx("div",{className:"insight-value",children:n.preferred===0?"Ninguno":n.preferred/n.active>=.3?"Suficientes":n.preferred/n.active>=.2?"Buenos":"Pocos"})]}),r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Diversificación"}),r.jsx("div",{className:"insight-value",children:Object.keys(n.byCategory).length>=3?"Alta":Object.keys(n.byCategory).length>=2?"Media":"Baja"})]})]})]})]})},QL=({searchTerm:n,setSearchTerm:e,filterStatus:t,setFilterStatus:a,filterCategory:o,setFilterCategory:c,filterFuelType:d,setFilterFuelType:f,viewMode:p,setViewMode:v,onClearFilters:_,resultsCount:N})=>{const C=[{value:"all",label:"Todos los Estados",icon:"list"},{value:"active",label:"Activos",icon:"check-circle"},{value:"inactive",label:"Inactivos",icon:"x-circle"},{value:"suspended",label:"Suspendidos",icon:"alert-circle"},{value:"preferred",label:"Preferidos",icon:"star"}],j=[{value:"all",label:"Todas las Categorías",icon:"grid"},{value:"combustibles",label:"Combustibles",icon:"fuel"},{value:"lubricantes",label:"Lubricantes",icon:"droplets"},{value:"aditivos",label:"Aditivos",icon:"flask"}],b=[{value:"all",label:"Todos los Combustibles",icon:"fuel"},...Object.entries(An).map(([x,L])=>({value:x,label:L,icon:"droplet"}))],M=n||t!=="all"||o!=="all"||d!=="all";return r.jsxs("div",{className:"suppliers-filters",children:[r.jsxs("div",{className:"filters-top",children:[r.jsx("div",{className:"search-container",children:r.jsxs("div",{className:"search-input-wrapper",children:[r.jsx("i",{className:"icon-search search-icon"}),r.jsx("input",{type:"text",placeholder:"Buscar por nombre, NIT, contacto, ciudad...",value:n,onChange:x=>e(x.target.value),className:"search-input"}),n&&r.jsx("button",{className:"search-clear",onClick:()=>e(""),title:"Limpiar búsqueda",children:r.jsx("i",{className:"icon-x"})})]})}),r.jsxs("div",{className:"view-controls",children:[r.jsxs("div",{className:"view-mode-toggle",children:[r.jsx("button",{className:`view-btn ${p==="cards"?"active":""}`,onClick:()=>v("cards"),title:"Vista de tarjetas",children:r.jsx("i",{className:"icon-grid"})}),r.jsx("button",{className:`view-btn ${p==="table"?"active":""}`,onClick:()=>v("table"),title:"Vista de tabla",children:r.jsx("i",{className:"icon-list"})})]}),M&&r.jsxs("button",{className:"btn btn-secondary clear-filters",onClick:_,title:"Limpiar todos los filtros",children:[r.jsx("i",{className:"icon-filter-x"}),"Limpiar"]})]})]}),r.jsxs("div",{className:"filters-dropdowns",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{className:"filter-label",children:"Estado"}),r.jsxs("div",{className:"select-wrapper",children:[r.jsx("select",{value:t,onChange:x=>a(x.target.value),className:"filter-select",children:C.map(x=>r.jsx("option",{value:x.value,children:x.label},x.value))}),r.jsx("i",{className:"icon-chevron-down select-arrow"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{className:"filter-label",children:"Categoría"}),r.jsxs("div",{className:"select-wrapper",children:[r.jsx("select",{value:o,onChange:x=>c(x.target.value),className:"filter-select",children:j.map(x=>r.jsx("option",{value:x.value,children:x.label},x.value))}),r.jsx("i",{className:"icon-chevron-down select-arrow"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{className:"filter-label",children:"Tipo de Combustible"}),r.jsxs("div",{className:"select-wrapper",children:[r.jsx("select",{value:d,onChange:x=>f(x.target.value),className:"filter-select",children:b.map(x=>r.jsx("option",{value:x.value,children:x.label},x.value))}),r.jsx("i",{className:"icon-chevron-down select-arrow"})]})]})]}),r.jsxs("div",{className:"filters-summary",children:[r.jsxs("div",{className:"results-count",children:[r.jsx("i",{className:"icon-info-circle"}),r.jsx("span",{children:N===0?"No se encontraron proveedores":`Mostrando ${N} proveedor${N!==1?"es":""}`})]}),M&&r.jsxs("div",{className:"active-filters",children:[r.jsx("span",{className:"filters-label",children:"Filtros activos:"}),r.jsxs("div",{className:"filter-tags",children:[n&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-search"}),n,r.jsx("button",{onClick:()=>e(""),children:r.jsx("i",{className:"icon-x"})})]}),t!=="all"&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-filter"}),C.find(x=>x.value===t)?.label,r.jsx("button",{onClick:()=>a("all"),children:r.jsx("i",{className:"icon-x"})})]}),o!=="all"&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-tag"}),j.find(x=>x.value===o)?.label,r.jsx("button",{onClick:()=>c("all"),children:r.jsx("i",{className:"icon-x"})})]}),d!=="all"&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-droplet"}),b.find(x=>x.value===d)?.label,r.jsx("button",{onClick:()=>f("all"),children:r.jsx("i",{className:"icon-x"})})]})]})]})]}),r.jsxs("div",{className:"quick-filters",children:[r.jsx("span",{className:"quick-filters-label",children:"Acceso rápido:"}),r.jsxs("div",{className:"quick-filter-buttons",children:[r.jsxs("button",{className:`quick-filter-btn ${t==="preferred"?"active":""}`,onClick:()=>a(t==="preferred"?"all":"preferred"),children:[r.jsx("i",{className:"icon-star"}),"Preferidos"]}),r.jsxs("button",{className:`quick-filter-btn ${t==="active"?"active":""}`,onClick:()=>a(t==="active"?"all":"active"),children:[r.jsx("i",{className:"icon-check-circle"}),"Activos"]}),r.jsxs("button",{className:`quick-filter-btn ${o==="combustibles"?"active":""}`,onClick:()=>c(o==="combustibles"?"all":"combustibles"),children:[r.jsx("i",{className:"icon-fuel"}),"Combustibles"]}),r.jsxs("button",{className:`quick-filter-btn ${d==="diesel"?"active":""}`,onClick:()=>f(d==="diesel"?"all":"diesel"),children:[r.jsx("i",{className:"icon-droplet"}),"Diésel"]})]})]})]})},XL=()=>{const{hasPermission:n,userProfile:e}=Zs(),[t,a]=Y.useState([]),[o,c]=Y.useState(null),[d,f]=Y.useState(!0),[p,v]=Y.useState(null),[_,N]=Y.useState("cards"),[C,j]=Y.useState(!1),[b,M]=Y.useState(null),[x,L]=Y.useState("all"),[$,O]=Y.useState("all"),[U,F]=Y.useState("all"),[X,w]=Y.useState("");Y.useEffect(()=>{let B=null;return(()=>{B=vL(ce=>{a(ce||[]),f(!1)})})(),()=>{B&&B()}},[]),Y.useEffect(()=>{const B=async()=>{const J=await EL();J.success&&c(J.data)};t.length>0&&B()},[t]);const A=t.filter(B=>{const J=!X||B.name?.toLowerCase().includes(X.toLowerCase())||B.taxId?.toLowerCase().includes(X.toLowerCase())||B.contactPerson?.toLowerCase().includes(X.toLowerCase())||B.city?.toLowerCase().includes(X.toLowerCase()),ce=x==="all"||(x==="preferred"?B.isPreferred:B.status===x),ye=$==="all"||B.category===$,q=U==="all"||B.fuelTypes&&B.fuelTypes.includes(U);return J&&ce&&ye&&q}),R=()=>{if(!n("canManageSuppliers")){v("No tienes permisos para agregar proveedores");return}M(null),j(!0)},I=B=>{if(!n("canManageSuppliers")){v("No tienes permisos para editar proveedores");return}M(B),j(!0)},P=async(B,J)=>{if(!n("canManageSuppliers")){v("No tienes permisos para eliminar proveedores");return}if(window.confirm(`¿Estás seguro de que deseas desactivar el proveedor "${J}"?

Esta acción se puede revertir cambiando su estado a activo.`))try{const ce=await _L(B,e?.email);ce.success?v(null):v(ce.error||"Error al desactivar proveedor")}catch(ce){console.error("Error deleting supplier:",ce),v("Error inesperado al eliminar proveedor")}},V=()=>{j(!1),M(null),v(null)},k=()=>{j(!1),M(null),v(null)},Le=()=>{L("all"),O("all"),F("all"),w("")},ae=()=>{if(!n("canExportReports")){v("No tienes permisos para exportar datos");return}try{const B=A.map(ne=>({Nombre:ne.name,"NIT/Documento":ne.taxId,Tipo:ne.type,Categoría:ne.category,"Persona de Contacto":ne.contactPerson,Teléfono:ne.phone,Email:ne.email,Ciudad:ne.city,Combustibles:ne.fuelTypes?.join(", "),Rating:ne.rating,Estado:ne.status,Preferido:ne.isPreferred?"Sí":"No","Fecha Creación":ne.createdAt?.toDate?.()?.toLocaleDateString()||"N/A"})),J=[Object.keys(B[0]).join(","),...B.map(ne=>Object.values(ne).map(he=>`"${he||""}"`).join(","))].join(`
`),ce=new Blob([J],{type:"text/csv;charset=utf-8;"}),ye=document.createElement("a"),q=URL.createObjectURL(ce);ye.setAttribute("href",q),ye.setAttribute("download",`proveedores_${new Date().toISOString().split("T")[0]}.csv`),ye.style.visibility="hidden",document.body.appendChild(ye),ye.click(),document.body.removeChild(ye)}catch(B){console.error("Error exporting suppliers:",B),v("Error al exportar proveedores")}};return d?r.jsx("div",{className:"suppliers-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando proveedores..."})]})}):r.jsxs("div",{className:"suppliers-main",children:[r.jsxs("div",{className:"suppliers-header",children:[r.jsxs("div",{className:"header-content",children:[r.jsx("h1",{children:"Gestión de Proveedores"}),r.jsx("p",{className:"header-subtitle",children:"Administra los proveedores de combustibles y materiales"})]}),r.jsxs("div",{className:"header-actions",children:[n("canManageSuppliers")&&r.jsxs("button",{className:"btn btn-primary",onClick:R,children:[r.jsx("i",{className:"icon-plus"}),"Agregar Proveedor"]}),n("canExportReports")&&r.jsxs("button",{className:"btn btn-secondary",onClick:ae,disabled:A.length===0,children:[r.jsx("i",{className:"icon-download"}),"Exportar"]})]})]}),p&&r.jsxs("div",{className:"alert alert-error",children:[r.jsx("i",{className:"icon-alert-circle"}),r.jsx("span",{children:p}),r.jsx("button",{onClick:()=>v(null),className:"alert-close",children:r.jsx("i",{className:"icon-x"})})]}),o&&r.jsx(KL,{stats:o,suppliersCount:A.length,totalSuppliers:t.length}),r.jsx(QL,{searchTerm:X,setSearchTerm:w,filterStatus:x,setFilterStatus:L,filterCategory:$,setFilterCategory:O,filterFuelType:U,setFilterFuelType:F,viewMode:_,setViewMode:N,onClearFilters:Le,resultsCount:A.length}),A.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:r.jsx("i",{className:"icon-truck"})}),r.jsx("h3",{children:"No hay proveedores"}),r.jsx("p",{children:t.length===0?"Comienza agregando tu primer proveedor de combustibles.":"No se encontraron proveedores que coincidan con los filtros aplicados."}),t.length===0&&n("canManageSuppliers")&&r.jsxs("button",{className:"btn btn-primary",onClick:R,children:[r.jsx("i",{className:"icon-plus"}),"Agregar Primer Proveedor"]}),t.length>0&&r.jsxs("button",{className:"btn btn-secondary",onClick:Le,children:[r.jsx("i",{className:"icon-filter-x"}),"Limpiar Filtros"]})]}):r.jsx("div",{className:"suppliers-content",children:_==="cards"?r.jsx($L,{suppliers:A,onEdit:I,onDelete:P,hasEditPermission:n("canManageSuppliers"),hasDeletePermission:n("canManageSuppliers")}):r.jsx(GL,{suppliers:A,onEdit:I,onDelete:P,hasEditPermission:n("canManageSuppliers"),hasDeletePermission:n("canManageSuppliers")})}),C&&r.jsx(YL,{supplier:b,onClose:V,onSuccess:k,onError:v})]})},WL=()=>{const{user:n,userProfile:e}=Zs(),[t,a]=Y.useState("invitations"),[o,c]=Y.useState([]),[d,f]=Y.useState(!1),[p,v]=Y.useState(!1),[_,N]=Y.useState(!1),[C,j]=Y.useState({email:"",name:"",role:Es.CLIENTE});Y.useEffect(()=>{n&&e?.role==="admin"&&b()},[n,e]);const b=async()=>{f(!0);try{const U=await D2(n.uid);U.success?c(U.invitations):console.error("Error loading invitations:",U.error)}catch(U){console.error("Error loading invitations:",U)}finally{f(!1)}},M=async U=>{U.preventDefault(),N(!0);try{const F=await I2(C,n.uid);F.success?(j({email:"",name:"",role:Es.CLIENTE}),v(!1),await b(),alert(`Invitación creada exitosamente!
Código: ${F.invitation.code}`)):alert(`Error: ${F.error}`)}catch(F){console.error("Error creating invitation:",F),alert("Error creando invitación")}finally{N(!1)}},x=async U=>{if(confirm("¿Estás seguro de cancelar esta invitación?"))try{const F=await O2(U,n.uid);F.success?(await b(),alert("Invitación cancelada exitosamente")):alert(`Error: ${F.error}`)}catch(F){console.error("Error cancelling invitation:",F),alert("Error cancelando invitación")}},L=U=>({pending:{text:"Pendiente",class:"status-pending"},used:{text:"Usada",class:"status-used"},cancelled:{text:"Cancelada",class:"status-cancelled"},expired:{text:"Expirada",class:"status-expired"}})[U]||{text:U,class:"status-unknown"},$=U=>({admin:"Administrador",contador:"Contador",cliente:"Cliente"})[U]||U,O=U=>U?(U.toDate?U.toDate():new Date(U)).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return e?.role!=="admin"?r.jsxs("div",{className:"admin-unauthorized",children:[r.jsx("h2",{children:"⛔ Acceso Denegado"}),r.jsx("p",{children:"Solo los administradores pueden acceder a esta sección."})]}):r.jsxs("div",{className:"admin-main",children:[r.jsxs("div",{className:"admin-header",children:[r.jsx("h1",{children:"⚙️ Administración del Sistema"}),r.jsx("p",{children:"Gestión de usuarios y configuraciones"})]}),r.jsxs("div",{className:"admin-tabs",children:[r.jsx("button",{className:`tab-button ${t==="invitations"?"active":""}`,onClick:()=>a("invitations"),children:"🎫 Invitaciones"}),r.jsx("button",{className:`tab-button ${t==="users"?"active":""}`,onClick:()=>a("users"),children:"👥 Usuarios"}),r.jsx("button",{className:`tab-button ${t==="settings"?"active":""}`,onClick:()=>a("settings"),children:"⚙️ Configuración"})]}),r.jsxs("div",{className:"admin-content",children:[t==="invitations"&&r.jsxs("div",{className:"invitations-section",children:[r.jsxs("div",{className:"section-header",children:[r.jsx("h2",{children:"Gestión de Invitaciones"}),r.jsx("button",{className:"create-button",onClick:()=>v(!0),children:"+ Crear Invitación"})]}),d?r.jsx("div",{className:"loading",children:"Cargando invitaciones..."}):r.jsxs("div",{className:"invitations-table",children:[r.jsxs("table",{children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Código"}),r.jsx("th",{children:"Email"}),r.jsx("th",{children:"Nombre"}),r.jsx("th",{children:"Rol"}),r.jsx("th",{children:"Estado"}),r.jsx("th",{children:"Creada"}),r.jsx("th",{children:"Expira"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(U=>{const F=L(U.status);return r.jsxs("tr",{children:[r.jsx("td",{children:r.jsx("code",{className:"invitation-code",children:U.code})}),r.jsx("td",{children:U.targetEmail}),r.jsx("td",{children:U.targetName||"-"}),r.jsx("td",{children:$(U.targetRole)}),r.jsx("td",{children:r.jsx("span",{className:`status-badge ${F.class}`,children:F.text})}),r.jsx("td",{children:O(U.createdAt)}),r.jsx("td",{children:O(U.expiresAt)}),r.jsx("td",{children:U.status==="pending"&&r.jsx("button",{className:"cancel-button",onClick:()=>x(U.id),children:"Cancelar"})})]},U.id)})})]}),o.length===0&&r.jsx("div",{className:"empty-state",children:r.jsx("p",{children:"No hay invitaciones creadas"})})]})]}),t==="users"&&r.jsxs("div",{className:"users-section",children:[r.jsx("h2",{children:"👥 Usuarios del Sistema"}),r.jsxs("div",{className:"coming-soon",children:[r.jsx("span",{children:"🚧 En desarrollo"}),r.jsx("p",{children:"Próximamente: Lista de usuarios registrados, edición de permisos, y estadísticas."})]})]}),t==="settings"&&r.jsxs("div",{className:"settings-section",children:[r.jsx("h2",{children:"⚙️ Configuración del Sistema"}),r.jsxs("div",{className:"coming-soon",children:[r.jsx("span",{children:"🚧 En desarrollo"}),r.jsx("p",{children:"Próximamente: Configuraciones generales, notificaciones, y parámetros del sistema."})]})]})]}),p&&r.jsx("div",{className:"modal-overlay",onClick:()=>v(!1),children:r.jsxs("div",{className:"modal-content",onClick:U=>U.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:"Crear Nueva Invitación"}),r.jsx("button",{className:"modal-close",onClick:()=>v(!1),children:"×"})]}),r.jsxs("form",{onSubmit:M,className:"invitation-form",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email del usuario:"}),r.jsx("input",{id:"email",type:"email",required:!0,value:C.email,onChange:U=>j({...C,email:U.target.value}),placeholder:"usuario@ejemplo.com"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"name",children:"Nombre (opcional):"}),r.jsx("input",{id:"name",type:"text",value:C.name,onChange:U=>j({...C,name:U.target.value}),placeholder:"Nombre del usuario"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"role",children:"Rol:"}),r.jsxs("select",{id:"role",value:C.role,onChange:U=>j({...C,role:U.target.value}),children:[r.jsx("option",{value:Es.CLIENTE,children:"Cliente"}),r.jsx("option",{value:Es.CONTADOR,children:"Contador"}),r.jsx("option",{value:Es.ADMIN,children:"Administrador"})]})]}),r.jsxs("div",{className:"form-actions",children:[r.jsx("button",{type:"button",className:"cancel-button",onClick:()=>v(!1),children:"Cancelar"}),r.jsx("button",{type:"submit",className:"create-button",disabled:_,children:_?"Creando...":"Crear Invitación"})]})]})]})})]})},ZL=()=>r.jsxs("div",{className:"module-placeholder",children:[r.jsx("h2",{children:"📋 Módulo de Reportes"}),r.jsx("p",{children:"Análisis y reportes de combustibles"}),r.jsxs("div",{className:"coming-soon",children:[r.jsx("span",{children:"🚧 En desarrollo"}),r.jsx("p",{children:"Próximamente: Reportes personalizables, gráficos interactivos, y exportación."})]})]}),JL=()=>{const[n,e]=Y.useState("dashboard"),t=()=>{switch(n){case"dashboard":return r.jsx(AT,{});case"inventory":return r.jsx(uL,{});case"movements":return r.jsx(NL,{});case"vehicles":return r.jsx(RL,{});case"maintenance":return r.jsx(HL,{});case"products":return r.jsx(zL,{});case"suppliers":return r.jsx(XL,{});case"reports":return r.jsx(ZL,{});case"admin":return r.jsx(WL,{});default:return r.jsx(AT,{})}};return r.jsx(k2,{currentView:n,onViewChange:e,children:t()})},eV=()=>{const[n,e]=Y.useState("login"),[t,a]=Y.useState(!1),[o,c]=Y.useState(""),[d,f]=Y.useState(""),[p,v]=Y.useState(""),[_,N]=Y.useState(""),[C,j]=Y.useState({email:"",password:"",confirmPassword:"",invitationCode:""}),[b,M]=Y.useState(""),[x,L]=Y.useState(null),$=async R=>{R.preventDefault(),a(!0),c("");try{await HI(Hc,p,_)}catch(I){console.error("Error en login:",I),c(X(I.code))}finally{a(!1)}},O=async()=>{a(!0),c("");try{const R=new Ca,I=await dR(Hc,R);x?await bT(I.user,x.code):await rC(I.user)}catch(R){console.error("Error en login con Google:",R),c("Error al iniciar sesión con Google")}finally{a(!1)}},U=async R=>{R.preventDefault(),a(!0),c(""),f("");try{const I=await iC(b);I.success?(L(I.invitation),f(`Invitación válida para: ${I.invitation.targetEmail}`),e("register"),j({...C,email:I.invitation.targetEmail,invitationCode:b})):c(I.error)}catch(I){console.error("Error validando invitación:",I),c("Error validando código de invitación")}finally{a(!1)}},F=async R=>{if(R.preventDefault(),a(!0),c(""),C.password!==C.confirmPassword){c("Las contraseñas no coinciden"),a(!1);return}if(C.password.length<6){c("La contraseña debe tener al menos 6 caracteres"),a(!1);return}try{const I=await FI(Hc,C.email,C.password),P=await bT(I.user,C.invitationCode);P.success?f("¡Registro exitoso! Bienvenido al sistema."):c(P.error)}catch(I){console.error("Error en registro:",I),c(X(I.code))}finally{a(!1)}},X=R=>{switch(R){case"auth/invalid-email":return"El formato del email es inválido";case"auth/user-not-found":return"Usuario no encontrado";case"auth/wrong-password":return"Contraseña incorrecta";case"auth/invalid-credential":return"Email o contraseña incorrectos";case"auth/email-already-in-use":return"Este email ya está registrado";case"auth/weak-password":return"La contraseña es muy débil";default:return"Error de autenticación. Inténtalo de nuevo."}},w=()=>{c(""),f(""),v(""),N(""),M(""),L(null),j({email:"",password:"",confirmPassword:"",invitationCode:""})},A=()=>{switch(n){case"login":return r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:$,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email:"}),r.jsx("input",{id:"email",type:"email",value:p,onChange:R=>v(R.target.value),required:!0,disabled:t,placeholder:"tu-email@ejemplo.com"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"Contraseña:"}),r.jsx("input",{id:"password",type:"password",value:_,onChange:R=>N(R.target.value),required:!0,disabled:t,placeholder:"Tu contraseña"})]}),r.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Iniciando sesión...":"Iniciar Sesión"})]}),r.jsx("div",{className:"auth-divider",children:r.jsx("span",{children:"o"})}),r.jsxs("button",{onClick:O,className:"auth-button google",disabled:t,children:[r.jsx("span",{children:"🔗"}),"Continuar con Google"]}),r.jsx("div",{className:"auth-actions",children:r.jsx("button",{className:"link-button",onClick:()=>{w(),e("invite")},children:"¿Tienes un código de invitación? Regístrate aquí"})})]});case"invite":return r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:U,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"inviteCode",children:"Código de invitación:"}),r.jsx("input",{id:"inviteCode",type:"text",value:b,onChange:R=>M(R.target.value.toUpperCase()),required:!0,disabled:t,placeholder:"XXXXXXXX",maxLength:8,style:{textTransform:"uppercase",fontFamily:"monospace"}}),r.jsx("small",{children:"Ingresa el código de 8 caracteres que recibiste"})]}),r.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Validando...":"Validar Código"})]}),r.jsx("div",{className:"auth-actions",children:r.jsx("button",{className:"link-button",onClick:()=>{w(),e("login")},children:"Volver al inicio de sesión"})})]});case"register":return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"invitation-info",children:r.jsxs("div",{className:"success-message",children:["✅ Código válido para: ",x?.targetEmail]})}),r.jsxs("form",{onSubmit:F,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"registerEmail",children:"Email:"}),r.jsx("input",{id:"registerEmail",type:"email",value:C.email,disabled:!0,className:"disabled-input"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"registerPassword",children:"Contraseña:"}),r.jsx("input",{id:"registerPassword",type:"password",value:C.password,onChange:R=>j({...C,password:R.target.value}),required:!0,disabled:t,placeholder:"Mínimo 6 caracteres",minLength:6})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"confirmPassword",children:"Confirmar contraseña:"}),r.jsx("input",{id:"confirmPassword",type:"password",value:C.confirmPassword,onChange:R=>j({...C,confirmPassword:R.target.value}),required:!0,disabled:t,placeholder:"Repite tu contraseña"})]}),r.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Registrando...":"Crear Cuenta"})]}),r.jsx("div",{className:"auth-divider",children:r.jsx("span",{children:"o"})}),r.jsxs("button",{onClick:O,className:"auth-button google",disabled:t,children:[r.jsx("span",{children:"🔗"}),"Registrarse con Google"]}),r.jsx("div",{className:"auth-actions",children:r.jsx("button",{className:"link-button",onClick:()=>{w(),e("invite")},children:"Usar otro código de invitación"})})]});default:return null}};return r.jsx("div",{className:"auth-container",children:r.jsxs("div",{className:"auth-card",children:[r.jsxs("div",{className:"auth-header",children:[r.jsx("h1",{children:"⛽ Combustibles"}),r.jsx("h2",{children:"Forestech Colombia"}),r.jsxs("p",{children:[n==="login"&&"Sistema de gestión de combustibles",n==="invite"&&"Validar código de invitación",n==="register"&&"Crear nueva cuenta"]})]}),r.jsxs("div",{className:"auth-form",children:[o&&r.jsx("div",{className:"error-message",children:o}),d&&r.jsx("div",{className:"success-message",children:d}),A(),r.jsx("div",{className:"auth-footer",children:r.jsx("p",{children:r.jsxs("small",{children:["Solo usuarios autorizados pueden acceder al sistema.",r.jsx("br",{}),n==="login"?"Contacta al administrador para obtener un código de invitación.":"Si no tienes código, contacta al administrador."]})})})]})]})})};function tV(){return r.jsx(P2,{children:r.jsx(nV,{})})}function nV(){const{user:n,loading:e}=Zs();return e?r.jsx("div",{className:"loading-container",children:r.jsxs("div",{className:"loader",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Cargando..."})]})}):r.jsxs("div",{className:"App",children:[!n&&r.jsx(eV,{}),n&&r.jsx(JL,{})]})}rS.createRoot(document.getElementById("root")).render(r.jsx(Y.StrictMode,{children:r.jsx(tV,{})}));
