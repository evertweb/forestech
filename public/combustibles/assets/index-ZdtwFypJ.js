(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}})();var lp={exports:{}},vc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GE;function Iw(){if(GE)return vc;GE=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,o,c){var d=null;if(c!==void 0&&(d=""+c),o.key!==void 0&&(d=""+o.key),"key"in o){c={};for(var m in o)m!=="key"&&(c[m]=o[m])}else c=o;return o=c.ref,{$$typeof:s,type:i,key:d,ref:o!==void 0?o:null,props:c}}return vc.Fragment=e,vc.jsx=t,vc.jsxs=t,vc}var $E;function Rw(){return $E||($E=1,lp.exports=Iw()),lp.exports}var r=Rw(),cp={exports:{}},De={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KE;function Dw(){if(KE)return De;KE=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),T=Symbol.iterator;function x(q){return q===null||typeof q!="object"?null:(q=T&&q[T]||q["@@iterator"],typeof q=="function"?q:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,M={};function S(q,ne,he){this.props=q,this.context=ne,this.refs=M,this.updater=he||C}S.prototype.isReactComponent={},S.prototype.setState=function(q,ne){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,ne,"setState")},S.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function U(){}U.prototype=S.prototype;function $(q,ne,he){this.props=q,this.context=ne,this.refs=M,this.updater=he||C}var F=$.prototype=new U;F.constructor=$,N(F,S.prototype),F.isPureReactComponent=!0;var V=Array.isArray,B={H:null,A:null,T:null,S:null,V:null},ee=Object.prototype.hasOwnProperty;function D(q,ne,he,ue,be,Pe){return he=Pe.ref,{$$typeof:s,type:q,key:ne,ref:he!==void 0?he:null,props:Pe}}function A(q,ne){return D(q.type,ne,void 0,void 0,void 0,q.props)}function R(q){return typeof q=="object"&&q!==null&&q.$$typeof===s}function I(q){var ne={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(he){return ne[he]})}var k=/\/+/g;function P(q,ne){return typeof q=="object"&&q!==null&&q.key!=null?I(""+q.key):ne.toString(36)}function O(){}function Ve(q){switch(q.status){case"fulfilled":return q.value;case"rejected":throw q.reason;default:switch(typeof q.status=="string"?q.then(O,O):(q.status="pending",q.then(function(ne){q.status==="pending"&&(q.status="fulfilled",q.value=ne)},function(ne){q.status==="pending"&&(q.status="rejected",q.reason=ne)})),q.status){case"fulfilled":return q.value;case"rejected":throw q.reason}}throw q}function ae(q,ne,he,ue,be){var Pe=typeof q;(Pe==="undefined"||Pe==="boolean")&&(q=null);var Ce=!1;if(q===null)Ce=!0;else switch(Pe){case"bigint":case"string":case"number":Ce=!0;break;case"object":switch(q.$$typeof){case s:case e:Ce=!0;break;case _:return Ce=q._init,ae(Ce(q._payload),ne,he,ue,be)}}if(Ce)return be=be(q),Ce=ue===""?"."+P(q,0):ue,V(be)?(he="",Ce!=null&&(he=Ce.replace(k,"$&/")+"/"),ae(be,ne,he,"",function(bs){return bs})):be!=null&&(R(be)&&(be=A(be,he+(be.key==null||q&&q.key===be.key?"":(""+be.key).replace(k,"$&/")+"/")+Ce)),ne.push(be)),1;Ce=0;var qt=ue===""?".":ue+":";if(V(q))for(var ot=0;ot<q.length;ot++)ue=q[ot],Pe=qt+P(ue,ot),Ce+=ae(ue,ne,he,Pe,be);else if(ot=x(q),typeof ot=="function")for(q=ot.call(q),ot=0;!(ue=q.next()).done;)ue=ue.value,Pe=qt+P(ue,ot++),Ce+=ae(ue,ne,he,Pe,be);else if(Pe==="object"){if(typeof q.then=="function")return ae(Ve(q),ne,he,ue,be);throw ne=String(q),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.")}return Ce}function H(q,ne,he){if(q==null)return q;var ue=[],be=0;return ae(q,ue,"","",function(Pe){return ne.call(he,Pe,be++)}),ue}function te(q){if(q._status===-1){var ne=q._result;ne=ne(),ne.then(function(he){(q._status===0||q._status===-1)&&(q._status=1,q._result=he)},function(he){(q._status===0||q._status===-1)&&(q._status=2,q._result=he)}),q._status===-1&&(q._status=0,q._result=ne)}if(q._status===1)return q._result.default;throw q._result}var ce=typeof reportError=="function"?reportError:function(q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ne=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof q=="object"&&q!==null&&typeof q.message=="string"?String(q.message):String(q),error:q});if(!window.dispatchEvent(ne))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",q);return}console.error(q)};function ge(){}return De.Children={map:H,forEach:function(q,ne,he){H(q,function(){ne.apply(this,arguments)},he)},count:function(q){var ne=0;return H(q,function(){ne++}),ne},toArray:function(q){return H(q,function(ne){return ne})||[]},only:function(q){if(!R(q))throw Error("React.Children.only expected to receive a single React element child.");return q}},De.Component=S,De.Fragment=t,De.Profiler=o,De.PureComponent=$,De.StrictMode=i,De.Suspense=p,De.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=B,De.__COMPILER_RUNTIME={__proto__:null,c:function(q){return B.H.useMemoCache(q)}},De.cache=function(q){return function(){return q.apply(null,arguments)}},De.cloneElement=function(q,ne,he){if(q==null)throw Error("The argument must be a React element, but you passed "+q+".");var ue=N({},q.props),be=q.key,Pe=void 0;if(ne!=null)for(Ce in ne.ref!==void 0&&(Pe=void 0),ne.key!==void 0&&(be=""+ne.key),ne)!ee.call(ne,Ce)||Ce==="key"||Ce==="__self"||Ce==="__source"||Ce==="ref"&&ne.ref===void 0||(ue[Ce]=ne[Ce]);var Ce=arguments.length-2;if(Ce===1)ue.children=he;else if(1<Ce){for(var qt=Array(Ce),ot=0;ot<Ce;ot++)qt[ot]=arguments[ot+2];ue.children=qt}return D(q.type,be,void 0,void 0,Pe,ue)},De.createContext=function(q){return q={$$typeof:d,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null},q.Provider=q,q.Consumer={$$typeof:c,_context:q},q},De.createElement=function(q,ne,he){var ue,be={},Pe=null;if(ne!=null)for(ue in ne.key!==void 0&&(Pe=""+ne.key),ne)ee.call(ne,ue)&&ue!=="key"&&ue!=="__self"&&ue!=="__source"&&(be[ue]=ne[ue]);var Ce=arguments.length-2;if(Ce===1)be.children=he;else if(1<Ce){for(var qt=Array(Ce),ot=0;ot<Ce;ot++)qt[ot]=arguments[ot+2];be.children=qt}if(q&&q.defaultProps)for(ue in Ce=q.defaultProps,Ce)be[ue]===void 0&&(be[ue]=Ce[ue]);return D(q,Pe,void 0,void 0,null,be)},De.createRef=function(){return{current:null}},De.forwardRef=function(q){return{$$typeof:m,render:q}},De.isValidElement=R,De.lazy=function(q){return{$$typeof:_,_payload:{_status:-1,_result:q},_init:te}},De.memo=function(q,ne){return{$$typeof:v,type:q,compare:ne===void 0?null:ne}},De.startTransition=function(q){var ne=B.T,he={};B.T=he;try{var ue=q(),be=B.S;be!==null&&be(he,ue),typeof ue=="object"&&ue!==null&&typeof ue.then=="function"&&ue.then(ge,ce)}catch(Pe){ce(Pe)}finally{B.T=ne}},De.unstable_useCacheRefresh=function(){return B.H.useCacheRefresh()},De.use=function(q){return B.H.use(q)},De.useActionState=function(q,ne,he){return B.H.useActionState(q,ne,he)},De.useCallback=function(q,ne){return B.H.useCallback(q,ne)},De.useContext=function(q){return B.H.useContext(q)},De.useDebugValue=function(){},De.useDeferredValue=function(q,ne){return B.H.useDeferredValue(q,ne)},De.useEffect=function(q,ne,he){var ue=B.H;if(typeof he=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ue.useEffect(q,ne)},De.useId=function(){return B.H.useId()},De.useImperativeHandle=function(q,ne,he){return B.H.useImperativeHandle(q,ne,he)},De.useInsertionEffect=function(q,ne){return B.H.useInsertionEffect(q,ne)},De.useLayoutEffect=function(q,ne){return B.H.useLayoutEffect(q,ne)},De.useMemo=function(q,ne){return B.H.useMemo(q,ne)},De.useOptimistic=function(q,ne){return B.H.useOptimistic(q,ne)},De.useReducer=function(q,ne,he){return B.H.useReducer(q,ne,he)},De.useRef=function(q){return B.H.useRef(q)},De.useState=function(q){return B.H.useState(q)},De.useSyncExternalStore=function(q,ne,he){return B.H.useSyncExternalStore(q,ne,he)},De.useTransition=function(){return B.H.useTransition()},De.version="19.1.0",De}var YE;function fg(){return YE||(YE=1,cp.exports=Dw()),cp.exports}var W=fg(),up={exports:{}},yc={},dp={exports:{}},hp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QE;function Ow(){return QE||(QE=1,function(s){function e(H,te){var ce=H.length;H.push(te);e:for(;0<ce;){var ge=ce-1>>>1,q=H[ge];if(0<o(q,te))H[ge]=te,H[ce]=q,ce=ge;else break e}}function t(H){return H.length===0?null:H[0]}function i(H){if(H.length===0)return null;var te=H[0],ce=H.pop();if(ce!==te){H[0]=ce;e:for(var ge=0,q=H.length,ne=q>>>1;ge<ne;){var he=2*(ge+1)-1,ue=H[he],be=he+1,Pe=H[be];if(0>o(ue,ce))be<q&&0>o(Pe,ue)?(H[ge]=Pe,H[be]=ce,ge=be):(H[ge]=ue,H[he]=ce,ge=he);else if(be<q&&0>o(Pe,ce))H[ge]=Pe,H[be]=ce,ge=be;else break e}}return te}function o(H,te){var ce=H.sortIndex-te.sortIndex;return ce!==0?ce:H.id-te.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;s.unstable_now=function(){return c.now()}}else{var d=Date,m=d.now();s.unstable_now=function(){return d.now()-m}}var p=[],v=[],_=1,T=null,x=3,C=!1,N=!1,M=!1,S=!1,U=typeof setTimeout=="function"?setTimeout:null,$=typeof clearTimeout=="function"?clearTimeout:null,F=typeof setImmediate<"u"?setImmediate:null;function V(H){for(var te=t(v);te!==null;){if(te.callback===null)i(v);else if(te.startTime<=H)i(v),te.sortIndex=te.expirationTime,e(p,te);else break;te=t(v)}}function B(H){if(M=!1,V(H),!N)if(t(p)!==null)N=!0,ee||(ee=!0,P());else{var te=t(v);te!==null&&ae(B,te.startTime-H)}}var ee=!1,D=-1,A=5,R=-1;function I(){return S?!0:!(s.unstable_now()-R<A)}function k(){if(S=!1,ee){var H=s.unstable_now();R=H;var te=!0;try{e:{N=!1,M&&(M=!1,$(D),D=-1),C=!0;var ce=x;try{t:{for(V(H),T=t(p);T!==null&&!(T.expirationTime>H&&I());){var ge=T.callback;if(typeof ge=="function"){T.callback=null,x=T.priorityLevel;var q=ge(T.expirationTime<=H);if(H=s.unstable_now(),typeof q=="function"){T.callback=q,V(H),te=!0;break t}T===t(p)&&i(p),V(H)}else i(p);T=t(p)}if(T!==null)te=!0;else{var ne=t(v);ne!==null&&ae(B,ne.startTime-H),te=!1}}break e}finally{T=null,x=ce,C=!1}te=void 0}}finally{te?P():ee=!1}}}var P;if(typeof F=="function")P=function(){F(k)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,Ve=O.port2;O.port1.onmessage=k,P=function(){Ve.postMessage(null)}}else P=function(){U(k,0)};function ae(H,te){D=U(function(){H(s.unstable_now())},te)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(H){H.callback=null},s.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<H?Math.floor(1e3/H):5},s.unstable_getCurrentPriorityLevel=function(){return x},s.unstable_next=function(H){switch(x){case 1:case 2:case 3:var te=3;break;default:te=x}var ce=x;x=te;try{return H()}finally{x=ce}},s.unstable_requestPaint=function(){S=!0},s.unstable_runWithPriority=function(H,te){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var ce=x;x=H;try{return te()}finally{x=ce}},s.unstable_scheduleCallback=function(H,te,ce){var ge=s.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?ge+ce:ge):ce=ge,H){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=ce+q,H={id:_++,callback:te,priorityLevel:H,startTime:ce,expirationTime:q,sortIndex:-1},ce>ge?(H.sortIndex=ce,e(v,H),t(p)===null&&H===t(v)&&(M?($(D),D=-1):M=!0,ae(B,ce-ge))):(H.sortIndex=q,e(p,H),N||C||(N=!0,ee||(ee=!0,P()))),H},s.unstable_shouldYield=I,s.unstable_wrapCallback=function(H){var te=x;return function(){var ce=x;x=te;try{return H.apply(this,arguments)}finally{x=ce}}}}(hp)),hp}var XE;function Mw(){return XE||(XE=1,dp.exports=Ow()),dp.exports}var fp={exports:{}},un={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WE;function Pw(){if(WE)return un;WE=1;var s=fg();function e(p){var v="https://react.dev/errors/"+p;if(1<arguments.length){v+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)v+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+p+"; visit "+v+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(p,v,_){var T=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:T==null?null:""+T,children:p,containerInfo:v,implementation:_}}var d=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(p,v){if(p==="font")return"";if(typeof v=="string")return v==="use-credentials"?v:""}return un.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,un.createPortal=function(p,v){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!v||v.nodeType!==1&&v.nodeType!==9&&v.nodeType!==11)throw Error(e(299));return c(p,v,null,_)},un.flushSync=function(p){var v=d.T,_=i.p;try{if(d.T=null,i.p=2,p)return p()}finally{d.T=v,i.p=_,i.d.f()}},un.preconnect=function(p,v){typeof p=="string"&&(v?(v=v.crossOrigin,v=typeof v=="string"?v==="use-credentials"?v:"":void 0):v=null,i.d.C(p,v))},un.prefetchDNS=function(p){typeof p=="string"&&i.d.D(p)},un.preinit=function(p,v){if(typeof p=="string"&&v&&typeof v.as=="string"){var _=v.as,T=m(_,v.crossOrigin),x=typeof v.integrity=="string"?v.integrity:void 0,C=typeof v.fetchPriority=="string"?v.fetchPriority:void 0;_==="style"?i.d.S(p,typeof v.precedence=="string"?v.precedence:void 0,{crossOrigin:T,integrity:x,fetchPriority:C}):_==="script"&&i.d.X(p,{crossOrigin:T,integrity:x,fetchPriority:C,nonce:typeof v.nonce=="string"?v.nonce:void 0})}},un.preinitModule=function(p,v){if(typeof p=="string")if(typeof v=="object"&&v!==null){if(v.as==null||v.as==="script"){var _=m(v.as,v.crossOrigin);i.d.M(p,{crossOrigin:_,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0})}}else v==null&&i.d.M(p)},un.preload=function(p,v){if(typeof p=="string"&&typeof v=="object"&&v!==null&&typeof v.as=="string"){var _=v.as,T=m(_,v.crossOrigin);i.d.L(p,_,{crossOrigin:T,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0,type:typeof v.type=="string"?v.type:void 0,fetchPriority:typeof v.fetchPriority=="string"?v.fetchPriority:void 0,referrerPolicy:typeof v.referrerPolicy=="string"?v.referrerPolicy:void 0,imageSrcSet:typeof v.imageSrcSet=="string"?v.imageSrcSet:void 0,imageSizes:typeof v.imageSizes=="string"?v.imageSizes:void 0,media:typeof v.media=="string"?v.media:void 0})}},un.preloadModule=function(p,v){if(typeof p=="string")if(v){var _=m(v.as,v.crossOrigin);i.d.m(p,{as:typeof v.as=="string"&&v.as!=="script"?v.as:void 0,crossOrigin:_,integrity:typeof v.integrity=="string"?v.integrity:void 0})}else i.d.m(p)},un.requestFormReset=function(p){i.d.r(p)},un.unstable_batchedUpdates=function(p,v){return p(v)},un.useFormState=function(p,v,_){return d.H.useFormState(p,v,_)},un.useFormStatus=function(){return d.H.useHostTransitionStatus()},un.version="19.1.0",un}var ZE;function kw(){if(ZE)return fp.exports;ZE=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),fp.exports=Pw(),fp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JE;function Vw(){if(JE)return yc;JE=1;var s=Mw(),e=fg(),t=kw();function i(n){var a="https://react.dev/errors/"+n;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+n+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function c(n){var a=n,l=n;if(n.alternate)for(;a.return;)a=a.return;else{n=a;do a=n,(a.flags&4098)!==0&&(l=a.return),n=a.return;while(n)}return a.tag===3?l:null}function d(n){if(n.tag===13){var a=n.memoizedState;if(a===null&&(n=n.alternate,n!==null&&(a=n.memoizedState)),a!==null)return a.dehydrated}return null}function m(n){if(c(n)!==n)throw Error(i(188))}function p(n){var a=n.alternate;if(!a){if(a=c(n),a===null)throw Error(i(188));return a!==n?null:n}for(var l=n,u=a;;){var f=l.return;if(f===null)break;var g=f.alternate;if(g===null){if(u=f.return,u!==null){l=u;continue}break}if(f.child===g.child){for(g=f.child;g;){if(g===l)return m(f),n;if(g===u)return m(f),a;g=g.sibling}throw Error(i(188))}if(l.return!==u.return)l=f,u=g;else{for(var b=!1,w=f.child;w;){if(w===l){b=!0,l=f,u=g;break}if(w===u){b=!0,u=f,l=g;break}w=w.sibling}if(!b){for(w=g.child;w;){if(w===l){b=!0,l=g,u=f;break}if(w===u){b=!0,u=g,l=f;break}w=w.sibling}if(!b)throw Error(i(189))}}if(l.alternate!==u)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?n:a}function v(n){var a=n.tag;if(a===5||a===26||a===27||a===6)return n;for(n=n.child;n!==null;){if(a=v(n),a!==null)return a;n=n.sibling}return null}var _=Object.assign,T=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),U=Symbol.for("react.provider"),$=Symbol.for("react.consumer"),F=Symbol.for("react.context"),V=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),ee=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),k=Symbol.iterator;function P(n){return n===null||typeof n!="object"?null:(n=k&&n[k]||n["@@iterator"],typeof n=="function"?n:null)}var O=Symbol.for("react.client.reference");function Ve(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===O?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case N:return"Fragment";case S:return"Profiler";case M:return"StrictMode";case B:return"Suspense";case ee:return"SuspenseList";case R:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case C:return"Portal";case F:return(n.displayName||"Context")+".Provider";case $:return(n._context.displayName||"Context")+".Consumer";case V:var a=n.render;return n=n.displayName,n||(n=a.displayName||a.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case D:return a=n.displayName||null,a!==null?a:Ve(n.type)||"Memo";case A:a=n._payload,n=n._init;try{return Ve(n(a))}catch{}}return null}var ae=Array.isArray,H=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,te=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce={pending:!1,data:null,method:null,action:null},ge=[],q=-1;function ne(n){return{current:n}}function he(n){0>q||(n.current=ge[q],ge[q]=null,q--)}function ue(n,a){q++,ge[q]=n.current,n.current=a}var be=ne(null),Pe=ne(null),Ce=ne(null),qt=ne(null);function ot(n,a){switch(ue(Ce,a),ue(Pe,n),ue(be,null),a.nodeType){case 9:case 11:n=(n=a.documentElement)&&(n=n.namespaceURI)?_E(n):0;break;default:if(n=a.tagName,a=a.namespaceURI)a=_E(a),n=EE(a,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}he(be),ue(be,n)}function bs(){he(be),he(Pe),he(Ce)}function Oa(n){n.memoizedState!==null&&ue(qt,n);var a=be.current,l=EE(a,n.type);a!==l&&(ue(Pe,n),ue(be,l))}function Xs(n){Pe.current===n&&(he(be),he(Pe)),qt.current===n&&(he(qt),hc._currentValue=ce)}var ki=Object.prototype.hasOwnProperty,Vi=s.unstable_scheduleCallback,Li=s.unstable_cancelCallback,cl=s.unstable_shouldYield,pu=s.unstable_requestPaint,$n=s.unstable_now,lf=s.unstable_getCurrentPriorityLevel,ul=s.unstable_ImmediatePriority,Lr=s.unstable_UserBlockingPriority,Ui=s.unstable_NormalPriority,cf=s.unstable_LowPriority,Ur=s.unstable_IdlePriority,dl=s.log,gu=s.unstable_setDisableYieldValue,yt=null,Ze=null;function Dn(n){if(typeof dl=="function"&&gu(n),Ze&&typeof Ze.setStrictMode=="function")try{Ze.setStrictMode(yt,n)}catch{}}var ln=Math.clz32?Math.clz32:Fi,vu=Math.log,uf=Math.LN2;function Fi(n){return n>>>=0,n===0?32:31-(vu(n)/uf|0)|0}var qi=256,Bi=4194304;function ls(n){var a=n&42;if(a!==0)return a;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Fr(n,a,l){var u=n.pendingLanes;if(u===0)return 0;var f=0,g=n.suspendedLanes,b=n.pingedLanes;n=n.warmLanes;var w=u&134217727;return w!==0?(u=w&~g,u!==0?f=ls(u):(b&=w,b!==0?f=ls(b):l||(l=w&~n,l!==0&&(f=ls(l))))):(w=u&~g,w!==0?f=ls(w):b!==0?f=ls(b):l||(l=u&~n,l!==0&&(f=ls(l)))),f===0?0:a!==0&&a!==f&&(a&g)===0&&(g=f&-f,l=a&-a,g>=l||g===32&&(l&4194048)!==0)?a:f}function zi(n,a){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&a)===0}function hl(n,a){switch(n){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fl(){var n=qi;return qi<<=1,(qi&4194048)===0&&(qi=256),n}function ml(){var n=Bi;return Bi<<=1,(Bi&62914560)===0&&(Bi=4194304),n}function Ws(n){for(var a=[],l=0;31>l;l++)a.push(n);return a}function Zs(n,a){n.pendingLanes|=a,a!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function pl(n,a,l,u,f,g){var b=n.pendingLanes;n.pendingLanes=l,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=l,n.entangledLanes&=l,n.errorRecoveryDisabledLanes&=l,n.shellSuspendCounter=0;var w=n.entanglements,L=n.expirationTimes,Q=n.hiddenUpdates;for(l=b&~l;0<l;){var se=31-ln(l),oe=1<<se;w[se]=0,L[se]=-1;var X=Q[se];if(X!==null)for(Q[se]=null,se=0;se<X.length;se++){var Z=X[se];Z!==null&&(Z.lane&=-536870913)}l&=~oe}u!==0&&Ts(n,u,0),g!==0&&f===0&&n.tag!==0&&(n.suspendedLanes|=g&~(b&~a))}function Ts(n,a,l){n.pendingLanes|=a,n.suspendedLanes&=~a;var u=31-ln(a);n.entangledLanes|=a,n.entanglements[u]=n.entanglements[u]|1073741824|l&4194090}function gl(n,a){var l=n.entangledLanes|=a;for(n=n.entanglements;l;){var u=31-ln(l),f=1<<u;f&a|n[u]&a&&(n[u]|=a),l&=~f}}function Ma(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function qr(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Pa(){var n=te.p;return n!==0?n:(n=window.event,n===void 0?32:UE(n.type))}function yu(n,a){var l=te.p;try{return te.p=n,a()}finally{te.p=l}}var dt=Math.random().toString(36).slice(2),Dt="__reactFiber$"+dt,St="__reactProps$"+dt,Kn="__reactContainer$"+dt,vl="__reactEvents$"+dt,df="__reactListeners$"+dt,ka="__reactHandles$"+dt,_u="__reactResources$"+dt,Hi="__reactMarker$"+dt;function Va(n){delete n[Dt],delete n[St],delete n[vl],delete n[df],delete n[ka]}function Js(n){var a=n[Dt];if(a)return a;for(var l=n.parentNode;l;){if(a=l[Kn]||l[Dt]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(n=xE(n);n!==null;){if(l=n[Dt])return l;n=xE(n)}return a}n=l,l=n.parentNode}return null}function Ns(n){if(n=n[Dt]||n[Kn]){var a=n.tag;if(a===5||a===6||a===13||a===26||a===27||a===3)return n}return null}function xs(n){var a=n.tag;if(a===5||a===26||a===27||a===6)return n.stateNode;throw Error(i(33))}function gn(n){var a=n[_u];return a||(a=n[_u]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Tt(n){n[Hi]=!0}var yl=new Set,Br={};function cs(n,a){ea(n,a),ea(n+"Capture",a)}function ea(n,a){for(Br[n]=a,n=0;n<a.length;n++)yl.add(a[n])}var Eu=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),bu={},Gi={};function Tu(n){return ki.call(Gi,n)?!0:ki.call(bu,n)?!1:Eu.test(n)?Gi[n]=!0:(bu[n]=!0,!1)}function La(n,a,l){if(Tu(a))if(l===null)n.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":n.removeAttribute(a);return;case"boolean":var u=a.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){n.removeAttribute(a);return}}n.setAttribute(a,""+l)}}function As(n,a,l){if(l===null)n.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(a);return}n.setAttribute(a,""+l)}}function Qt(n,a,l,u){if(u===null)n.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(l);return}n.setAttributeNS(a,l,""+u)}}var $i,Nu;function ta(n){if($i===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);$i=a&&a[1]||"",Nu=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+$i+n+Nu}var zr=!1;function Hr(n,a){if(!n||zr)return"";zr=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(a){var oe=function(){throw Error()};if(Object.defineProperty(oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(oe,[])}catch(Z){var X=Z}Reflect.construct(n,[],oe)}else{try{oe.call()}catch(Z){X=Z}n.call(oe.prototype)}}else{try{throw Error()}catch(Z){X=Z}(oe=n())&&typeof oe.catch=="function"&&oe.catch(function(){})}}catch(Z){if(Z&&X&&typeof Z.stack=="string")return[Z.stack,X.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=u.DetermineComponentFrameRoot(),b=g[0],w=g[1];if(b&&w){var L=b.split(`
`),Q=w.split(`
`);for(f=u=0;u<L.length&&!L[u].includes("DetermineComponentFrameRoot");)u++;for(;f<Q.length&&!Q[f].includes("DetermineComponentFrameRoot");)f++;if(u===L.length||f===Q.length)for(u=L.length-1,f=Q.length-1;1<=u&&0<=f&&L[u]!==Q[f];)f--;for(;1<=u&&0<=f;u--,f--)if(L[u]!==Q[f]){if(u!==1||f!==1)do if(u--,f--,0>f||L[u]!==Q[f]){var se=`
`+L[u].replace(" at new "," at ");return n.displayName&&se.includes("<anonymous>")&&(se=se.replace("<anonymous>",n.displayName)),se}while(1<=u&&0<=f);break}}}finally{zr=!1,Error.prepareStackTrace=l}return(l=n?n.displayName||n.name:"")?ta(l):""}function _l(n){switch(n.tag){case 26:case 27:case 5:return ta(n.type);case 16:return ta("Lazy");case 13:return ta("Suspense");case 19:return ta("SuspenseList");case 0:case 15:return Hr(n.type,!1);case 11:return Hr(n.type.render,!1);case 1:return Hr(n.type,!0);case 31:return ta("Activity");default:return""}}function Gr(n){try{var a="";do a+=_l(n),n=n.return;while(n);return a}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function vn(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function El(n){var a=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function hf(n){var a=El(n)?"checked":"value",l=Object.getOwnPropertyDescriptor(n.constructor.prototype,a),u=""+n[a];if(!n.hasOwnProperty(a)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var f=l.get,g=l.set;return Object.defineProperty(n,a,{configurable:!0,get:function(){return f.call(this)},set:function(b){u=""+b,g.call(this,b)}}),Object.defineProperty(n,a,{enumerable:l.enumerable}),{getValue:function(){return u},setValue:function(b){u=""+b},stopTracking:function(){n._valueTracker=null,delete n[a]}}}}function $r(n){n._valueTracker||(n._valueTracker=hf(n))}function bl(n){if(!n)return!1;var a=n._valueTracker;if(!a)return!0;var l=a.getValue(),u="";return n&&(u=El(n)?n.checked?"true":"false":n.value),n=u,n!==l?(a.setValue(n),!0):!1}function Ki(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var ff=/[\n"\\]/g;function wt(n){return n.replace(ff,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function On(n,a,l,u,f,g,b,w){n.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?n.type=b:n.removeAttribute("type"),a!=null?b==="number"?(a===0&&n.value===""||n.value!=a)&&(n.value=""+vn(a)):n.value!==""+vn(a)&&(n.value=""+vn(a)):b!=="submit"&&b!=="reset"||n.removeAttribute("value"),a!=null?Ua(n,b,vn(a)):l!=null?Ua(n,b,vn(l)):u!=null&&n.removeAttribute("value"),f==null&&g!=null&&(n.defaultChecked=!!g),f!=null&&(n.checked=f&&typeof f!="function"&&typeof f!="symbol"),w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?n.name=""+vn(w):n.removeAttribute("name")}function Yi(n,a,l,u,f,g,b,w){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(n.type=g),a!=null||l!=null){if(!(g!=="submit"&&g!=="reset"||a!=null))return;l=l!=null?""+vn(l):"",a=a!=null?""+vn(a):l,w||a===n.value||(n.value=a),n.defaultValue=a}u=u??f,u=typeof u!="function"&&typeof u!="symbol"&&!!u,n.checked=w?n.checked:!!u,n.defaultChecked=!!u,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(n.name=b)}function Ua(n,a,l){a==="number"&&Ki(n.ownerDocument)===n||n.defaultValue===""+l||(n.defaultValue=""+l)}function na(n,a,l,u){if(n=n.options,a){a={};for(var f=0;f<l.length;f++)a["$"+l[f]]=!0;for(l=0;l<n.length;l++)f=a.hasOwnProperty("$"+n[l].value),n[l].selected!==f&&(n[l].selected=f),f&&u&&(n[l].defaultSelected=!0)}else{for(l=""+vn(l),a=null,f=0;f<n.length;f++){if(n[f].value===l){n[f].selected=!0,u&&(n[f].defaultSelected=!0);return}a!==null||n[f].disabled||(a=n[f])}a!==null&&(a.selected=!0)}}function tt(n,a,l){if(a!=null&&(a=""+vn(a),a!==n.value&&(n.value=a),l==null)){n.defaultValue!==a&&(n.defaultValue=a);return}n.defaultValue=l!=null?""+vn(l):""}function Qi(n,a,l,u){if(a==null){if(u!=null){if(l!=null)throw Error(i(92));if(ae(u)){if(1<u.length)throw Error(i(93));u=u[0]}l=u}l==null&&(l=""),a=l}l=vn(a),n.defaultValue=l,u=n.textContent,u===l&&u!==""&&u!==null&&(n.value=u)}function Yn(n,a){if(a){var l=n.firstChild;if(l&&l===n.lastChild&&l.nodeType===3){l.nodeValue=a;return}}n.textContent=a}var Xi=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function xu(n,a,l){var u=a.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?n.setProperty(a,""):a==="float"?n.cssFloat="":n[a]="":u?n.setProperty(a,l):typeof l!="number"||l===0||Xi.has(a)?a==="float"?n.cssFloat=l:n[a]=(""+l).trim():n[a]=l+"px"}function Tl(n,a,l){if(a!=null&&typeof a!="object")throw Error(i(62));if(n=n.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||a!=null&&a.hasOwnProperty(u)||(u.indexOf("--")===0?n.setProperty(u,""):u==="float"?n.cssFloat="":n[u]="");for(var f in a)u=a[f],a.hasOwnProperty(f)&&l[f]!==u&&xu(n,f,u)}else for(var g in a)a.hasOwnProperty(g)&&xu(n,g,a[g])}function Nl(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),pf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Kr(n){return pf.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}var sa=null;function Qn(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var aa=null,ia=null;function xl(n){var a=Ns(n);if(a&&(n=a.stateNode)){var l=n[St]||null;e:switch(n=a.stateNode,a.type){case"input":if(On(n,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),a=l.name,l.type==="radio"&&a!=null){for(l=n;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+wt(""+a)+'"][type="radio"]'),a=0;a<l.length;a++){var u=l[a];if(u!==n&&u.form===n.form){var f=u[St]||null;if(!f)throw Error(i(90));On(u,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(a=0;a<l.length;a++)u=l[a],u.form===n.form&&bl(u)}break e;case"textarea":tt(n,l.value,l.defaultValue);break e;case"select":a=l.value,a!=null&&na(n,!!l.multiple,a,!1)}}}var Ss=!1;function Au(n,a,l){if(Ss)return n(a,l);Ss=!0;try{var u=n(a);return u}finally{if(Ss=!1,(aa!==null||ia!==null)&&(yd(),aa&&(a=aa,n=ia,ia=aa=null,xl(a),n)))for(a=0;a<n.length;a++)xl(n[a])}}function Wi(n,a){var l=n.stateNode;if(l===null)return null;var u=l[St]||null;if(u===null)return null;l=u[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(n=n.type,u=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!u;break e;default:n=!1}if(n)return null;if(l&&typeof l!="function")throw Error(i(231,a,typeof l));return l}var us=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xn=!1;if(us)try{var Zi={};Object.defineProperty(Zi,"passive",{get:function(){Xn=!0}}),window.addEventListener("test",Zi,Zi),window.removeEventListener("test",Zi,Zi)}catch{Xn=!1}var ws=null,Fa=null,ra=null;function Al(){if(ra)return ra;var n,a=Fa,l=a.length,u,f="value"in ws?ws.value:ws.textContent,g=f.length;for(n=0;n<l&&a[n]===f[n];n++);var b=l-n;for(u=1;u<=b&&a[l-u]===f[g-u];u++);return ra=f.slice(n,1<u?1-u:void 0)}function Cs(n){var a=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&a===13&&(n=13)):n=a,n===10&&(n=13),32<=n||n===13?n:0}function js(){return!0}function Sl(){return!1}function Bt(n){function a(l,u,f,g,b){this._reactName=l,this._targetInst=f,this.type=u,this.nativeEvent=g,this.target=b,this.currentTarget=null;for(var w in n)n.hasOwnProperty(w)&&(l=n[w],this[w]=l?l(g):g[w]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?js:Sl,this.isPropagationStopped=Sl,this}return _(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=js)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=js)},persist:function(){},isPersistent:js}),a}var We={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Yr=Bt(We),Ji=_({},We,{view:0,detail:0}),Su=Bt(Ji),Qr,Xr,Is,er=_({},Ji,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sr,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Is&&(Is&&n.type==="mousemove"?(Qr=n.screenX-Is.screenX,Xr=n.screenY-Is.screenY):Xr=Qr=0,Is=n),Qr)},movementY:function(n){return"movementY"in n?n.movementY:Xr}}),Wn=Bt(er),wu=_({},er,{dataTransfer:0}),gf=Bt(wu),tr=_({},Ji,{relatedTarget:0}),Wr=Bt(tr),wl=_({},We,{animationName:0,elapsedTime:0,pseudoElement:0}),Zr=Bt(wl),Cu=_({},We,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Jr=Bt(Cu),vf=_({},We,{data:0}),Cl=Bt(vf),nr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ju={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Iu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jl(n){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(n):(n=Iu[n])?!!a[n]:!1}function sr(){return jl}var Ru=_({},Ji,{key:function(n){if(n.key){var a=nr[n.key]||n.key;if(a!=="Unidentified")return a}return n.type==="keypress"?(n=Cs(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?ju[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sr,charCode:function(n){return n.type==="keypress"?Cs(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Cs(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),eo=Bt(Ru),Du=_({},er,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Il=Bt(Du),oa=_({},Ji,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sr}),Ou=Bt(oa),Mu=_({},We,{propertyName:0,elapsedTime:0,pseudoElement:0}),Pu=Bt(Mu),ku=_({},er,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),to=Bt(ku),yn=_({},We,{newState:0,oldState:0}),Vu=Bt(yn),Lu=[9,13,27,32],Rs=us&&"CompositionEvent"in window,h=null;us&&"documentMode"in document&&(h=document.documentMode);var y=us&&"TextEvent"in window&&!h,E=us&&(!Rs||h&&8<h&&11>=h),j=" ",K=!1;function J(n,a){switch(n){case"keyup":return Lu.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function de(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var ze=!1;function Ot(n,a){switch(n){case"compositionend":return de(a);case"keypress":return a.which!==32?null:(K=!0,j);case"textInput":return n=a.data,n===j&&K?null:n;default:return null}}function He(n,a){if(ze)return n==="compositionend"||!Rs&&J(n,a)?(n=Al(),ra=Fa=ws=null,ze=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return E&&a.locale!=="ko"?null:a.data;default:return null}}var zt={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mt(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a==="input"?!!zt[n.type]:a==="textarea"}function la(n,a,l,u){aa?ia?ia.push(u):ia=[u]:aa=u,a=xd(a,"onChange"),0<a.length&&(l=new Yr("onChange","change",null,l,u),n.push({event:l,listeners:a}))}var Xt=null,Ds=null;function Rl(n){mE(n,0)}function Uu(n){var a=xs(n);if(bl(a))return n}function Pv(n,a){if(n==="change")return a}var kv=!1;if(us){var yf;if(us){var _f="oninput"in document;if(!_f){var Vv=document.createElement("div");Vv.setAttribute("oninput","return;"),_f=typeof Vv.oninput=="function"}yf=_f}else yf=!1;kv=yf&&(!document.documentMode||9<document.documentMode)}function Lv(){Xt&&(Xt.detachEvent("onpropertychange",Uv),Ds=Xt=null)}function Uv(n){if(n.propertyName==="value"&&Uu(Ds)){var a=[];la(a,Ds,n,Qn(n)),Au(Rl,a)}}function rS(n,a,l){n==="focusin"?(Lv(),Xt=a,Ds=l,Xt.attachEvent("onpropertychange",Uv)):n==="focusout"&&Lv()}function oS(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Uu(Ds)}function lS(n,a){if(n==="click")return Uu(a)}function cS(n,a){if(n==="input"||n==="change")return Uu(a)}function uS(n,a){return n===a&&(n!==0||1/n===1/a)||n!==n&&a!==a}var Mn=typeof Object.is=="function"?Object.is:uS;function Dl(n,a){if(Mn(n,a))return!0;if(typeof n!="object"||n===null||typeof a!="object"||a===null)return!1;var l=Object.keys(n),u=Object.keys(a);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var f=l[u];if(!ki.call(a,f)||!Mn(n[f],a[f]))return!1}return!0}function Fv(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function qv(n,a){var l=Fv(n);n=0;for(var u;l;){if(l.nodeType===3){if(u=n+l.textContent.length,n<=a&&u>=a)return{node:l,offset:a-n};n=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Fv(l)}}function Bv(n,a){return n&&a?n===a?!0:n&&n.nodeType===3?!1:a&&a.nodeType===3?Bv(n,a.parentNode):"contains"in n?n.contains(a):n.compareDocumentPosition?!!(n.compareDocumentPosition(a)&16):!1:!1}function zv(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var a=Ki(n.document);a instanceof n.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)n=a.contentWindow;else break;a=Ki(n.document)}return a}function Ef(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a&&(a==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||a==="textarea"||n.contentEditable==="true")}var dS=us&&"documentMode"in document&&11>=document.documentMode,no=null,bf=null,Ol=null,Tf=!1;function Hv(n,a,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Tf||no==null||no!==Ki(u)||(u=no,"selectionStart"in u&&Ef(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Ol&&Dl(Ol,u)||(Ol=u,u=xd(bf,"onSelect"),0<u.length&&(a=new Yr("onSelect","select",null,a,l),n.push({event:a,listeners:u}),a.target=no)))}function ar(n,a){var l={};return l[n.toLowerCase()]=a.toLowerCase(),l["Webkit"+n]="webkit"+a,l["Moz"+n]="moz"+a,l}var so={animationend:ar("Animation","AnimationEnd"),animationiteration:ar("Animation","AnimationIteration"),animationstart:ar("Animation","AnimationStart"),transitionrun:ar("Transition","TransitionRun"),transitionstart:ar("Transition","TransitionStart"),transitioncancel:ar("Transition","TransitionCancel"),transitionend:ar("Transition","TransitionEnd")},Nf={},Gv={};us&&(Gv=document.createElement("div").style,"AnimationEvent"in window||(delete so.animationend.animation,delete so.animationiteration.animation,delete so.animationstart.animation),"TransitionEvent"in window||delete so.transitionend.transition);function ir(n){if(Nf[n])return Nf[n];if(!so[n])return n;var a=so[n],l;for(l in a)if(a.hasOwnProperty(l)&&l in Gv)return Nf[n]=a[l];return n}var $v=ir("animationend"),Kv=ir("animationiteration"),Yv=ir("animationstart"),hS=ir("transitionrun"),fS=ir("transitionstart"),mS=ir("transitioncancel"),Qv=ir("transitionend"),Xv=new Map,xf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");xf.push("scrollEnd");function ds(n,a){Xv.set(n,a),cs(a,[n])}var Wv=new WeakMap;function Zn(n,a){if(typeof n=="object"&&n!==null){var l=Wv.get(n);return l!==void 0?l:(a={value:n,source:a,stack:Gr(a)},Wv.set(n,a),a)}return{value:n,source:a,stack:Gr(a)}}var Jn=[],ao=0,Af=0;function Fu(){for(var n=ao,a=Af=ao=0;a<n;){var l=Jn[a];Jn[a++]=null;var u=Jn[a];Jn[a++]=null;var f=Jn[a];Jn[a++]=null;var g=Jn[a];if(Jn[a++]=null,u!==null&&f!==null){var b=u.pending;b===null?f.next=f:(f.next=b.next,b.next=f),u.pending=f}g!==0&&Zv(l,f,g)}}function qu(n,a,l,u){Jn[ao++]=n,Jn[ao++]=a,Jn[ao++]=l,Jn[ao++]=u,Af|=u,n.lanes|=u,n=n.alternate,n!==null&&(n.lanes|=u)}function Sf(n,a,l,u){return qu(n,a,l,u),Bu(n)}function io(n,a){return qu(n,null,null,a),Bu(n)}function Zv(n,a,l){n.lanes|=l;var u=n.alternate;u!==null&&(u.lanes|=l);for(var f=!1,g=n.return;g!==null;)g.childLanes|=l,u=g.alternate,u!==null&&(u.childLanes|=l),g.tag===22&&(n=g.stateNode,n===null||n._visibility&1||(f=!0)),n=g,g=g.return;return n.tag===3?(g=n.stateNode,f&&a!==null&&(f=31-ln(l),n=g.hiddenUpdates,u=n[f],u===null?n[f]=[a]:u.push(a),a.lane=l|536870912),g):null}function Bu(n){if(50<ac)throw ac=0,Dm=null,Error(i(185));for(var a=n.return;a!==null;)n=a,a=n.return;return n.tag===3?n.stateNode:null}var ro={};function pS(n,a,l,u){this.tag=n,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pn(n,a,l,u){return new pS(n,a,l,u)}function wf(n){return n=n.prototype,!(!n||!n.isReactComponent)}function ca(n,a){var l=n.alternate;return l===null?(l=Pn(n.tag,a,n.key,n.mode),l.elementType=n.elementType,l.type=n.type,l.stateNode=n.stateNode,l.alternate=n,n.alternate=l):(l.pendingProps=a,l.type=n.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=n.flags&65011712,l.childLanes=n.childLanes,l.lanes=n.lanes,l.child=n.child,l.memoizedProps=n.memoizedProps,l.memoizedState=n.memoizedState,l.updateQueue=n.updateQueue,a=n.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=n.sibling,l.index=n.index,l.ref=n.ref,l.refCleanup=n.refCleanup,l}function Jv(n,a){n.flags&=65011714;var l=n.alternate;return l===null?(n.childLanes=0,n.lanes=a,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=l.childLanes,n.lanes=l.lanes,n.child=l.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=l.memoizedProps,n.memoizedState=l.memoizedState,n.updateQueue=l.updateQueue,n.type=l.type,a=l.dependencies,n.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),n}function zu(n,a,l,u,f,g){var b=0;if(u=n,typeof n=="function")wf(n)&&(b=1);else if(typeof n=="string")b=vw(n,l,be.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case R:return n=Pn(31,l,a,f),n.elementType=R,n.lanes=g,n;case N:return rr(l.children,f,g,a);case M:b=8,f|=24;break;case S:return n=Pn(12,l,a,f|2),n.elementType=S,n.lanes=g,n;case B:return n=Pn(13,l,a,f),n.elementType=B,n.lanes=g,n;case ee:return n=Pn(19,l,a,f),n.elementType=ee,n.lanes=g,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case U:case F:b=10;break e;case $:b=9;break e;case V:b=11;break e;case D:b=14;break e;case A:b=16,u=null;break e}b=29,l=Error(i(130,n===null?"null":typeof n,"")),u=null}return a=Pn(b,l,a,f),a.elementType=n,a.type=u,a.lanes=g,a}function rr(n,a,l,u){return n=Pn(7,n,u,a),n.lanes=l,n}function Cf(n,a,l){return n=Pn(6,n,null,a),n.lanes=l,n}function jf(n,a,l){return a=Pn(4,n.children!==null?n.children:[],n.key,a),a.lanes=l,a.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},a}var oo=[],lo=0,Hu=null,Gu=0,es=[],ts=0,or=null,ua=1,da="";function lr(n,a){oo[lo++]=Gu,oo[lo++]=Hu,Hu=n,Gu=a}function ey(n,a,l){es[ts++]=ua,es[ts++]=da,es[ts++]=or,or=n;var u=ua;n=da;var f=32-ln(u)-1;u&=~(1<<f),l+=1;var g=32-ln(a)+f;if(30<g){var b=f-f%5;g=(u&(1<<b)-1).toString(32),u>>=b,f-=b,ua=1<<32-ln(a)+f|l<<f|u,da=g+n}else ua=1<<g|l<<f|u,da=n}function If(n){n.return!==null&&(lr(n,1),ey(n,1,0))}function Rf(n){for(;n===Hu;)Hu=oo[--lo],oo[lo]=null,Gu=oo[--lo],oo[lo]=null;for(;n===or;)or=es[--ts],es[ts]=null,da=es[--ts],es[ts]=null,ua=es[--ts],es[ts]=null}var _n=null,_t=null,Qe=!1,cr=null,Os=!1,Df=Error(i(519));function ur(n){var a=Error(i(418,""));throw kl(Zn(a,n)),Df}function ty(n){var a=n.stateNode,l=n.type,u=n.memoizedProps;switch(a[Dt]=n,a[St]=u,l){case"dialog":Ue("cancel",a),Ue("close",a);break;case"iframe":case"object":case"embed":Ue("load",a);break;case"video":case"audio":for(l=0;l<rc.length;l++)Ue(rc[l],a);break;case"source":Ue("error",a);break;case"img":case"image":case"link":Ue("error",a),Ue("load",a);break;case"details":Ue("toggle",a);break;case"input":Ue("invalid",a),Yi(a,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),$r(a);break;case"select":Ue("invalid",a);break;case"textarea":Ue("invalid",a),Qi(a,u.value,u.defaultValue,u.children),$r(a)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||a.textContent===""+l||u.suppressHydrationWarning===!0||yE(a.textContent,l)?(u.popover!=null&&(Ue("beforetoggle",a),Ue("toggle",a)),u.onScroll!=null&&Ue("scroll",a),u.onScrollEnd!=null&&Ue("scrollend",a),u.onClick!=null&&(a.onclick=Ad),a=!0):a=!1,a||ur(n)}function ny(n){for(_n=n.return;_n;)switch(_n.tag){case 5:case 13:Os=!1;return;case 27:case 3:Os=!0;return;default:_n=_n.return}}function Ml(n){if(n!==_n)return!1;if(!Qe)return ny(n),Qe=!0,!1;var a=n.tag,l;if((l=a!==3&&a!==27)&&((l=a===5)&&(l=n.type,l=!(l!=="form"&&l!=="button")||Ym(n.type,n.memoizedProps)),l=!l),l&&_t&&ur(n),ny(n),a===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));e:{for(n=n.nextSibling,a=0;n;){if(n.nodeType===8)if(l=n.data,l==="/$"){if(a===0){_t=fs(n.nextSibling);break e}a--}else l!=="$"&&l!=="$!"&&l!=="$?"||a++;n=n.nextSibling}_t=null}}else a===27?(a=_t,ni(n.type)?(n=Zm,Zm=null,_t=n):_t=a):_t=_n?fs(n.stateNode.nextSibling):null;return!0}function Pl(){_t=_n=null,Qe=!1}function sy(){var n=cr;return n!==null&&(Sn===null?Sn=n:Sn.push.apply(Sn,n),cr=null),n}function kl(n){cr===null?cr=[n]:cr.push(n)}var Of=ne(null),dr=null,ha=null;function qa(n,a,l){ue(Of,a._currentValue),a._currentValue=l}function fa(n){n._currentValue=Of.current,he(Of)}function Mf(n,a,l){for(;n!==null;){var u=n.alternate;if((n.childLanes&a)!==a?(n.childLanes|=a,u!==null&&(u.childLanes|=a)):u!==null&&(u.childLanes&a)!==a&&(u.childLanes|=a),n===l)break;n=n.return}}function Pf(n,a,l,u){var f=n.child;for(f!==null&&(f.return=n);f!==null;){var g=f.dependencies;if(g!==null){var b=f.child;g=g.firstContext;e:for(;g!==null;){var w=g;g=f;for(var L=0;L<a.length;L++)if(w.context===a[L]){g.lanes|=l,w=g.alternate,w!==null&&(w.lanes|=l),Mf(g.return,l,n),u||(b=null);break e}g=w.next}}else if(f.tag===18){if(b=f.return,b===null)throw Error(i(341));b.lanes|=l,g=b.alternate,g!==null&&(g.lanes|=l),Mf(b,l,n),b=null}else b=f.child;if(b!==null)b.return=f;else for(b=f;b!==null;){if(b===n){b=null;break}if(f=b.sibling,f!==null){f.return=b.return,b=f;break}b=b.return}f=b}}function Vl(n,a,l,u){n=null;for(var f=a,g=!1;f!==null;){if(!g){if((f.flags&524288)!==0)g=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var b=f.alternate;if(b===null)throw Error(i(387));if(b=b.memoizedProps,b!==null){var w=f.type;Mn(f.pendingProps.value,b.value)||(n!==null?n.push(w):n=[w])}}else if(f===qt.current){if(b=f.alternate,b===null)throw Error(i(387));b.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(n!==null?n.push(hc):n=[hc])}f=f.return}n!==null&&Pf(a,n,l,u),a.flags|=262144}function $u(n){for(n=n.firstContext;n!==null;){if(!Mn(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function hr(n){dr=n,ha=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function cn(n){return ay(dr,n)}function Ku(n,a){return dr===null&&hr(n),ay(n,a)}function ay(n,a){var l=a._currentValue;if(a={context:a,memoizedValue:l,next:null},ha===null){if(n===null)throw Error(i(308));ha=a,n.dependencies={lanes:0,firstContext:a},n.flags|=524288}else ha=ha.next=a;return l}var gS=typeof AbortController<"u"?AbortController:function(){var n=[],a=this.signal={aborted:!1,addEventListener:function(l,u){n.push(u)}};this.abort=function(){a.aborted=!0,n.forEach(function(l){return l()})}},vS=s.unstable_scheduleCallback,yS=s.unstable_NormalPriority,Pt={$$typeof:F,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function kf(){return{controller:new gS,data:new Map,refCount:0}}function Ll(n){n.refCount--,n.refCount===0&&vS(yS,function(){n.controller.abort()})}var Ul=null,Vf=0,co=0,uo=null;function _S(n,a){if(Ul===null){var l=Ul=[];Vf=0,co=Um(),uo={status:"pending",value:void 0,then:function(u){l.push(u)}}}return Vf++,a.then(iy,iy),a}function iy(){if(--Vf===0&&Ul!==null){uo!==null&&(uo.status="fulfilled");var n=Ul;Ul=null,co=0,uo=null;for(var a=0;a<n.length;a++)(0,n[a])()}}function ES(n,a){var l=[],u={status:"pending",value:null,reason:null,then:function(f){l.push(f)}};return n.then(function(){u.status="fulfilled",u.value=a;for(var f=0;f<l.length;f++)(0,l[f])(a)},function(f){for(u.status="rejected",u.reason=f,f=0;f<l.length;f++)(0,l[f])(void 0)}),u}var ry=H.S;H.S=function(n,a){typeof a=="object"&&a!==null&&typeof a.then=="function"&&_S(n,a),ry!==null&&ry(n,a)};var fr=ne(null);function Lf(){var n=fr.current;return n!==null?n:lt.pooledCache}function Yu(n,a){a===null?ue(fr,fr.current):ue(fr,a.pool)}function oy(){var n=Lf();return n===null?null:{parent:Pt._currentValue,pool:n}}var Fl=Error(i(460)),ly=Error(i(474)),Qu=Error(i(542)),Uf={then:function(){}};function cy(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Xu(){}function uy(n,a,l){switch(l=n[l],l===void 0?n.push(a):l!==a&&(a.then(Xu,Xu),a=l),a.status){case"fulfilled":return a.value;case"rejected":throw n=a.reason,hy(n),n;default:if(typeof a.status=="string")a.then(Xu,Xu);else{if(n=lt,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=a,n.status="pending",n.then(function(u){if(a.status==="pending"){var f=a;f.status="fulfilled",f.value=u}},function(u){if(a.status==="pending"){var f=a;f.status="rejected",f.reason=u}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw n=a.reason,hy(n),n}throw ql=a,Fl}}var ql=null;function dy(){if(ql===null)throw Error(i(459));var n=ql;return ql=null,n}function hy(n){if(n===Fl||n===Qu)throw Error(i(483))}var Ba=!1;function Ff(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function qf(n,a){n=n.updateQueue,a.updateQueue===n&&(a.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function za(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Ha(n,a,l){var u=n.updateQueue;if(u===null)return null;if(u=u.shared,(Je&2)!==0){var f=u.pending;return f===null?a.next=a:(a.next=f.next,f.next=a),u.pending=a,a=Bu(n),Zv(n,null,l),a}return qu(n,u,a,l),Bu(n)}function Bl(n,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194048)!==0)){var u=a.lanes;u&=n.pendingLanes,l|=u,a.lanes=l,gl(n,l)}}function Bf(n,a){var l=n.updateQueue,u=n.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var f=null,g=null;if(l=l.firstBaseUpdate,l!==null){do{var b={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};g===null?f=g=b:g=g.next=b,l=l.next}while(l!==null);g===null?f=g=a:g=g.next=a}else f=g=a;l={baseState:u.baseState,firstBaseUpdate:f,lastBaseUpdate:g,shared:u.shared,callbacks:u.callbacks},n.updateQueue=l;return}n=l.lastBaseUpdate,n===null?l.firstBaseUpdate=a:n.next=a,l.lastBaseUpdate=a}var zf=!1;function zl(){if(zf){var n=uo;if(n!==null)throw n}}function Hl(n,a,l,u){zf=!1;var f=n.updateQueue;Ba=!1;var g=f.firstBaseUpdate,b=f.lastBaseUpdate,w=f.shared.pending;if(w!==null){f.shared.pending=null;var L=w,Q=L.next;L.next=null,b===null?g=Q:b.next=Q,b=L;var se=n.alternate;se!==null&&(se=se.updateQueue,w=se.lastBaseUpdate,w!==b&&(w===null?se.firstBaseUpdate=Q:w.next=Q,se.lastBaseUpdate=L))}if(g!==null){var oe=f.baseState;b=0,se=Q=L=null,w=g;do{var X=w.lane&-536870913,Z=X!==w.lane;if(Z?(Ge&X)===X:(u&X)===X){X!==0&&X===co&&(zf=!0),se!==null&&(se=se.next={lane:0,tag:w.tag,payload:w.payload,callback:null,next:null});e:{var we=n,Ne=w;X=a;var at=l;switch(Ne.tag){case 1:if(we=Ne.payload,typeof we=="function"){oe=we.call(at,oe,X);break e}oe=we;break e;case 3:we.flags=we.flags&-65537|128;case 0:if(we=Ne.payload,X=typeof we=="function"?we.call(at,oe,X):we,X==null)break e;oe=_({},oe,X);break e;case 2:Ba=!0}}X=w.callback,X!==null&&(n.flags|=64,Z&&(n.flags|=8192),Z=f.callbacks,Z===null?f.callbacks=[X]:Z.push(X))}else Z={lane:X,tag:w.tag,payload:w.payload,callback:w.callback,next:null},se===null?(Q=se=Z,L=oe):se=se.next=Z,b|=X;if(w=w.next,w===null){if(w=f.shared.pending,w===null)break;Z=w,w=Z.next,Z.next=null,f.lastBaseUpdate=Z,f.shared.pending=null}}while(!0);se===null&&(L=oe),f.baseState=L,f.firstBaseUpdate=Q,f.lastBaseUpdate=se,g===null&&(f.shared.lanes=0),Za|=b,n.lanes=b,n.memoizedState=oe}}function fy(n,a){if(typeof n!="function")throw Error(i(191,n));n.call(a)}function my(n,a){var l=n.callbacks;if(l!==null)for(n.callbacks=null,n=0;n<l.length;n++)fy(l[n],a)}var ho=ne(null),Wu=ne(0);function py(n,a){n=Ea,ue(Wu,n),ue(ho,a),Ea=n|a.baseLanes}function Hf(){ue(Wu,Ea),ue(ho,ho.current)}function Gf(){Ea=Wu.current,he(ho),he(Wu)}var Ga=0,Oe=null,nt=null,Ct=null,Zu=!1,fo=!1,mr=!1,Ju=0,Gl=0,mo=null,bS=0;function Nt(){throw Error(i(321))}function $f(n,a){if(a===null)return!1;for(var l=0;l<a.length&&l<n.length;l++)if(!Mn(n[l],a[l]))return!1;return!0}function Kf(n,a,l,u,f,g){return Ga=g,Oe=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,H.H=n===null||n.memoizedState===null?Zy:Jy,mr=!1,g=l(u,f),mr=!1,fo&&(g=vy(a,l,u,f)),gy(n),g}function gy(n){H.H=id;var a=nt!==null&&nt.next!==null;if(Ga=0,Ct=nt=Oe=null,Zu=!1,Gl=0,mo=null,a)throw Error(i(300));n===null||Ht||(n=n.dependencies,n!==null&&$u(n)&&(Ht=!0))}function vy(n,a,l,u){Oe=n;var f=0;do{if(fo&&(mo=null),Gl=0,fo=!1,25<=f)throw Error(i(301));if(f+=1,Ct=nt=null,n.updateQueue!=null){var g=n.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}H.H=CS,g=a(l,u)}while(fo);return g}function TS(){var n=H.H,a=n.useState()[0];return a=typeof a.then=="function"?$l(a):a,n=n.useState()[0],(nt!==null?nt.memoizedState:null)!==n&&(Oe.flags|=1024),a}function Yf(){var n=Ju!==0;return Ju=0,n}function Qf(n,a,l){a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~l}function Xf(n){if(Zu){for(n=n.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Zu=!1}Ga=0,Ct=nt=Oe=null,fo=!1,Gl=Ju=0,mo=null}function xn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ct===null?Oe.memoizedState=Ct=n:Ct=Ct.next=n,Ct}function jt(){if(nt===null){var n=Oe.alternate;n=n!==null?n.memoizedState:null}else n=nt.next;var a=Ct===null?Oe.memoizedState:Ct.next;if(a!==null)Ct=a,nt=n;else{if(n===null)throw Oe.alternate===null?Error(i(467)):Error(i(310));nt=n,n={memoizedState:nt.memoizedState,baseState:nt.baseState,baseQueue:nt.baseQueue,queue:nt.queue,next:null},Ct===null?Oe.memoizedState=Ct=n:Ct=Ct.next=n}return Ct}function Wf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function $l(n){var a=Gl;return Gl+=1,mo===null&&(mo=[]),n=uy(mo,n,a),a=Oe,(Ct===null?a.memoizedState:Ct.next)===null&&(a=a.alternate,H.H=a===null||a.memoizedState===null?Zy:Jy),n}function ed(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return $l(n);if(n.$$typeof===F)return cn(n)}throw Error(i(438,String(n)))}function Zf(n){var a=null,l=Oe.updateQueue;if(l!==null&&(a=l.memoCache),a==null){var u=Oe.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(a={data:u.data.map(function(f){return f.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),l===null&&(l=Wf(),Oe.updateQueue=l),l.memoCache=a,l=a.data[a.index],l===void 0)for(l=a.data[a.index]=Array(n),u=0;u<n;u++)l[u]=I;return a.index++,l}function ma(n,a){return typeof a=="function"?a(n):a}function td(n){var a=jt();return Jf(a,nt,n)}function Jf(n,a,l){var u=n.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=l;var f=n.baseQueue,g=u.pending;if(g!==null){if(f!==null){var b=f.next;f.next=g.next,g.next=b}a.baseQueue=f=g,u.pending=null}if(g=n.baseState,f===null)n.memoizedState=g;else{a=f.next;var w=b=null,L=null,Q=a,se=!1;do{var oe=Q.lane&-536870913;if(oe!==Q.lane?(Ge&oe)===oe:(Ga&oe)===oe){var X=Q.revertLane;if(X===0)L!==null&&(L=L.next={lane:0,revertLane:0,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),oe===co&&(se=!0);else if((Ga&X)===X){Q=Q.next,X===co&&(se=!0);continue}else oe={lane:0,revertLane:Q.revertLane,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},L===null?(w=L=oe,b=g):L=L.next=oe,Oe.lanes|=X,Za|=X;oe=Q.action,mr&&l(g,oe),g=Q.hasEagerState?Q.eagerState:l(g,oe)}else X={lane:oe,revertLane:Q.revertLane,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},L===null?(w=L=X,b=g):L=L.next=X,Oe.lanes|=oe,Za|=oe;Q=Q.next}while(Q!==null&&Q!==a);if(L===null?b=g:L.next=w,!Mn(g,n.memoizedState)&&(Ht=!0,se&&(l=uo,l!==null)))throw l;n.memoizedState=g,n.baseState=b,n.baseQueue=L,u.lastRenderedState=g}return f===null&&(u.lanes=0),[n.memoizedState,u.dispatch]}function em(n){var a=jt(),l=a.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=n;var u=l.dispatch,f=l.pending,g=a.memoizedState;if(f!==null){l.pending=null;var b=f=f.next;do g=n(g,b.action),b=b.next;while(b!==f);Mn(g,a.memoizedState)||(Ht=!0),a.memoizedState=g,a.baseQueue===null&&(a.baseState=g),l.lastRenderedState=g}return[g,u]}function yy(n,a,l){var u=Oe,f=jt(),g=Qe;if(g){if(l===void 0)throw Error(i(407));l=l()}else l=a();var b=!Mn((nt||f).memoizedState,l);b&&(f.memoizedState=l,Ht=!0),f=f.queue;var w=by.bind(null,u,f,n);if(Kl(2048,8,w,[n]),f.getSnapshot!==a||b||Ct!==null&&Ct.memoizedState.tag&1){if(u.flags|=2048,po(9,nd(),Ey.bind(null,u,f,l,a),null),lt===null)throw Error(i(349));g||(Ga&124)!==0||_y(u,a,l)}return l}function _y(n,a,l){n.flags|=16384,n={getSnapshot:a,value:l},a=Oe.updateQueue,a===null?(a=Wf(),Oe.updateQueue=a,a.stores=[n]):(l=a.stores,l===null?a.stores=[n]:l.push(n))}function Ey(n,a,l,u){a.value=l,a.getSnapshot=u,Ty(a)&&Ny(n)}function by(n,a,l){return l(function(){Ty(a)&&Ny(n)})}function Ty(n){var a=n.getSnapshot;n=n.value;try{var l=a();return!Mn(n,l)}catch{return!0}}function Ny(n){var a=io(n,2);a!==null&&Fn(a,n,2)}function tm(n){var a=xn();if(typeof n=="function"){var l=n;if(n=l(),mr){Dn(!0);try{l()}finally{Dn(!1)}}}return a.memoizedState=a.baseState=n,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ma,lastRenderedState:n},a}function xy(n,a,l,u){return n.baseState=l,Jf(n,nt,typeof u=="function"?u:ma)}function NS(n,a,l,u,f){if(ad(n))throw Error(i(485));if(n=a.action,n!==null){var g={payload:f,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){g.listeners.push(b)}};H.T!==null?l(!0):g.isTransition=!1,u(g),l=a.pending,l===null?(g.next=a.pending=g,Ay(a,g)):(g.next=l.next,a.pending=l.next=g)}}function Ay(n,a){var l=a.action,u=a.payload,f=n.state;if(a.isTransition){var g=H.T,b={};H.T=b;try{var w=l(f,u),L=H.S;L!==null&&L(b,w),Sy(n,a,w)}catch(Q){nm(n,a,Q)}finally{H.T=g}}else try{g=l(f,u),Sy(n,a,g)}catch(Q){nm(n,a,Q)}}function Sy(n,a,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){wy(n,a,u)},function(u){return nm(n,a,u)}):wy(n,a,l)}function wy(n,a,l){a.status="fulfilled",a.value=l,Cy(a),n.state=l,a=n.pending,a!==null&&(l=a.next,l===a?n.pending=null:(l=l.next,a.next=l,Ay(n,l)))}function nm(n,a,l){var u=n.pending;if(n.pending=null,u!==null){u=u.next;do a.status="rejected",a.reason=l,Cy(a),a=a.next;while(a!==u)}n.action=null}function Cy(n){n=n.listeners;for(var a=0;a<n.length;a++)(0,n[a])()}function jy(n,a){return a}function Iy(n,a){if(Qe){var l=lt.formState;if(l!==null){e:{var u=Oe;if(Qe){if(_t){t:{for(var f=_t,g=Os;f.nodeType!==8;){if(!g){f=null;break t}if(f=fs(f.nextSibling),f===null){f=null;break t}}g=f.data,f=g==="F!"||g==="F"?f:null}if(f){_t=fs(f.nextSibling),u=f.data==="F!";break e}}ur(u)}u=!1}u&&(a=l[0])}}return l=xn(),l.memoizedState=l.baseState=a,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jy,lastRenderedState:a},l.queue=u,l=Qy.bind(null,Oe,u),u.dispatch=l,u=tm(!1),g=om.bind(null,Oe,!1,u.queue),u=xn(),f={state:a,dispatch:null,action:n,pending:null},u.queue=f,l=NS.bind(null,Oe,f,g,l),f.dispatch=l,u.memoizedState=n,[a,l,!1]}function Ry(n){var a=jt();return Dy(a,nt,n)}function Dy(n,a,l){if(a=Jf(n,a,jy)[0],n=td(ma)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var u=$l(a)}catch(b){throw b===Fl?Qu:b}else u=a;a=jt();var f=a.queue,g=f.dispatch;return l!==a.memoizedState&&(Oe.flags|=2048,po(9,nd(),xS.bind(null,f,l),null)),[u,g,n]}function xS(n,a){n.action=a}function Oy(n){var a=jt(),l=nt;if(l!==null)return Dy(a,l,n);jt(),a=a.memoizedState,l=jt();var u=l.queue.dispatch;return l.memoizedState=n,[a,u,!1]}function po(n,a,l,u){return n={tag:n,create:l,deps:u,inst:a,next:null},a=Oe.updateQueue,a===null&&(a=Wf(),Oe.updateQueue=a),l=a.lastEffect,l===null?a.lastEffect=n.next=n:(u=l.next,l.next=n,n.next=u,a.lastEffect=n),n}function nd(){return{destroy:void 0,resource:void 0}}function My(){return jt().memoizedState}function sd(n,a,l,u){var f=xn();u=u===void 0?null:u,Oe.flags|=n,f.memoizedState=po(1|a,nd(),l,u)}function Kl(n,a,l,u){var f=jt();u=u===void 0?null:u;var g=f.memoizedState.inst;nt!==null&&u!==null&&$f(u,nt.memoizedState.deps)?f.memoizedState=po(a,g,l,u):(Oe.flags|=n,f.memoizedState=po(1|a,g,l,u))}function Py(n,a){sd(8390656,8,n,a)}function ky(n,a){Kl(2048,8,n,a)}function Vy(n,a){return Kl(4,2,n,a)}function Ly(n,a){return Kl(4,4,n,a)}function Uy(n,a){if(typeof a=="function"){n=n();var l=a(n);return function(){typeof l=="function"?l():a(null)}}if(a!=null)return n=n(),a.current=n,function(){a.current=null}}function Fy(n,a,l){l=l!=null?l.concat([n]):null,Kl(4,4,Uy.bind(null,a,n),l)}function sm(){}function qy(n,a){var l=jt();a=a===void 0?null:a;var u=l.memoizedState;return a!==null&&$f(a,u[1])?u[0]:(l.memoizedState=[n,a],n)}function By(n,a){var l=jt();a=a===void 0?null:a;var u=l.memoizedState;if(a!==null&&$f(a,u[1]))return u[0];if(u=n(),mr){Dn(!0);try{n()}finally{Dn(!1)}}return l.memoizedState=[u,a],u}function am(n,a,l){return l===void 0||(Ga&1073741824)!==0?n.memoizedState=a:(n.memoizedState=l,n=G_(),Oe.lanes|=n,Za|=n,l)}function zy(n,a,l,u){return Mn(l,a)?l:ho.current!==null?(n=am(n,l,u),Mn(n,a)||(Ht=!0),n):(Ga&42)===0?(Ht=!0,n.memoizedState=l):(n=G_(),Oe.lanes|=n,Za|=n,a)}function Hy(n,a,l,u,f){var g=te.p;te.p=g!==0&&8>g?g:8;var b=H.T,w={};H.T=w,om(n,!1,a,l);try{var L=f(),Q=H.S;if(Q!==null&&Q(w,L),L!==null&&typeof L=="object"&&typeof L.then=="function"){var se=ES(L,u);Yl(n,a,se,Un(n))}else Yl(n,a,u,Un(n))}catch(oe){Yl(n,a,{then:function(){},status:"rejected",reason:oe},Un())}finally{te.p=g,H.T=b}}function AS(){}function im(n,a,l,u){if(n.tag!==5)throw Error(i(476));var f=Gy(n).queue;Hy(n,f,a,ce,l===null?AS:function(){return $y(n),l(u)})}function Gy(n){var a=n.memoizedState;if(a!==null)return a;a={memoizedState:ce,baseState:ce,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ma,lastRenderedState:ce},next:null};var l={};return a.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ma,lastRenderedState:l},next:null},n.memoizedState=a,n=n.alternate,n!==null&&(n.memoizedState=a),a}function $y(n){var a=Gy(n).next.queue;Yl(n,a,{},Un())}function rm(){return cn(hc)}function Ky(){return jt().memoizedState}function Yy(){return jt().memoizedState}function SS(n){for(var a=n.return;a!==null;){switch(a.tag){case 24:case 3:var l=Un();n=za(l);var u=Ha(a,n,l);u!==null&&(Fn(u,a,l),Bl(u,a,l)),a={cache:kf()},n.payload=a;return}a=a.return}}function wS(n,a,l){var u=Un();l={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},ad(n)?Xy(a,l):(l=Sf(n,a,l,u),l!==null&&(Fn(l,n,u),Wy(l,a,u)))}function Qy(n,a,l){var u=Un();Yl(n,a,l,u)}function Yl(n,a,l,u){var f={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(ad(n))Xy(a,f);else{var g=n.alternate;if(n.lanes===0&&(g===null||g.lanes===0)&&(g=a.lastRenderedReducer,g!==null))try{var b=a.lastRenderedState,w=g(b,l);if(f.hasEagerState=!0,f.eagerState=w,Mn(w,b))return qu(n,a,f,0),lt===null&&Fu(),!1}catch{}finally{}if(l=Sf(n,a,f,u),l!==null)return Fn(l,n,u),Wy(l,a,u),!0}return!1}function om(n,a,l,u){if(u={lane:2,revertLane:Um(),action:u,hasEagerState:!1,eagerState:null,next:null},ad(n)){if(a)throw Error(i(479))}else a=Sf(n,l,u,2),a!==null&&Fn(a,n,2)}function ad(n){var a=n.alternate;return n===Oe||a!==null&&a===Oe}function Xy(n,a){fo=Zu=!0;var l=n.pending;l===null?a.next=a:(a.next=l.next,l.next=a),n.pending=a}function Wy(n,a,l){if((l&4194048)!==0){var u=a.lanes;u&=n.pendingLanes,l|=u,a.lanes=l,gl(n,l)}}var id={readContext:cn,use:ed,useCallback:Nt,useContext:Nt,useEffect:Nt,useImperativeHandle:Nt,useLayoutEffect:Nt,useInsertionEffect:Nt,useMemo:Nt,useReducer:Nt,useRef:Nt,useState:Nt,useDebugValue:Nt,useDeferredValue:Nt,useTransition:Nt,useSyncExternalStore:Nt,useId:Nt,useHostTransitionStatus:Nt,useFormState:Nt,useActionState:Nt,useOptimistic:Nt,useMemoCache:Nt,useCacheRefresh:Nt},Zy={readContext:cn,use:ed,useCallback:function(n,a){return xn().memoizedState=[n,a===void 0?null:a],n},useContext:cn,useEffect:Py,useImperativeHandle:function(n,a,l){l=l!=null?l.concat([n]):null,sd(4194308,4,Uy.bind(null,a,n),l)},useLayoutEffect:function(n,a){return sd(4194308,4,n,a)},useInsertionEffect:function(n,a){sd(4,2,n,a)},useMemo:function(n,a){var l=xn();a=a===void 0?null:a;var u=n();if(mr){Dn(!0);try{n()}finally{Dn(!1)}}return l.memoizedState=[u,a],u},useReducer:function(n,a,l){var u=xn();if(l!==void 0){var f=l(a);if(mr){Dn(!0);try{l(a)}finally{Dn(!1)}}}else f=a;return u.memoizedState=u.baseState=f,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:f},u.queue=n,n=n.dispatch=wS.bind(null,Oe,n),[u.memoizedState,n]},useRef:function(n){var a=xn();return n={current:n},a.memoizedState=n},useState:function(n){n=tm(n);var a=n.queue,l=Qy.bind(null,Oe,a);return a.dispatch=l,[n.memoizedState,l]},useDebugValue:sm,useDeferredValue:function(n,a){var l=xn();return am(l,n,a)},useTransition:function(){var n=tm(!1);return n=Hy.bind(null,Oe,n.queue,!0,!1),xn().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,a,l){var u=Oe,f=xn();if(Qe){if(l===void 0)throw Error(i(407));l=l()}else{if(l=a(),lt===null)throw Error(i(349));(Ge&124)!==0||_y(u,a,l)}f.memoizedState=l;var g={value:l,getSnapshot:a};return f.queue=g,Py(by.bind(null,u,g,n),[n]),u.flags|=2048,po(9,nd(),Ey.bind(null,u,g,l,a),null),l},useId:function(){var n=xn(),a=lt.identifierPrefix;if(Qe){var l=da,u=ua;l=(u&~(1<<32-ln(u)-1)).toString(32)+l,a="«"+a+"R"+l,l=Ju++,0<l&&(a+="H"+l.toString(32)),a+="»"}else l=bS++,a="«"+a+"r"+l.toString(32)+"»";return n.memoizedState=a},useHostTransitionStatus:rm,useFormState:Iy,useActionState:Iy,useOptimistic:function(n){var a=xn();a.memoizedState=a.baseState=n;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=l,a=om.bind(null,Oe,!0,l),l.dispatch=a,[n,a]},useMemoCache:Zf,useCacheRefresh:function(){return xn().memoizedState=SS.bind(null,Oe)}},Jy={readContext:cn,use:ed,useCallback:qy,useContext:cn,useEffect:ky,useImperativeHandle:Fy,useInsertionEffect:Vy,useLayoutEffect:Ly,useMemo:By,useReducer:td,useRef:My,useState:function(){return td(ma)},useDebugValue:sm,useDeferredValue:function(n,a){var l=jt();return zy(l,nt.memoizedState,n,a)},useTransition:function(){var n=td(ma)[0],a=jt().memoizedState;return[typeof n=="boolean"?n:$l(n),a]},useSyncExternalStore:yy,useId:Ky,useHostTransitionStatus:rm,useFormState:Ry,useActionState:Ry,useOptimistic:function(n,a){var l=jt();return xy(l,nt,n,a)},useMemoCache:Zf,useCacheRefresh:Yy},CS={readContext:cn,use:ed,useCallback:qy,useContext:cn,useEffect:ky,useImperativeHandle:Fy,useInsertionEffect:Vy,useLayoutEffect:Ly,useMemo:By,useReducer:em,useRef:My,useState:function(){return em(ma)},useDebugValue:sm,useDeferredValue:function(n,a){var l=jt();return nt===null?am(l,n,a):zy(l,nt.memoizedState,n,a)},useTransition:function(){var n=em(ma)[0],a=jt().memoizedState;return[typeof n=="boolean"?n:$l(n),a]},useSyncExternalStore:yy,useId:Ky,useHostTransitionStatus:rm,useFormState:Oy,useActionState:Oy,useOptimistic:function(n,a){var l=jt();return nt!==null?xy(l,nt,n,a):(l.baseState=n,[n,l.queue.dispatch])},useMemoCache:Zf,useCacheRefresh:Yy},go=null,Ql=0;function rd(n){var a=Ql;return Ql+=1,go===null&&(go=[]),uy(go,n,a)}function Xl(n,a){a=a.props.ref,n.ref=a!==void 0?a:null}function od(n,a){throw a.$$typeof===T?Error(i(525)):(n=Object.prototype.toString.call(a),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":n)))}function e_(n){var a=n._init;return a(n._payload)}function t_(n){function a(G,z){if(n){var Y=G.deletions;Y===null?(G.deletions=[z],G.flags|=16):Y.push(z)}}function l(G,z){if(!n)return null;for(;z!==null;)a(G,z),z=z.sibling;return null}function u(G){for(var z=new Map;G!==null;)G.key!==null?z.set(G.key,G):z.set(G.index,G),G=G.sibling;return z}function f(G,z){return G=ca(G,z),G.index=0,G.sibling=null,G}function g(G,z,Y){return G.index=Y,n?(Y=G.alternate,Y!==null?(Y=Y.index,Y<z?(G.flags|=67108866,z):Y):(G.flags|=67108866,z)):(G.flags|=1048576,z)}function b(G){return n&&G.alternate===null&&(G.flags|=67108866),G}function w(G,z,Y,ie){return z===null||z.tag!==6?(z=Cf(Y,G.mode,ie),z.return=G,z):(z=f(z,Y),z.return=G,z)}function L(G,z,Y,ie){var ve=Y.type;return ve===N?se(G,z,Y.props.children,ie,Y.key):z!==null&&(z.elementType===ve||typeof ve=="object"&&ve!==null&&ve.$$typeof===A&&e_(ve)===z.type)?(z=f(z,Y.props),Xl(z,Y),z.return=G,z):(z=zu(Y.type,Y.key,Y.props,null,G.mode,ie),Xl(z,Y),z.return=G,z)}function Q(G,z,Y,ie){return z===null||z.tag!==4||z.stateNode.containerInfo!==Y.containerInfo||z.stateNode.implementation!==Y.implementation?(z=jf(Y,G.mode,ie),z.return=G,z):(z=f(z,Y.children||[]),z.return=G,z)}function se(G,z,Y,ie,ve){return z===null||z.tag!==7?(z=rr(Y,G.mode,ie,ve),z.return=G,z):(z=f(z,Y),z.return=G,z)}function oe(G,z,Y){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return z=Cf(""+z,G.mode,Y),z.return=G,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case x:return Y=zu(z.type,z.key,z.props,null,G.mode,Y),Xl(Y,z),Y.return=G,Y;case C:return z=jf(z,G.mode,Y),z.return=G,z;case A:var ie=z._init;return z=ie(z._payload),oe(G,z,Y)}if(ae(z)||P(z))return z=rr(z,G.mode,Y,null),z.return=G,z;if(typeof z.then=="function")return oe(G,rd(z),Y);if(z.$$typeof===F)return oe(G,Ku(G,z),Y);od(G,z)}return null}function X(G,z,Y,ie){var ve=z!==null?z.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return ve!==null?null:w(G,z,""+Y,ie);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case x:return Y.key===ve?L(G,z,Y,ie):null;case C:return Y.key===ve?Q(G,z,Y,ie):null;case A:return ve=Y._init,Y=ve(Y._payload),X(G,z,Y,ie)}if(ae(Y)||P(Y))return ve!==null?null:se(G,z,Y,ie,null);if(typeof Y.then=="function")return X(G,z,rd(Y),ie);if(Y.$$typeof===F)return X(G,z,Ku(G,Y),ie);od(G,Y)}return null}function Z(G,z,Y,ie,ve){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return G=G.get(Y)||null,w(z,G,""+ie,ve);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case x:return G=G.get(ie.key===null?Y:ie.key)||null,L(z,G,ie,ve);case C:return G=G.get(ie.key===null?Y:ie.key)||null,Q(z,G,ie,ve);case A:var ke=ie._init;return ie=ke(ie._payload),Z(G,z,Y,ie,ve)}if(ae(ie)||P(ie))return G=G.get(Y)||null,se(z,G,ie,ve,null);if(typeof ie.then=="function")return Z(G,z,Y,rd(ie),ve);if(ie.$$typeof===F)return Z(G,z,Y,Ku(z,ie),ve);od(z,ie)}return null}function we(G,z,Y,ie){for(var ve=null,ke=null,ye=z,xe=z=0,$t=null;ye!==null&&xe<Y.length;xe++){ye.index>xe?($t=ye,ye=null):$t=ye.sibling;var Ye=X(G,ye,Y[xe],ie);if(Ye===null){ye===null&&(ye=$t);break}n&&ye&&Ye.alternate===null&&a(G,ye),z=g(Ye,z,xe),ke===null?ve=Ye:ke.sibling=Ye,ke=Ye,ye=$t}if(xe===Y.length)return l(G,ye),Qe&&lr(G,xe),ve;if(ye===null){for(;xe<Y.length;xe++)ye=oe(G,Y[xe],ie),ye!==null&&(z=g(ye,z,xe),ke===null?ve=ye:ke.sibling=ye,ke=ye);return Qe&&lr(G,xe),ve}for(ye=u(ye);xe<Y.length;xe++)$t=Z(ye,G,xe,Y[xe],ie),$t!==null&&(n&&$t.alternate!==null&&ye.delete($t.key===null?xe:$t.key),z=g($t,z,xe),ke===null?ve=$t:ke.sibling=$t,ke=$t);return n&&ye.forEach(function(oi){return a(G,oi)}),Qe&&lr(G,xe),ve}function Ne(G,z,Y,ie){if(Y==null)throw Error(i(151));for(var ve=null,ke=null,ye=z,xe=z=0,$t=null,Ye=Y.next();ye!==null&&!Ye.done;xe++,Ye=Y.next()){ye.index>xe?($t=ye,ye=null):$t=ye.sibling;var oi=X(G,ye,Ye.value,ie);if(oi===null){ye===null&&(ye=$t);break}n&&ye&&oi.alternate===null&&a(G,ye),z=g(oi,z,xe),ke===null?ve=oi:ke.sibling=oi,ke=oi,ye=$t}if(Ye.done)return l(G,ye),Qe&&lr(G,xe),ve;if(ye===null){for(;!Ye.done;xe++,Ye=Y.next())Ye=oe(G,Ye.value,ie),Ye!==null&&(z=g(Ye,z,xe),ke===null?ve=Ye:ke.sibling=Ye,ke=Ye);return Qe&&lr(G,xe),ve}for(ye=u(ye);!Ye.done;xe++,Ye=Y.next())Ye=Z(ye,G,xe,Ye.value,ie),Ye!==null&&(n&&Ye.alternate!==null&&ye.delete(Ye.key===null?xe:Ye.key),z=g(Ye,z,xe),ke===null?ve=Ye:ke.sibling=Ye,ke=Ye);return n&&ye.forEach(function(jw){return a(G,jw)}),Qe&&lr(G,xe),ve}function at(G,z,Y,ie){if(typeof Y=="object"&&Y!==null&&Y.type===N&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case x:e:{for(var ve=Y.key;z!==null;){if(z.key===ve){if(ve=Y.type,ve===N){if(z.tag===7){l(G,z.sibling),ie=f(z,Y.props.children),ie.return=G,G=ie;break e}}else if(z.elementType===ve||typeof ve=="object"&&ve!==null&&ve.$$typeof===A&&e_(ve)===z.type){l(G,z.sibling),ie=f(z,Y.props),Xl(ie,Y),ie.return=G,G=ie;break e}l(G,z);break}else a(G,z);z=z.sibling}Y.type===N?(ie=rr(Y.props.children,G.mode,ie,Y.key),ie.return=G,G=ie):(ie=zu(Y.type,Y.key,Y.props,null,G.mode,ie),Xl(ie,Y),ie.return=G,G=ie)}return b(G);case C:e:{for(ve=Y.key;z!==null;){if(z.key===ve)if(z.tag===4&&z.stateNode.containerInfo===Y.containerInfo&&z.stateNode.implementation===Y.implementation){l(G,z.sibling),ie=f(z,Y.children||[]),ie.return=G,G=ie;break e}else{l(G,z);break}else a(G,z);z=z.sibling}ie=jf(Y,G.mode,ie),ie.return=G,G=ie}return b(G);case A:return ve=Y._init,Y=ve(Y._payload),at(G,z,Y,ie)}if(ae(Y))return we(G,z,Y,ie);if(P(Y)){if(ve=P(Y),typeof ve!="function")throw Error(i(150));return Y=ve.call(Y),Ne(G,z,Y,ie)}if(typeof Y.then=="function")return at(G,z,rd(Y),ie);if(Y.$$typeof===F)return at(G,z,Ku(G,Y),ie);od(G,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint"?(Y=""+Y,z!==null&&z.tag===6?(l(G,z.sibling),ie=f(z,Y),ie.return=G,G=ie):(l(G,z),ie=Cf(Y,G.mode,ie),ie.return=G,G=ie),b(G)):l(G,z)}return function(G,z,Y,ie){try{Ql=0;var ve=at(G,z,Y,ie);return go=null,ve}catch(ye){if(ye===Fl||ye===Qu)throw ye;var ke=Pn(29,ye,null,G.mode);return ke.lanes=ie,ke.return=G,ke}finally{}}}var vo=t_(!0),n_=t_(!1),ns=ne(null),Ms=null;function $a(n){var a=n.alternate;ue(kt,kt.current&1),ue(ns,n),Ms===null&&(a===null||ho.current!==null||a.memoizedState!==null)&&(Ms=n)}function s_(n){if(n.tag===22){if(ue(kt,kt.current),ue(ns,n),Ms===null){var a=n.alternate;a!==null&&a.memoizedState!==null&&(Ms=n)}}else Ka()}function Ka(){ue(kt,kt.current),ue(ns,ns.current)}function pa(n){he(ns),Ms===n&&(Ms=null),he(kt)}var kt=ne(0);function ld(n){for(var a=n;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||Wm(l)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}function lm(n,a,l,u){a=n.memoizedState,l=l(u,a),l=l==null?a:_({},a,l),n.memoizedState=l,n.lanes===0&&(n.updateQueue.baseState=l)}var cm={enqueueSetState:function(n,a,l){n=n._reactInternals;var u=Un(),f=za(u);f.payload=a,l!=null&&(f.callback=l),a=Ha(n,f,u),a!==null&&(Fn(a,n,u),Bl(a,n,u))},enqueueReplaceState:function(n,a,l){n=n._reactInternals;var u=Un(),f=za(u);f.tag=1,f.payload=a,l!=null&&(f.callback=l),a=Ha(n,f,u),a!==null&&(Fn(a,n,u),Bl(a,n,u))},enqueueForceUpdate:function(n,a){n=n._reactInternals;var l=Un(),u=za(l);u.tag=2,a!=null&&(u.callback=a),a=Ha(n,u,l),a!==null&&(Fn(a,n,l),Bl(a,n,l))}};function a_(n,a,l,u,f,g,b){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(u,g,b):a.prototype&&a.prototype.isPureReactComponent?!Dl(l,u)||!Dl(f,g):!0}function i_(n,a,l,u){n=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,u),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,u),a.state!==n&&cm.enqueueReplaceState(a,a.state,null)}function pr(n,a){var l=a;if("ref"in a){l={};for(var u in a)u!=="ref"&&(l[u]=a[u])}if(n=n.defaultProps){l===a&&(l=_({},l));for(var f in n)l[f]===void 0&&(l[f]=n[f])}return l}var cd=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)};function r_(n){cd(n)}function o_(n){console.error(n)}function l_(n){cd(n)}function ud(n,a){try{var l=n.onUncaughtError;l(a.value,{componentStack:a.stack})}catch(u){setTimeout(function(){throw u})}}function c_(n,a,l){try{var u=n.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function um(n,a,l){return l=za(l),l.tag=3,l.payload={element:null},l.callback=function(){ud(n,a)},l}function u_(n){return n=za(n),n.tag=3,n}function d_(n,a,l,u){var f=l.type.getDerivedStateFromError;if(typeof f=="function"){var g=u.value;n.payload=function(){return f(g)},n.callback=function(){c_(a,l,u)}}var b=l.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(n.callback=function(){c_(a,l,u),typeof f!="function"&&(Ja===null?Ja=new Set([this]):Ja.add(this));var w=u.stack;this.componentDidCatch(u.value,{componentStack:w!==null?w:""})})}function jS(n,a,l,u,f){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(a=l.alternate,a!==null&&Vl(a,l,f,!0),l=ns.current,l!==null){switch(l.tag){case 13:return Ms===null?Mm():l.alternate===null&&Et===0&&(Et=3),l.flags&=-257,l.flags|=65536,l.lanes=f,u===Uf?l.flags|=16384:(a=l.updateQueue,a===null?l.updateQueue=new Set([u]):a.add(u),km(n,u,f)),!1;case 22:return l.flags|=65536,u===Uf?l.flags|=16384:(a=l.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=a):(l=a.retryQueue,l===null?a.retryQueue=new Set([u]):l.add(u)),km(n,u,f)),!1}throw Error(i(435,l.tag))}return km(n,u,f),Mm(),!1}if(Qe)return a=ns.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=f,u!==Df&&(n=Error(i(422),{cause:u}),kl(Zn(n,l)))):(u!==Df&&(a=Error(i(423),{cause:u}),kl(Zn(a,l))),n=n.current.alternate,n.flags|=65536,f&=-f,n.lanes|=f,u=Zn(u,l),f=um(n.stateNode,u,f),Bf(n,f),Et!==4&&(Et=2)),!1;var g=Error(i(520),{cause:u});if(g=Zn(g,l),sc===null?sc=[g]:sc.push(g),Et!==4&&(Et=2),a===null)return!0;u=Zn(u,l),l=a;do{switch(l.tag){case 3:return l.flags|=65536,n=f&-f,l.lanes|=n,n=um(l.stateNode,u,n),Bf(l,n),!1;case 1:if(a=l.type,g=l.stateNode,(l.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Ja===null||!Ja.has(g))))return l.flags|=65536,f&=-f,l.lanes|=f,f=u_(f),d_(f,n,l,u),Bf(l,f),!1}l=l.return}while(l!==null);return!1}var h_=Error(i(461)),Ht=!1;function Wt(n,a,l,u){a.child=n===null?n_(a,null,l,u):vo(a,n.child,l,u)}function f_(n,a,l,u,f){l=l.render;var g=a.ref;if("ref"in u){var b={};for(var w in u)w!=="ref"&&(b[w]=u[w])}else b=u;return hr(a),u=Kf(n,a,l,b,g,f),w=Yf(),n!==null&&!Ht?(Qf(n,a,f),ga(n,a,f)):(Qe&&w&&If(a),a.flags|=1,Wt(n,a,u,f),a.child)}function m_(n,a,l,u,f){if(n===null){var g=l.type;return typeof g=="function"&&!wf(g)&&g.defaultProps===void 0&&l.compare===null?(a.tag=15,a.type=g,p_(n,a,g,u,f)):(n=zu(l.type,null,u,a,a.mode,f),n.ref=a.ref,n.return=a,a.child=n)}if(g=n.child,!ym(n,f)){var b=g.memoizedProps;if(l=l.compare,l=l!==null?l:Dl,l(b,u)&&n.ref===a.ref)return ga(n,a,f)}return a.flags|=1,n=ca(g,u),n.ref=a.ref,n.return=a,a.child=n}function p_(n,a,l,u,f){if(n!==null){var g=n.memoizedProps;if(Dl(g,u)&&n.ref===a.ref)if(Ht=!1,a.pendingProps=u=g,ym(n,f))(n.flags&131072)!==0&&(Ht=!0);else return a.lanes=n.lanes,ga(n,a,f)}return dm(n,a,l,u,f)}function g_(n,a,l){var u=a.pendingProps,f=u.children,g=n!==null?n.memoizedState:null;if(u.mode==="hidden"){if((a.flags&128)!==0){if(u=g!==null?g.baseLanes|l:l,n!==null){for(f=a.child=n.child,g=0;f!==null;)g=g|f.lanes|f.childLanes,f=f.sibling;a.childLanes=g&~u}else a.childLanes=0,a.child=null;return v_(n,a,u,l)}if((l&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},n!==null&&Yu(a,g!==null?g.cachePool:null),g!==null?py(a,g):Hf(),s_(a);else return a.lanes=a.childLanes=536870912,v_(n,a,g!==null?g.baseLanes|l:l,l)}else g!==null?(Yu(a,g.cachePool),py(a,g),Ka(),a.memoizedState=null):(n!==null&&Yu(a,null),Hf(),Ka());return Wt(n,a,f,l),a.child}function v_(n,a,l,u){var f=Lf();return f=f===null?null:{parent:Pt._currentValue,pool:f},a.memoizedState={baseLanes:l,cachePool:f},n!==null&&Yu(a,null),Hf(),s_(a),n!==null&&Vl(n,a,u,!0),null}function dd(n,a){var l=a.ref;if(l===null)n!==null&&n.ref!==null&&(a.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(n===null||n.ref!==l)&&(a.flags|=4194816)}}function dm(n,a,l,u,f){return hr(a),l=Kf(n,a,l,u,void 0,f),u=Yf(),n!==null&&!Ht?(Qf(n,a,f),ga(n,a,f)):(Qe&&u&&If(a),a.flags|=1,Wt(n,a,l,f),a.child)}function y_(n,a,l,u,f,g){return hr(a),a.updateQueue=null,l=vy(a,u,l,f),gy(n),u=Yf(),n!==null&&!Ht?(Qf(n,a,g),ga(n,a,g)):(Qe&&u&&If(a),a.flags|=1,Wt(n,a,l,g),a.child)}function __(n,a,l,u,f){if(hr(a),a.stateNode===null){var g=ro,b=l.contextType;typeof b=="object"&&b!==null&&(g=cn(b)),g=new l(u,g),a.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=cm,a.stateNode=g,g._reactInternals=a,g=a.stateNode,g.props=u,g.state=a.memoizedState,g.refs={},Ff(a),b=l.contextType,g.context=typeof b=="object"&&b!==null?cn(b):ro,g.state=a.memoizedState,b=l.getDerivedStateFromProps,typeof b=="function"&&(lm(a,l,b,u),g.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(b=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),b!==g.state&&cm.enqueueReplaceState(g,g.state,null),Hl(a,u,g,f),zl(),g.state=a.memoizedState),typeof g.componentDidMount=="function"&&(a.flags|=4194308),u=!0}else if(n===null){g=a.stateNode;var w=a.memoizedProps,L=pr(l,w);g.props=L;var Q=g.context,se=l.contextType;b=ro,typeof se=="object"&&se!==null&&(b=cn(se));var oe=l.getDerivedStateFromProps;se=typeof oe=="function"||typeof g.getSnapshotBeforeUpdate=="function",w=a.pendingProps!==w,se||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(w||Q!==b)&&i_(a,g,u,b),Ba=!1;var X=a.memoizedState;g.state=X,Hl(a,u,g,f),zl(),Q=a.memoizedState,w||X!==Q||Ba?(typeof oe=="function"&&(lm(a,l,oe,u),Q=a.memoizedState),(L=Ba||a_(a,l,L,u,X,Q,b))?(se||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(a.flags|=4194308)):(typeof g.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=u,a.memoizedState=Q),g.props=u,g.state=Q,g.context=b,u=L):(typeof g.componentDidMount=="function"&&(a.flags|=4194308),u=!1)}else{g=a.stateNode,qf(n,a),b=a.memoizedProps,se=pr(l,b),g.props=se,oe=a.pendingProps,X=g.context,Q=l.contextType,L=ro,typeof Q=="object"&&Q!==null&&(L=cn(Q)),w=l.getDerivedStateFromProps,(Q=typeof w=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(b!==oe||X!==L)&&i_(a,g,u,L),Ba=!1,X=a.memoizedState,g.state=X,Hl(a,u,g,f),zl();var Z=a.memoizedState;b!==oe||X!==Z||Ba||n!==null&&n.dependencies!==null&&$u(n.dependencies)?(typeof w=="function"&&(lm(a,l,w,u),Z=a.memoizedState),(se=Ba||a_(a,l,se,u,X,Z,L)||n!==null&&n.dependencies!==null&&$u(n.dependencies))?(Q||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(u,Z,L),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(u,Z,L)),typeof g.componentDidUpdate=="function"&&(a.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof g.componentDidUpdate!="function"||b===n.memoizedProps&&X===n.memoizedState||(a.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||b===n.memoizedProps&&X===n.memoizedState||(a.flags|=1024),a.memoizedProps=u,a.memoizedState=Z),g.props=u,g.state=Z,g.context=L,u=se):(typeof g.componentDidUpdate!="function"||b===n.memoizedProps&&X===n.memoizedState||(a.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||b===n.memoizedProps&&X===n.memoizedState||(a.flags|=1024),u=!1)}return g=u,dd(n,a),u=(a.flags&128)!==0,g||u?(g=a.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:g.render(),a.flags|=1,n!==null&&u?(a.child=vo(a,n.child,null,f),a.child=vo(a,null,l,f)):Wt(n,a,l,f),a.memoizedState=g.state,n=a.child):n=ga(n,a,f),n}function E_(n,a,l,u){return Pl(),a.flags|=256,Wt(n,a,l,u),a.child}var hm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function fm(n){return{baseLanes:n,cachePool:oy()}}function mm(n,a,l){return n=n!==null?n.childLanes&~l:0,a&&(n|=ss),n}function b_(n,a,l){var u=a.pendingProps,f=!1,g=(a.flags&128)!==0,b;if((b=g)||(b=n!==null&&n.memoizedState===null?!1:(kt.current&2)!==0),b&&(f=!0,a.flags&=-129),b=(a.flags&32)!==0,a.flags&=-33,n===null){if(Qe){if(f?$a(a):Ka(),Qe){var w=_t,L;if(L=w){e:{for(L=w,w=Os;L.nodeType!==8;){if(!w){w=null;break e}if(L=fs(L.nextSibling),L===null){w=null;break e}}w=L}w!==null?(a.memoizedState={dehydrated:w,treeContext:or!==null?{id:ua,overflow:da}:null,retryLane:536870912,hydrationErrors:null},L=Pn(18,null,null,0),L.stateNode=w,L.return=a,a.child=L,_n=a,_t=null,L=!0):L=!1}L||ur(a)}if(w=a.memoizedState,w!==null&&(w=w.dehydrated,w!==null))return Wm(w)?a.lanes=32:a.lanes=536870912,null;pa(a)}return w=u.children,u=u.fallback,f?(Ka(),f=a.mode,w=hd({mode:"hidden",children:w},f),u=rr(u,f,l,null),w.return=a,u.return=a,w.sibling=u,a.child=w,f=a.child,f.memoizedState=fm(l),f.childLanes=mm(n,b,l),a.memoizedState=hm,u):($a(a),pm(a,w))}if(L=n.memoizedState,L!==null&&(w=L.dehydrated,w!==null)){if(g)a.flags&256?($a(a),a.flags&=-257,a=gm(n,a,l)):a.memoizedState!==null?(Ka(),a.child=n.child,a.flags|=128,a=null):(Ka(),f=u.fallback,w=a.mode,u=hd({mode:"visible",children:u.children},w),f=rr(f,w,l,null),f.flags|=2,u.return=a,f.return=a,u.sibling=f,a.child=u,vo(a,n.child,null,l),u=a.child,u.memoizedState=fm(l),u.childLanes=mm(n,b,l),a.memoizedState=hm,a=f);else if($a(a),Wm(w)){if(b=w.nextSibling&&w.nextSibling.dataset,b)var Q=b.dgst;b=Q,u=Error(i(419)),u.stack="",u.digest=b,kl({value:u,source:null,stack:null}),a=gm(n,a,l)}else if(Ht||Vl(n,a,l,!1),b=(l&n.childLanes)!==0,Ht||b){if(b=lt,b!==null&&(u=l&-l,u=(u&42)!==0?1:Ma(u),u=(u&(b.suspendedLanes|l))!==0?0:u,u!==0&&u!==L.retryLane))throw L.retryLane=u,io(n,u),Fn(b,n,u),h_;w.data==="$?"||Mm(),a=gm(n,a,l)}else w.data==="$?"?(a.flags|=192,a.child=n.child,a=null):(n=L.treeContext,_t=fs(w.nextSibling),_n=a,Qe=!0,cr=null,Os=!1,n!==null&&(es[ts++]=ua,es[ts++]=da,es[ts++]=or,ua=n.id,da=n.overflow,or=a),a=pm(a,u.children),a.flags|=4096);return a}return f?(Ka(),f=u.fallback,w=a.mode,L=n.child,Q=L.sibling,u=ca(L,{mode:"hidden",children:u.children}),u.subtreeFlags=L.subtreeFlags&65011712,Q!==null?f=ca(Q,f):(f=rr(f,w,l,null),f.flags|=2),f.return=a,u.return=a,u.sibling=f,a.child=u,u=f,f=a.child,w=n.child.memoizedState,w===null?w=fm(l):(L=w.cachePool,L!==null?(Q=Pt._currentValue,L=L.parent!==Q?{parent:Q,pool:Q}:L):L=oy(),w={baseLanes:w.baseLanes|l,cachePool:L}),f.memoizedState=w,f.childLanes=mm(n,b,l),a.memoizedState=hm,u):($a(a),l=n.child,n=l.sibling,l=ca(l,{mode:"visible",children:u.children}),l.return=a,l.sibling=null,n!==null&&(b=a.deletions,b===null?(a.deletions=[n],a.flags|=16):b.push(n)),a.child=l,a.memoizedState=null,l)}function pm(n,a){return a=hd({mode:"visible",children:a},n.mode),a.return=n,n.child=a}function hd(n,a){return n=Pn(22,n,null,a),n.lanes=0,n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},n}function gm(n,a,l){return vo(a,n.child,null,l),n=pm(a,a.pendingProps.children),n.flags|=2,a.memoizedState=null,n}function T_(n,a,l){n.lanes|=a;var u=n.alternate;u!==null&&(u.lanes|=a),Mf(n.return,a,l)}function vm(n,a,l,u,f){var g=n.memoizedState;g===null?n.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:f}:(g.isBackwards=a,g.rendering=null,g.renderingStartTime=0,g.last=u,g.tail=l,g.tailMode=f)}function N_(n,a,l){var u=a.pendingProps,f=u.revealOrder,g=u.tail;if(Wt(n,a,u.children,l),u=kt.current,(u&2)!==0)u=u&1|2,a.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=a.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&T_(n,l,a);else if(n.tag===19)T_(n,l,a);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===a)break e;for(;n.sibling===null;){if(n.return===null||n.return===a)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}u&=1}switch(ue(kt,u),f){case"forwards":for(l=a.child,f=null;l!==null;)n=l.alternate,n!==null&&ld(n)===null&&(f=l),l=l.sibling;l=f,l===null?(f=a.child,a.child=null):(f=l.sibling,l.sibling=null),vm(a,!1,f,l,g);break;case"backwards":for(l=null,f=a.child,a.child=null;f!==null;){if(n=f.alternate,n!==null&&ld(n)===null){a.child=f;break}n=f.sibling,f.sibling=l,l=f,f=n}vm(a,!0,l,null,g);break;case"together":vm(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function ga(n,a,l){if(n!==null&&(a.dependencies=n.dependencies),Za|=a.lanes,(l&a.childLanes)===0)if(n!==null){if(Vl(n,a,l,!1),(l&a.childLanes)===0)return null}else return null;if(n!==null&&a.child!==n.child)throw Error(i(153));if(a.child!==null){for(n=a.child,l=ca(n,n.pendingProps),a.child=l,l.return=a;n.sibling!==null;)n=n.sibling,l=l.sibling=ca(n,n.pendingProps),l.return=a;l.sibling=null}return a.child}function ym(n,a){return(n.lanes&a)!==0?!0:(n=n.dependencies,!!(n!==null&&$u(n)))}function IS(n,a,l){switch(a.tag){case 3:ot(a,a.stateNode.containerInfo),qa(a,Pt,n.memoizedState.cache),Pl();break;case 27:case 5:Oa(a);break;case 4:ot(a,a.stateNode.containerInfo);break;case 10:qa(a,a.type,a.memoizedProps.value);break;case 13:var u=a.memoizedState;if(u!==null)return u.dehydrated!==null?($a(a),a.flags|=128,null):(l&a.child.childLanes)!==0?b_(n,a,l):($a(a),n=ga(n,a,l),n!==null?n.sibling:null);$a(a);break;case 19:var f=(n.flags&128)!==0;if(u=(l&a.childLanes)!==0,u||(Vl(n,a,l,!1),u=(l&a.childLanes)!==0),f){if(u)return N_(n,a,l);a.flags|=128}if(f=a.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),ue(kt,kt.current),u)break;return null;case 22:case 23:return a.lanes=0,g_(n,a,l);case 24:qa(a,Pt,n.memoizedState.cache)}return ga(n,a,l)}function x_(n,a,l){if(n!==null)if(n.memoizedProps!==a.pendingProps)Ht=!0;else{if(!ym(n,l)&&(a.flags&128)===0)return Ht=!1,IS(n,a,l);Ht=(n.flags&131072)!==0}else Ht=!1,Qe&&(a.flags&1048576)!==0&&ey(a,Gu,a.index);switch(a.lanes=0,a.tag){case 16:e:{n=a.pendingProps;var u=a.elementType,f=u._init;if(u=f(u._payload),a.type=u,typeof u=="function")wf(u)?(n=pr(u,n),a.tag=1,a=__(null,a,u,n,l)):(a.tag=0,a=dm(null,a,u,n,l));else{if(u!=null){if(f=u.$$typeof,f===V){a.tag=11,a=f_(null,a,u,n,l);break e}else if(f===D){a.tag=14,a=m_(null,a,u,n,l);break e}}throw a=Ve(u)||u,Error(i(306,a,""))}}return a;case 0:return dm(n,a,a.type,a.pendingProps,l);case 1:return u=a.type,f=pr(u,a.pendingProps),__(n,a,u,f,l);case 3:e:{if(ot(a,a.stateNode.containerInfo),n===null)throw Error(i(387));u=a.pendingProps;var g=a.memoizedState;f=g.element,qf(n,a),Hl(a,u,null,l);var b=a.memoizedState;if(u=b.cache,qa(a,Pt,u),u!==g.cache&&Pf(a,[Pt],l,!0),zl(),u=b.element,g.isDehydrated)if(g={element:u,isDehydrated:!1,cache:b.cache},a.updateQueue.baseState=g,a.memoizedState=g,a.flags&256){a=E_(n,a,u,l);break e}else if(u!==f){f=Zn(Error(i(424)),a),kl(f),a=E_(n,a,u,l);break e}else{switch(n=a.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(_t=fs(n.firstChild),_n=a,Qe=!0,cr=null,Os=!0,l=n_(a,null,u,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Pl(),u===f){a=ga(n,a,l);break e}Wt(n,a,u,l)}a=a.child}return a;case 26:return dd(n,a),n===null?(l=CE(a.type,null,a.pendingProps,null))?a.memoizedState=l:Qe||(l=a.type,n=a.pendingProps,u=Sd(Ce.current).createElement(l),u[Dt]=a,u[St]=n,Jt(u,l,n),Tt(u),a.stateNode=u):a.memoizedState=CE(a.type,n.memoizedProps,a.pendingProps,n.memoizedState),null;case 27:return Oa(a),n===null&&Qe&&(u=a.stateNode=AE(a.type,a.pendingProps,Ce.current),_n=a,Os=!0,f=_t,ni(a.type)?(Zm=f,_t=fs(u.firstChild)):_t=f),Wt(n,a,a.pendingProps.children,l),dd(n,a),n===null&&(a.flags|=4194304),a.child;case 5:return n===null&&Qe&&((f=u=_t)&&(u=aw(u,a.type,a.pendingProps,Os),u!==null?(a.stateNode=u,_n=a,_t=fs(u.firstChild),Os=!1,f=!0):f=!1),f||ur(a)),Oa(a),f=a.type,g=a.pendingProps,b=n!==null?n.memoizedProps:null,u=g.children,Ym(f,g)?u=null:b!==null&&Ym(f,b)&&(a.flags|=32),a.memoizedState!==null&&(f=Kf(n,a,TS,null,null,l),hc._currentValue=f),dd(n,a),Wt(n,a,u,l),a.child;case 6:return n===null&&Qe&&((n=l=_t)&&(l=iw(l,a.pendingProps,Os),l!==null?(a.stateNode=l,_n=a,_t=null,n=!0):n=!1),n||ur(a)),null;case 13:return b_(n,a,l);case 4:return ot(a,a.stateNode.containerInfo),u=a.pendingProps,n===null?a.child=vo(a,null,u,l):Wt(n,a,u,l),a.child;case 11:return f_(n,a,a.type,a.pendingProps,l);case 7:return Wt(n,a,a.pendingProps,l),a.child;case 8:return Wt(n,a,a.pendingProps.children,l),a.child;case 12:return Wt(n,a,a.pendingProps.children,l),a.child;case 10:return u=a.pendingProps,qa(a,a.type,u.value),Wt(n,a,u.children,l),a.child;case 9:return f=a.type._context,u=a.pendingProps.children,hr(a),f=cn(f),u=u(f),a.flags|=1,Wt(n,a,u,l),a.child;case 14:return m_(n,a,a.type,a.pendingProps,l);case 15:return p_(n,a,a.type,a.pendingProps,l);case 19:return N_(n,a,l);case 31:return u=a.pendingProps,l=a.mode,u={mode:u.mode,children:u.children},n===null?(l=hd(u,l),l.ref=a.ref,a.child=l,l.return=a,a=l):(l=ca(n.child,u),l.ref=a.ref,a.child=l,l.return=a,a=l),a;case 22:return g_(n,a,l);case 24:return hr(a),u=cn(Pt),n===null?(f=Lf(),f===null&&(f=lt,g=kf(),f.pooledCache=g,g.refCount++,g!==null&&(f.pooledCacheLanes|=l),f=g),a.memoizedState={parent:u,cache:f},Ff(a),qa(a,Pt,f)):((n.lanes&l)!==0&&(qf(n,a),Hl(a,null,null,l),zl()),f=n.memoizedState,g=a.memoizedState,f.parent!==u?(f={parent:u,cache:u},a.memoizedState=f,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=f),qa(a,Pt,u)):(u=g.cache,qa(a,Pt,u),u!==f.cache&&Pf(a,[Pt],l,!0))),Wt(n,a,a.pendingProps.children,l),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function va(n){n.flags|=4}function A_(n,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!OE(a)){if(a=ns.current,a!==null&&((Ge&4194048)===Ge?Ms!==null:(Ge&62914560)!==Ge&&(Ge&536870912)===0||a!==Ms))throw ql=Uf,ly;n.flags|=8192}}function fd(n,a){a!==null&&(n.flags|=4),n.flags&16384&&(a=n.tag!==22?ml():536870912,n.lanes|=a,bo|=a)}function Wl(n,a){if(!Qe)switch(n.tailMode){case"hidden":a=n.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?n.tail=null:l.sibling=null;break;case"collapsed":l=n.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?a||n.tail===null?n.tail=null:n.tail.sibling=null:u.sibling=null}}function gt(n){var a=n.alternate!==null&&n.alternate.child===n.child,l=0,u=0;if(a)for(var f=n.child;f!==null;)l|=f.lanes|f.childLanes,u|=f.subtreeFlags&65011712,u|=f.flags&65011712,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)l|=f.lanes|f.childLanes,u|=f.subtreeFlags,u|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=u,n.childLanes=l,a}function RS(n,a,l){var u=a.pendingProps;switch(Rf(a),a.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gt(a),null;case 1:return gt(a),null;case 3:return l=a.stateNode,u=null,n!==null&&(u=n.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),fa(Pt),bs(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(n===null||n.child===null)&&(Ml(a)?va(a):n===null||n.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,sy())),gt(a),null;case 26:return l=a.memoizedState,n===null?(va(a),l!==null?(gt(a),A_(a,l)):(gt(a),a.flags&=-16777217)):l?l!==n.memoizedState?(va(a),gt(a),A_(a,l)):(gt(a),a.flags&=-16777217):(n.memoizedProps!==u&&va(a),gt(a),a.flags&=-16777217),null;case 27:Xs(a),l=Ce.current;var f=a.type;if(n!==null&&a.stateNode!=null)n.memoizedProps!==u&&va(a);else{if(!u){if(a.stateNode===null)throw Error(i(166));return gt(a),null}n=be.current,Ml(a)?ty(a):(n=AE(f,u,l),a.stateNode=n,va(a))}return gt(a),null;case 5:if(Xs(a),l=a.type,n!==null&&a.stateNode!=null)n.memoizedProps!==u&&va(a);else{if(!u){if(a.stateNode===null)throw Error(i(166));return gt(a),null}if(n=be.current,Ml(a))ty(a);else{switch(f=Sd(Ce.current),n){case 1:n=f.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:n=f.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":n=f.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":n=f.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":n=f.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild);break;case"select":n=typeof u.is=="string"?f.createElement("select",{is:u.is}):f.createElement("select"),u.multiple?n.multiple=!0:u.size&&(n.size=u.size);break;default:n=typeof u.is=="string"?f.createElement(l,{is:u.is}):f.createElement(l)}}n[Dt]=a,n[St]=u;e:for(f=a.child;f!==null;){if(f.tag===5||f.tag===6)n.appendChild(f.stateNode);else if(f.tag!==4&&f.tag!==27&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===a)break e;for(;f.sibling===null;){if(f.return===null||f.return===a)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}a.stateNode=n;e:switch(Jt(n,l,u),l){case"button":case"input":case"select":case"textarea":n=!!u.autoFocus;break e;case"img":n=!0;break e;default:n=!1}n&&va(a)}}return gt(a),a.flags&=-16777217,null;case 6:if(n&&a.stateNode!=null)n.memoizedProps!==u&&va(a);else{if(typeof u!="string"&&a.stateNode===null)throw Error(i(166));if(n=Ce.current,Ml(a)){if(n=a.stateNode,l=a.memoizedProps,u=null,f=_n,f!==null)switch(f.tag){case 27:case 5:u=f.memoizedProps}n[Dt]=a,n=!!(n.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||yE(n.nodeValue,l)),n||ur(a)}else n=Sd(n).createTextNode(u),n[Dt]=a,a.stateNode=n}return gt(a),null;case 13:if(u=a.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(f=Ml(a),u!==null&&u.dehydrated!==null){if(n===null){if(!f)throw Error(i(318));if(f=a.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[Dt]=a}else Pl(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;gt(a),f=!1}else f=sy(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=f),f=!0;if(!f)return a.flags&256?(pa(a),a):(pa(a),null)}if(pa(a),(a.flags&128)!==0)return a.lanes=l,a;if(l=u!==null,n=n!==null&&n.memoizedState!==null,l){u=a.child,f=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(f=u.alternate.memoizedState.cachePool.pool);var g=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(g=u.memoizedState.cachePool.pool),g!==f&&(u.flags|=2048)}return l!==n&&l&&(a.child.flags|=8192),fd(a,a.updateQueue),gt(a),null;case 4:return bs(),n===null&&zm(a.stateNode.containerInfo),gt(a),null;case 10:return fa(a.type),gt(a),null;case 19:if(he(kt),f=a.memoizedState,f===null)return gt(a),null;if(u=(a.flags&128)!==0,g=f.rendering,g===null)if(u)Wl(f,!1);else{if(Et!==0||n!==null&&(n.flags&128)!==0)for(n=a.child;n!==null;){if(g=ld(n),g!==null){for(a.flags|=128,Wl(f,!1),n=g.updateQueue,a.updateQueue=n,fd(a,n),a.subtreeFlags=0,n=l,l=a.child;l!==null;)Jv(l,n),l=l.sibling;return ue(kt,kt.current&1|2),a.child}n=n.sibling}f.tail!==null&&$n()>gd&&(a.flags|=128,u=!0,Wl(f,!1),a.lanes=4194304)}else{if(!u)if(n=ld(g),n!==null){if(a.flags|=128,u=!0,n=n.updateQueue,a.updateQueue=n,fd(a,n),Wl(f,!0),f.tail===null&&f.tailMode==="hidden"&&!g.alternate&&!Qe)return gt(a),null}else 2*$n()-f.renderingStartTime>gd&&l!==536870912&&(a.flags|=128,u=!0,Wl(f,!1),a.lanes=4194304);f.isBackwards?(g.sibling=a.child,a.child=g):(n=f.last,n!==null?n.sibling=g:a.child=g,f.last=g)}return f.tail!==null?(a=f.tail,f.rendering=a,f.tail=a.sibling,f.renderingStartTime=$n(),a.sibling=null,n=kt.current,ue(kt,u?n&1|2:n&1),a):(gt(a),null);case 22:case 23:return pa(a),Gf(),u=a.memoizedState!==null,n!==null?n.memoizedState!==null!==u&&(a.flags|=8192):u&&(a.flags|=8192),u?(l&536870912)!==0&&(a.flags&128)===0&&(gt(a),a.subtreeFlags&6&&(a.flags|=8192)):gt(a),l=a.updateQueue,l!==null&&fd(a,l.retryQueue),l=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),u=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(u=a.memoizedState.cachePool.pool),u!==l&&(a.flags|=2048),n!==null&&he(fr),null;case 24:return l=null,n!==null&&(l=n.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),fa(Pt),gt(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function DS(n,a){switch(Rf(a),a.tag){case 1:return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 3:return fa(Pt),bs(),n=a.flags,(n&65536)!==0&&(n&128)===0?(a.flags=n&-65537|128,a):null;case 26:case 27:case 5:return Xs(a),null;case 13:if(pa(a),n=a.memoizedState,n!==null&&n.dehydrated!==null){if(a.alternate===null)throw Error(i(340));Pl()}return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 19:return he(kt),null;case 4:return bs(),null;case 10:return fa(a.type),null;case 22:case 23:return pa(a),Gf(),n!==null&&he(fr),n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 24:return fa(Pt),null;case 25:return null;default:return null}}function S_(n,a){switch(Rf(a),a.tag){case 3:fa(Pt),bs();break;case 26:case 27:case 5:Xs(a);break;case 4:bs();break;case 13:pa(a);break;case 19:he(kt);break;case 10:fa(a.type);break;case 22:case 23:pa(a),Gf(),n!==null&&he(fr);break;case 24:fa(Pt)}}function Zl(n,a){try{var l=a.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var f=u.next;l=f;do{if((l.tag&n)===n){u=void 0;var g=l.create,b=l.inst;u=g(),b.destroy=u}l=l.next}while(l!==f)}}catch(w){it(a,a.return,w)}}function Ya(n,a,l){try{var u=a.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var g=f.next;u=g;do{if((u.tag&n)===n){var b=u.inst,w=b.destroy;if(w!==void 0){b.destroy=void 0,f=a;var L=l,Q=w;try{Q()}catch(se){it(f,L,se)}}}u=u.next}while(u!==g)}}catch(se){it(a,a.return,se)}}function w_(n){var a=n.updateQueue;if(a!==null){var l=n.stateNode;try{my(a,l)}catch(u){it(n,n.return,u)}}}function C_(n,a,l){l.props=pr(n.type,n.memoizedProps),l.state=n.memoizedState;try{l.componentWillUnmount()}catch(u){it(n,a,u)}}function Jl(n,a){try{var l=n.ref;if(l!==null){switch(n.tag){case 26:case 27:case 5:var u=n.stateNode;break;case 30:u=n.stateNode;break;default:u=n.stateNode}typeof l=="function"?n.refCleanup=l(u):l.current=u}}catch(f){it(n,a,f)}}function Ps(n,a){var l=n.ref,u=n.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(f){it(n,a,f)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(f){it(n,a,f)}else l.current=null}function j_(n){var a=n.type,l=n.memoizedProps,u=n.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(f){it(n,n.return,f)}}function _m(n,a,l){try{var u=n.stateNode;JS(u,n.type,l,a),u[St]=a}catch(f){it(n,n.return,f)}}function I_(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&ni(n.type)||n.tag===4}function Em(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||I_(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&ni(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function bm(n,a,l){var u=n.tag;if(u===5||u===6)n=n.stateNode,a?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(n,a):(a=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,a.appendChild(n),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=Ad));else if(u!==4&&(u===27&&ni(n.type)&&(l=n.stateNode,a=null),n=n.child,n!==null))for(bm(n,a,l),n=n.sibling;n!==null;)bm(n,a,l),n=n.sibling}function md(n,a,l){var u=n.tag;if(u===5||u===6)n=n.stateNode,a?l.insertBefore(n,a):l.appendChild(n);else if(u!==4&&(u===27&&ni(n.type)&&(l=n.stateNode),n=n.child,n!==null))for(md(n,a,l),n=n.sibling;n!==null;)md(n,a,l),n=n.sibling}function R_(n){var a=n.stateNode,l=n.memoizedProps;try{for(var u=n.type,f=a.attributes;f.length;)a.removeAttributeNode(f[0]);Jt(a,u,l),a[Dt]=n,a[St]=l}catch(g){it(n,n.return,g)}}var ya=!1,xt=!1,Tm=!1,D_=typeof WeakSet=="function"?WeakSet:Set,Gt=null;function OS(n,a){if(n=n.containerInfo,$m=Dd,n=zv(n),Ef(n)){if("selectionStart"in n)var l={start:n.selectionStart,end:n.selectionEnd};else e:{l=(l=n.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var f=u.anchorOffset,g=u.focusNode;u=u.focusOffset;try{l.nodeType,g.nodeType}catch{l=null;break e}var b=0,w=-1,L=-1,Q=0,se=0,oe=n,X=null;t:for(;;){for(var Z;oe!==l||f!==0&&oe.nodeType!==3||(w=b+f),oe!==g||u!==0&&oe.nodeType!==3||(L=b+u),oe.nodeType===3&&(b+=oe.nodeValue.length),(Z=oe.firstChild)!==null;)X=oe,oe=Z;for(;;){if(oe===n)break t;if(X===l&&++Q===f&&(w=b),X===g&&++se===u&&(L=b),(Z=oe.nextSibling)!==null)break;oe=X,X=oe.parentNode}oe=Z}l=w===-1||L===-1?null:{start:w,end:L}}else l=null}l=l||{start:0,end:0}}else l=null;for(Km={focusedElem:n,selectionRange:l},Dd=!1,Gt=a;Gt!==null;)if(a=Gt,n=a.child,(a.subtreeFlags&1024)!==0&&n!==null)n.return=a,Gt=n;else for(;Gt!==null;){switch(a=Gt,g=a.alternate,n=a.flags,a.tag){case 0:break;case 11:case 15:break;case 1:if((n&1024)!==0&&g!==null){n=void 0,l=a,f=g.memoizedProps,g=g.memoizedState,u=l.stateNode;try{var we=pr(l.type,f,l.elementType===l.type);n=u.getSnapshotBeforeUpdate(we,g),u.__reactInternalSnapshotBeforeUpdate=n}catch(Ne){it(l,l.return,Ne)}}break;case 3:if((n&1024)!==0){if(n=a.stateNode.containerInfo,l=n.nodeType,l===9)Xm(n);else if(l===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Xm(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=a.sibling,n!==null){n.return=a.return,Gt=n;break}Gt=a.return}}function O_(n,a,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:Qa(n,l),u&4&&Zl(5,l);break;case 1:if(Qa(n,l),u&4)if(n=l.stateNode,a===null)try{n.componentDidMount()}catch(b){it(l,l.return,b)}else{var f=pr(l.type,a.memoizedProps);a=a.memoizedState;try{n.componentDidUpdate(f,a,n.__reactInternalSnapshotBeforeUpdate)}catch(b){it(l,l.return,b)}}u&64&&w_(l),u&512&&Jl(l,l.return);break;case 3:if(Qa(n,l),u&64&&(n=l.updateQueue,n!==null)){if(a=null,l.child!==null)switch(l.child.tag){case 27:case 5:a=l.child.stateNode;break;case 1:a=l.child.stateNode}try{my(n,a)}catch(b){it(l,l.return,b)}}break;case 27:a===null&&u&4&&R_(l);case 26:case 5:Qa(n,l),a===null&&u&4&&j_(l),u&512&&Jl(l,l.return);break;case 12:Qa(n,l);break;case 13:Qa(n,l),u&4&&k_(n,l),u&64&&(n=l.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(l=BS.bind(null,l),rw(n,l))));break;case 22:if(u=l.memoizedState!==null||ya,!u){a=a!==null&&a.memoizedState!==null||xt,f=ya;var g=xt;ya=u,(xt=a)&&!g?Xa(n,l,(l.subtreeFlags&8772)!==0):Qa(n,l),ya=f,xt=g}break;case 30:break;default:Qa(n,l)}}function M_(n){var a=n.alternate;a!==null&&(n.alternate=null,M_(a)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(a=n.stateNode,a!==null&&Va(a)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var ht=null,An=!1;function _a(n,a,l){for(l=l.child;l!==null;)P_(n,a,l),l=l.sibling}function P_(n,a,l){if(Ze&&typeof Ze.onCommitFiberUnmount=="function")try{Ze.onCommitFiberUnmount(yt,l)}catch{}switch(l.tag){case 26:xt||Ps(l,a),_a(n,a,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:xt||Ps(l,a);var u=ht,f=An;ni(l.type)&&(ht=l.stateNode,An=!1),_a(n,a,l),lc(l.stateNode),ht=u,An=f;break;case 5:xt||Ps(l,a);case 6:if(u=ht,f=An,ht=null,_a(n,a,l),ht=u,An=f,ht!==null)if(An)try{(ht.nodeType===9?ht.body:ht.nodeName==="HTML"?ht.ownerDocument.body:ht).removeChild(l.stateNode)}catch(g){it(l,a,g)}else try{ht.removeChild(l.stateNode)}catch(g){it(l,a,g)}break;case 18:ht!==null&&(An?(n=ht,NE(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,l.stateNode),gc(n)):NE(ht,l.stateNode));break;case 4:u=ht,f=An,ht=l.stateNode.containerInfo,An=!0,_a(n,a,l),ht=u,An=f;break;case 0:case 11:case 14:case 15:xt||Ya(2,l,a),xt||Ya(4,l,a),_a(n,a,l);break;case 1:xt||(Ps(l,a),u=l.stateNode,typeof u.componentWillUnmount=="function"&&C_(l,a,u)),_a(n,a,l);break;case 21:_a(n,a,l);break;case 22:xt=(u=xt)||l.memoizedState!==null,_a(n,a,l),xt=u;break;default:_a(n,a,l)}}function k_(n,a){if(a.memoizedState===null&&(n=a.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{gc(n)}catch(l){it(a,a.return,l)}}function MS(n){switch(n.tag){case 13:case 19:var a=n.stateNode;return a===null&&(a=n.stateNode=new D_),a;case 22:return n=n.stateNode,a=n._retryCache,a===null&&(a=n._retryCache=new D_),a;default:throw Error(i(435,n.tag))}}function Nm(n,a){var l=MS(n);a.forEach(function(u){var f=zS.bind(null,n,u);l.has(u)||(l.add(u),u.then(f,f))})}function kn(n,a){var l=a.deletions;if(l!==null)for(var u=0;u<l.length;u++){var f=l[u],g=n,b=a,w=b;e:for(;w!==null;){switch(w.tag){case 27:if(ni(w.type)){ht=w.stateNode,An=!1;break e}break;case 5:ht=w.stateNode,An=!1;break e;case 3:case 4:ht=w.stateNode.containerInfo,An=!0;break e}w=w.return}if(ht===null)throw Error(i(160));P_(g,b,f),ht=null,An=!1,g=f.alternate,g!==null&&(g.return=null),f.return=null}if(a.subtreeFlags&13878)for(a=a.child;a!==null;)V_(a,n),a=a.sibling}var hs=null;function V_(n,a){var l=n.alternate,u=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:kn(a,n),Vn(n),u&4&&(Ya(3,n,n.return),Zl(3,n),Ya(5,n,n.return));break;case 1:kn(a,n),Vn(n),u&512&&(xt||l===null||Ps(l,l.return)),u&64&&ya&&(n=n.updateQueue,n!==null&&(u=n.callbacks,u!==null&&(l=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var f=hs;if(kn(a,n),Vn(n),u&512&&(xt||l===null||Ps(l,l.return)),u&4){var g=l!==null?l.memoizedState:null;if(u=n.memoizedState,l===null)if(u===null)if(n.stateNode===null){e:{u=n.type,l=n.memoizedProps,f=f.ownerDocument||f;t:switch(u){case"title":g=f.getElementsByTagName("title")[0],(!g||g[Hi]||g[Dt]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=f.createElement(u),f.head.insertBefore(g,f.querySelector("head > title"))),Jt(g,u,l),g[Dt]=n,Tt(g),u=g;break e;case"link":var b=RE("link","href",f).get(u+(l.href||""));if(b){for(var w=0;w<b.length;w++)if(g=b[w],g.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&g.getAttribute("rel")===(l.rel==null?null:l.rel)&&g.getAttribute("title")===(l.title==null?null:l.title)&&g.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){b.splice(w,1);break t}}g=f.createElement(u),Jt(g,u,l),f.head.appendChild(g);break;case"meta":if(b=RE("meta","content",f).get(u+(l.content||""))){for(w=0;w<b.length;w++)if(g=b[w],g.getAttribute("content")===(l.content==null?null:""+l.content)&&g.getAttribute("name")===(l.name==null?null:l.name)&&g.getAttribute("property")===(l.property==null?null:l.property)&&g.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&g.getAttribute("charset")===(l.charSet==null?null:l.charSet)){b.splice(w,1);break t}}g=f.createElement(u),Jt(g,u,l),f.head.appendChild(g);break;default:throw Error(i(468,u))}g[Dt]=n,Tt(g),u=g}n.stateNode=u}else DE(f,n.type,n.stateNode);else n.stateNode=IE(f,u,n.memoizedProps);else g!==u?(g===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):g.count--,u===null?DE(f,n.type,n.stateNode):IE(f,u,n.memoizedProps)):u===null&&n.stateNode!==null&&_m(n,n.memoizedProps,l.memoizedProps)}break;case 27:kn(a,n),Vn(n),u&512&&(xt||l===null||Ps(l,l.return)),l!==null&&u&4&&_m(n,n.memoizedProps,l.memoizedProps);break;case 5:if(kn(a,n),Vn(n),u&512&&(xt||l===null||Ps(l,l.return)),n.flags&32){f=n.stateNode;try{Yn(f,"")}catch(Z){it(n,n.return,Z)}}u&4&&n.stateNode!=null&&(f=n.memoizedProps,_m(n,f,l!==null?l.memoizedProps:f)),u&1024&&(Tm=!0);break;case 6:if(kn(a,n),Vn(n),u&4){if(n.stateNode===null)throw Error(i(162));u=n.memoizedProps,l=n.stateNode;try{l.nodeValue=u}catch(Z){it(n,n.return,Z)}}break;case 3:if(jd=null,f=hs,hs=wd(a.containerInfo),kn(a,n),hs=f,Vn(n),u&4&&l!==null&&l.memoizedState.isDehydrated)try{gc(a.containerInfo)}catch(Z){it(n,n.return,Z)}Tm&&(Tm=!1,L_(n));break;case 4:u=hs,hs=wd(n.stateNode.containerInfo),kn(a,n),Vn(n),hs=u;break;case 12:kn(a,n),Vn(n);break;case 13:kn(a,n),Vn(n),n.child.flags&8192&&n.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(jm=$n()),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,Nm(n,u)));break;case 22:f=n.memoizedState!==null;var L=l!==null&&l.memoizedState!==null,Q=ya,se=xt;if(ya=Q||f,xt=se||L,kn(a,n),xt=se,ya=Q,Vn(n),u&8192)e:for(a=n.stateNode,a._visibility=f?a._visibility&-2:a._visibility|1,f&&(l===null||L||ya||xt||gr(n)),l=null,a=n;;){if(a.tag===5||a.tag===26){if(l===null){L=l=a;try{if(g=L.stateNode,f)b=g.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{w=L.stateNode;var oe=L.memoizedProps.style,X=oe!=null&&oe.hasOwnProperty("display")?oe.display:null;w.style.display=X==null||typeof X=="boolean"?"":(""+X).trim()}}catch(Z){it(L,L.return,Z)}}}else if(a.tag===6){if(l===null){L=a;try{L.stateNode.nodeValue=f?"":L.memoizedProps}catch(Z){it(L,L.return,Z)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===n)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break e;for(;a.sibling===null;){if(a.return===null||a.return===n)break e;l===a&&(l=null),a=a.return}l===a&&(l=null),a.sibling.return=a.return,a=a.sibling}u&4&&(u=n.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,Nm(n,l))));break;case 19:kn(a,n),Vn(n),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,Nm(n,u)));break;case 30:break;case 21:break;default:kn(a,n),Vn(n)}}function Vn(n){var a=n.flags;if(a&2){try{for(var l,u=n.return;u!==null;){if(I_(u)){l=u;break}u=u.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var f=l.stateNode,g=Em(n);md(n,g,f);break;case 5:var b=l.stateNode;l.flags&32&&(Yn(b,""),l.flags&=-33);var w=Em(n);md(n,w,b);break;case 3:case 4:var L=l.stateNode.containerInfo,Q=Em(n);bm(n,Q,L);break;default:throw Error(i(161))}}catch(se){it(n,n.return,se)}n.flags&=-3}a&4096&&(n.flags&=-4097)}function L_(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var a=n;L_(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),n=n.sibling}}function Qa(n,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)O_(n,a.alternate,a),a=a.sibling}function gr(n){for(n=n.child;n!==null;){var a=n;switch(a.tag){case 0:case 11:case 14:case 15:Ya(4,a,a.return),gr(a);break;case 1:Ps(a,a.return);var l=a.stateNode;typeof l.componentWillUnmount=="function"&&C_(a,a.return,l),gr(a);break;case 27:lc(a.stateNode);case 26:case 5:Ps(a,a.return),gr(a);break;case 22:a.memoizedState===null&&gr(a);break;case 30:gr(a);break;default:gr(a)}n=n.sibling}}function Xa(n,a,l){for(l=l&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var u=a.alternate,f=n,g=a,b=g.flags;switch(g.tag){case 0:case 11:case 15:Xa(f,g,l),Zl(4,g);break;case 1:if(Xa(f,g,l),u=g,f=u.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(Q){it(u,u.return,Q)}if(u=g,f=u.updateQueue,f!==null){var w=u.stateNode;try{var L=f.shared.hiddenCallbacks;if(L!==null)for(f.shared.hiddenCallbacks=null,f=0;f<L.length;f++)fy(L[f],w)}catch(Q){it(u,u.return,Q)}}l&&b&64&&w_(g),Jl(g,g.return);break;case 27:R_(g);case 26:case 5:Xa(f,g,l),l&&u===null&&b&4&&j_(g),Jl(g,g.return);break;case 12:Xa(f,g,l);break;case 13:Xa(f,g,l),l&&b&4&&k_(f,g);break;case 22:g.memoizedState===null&&Xa(f,g,l),Jl(g,g.return);break;case 30:break;default:Xa(f,g,l)}a=a.sibling}}function xm(n,a){var l=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),n=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(n=a.memoizedState.cachePool.pool),n!==l&&(n!=null&&n.refCount++,l!=null&&Ll(l))}function Am(n,a){n=null,a.alternate!==null&&(n=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==n&&(a.refCount++,n!=null&&Ll(n))}function ks(n,a,l,u){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)U_(n,a,l,u),a=a.sibling}function U_(n,a,l,u){var f=a.flags;switch(a.tag){case 0:case 11:case 15:ks(n,a,l,u),f&2048&&Zl(9,a);break;case 1:ks(n,a,l,u);break;case 3:ks(n,a,l,u),f&2048&&(n=null,a.alternate!==null&&(n=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==n&&(a.refCount++,n!=null&&Ll(n)));break;case 12:if(f&2048){ks(n,a,l,u),n=a.stateNode;try{var g=a.memoizedProps,b=g.id,w=g.onPostCommit;typeof w=="function"&&w(b,a.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(L){it(a,a.return,L)}}else ks(n,a,l,u);break;case 13:ks(n,a,l,u);break;case 23:break;case 22:g=a.stateNode,b=a.alternate,a.memoizedState!==null?g._visibility&2?ks(n,a,l,u):ec(n,a):g._visibility&2?ks(n,a,l,u):(g._visibility|=2,yo(n,a,l,u,(a.subtreeFlags&10256)!==0)),f&2048&&xm(b,a);break;case 24:ks(n,a,l,u),f&2048&&Am(a.alternate,a);break;default:ks(n,a,l,u)}}function yo(n,a,l,u,f){for(f=f&&(a.subtreeFlags&10256)!==0,a=a.child;a!==null;){var g=n,b=a,w=l,L=u,Q=b.flags;switch(b.tag){case 0:case 11:case 15:yo(g,b,w,L,f),Zl(8,b);break;case 23:break;case 22:var se=b.stateNode;b.memoizedState!==null?se._visibility&2?yo(g,b,w,L,f):ec(g,b):(se._visibility|=2,yo(g,b,w,L,f)),f&&Q&2048&&xm(b.alternate,b);break;case 24:yo(g,b,w,L,f),f&&Q&2048&&Am(b.alternate,b);break;default:yo(g,b,w,L,f)}a=a.sibling}}function ec(n,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var l=n,u=a,f=u.flags;switch(u.tag){case 22:ec(l,u),f&2048&&xm(u.alternate,u);break;case 24:ec(l,u),f&2048&&Am(u.alternate,u);break;default:ec(l,u)}a=a.sibling}}var tc=8192;function _o(n){if(n.subtreeFlags&tc)for(n=n.child;n!==null;)F_(n),n=n.sibling}function F_(n){switch(n.tag){case 26:_o(n),n.flags&tc&&n.memoizedState!==null&&_w(hs,n.memoizedState,n.memoizedProps);break;case 5:_o(n);break;case 3:case 4:var a=hs;hs=wd(n.stateNode.containerInfo),_o(n),hs=a;break;case 22:n.memoizedState===null&&(a=n.alternate,a!==null&&a.memoizedState!==null?(a=tc,tc=16777216,_o(n),tc=a):_o(n));break;default:_o(n)}}function q_(n){var a=n.alternate;if(a!==null&&(n=a.child,n!==null)){a.child=null;do a=n.sibling,n.sibling=null,n=a;while(n!==null)}}function nc(n){var a=n.deletions;if((n.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var u=a[l];Gt=u,z_(u,n)}q_(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)B_(n),n=n.sibling}function B_(n){switch(n.tag){case 0:case 11:case 15:nc(n),n.flags&2048&&Ya(9,n,n.return);break;case 3:nc(n);break;case 12:nc(n);break;case 22:var a=n.stateNode;n.memoizedState!==null&&a._visibility&2&&(n.return===null||n.return.tag!==13)?(a._visibility&=-3,pd(n)):nc(n);break;default:nc(n)}}function pd(n){var a=n.deletions;if((n.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var u=a[l];Gt=u,z_(u,n)}q_(n)}for(n=n.child;n!==null;){switch(a=n,a.tag){case 0:case 11:case 15:Ya(8,a,a.return),pd(a);break;case 22:l=a.stateNode,l._visibility&2&&(l._visibility&=-3,pd(a));break;default:pd(a)}n=n.sibling}}function z_(n,a){for(;Gt!==null;){var l=Gt;switch(l.tag){case 0:case 11:case 15:Ya(8,l,a);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Ll(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,Gt=u;else e:for(l=n;Gt!==null;){u=Gt;var f=u.sibling,g=u.return;if(M_(u),u===l){Gt=null;break e}if(f!==null){f.return=g,Gt=f;break e}Gt=g}}}var PS={getCacheForType:function(n){var a=cn(Pt),l=a.data.get(n);return l===void 0&&(l=n(),a.data.set(n,l)),l}},kS=typeof WeakMap=="function"?WeakMap:Map,Je=0,lt=null,Le=null,Ge=0,et=0,Ln=null,Wa=!1,Eo=!1,Sm=!1,Ea=0,Et=0,Za=0,vr=0,wm=0,ss=0,bo=0,sc=null,Sn=null,Cm=!1,jm=0,gd=1/0,vd=null,Ja=null,Zt=0,ei=null,To=null,No=0,Im=0,Rm=null,H_=null,ac=0,Dm=null;function Un(){if((Je&2)!==0&&Ge!==0)return Ge&-Ge;if(H.T!==null){var n=co;return n!==0?n:Um()}return Pa()}function G_(){ss===0&&(ss=(Ge&536870912)===0||Qe?fl():536870912);var n=ns.current;return n!==null&&(n.flags|=32),ss}function Fn(n,a,l){(n===lt&&(et===2||et===9)||n.cancelPendingCommit!==null)&&(xo(n,0),ti(n,Ge,ss,!1)),Zs(n,l),((Je&2)===0||n!==lt)&&(n===lt&&((Je&2)===0&&(vr|=l),Et===4&&ti(n,Ge,ss,!1)),Vs(n))}function $_(n,a,l){if((Je&6)!==0)throw Error(i(327));var u=!l&&(a&124)===0&&(a&n.expiredLanes)===0||zi(n,a),f=u?US(n,a):Pm(n,a,!0),g=u;do{if(f===0){Eo&&!u&&ti(n,a,0,!1);break}else{if(l=n.current.alternate,g&&!VS(l)){f=Pm(n,a,!1),g=!1;continue}if(f===2){if(g=a,n.errorRecoveryDisabledLanes&g)var b=0;else b=n.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){a=b;e:{var w=n;f=sc;var L=w.current.memoizedState.isDehydrated;if(L&&(xo(w,b).flags|=256),b=Pm(w,b,!1),b!==2){if(Sm&&!L){w.errorRecoveryDisabledLanes|=g,vr|=g,f=4;break e}g=Sn,Sn=f,g!==null&&(Sn===null?Sn=g:Sn.push.apply(Sn,g))}f=b}if(g=!1,f!==2)continue}}if(f===1){xo(n,0),ti(n,a,0,!0);break}e:{switch(u=n,g=f,g){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:ti(u,a,ss,!Wa);break e;case 2:Sn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(f=jm+300-$n(),10<f)){if(ti(u,a,ss,!Wa),Fr(u,0,!0)!==0)break e;u.timeoutHandle=bE(K_.bind(null,u,l,Sn,vd,Cm,a,ss,vr,bo,Wa,g,2,-0,0),f);break e}K_(u,l,Sn,vd,Cm,a,ss,vr,bo,Wa,g,0,-0,0)}}break}while(!0);Vs(n)}function K_(n,a,l,u,f,g,b,w,L,Q,se,oe,X,Z){if(n.timeoutHandle=-1,oe=a.subtreeFlags,(oe&8192||(oe&16785408)===16785408)&&(dc={stylesheets:null,count:0,unsuspend:yw},F_(a),oe=Ew(),oe!==null)){n.cancelPendingCommit=oe(eE.bind(null,n,a,g,l,u,f,b,w,L,se,1,X,Z)),ti(n,g,b,!Q);return}eE(n,a,g,l,u,f,b,w,L)}function VS(n){for(var a=n;;){var l=a.tag;if((l===0||l===11||l===15)&&a.flags&16384&&(l=a.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var f=l[u],g=f.getSnapshot;f=f.value;try{if(!Mn(g(),f))return!1}catch{return!1}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function ti(n,a,l,u){a&=~wm,a&=~vr,n.suspendedLanes|=a,n.pingedLanes&=~a,u&&(n.warmLanes|=a),u=n.expirationTimes;for(var f=a;0<f;){var g=31-ln(f),b=1<<g;u[g]=-1,f&=~b}l!==0&&Ts(n,l,a)}function yd(){return(Je&6)===0?(ic(0),!1):!0}function Om(){if(Le!==null){if(et===0)var n=Le.return;else n=Le,ha=dr=null,Xf(n),go=null,Ql=0,n=Le;for(;n!==null;)S_(n.alternate,n),n=n.return;Le=null}}function xo(n,a){var l=n.timeoutHandle;l!==-1&&(n.timeoutHandle=-1,tw(l)),l=n.cancelPendingCommit,l!==null&&(n.cancelPendingCommit=null,l()),Om(),lt=n,Le=l=ca(n.current,null),Ge=a,et=0,Ln=null,Wa=!1,Eo=zi(n,a),Sm=!1,bo=ss=wm=vr=Za=Et=0,Sn=sc=null,Cm=!1,(a&8)!==0&&(a|=a&32);var u=n.entangledLanes;if(u!==0)for(n=n.entanglements,u&=a;0<u;){var f=31-ln(u),g=1<<f;a|=n[f],u&=~g}return Ea=a,Fu(),l}function Y_(n,a){Oe=null,H.H=id,a===Fl||a===Qu?(a=dy(),et=3):a===ly?(a=dy(),et=4):et=a===h_?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Ln=a,Le===null&&(Et=1,ud(n,Zn(a,n.current)))}function Q_(){var n=H.H;return H.H=id,n===null?id:n}function X_(){var n=H.A;return H.A=PS,n}function Mm(){Et=4,Wa||(Ge&4194048)!==Ge&&ns.current!==null||(Eo=!0),(Za&134217727)===0&&(vr&134217727)===0||lt===null||ti(lt,Ge,ss,!1)}function Pm(n,a,l){var u=Je;Je|=2;var f=Q_(),g=X_();(lt!==n||Ge!==a)&&(vd=null,xo(n,a)),a=!1;var b=Et;e:do try{if(et!==0&&Le!==null){var w=Le,L=Ln;switch(et){case 8:Om(),b=6;break e;case 3:case 2:case 9:case 6:ns.current===null&&(a=!0);var Q=et;if(et=0,Ln=null,Ao(n,w,L,Q),l&&Eo){b=0;break e}break;default:Q=et,et=0,Ln=null,Ao(n,w,L,Q)}}LS(),b=Et;break}catch(se){Y_(n,se)}while(!0);return a&&n.shellSuspendCounter++,ha=dr=null,Je=u,H.H=f,H.A=g,Le===null&&(lt=null,Ge=0,Fu()),b}function LS(){for(;Le!==null;)W_(Le)}function US(n,a){var l=Je;Je|=2;var u=Q_(),f=X_();lt!==n||Ge!==a?(vd=null,gd=$n()+500,xo(n,a)):Eo=zi(n,a);e:do try{if(et!==0&&Le!==null){a=Le;var g=Ln;t:switch(et){case 1:et=0,Ln=null,Ao(n,a,g,1);break;case 2:case 9:if(cy(g)){et=0,Ln=null,Z_(a);break}a=function(){et!==2&&et!==9||lt!==n||(et=7),Vs(n)},g.then(a,a);break e;case 3:et=7;break e;case 4:et=5;break e;case 7:cy(g)?(et=0,Ln=null,Z_(a)):(et=0,Ln=null,Ao(n,a,g,7));break;case 5:var b=null;switch(Le.tag){case 26:b=Le.memoizedState;case 5:case 27:var w=Le;if(!b||OE(b)){et=0,Ln=null;var L=w.sibling;if(L!==null)Le=L;else{var Q=w.return;Q!==null?(Le=Q,_d(Q)):Le=null}break t}}et=0,Ln=null,Ao(n,a,g,5);break;case 6:et=0,Ln=null,Ao(n,a,g,6);break;case 8:Om(),Et=6;break e;default:throw Error(i(462))}}FS();break}catch(se){Y_(n,se)}while(!0);return ha=dr=null,H.H=u,H.A=f,Je=l,Le!==null?0:(lt=null,Ge=0,Fu(),Et)}function FS(){for(;Le!==null&&!cl();)W_(Le)}function W_(n){var a=x_(n.alternate,n,Ea);n.memoizedProps=n.pendingProps,a===null?_d(n):Le=a}function Z_(n){var a=n,l=a.alternate;switch(a.tag){case 15:case 0:a=y_(l,a,a.pendingProps,a.type,void 0,Ge);break;case 11:a=y_(l,a,a.pendingProps,a.type.render,a.ref,Ge);break;case 5:Xf(a);default:S_(l,a),a=Le=Jv(a,Ea),a=x_(l,a,Ea)}n.memoizedProps=n.pendingProps,a===null?_d(n):Le=a}function Ao(n,a,l,u){ha=dr=null,Xf(a),go=null,Ql=0;var f=a.return;try{if(jS(n,f,a,l,Ge)){Et=1,ud(n,Zn(l,n.current)),Le=null;return}}catch(g){if(f!==null)throw Le=f,g;Et=1,ud(n,Zn(l,n.current)),Le=null;return}a.flags&32768?(Qe||u===1?n=!0:Eo||(Ge&536870912)!==0?n=!1:(Wa=n=!0,(u===2||u===9||u===3||u===6)&&(u=ns.current,u!==null&&u.tag===13&&(u.flags|=16384))),J_(a,n)):_d(a)}function _d(n){var a=n;do{if((a.flags&32768)!==0){J_(a,Wa);return}n=a.return;var l=RS(a.alternate,a,Ea);if(l!==null){Le=l;return}if(a=a.sibling,a!==null){Le=a;return}Le=a=n}while(a!==null);Et===0&&(Et=5)}function J_(n,a){do{var l=DS(n.alternate,n);if(l!==null){l.flags&=32767,Le=l;return}if(l=n.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!a&&(n=n.sibling,n!==null)){Le=n;return}Le=n=l}while(n!==null);Et=6,Le=null}function eE(n,a,l,u,f,g,b,w,L){n.cancelPendingCommit=null;do Ed();while(Zt!==0);if((Je&6)!==0)throw Error(i(327));if(a!==null){if(a===n.current)throw Error(i(177));if(g=a.lanes|a.childLanes,g|=Af,pl(n,l,g,b,w,L),n===lt&&(Le=lt=null,Ge=0),To=a,ei=n,No=l,Im=g,Rm=f,H_=u,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,HS(Ui,function(){return iE(),null})):(n.callbackNode=null,n.callbackPriority=0),u=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||u){u=H.T,H.T=null,f=te.p,te.p=2,b=Je,Je|=4;try{OS(n,a,l)}finally{Je=b,te.p=f,H.T=u}}Zt=1,tE(),nE(),sE()}}function tE(){if(Zt===1){Zt=0;var n=ei,a=To,l=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||l){l=H.T,H.T=null;var u=te.p;te.p=2;var f=Je;Je|=4;try{V_(a,n);var g=Km,b=zv(n.containerInfo),w=g.focusedElem,L=g.selectionRange;if(b!==w&&w&&w.ownerDocument&&Bv(w.ownerDocument.documentElement,w)){if(L!==null&&Ef(w)){var Q=L.start,se=L.end;if(se===void 0&&(se=Q),"selectionStart"in w)w.selectionStart=Q,w.selectionEnd=Math.min(se,w.value.length);else{var oe=w.ownerDocument||document,X=oe&&oe.defaultView||window;if(X.getSelection){var Z=X.getSelection(),we=w.textContent.length,Ne=Math.min(L.start,we),at=L.end===void 0?Ne:Math.min(L.end,we);!Z.extend&&Ne>at&&(b=at,at=Ne,Ne=b);var G=qv(w,Ne),z=qv(w,at);if(G&&z&&(Z.rangeCount!==1||Z.anchorNode!==G.node||Z.anchorOffset!==G.offset||Z.focusNode!==z.node||Z.focusOffset!==z.offset)){var Y=oe.createRange();Y.setStart(G.node,G.offset),Z.removeAllRanges(),Ne>at?(Z.addRange(Y),Z.extend(z.node,z.offset)):(Y.setEnd(z.node,z.offset),Z.addRange(Y))}}}}for(oe=[],Z=w;Z=Z.parentNode;)Z.nodeType===1&&oe.push({element:Z,left:Z.scrollLeft,top:Z.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<oe.length;w++){var ie=oe[w];ie.element.scrollLeft=ie.left,ie.element.scrollTop=ie.top}}Dd=!!$m,Km=$m=null}finally{Je=f,te.p=u,H.T=l}}n.current=a,Zt=2}}function nE(){if(Zt===2){Zt=0;var n=ei,a=To,l=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||l){l=H.T,H.T=null;var u=te.p;te.p=2;var f=Je;Je|=4;try{O_(n,a.alternate,a)}finally{Je=f,te.p=u,H.T=l}}Zt=3}}function sE(){if(Zt===4||Zt===3){Zt=0,pu();var n=ei,a=To,l=No,u=H_;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Zt=5:(Zt=0,To=ei=null,aE(n,n.pendingLanes));var f=n.pendingLanes;if(f===0&&(Ja=null),qr(l),a=a.stateNode,Ze&&typeof Ze.onCommitFiberRoot=="function")try{Ze.onCommitFiberRoot(yt,a,void 0,(a.current.flags&128)===128)}catch{}if(u!==null){a=H.T,f=te.p,te.p=2,H.T=null;try{for(var g=n.onRecoverableError,b=0;b<u.length;b++){var w=u[b];g(w.value,{componentStack:w.stack})}}finally{H.T=a,te.p=f}}(No&3)!==0&&Ed(),Vs(n),f=n.pendingLanes,(l&4194090)!==0&&(f&42)!==0?n===Dm?ac++:(ac=0,Dm=n):ac=0,ic(0)}}function aE(n,a){(n.pooledCacheLanes&=a)===0&&(a=n.pooledCache,a!=null&&(n.pooledCache=null,Ll(a)))}function Ed(n){return tE(),nE(),sE(),iE()}function iE(){if(Zt!==5)return!1;var n=ei,a=Im;Im=0;var l=qr(No),u=H.T,f=te.p;try{te.p=32>l?32:l,H.T=null,l=Rm,Rm=null;var g=ei,b=No;if(Zt=0,To=ei=null,No=0,(Je&6)!==0)throw Error(i(331));var w=Je;if(Je|=4,B_(g.current),U_(g,g.current,b,l),Je=w,ic(0,!1),Ze&&typeof Ze.onPostCommitFiberRoot=="function")try{Ze.onPostCommitFiberRoot(yt,g)}catch{}return!0}finally{te.p=f,H.T=u,aE(n,a)}}function rE(n,a,l){a=Zn(l,a),a=um(n.stateNode,a,2),n=Ha(n,a,2),n!==null&&(Zs(n,2),Vs(n))}function it(n,a,l){if(n.tag===3)rE(n,n,l);else for(;a!==null;){if(a.tag===3){rE(a,n,l);break}else if(a.tag===1){var u=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Ja===null||!Ja.has(u))){n=Zn(l,n),l=u_(2),u=Ha(a,l,2),u!==null&&(d_(l,u,a,n),Zs(u,2),Vs(u));break}}a=a.return}}function km(n,a,l){var u=n.pingCache;if(u===null){u=n.pingCache=new kS;var f=new Set;u.set(a,f)}else f=u.get(a),f===void 0&&(f=new Set,u.set(a,f));f.has(l)||(Sm=!0,f.add(l),n=qS.bind(null,n,a,l),a.then(n,n))}function qS(n,a,l){var u=n.pingCache;u!==null&&u.delete(a),n.pingedLanes|=n.suspendedLanes&l,n.warmLanes&=~l,lt===n&&(Ge&l)===l&&(Et===4||Et===3&&(Ge&62914560)===Ge&&300>$n()-jm?(Je&2)===0&&xo(n,0):wm|=l,bo===Ge&&(bo=0)),Vs(n)}function oE(n,a){a===0&&(a=ml()),n=io(n,a),n!==null&&(Zs(n,a),Vs(n))}function BS(n){var a=n.memoizedState,l=0;a!==null&&(l=a.retryLane),oE(n,l)}function zS(n,a){var l=0;switch(n.tag){case 13:var u=n.stateNode,f=n.memoizedState;f!==null&&(l=f.retryLane);break;case 19:u=n.stateNode;break;case 22:u=n.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(a),oE(n,l)}function HS(n,a){return Vi(n,a)}var bd=null,So=null,Vm=!1,Td=!1,Lm=!1,yr=0;function Vs(n){n!==So&&n.next===null&&(So===null?bd=So=n:So=So.next=n),Td=!0,Vm||(Vm=!0,$S())}function ic(n,a){if(!Lm&&Td){Lm=!0;do for(var l=!1,u=bd;u!==null;){if(n!==0){var f=u.pendingLanes;if(f===0)var g=0;else{var b=u.suspendedLanes,w=u.pingedLanes;g=(1<<31-ln(42|n)+1)-1,g&=f&~(b&~w),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(l=!0,dE(u,g))}else g=Ge,g=Fr(u,u===lt?g:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(g&3)===0||zi(u,g)||(l=!0,dE(u,g));u=u.next}while(l);Lm=!1}}function GS(){lE()}function lE(){Td=Vm=!1;var n=0;yr!==0&&(ew()&&(n=yr),yr=0);for(var a=$n(),l=null,u=bd;u!==null;){var f=u.next,g=cE(u,a);g===0?(u.next=null,l===null?bd=f:l.next=f,f===null&&(So=l)):(l=u,(n!==0||(g&3)!==0)&&(Td=!0)),u=f}ic(n)}function cE(n,a){for(var l=n.suspendedLanes,u=n.pingedLanes,f=n.expirationTimes,g=n.pendingLanes&-62914561;0<g;){var b=31-ln(g),w=1<<b,L=f[b];L===-1?((w&l)===0||(w&u)!==0)&&(f[b]=hl(w,a)):L<=a&&(n.expiredLanes|=w),g&=~w}if(a=lt,l=Ge,l=Fr(n,n===a?l:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),u=n.callbackNode,l===0||n===a&&(et===2||et===9)||n.cancelPendingCommit!==null)return u!==null&&u!==null&&Li(u),n.callbackNode=null,n.callbackPriority=0;if((l&3)===0||zi(n,l)){if(a=l&-l,a===n.callbackPriority)return a;switch(u!==null&&Li(u),qr(l)){case 2:case 8:l=Lr;break;case 32:l=Ui;break;case 268435456:l=Ur;break;default:l=Ui}return u=uE.bind(null,n),l=Vi(l,u),n.callbackPriority=a,n.callbackNode=l,a}return u!==null&&u!==null&&Li(u),n.callbackPriority=2,n.callbackNode=null,2}function uE(n,a){if(Zt!==0&&Zt!==5)return n.callbackNode=null,n.callbackPriority=0,null;var l=n.callbackNode;if(Ed()&&n.callbackNode!==l)return null;var u=Ge;return u=Fr(n,n===lt?u:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),u===0?null:($_(n,u,a),cE(n,$n()),n.callbackNode!=null&&n.callbackNode===l?uE.bind(null,n):null)}function dE(n,a){if(Ed())return null;$_(n,a,!0)}function $S(){nw(function(){(Je&6)!==0?Vi(ul,GS):lE()})}function Um(){return yr===0&&(yr=fl()),yr}function hE(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Kr(""+n)}function fE(n,a){var l=a.ownerDocument.createElement("input");return l.name=a.name,l.value=a.value,n.id&&l.setAttribute("form",n.id),a.parentNode.insertBefore(l,a),n=new FormData(n),l.parentNode.removeChild(l),n}function KS(n,a,l,u,f){if(a==="submit"&&l&&l.stateNode===f){var g=hE((f[St]||null).action),b=u.submitter;b&&(a=(a=b[St]||null)?hE(a.formAction):b.getAttribute("formAction"),a!==null&&(g=a,b=null));var w=new Yr("action","action",null,u,f);n.push({event:w,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(yr!==0){var L=b?fE(f,b):new FormData(f);im(l,{pending:!0,data:L,method:f.method,action:g},null,L)}}else typeof g=="function"&&(w.preventDefault(),L=b?fE(f,b):new FormData(f),im(l,{pending:!0,data:L,method:f.method,action:g},g,L))},currentTarget:f}]})}}for(var Fm=0;Fm<xf.length;Fm++){var qm=xf[Fm],YS=qm.toLowerCase(),QS=qm[0].toUpperCase()+qm.slice(1);ds(YS,"on"+QS)}ds($v,"onAnimationEnd"),ds(Kv,"onAnimationIteration"),ds(Yv,"onAnimationStart"),ds("dblclick","onDoubleClick"),ds("focusin","onFocus"),ds("focusout","onBlur"),ds(hS,"onTransitionRun"),ds(fS,"onTransitionStart"),ds(mS,"onTransitionCancel"),ds(Qv,"onTransitionEnd"),ea("onMouseEnter",["mouseout","mouseover"]),ea("onMouseLeave",["mouseout","mouseover"]),ea("onPointerEnter",["pointerout","pointerover"]),ea("onPointerLeave",["pointerout","pointerover"]),cs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),cs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),cs("onBeforeInput",["compositionend","keypress","textInput","paste"]),cs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),cs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),cs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),XS=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(rc));function mE(n,a){a=(a&4)!==0;for(var l=0;l<n.length;l++){var u=n[l],f=u.event;u=u.listeners;e:{var g=void 0;if(a)for(var b=u.length-1;0<=b;b--){var w=u[b],L=w.instance,Q=w.currentTarget;if(w=w.listener,L!==g&&f.isPropagationStopped())break e;g=w,f.currentTarget=Q;try{g(f)}catch(se){cd(se)}f.currentTarget=null,g=L}else for(b=0;b<u.length;b++){if(w=u[b],L=w.instance,Q=w.currentTarget,w=w.listener,L!==g&&f.isPropagationStopped())break e;g=w,f.currentTarget=Q;try{g(f)}catch(se){cd(se)}f.currentTarget=null,g=L}}}}function Ue(n,a){var l=a[vl];l===void 0&&(l=a[vl]=new Set);var u=n+"__bubble";l.has(u)||(pE(a,n,2,!1),l.add(u))}function Bm(n,a,l){var u=0;a&&(u|=4),pE(l,n,u,a)}var Nd="_reactListening"+Math.random().toString(36).slice(2);function zm(n){if(!n[Nd]){n[Nd]=!0,yl.forEach(function(l){l!=="selectionchange"&&(XS.has(l)||Bm(l,!1,n),Bm(l,!0,n))});var a=n.nodeType===9?n:n.ownerDocument;a===null||a[Nd]||(a[Nd]=!0,Bm("selectionchange",!1,a))}}function pE(n,a,l,u){switch(UE(a)){case 2:var f=Nw;break;case 8:f=xw;break;default:f=sp}l=f.bind(null,a,l,n),f=void 0,!Xn||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(f=!0),u?f!==void 0?n.addEventListener(a,l,{capture:!0,passive:f}):n.addEventListener(a,l,!0):f!==void 0?n.addEventListener(a,l,{passive:f}):n.addEventListener(a,l,!1)}function Hm(n,a,l,u,f){var g=u;if((a&1)===0&&(a&2)===0&&u!==null)e:for(;;){if(u===null)return;var b=u.tag;if(b===3||b===4){var w=u.stateNode.containerInfo;if(w===f)break;if(b===4)for(b=u.return;b!==null;){var L=b.tag;if((L===3||L===4)&&b.stateNode.containerInfo===f)return;b=b.return}for(;w!==null;){if(b=Js(w),b===null)return;if(L=b.tag,L===5||L===6||L===26||L===27){u=g=b;continue e}w=w.parentNode}}u=u.return}Au(function(){var Q=g,se=Qn(l),oe=[];e:{var X=Xv.get(n);if(X!==void 0){var Z=Yr,we=n;switch(n){case"keypress":if(Cs(l)===0)break e;case"keydown":case"keyup":Z=eo;break;case"focusin":we="focus",Z=Wr;break;case"focusout":we="blur",Z=Wr;break;case"beforeblur":case"afterblur":Z=Wr;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Z=Wn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Z=gf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Z=Ou;break;case $v:case Kv:case Yv:Z=Zr;break;case Qv:Z=Pu;break;case"scroll":case"scrollend":Z=Su;break;case"wheel":Z=to;break;case"copy":case"cut":case"paste":Z=Jr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Z=Il;break;case"toggle":case"beforetoggle":Z=Vu}var Ne=(a&4)!==0,at=!Ne&&(n==="scroll"||n==="scrollend"),G=Ne?X!==null?X+"Capture":null:X;Ne=[];for(var z=Q,Y;z!==null;){var ie=z;if(Y=ie.stateNode,ie=ie.tag,ie!==5&&ie!==26&&ie!==27||Y===null||G===null||(ie=Wi(z,G),ie!=null&&Ne.push(oc(z,ie,Y))),at)break;z=z.return}0<Ne.length&&(X=new Z(X,we,null,l,se),oe.push({event:X,listeners:Ne}))}}if((a&7)===0){e:{if(X=n==="mouseover"||n==="pointerover",Z=n==="mouseout"||n==="pointerout",X&&l!==sa&&(we=l.relatedTarget||l.fromElement)&&(Js(we)||we[Kn]))break e;if((Z||X)&&(X=se.window===se?se:(X=se.ownerDocument)?X.defaultView||X.parentWindow:window,Z?(we=l.relatedTarget||l.toElement,Z=Q,we=we?Js(we):null,we!==null&&(at=c(we),Ne=we.tag,we!==at||Ne!==5&&Ne!==27&&Ne!==6)&&(we=null)):(Z=null,we=Q),Z!==we)){if(Ne=Wn,ie="onMouseLeave",G="onMouseEnter",z="mouse",(n==="pointerout"||n==="pointerover")&&(Ne=Il,ie="onPointerLeave",G="onPointerEnter",z="pointer"),at=Z==null?X:xs(Z),Y=we==null?X:xs(we),X=new Ne(ie,z+"leave",Z,l,se),X.target=at,X.relatedTarget=Y,ie=null,Js(se)===Q&&(Ne=new Ne(G,z+"enter",we,l,se),Ne.target=Y,Ne.relatedTarget=at,ie=Ne),at=ie,Z&&we)t:{for(Ne=Z,G=we,z=0,Y=Ne;Y;Y=wo(Y))z++;for(Y=0,ie=G;ie;ie=wo(ie))Y++;for(;0<z-Y;)Ne=wo(Ne),z--;for(;0<Y-z;)G=wo(G),Y--;for(;z--;){if(Ne===G||G!==null&&Ne===G.alternate)break t;Ne=wo(Ne),G=wo(G)}Ne=null}else Ne=null;Z!==null&&gE(oe,X,Z,Ne,!1),we!==null&&at!==null&&gE(oe,at,we,Ne,!0)}}e:{if(X=Q?xs(Q):window,Z=X.nodeName&&X.nodeName.toLowerCase(),Z==="select"||Z==="input"&&X.type==="file")var ve=Pv;else if(Mt(X))if(kv)ve=cS;else{ve=oS;var ke=rS}else Z=X.nodeName,!Z||Z.toLowerCase()!=="input"||X.type!=="checkbox"&&X.type!=="radio"?Q&&Nl(Q.elementType)&&(ve=Pv):ve=lS;if(ve&&(ve=ve(n,Q))){la(oe,ve,l,se);break e}ke&&ke(n,X,Q),n==="focusout"&&Q&&X.type==="number"&&Q.memoizedProps.value!=null&&Ua(X,"number",X.value)}switch(ke=Q?xs(Q):window,n){case"focusin":(Mt(ke)||ke.contentEditable==="true")&&(no=ke,bf=Q,Ol=null);break;case"focusout":Ol=bf=no=null;break;case"mousedown":Tf=!0;break;case"contextmenu":case"mouseup":case"dragend":Tf=!1,Hv(oe,l,se);break;case"selectionchange":if(dS)break;case"keydown":case"keyup":Hv(oe,l,se)}var ye;if(Rs)e:{switch(n){case"compositionstart":var xe="onCompositionStart";break e;case"compositionend":xe="onCompositionEnd";break e;case"compositionupdate":xe="onCompositionUpdate";break e}xe=void 0}else ze?J(n,l)&&(xe="onCompositionEnd"):n==="keydown"&&l.keyCode===229&&(xe="onCompositionStart");xe&&(E&&l.locale!=="ko"&&(ze||xe!=="onCompositionStart"?xe==="onCompositionEnd"&&ze&&(ye=Al()):(ws=se,Fa="value"in ws?ws.value:ws.textContent,ze=!0)),ke=xd(Q,xe),0<ke.length&&(xe=new Cl(xe,n,null,l,se),oe.push({event:xe,listeners:ke}),ye?xe.data=ye:(ye=de(l),ye!==null&&(xe.data=ye)))),(ye=y?Ot(n,l):He(n,l))&&(xe=xd(Q,"onBeforeInput"),0<xe.length&&(ke=new Cl("onBeforeInput","beforeinput",null,l,se),oe.push({event:ke,listeners:xe}),ke.data=ye)),KS(oe,n,Q,l,se)}mE(oe,a)})}function oc(n,a,l){return{instance:n,listener:a,currentTarget:l}}function xd(n,a){for(var l=a+"Capture",u=[];n!==null;){var f=n,g=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||g===null||(f=Wi(n,l),f!=null&&u.unshift(oc(n,f,g)),f=Wi(n,a),f!=null&&u.push(oc(n,f,g))),n.tag===3)return u;n=n.return}return[]}function wo(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function gE(n,a,l,u,f){for(var g=a._reactName,b=[];l!==null&&l!==u;){var w=l,L=w.alternate,Q=w.stateNode;if(w=w.tag,L!==null&&L===u)break;w!==5&&w!==26&&w!==27||Q===null||(L=Q,f?(Q=Wi(l,g),Q!=null&&b.unshift(oc(l,Q,L))):f||(Q=Wi(l,g),Q!=null&&b.push(oc(l,Q,L)))),l=l.return}b.length!==0&&n.push({event:a,listeners:b})}var WS=/\r\n?/g,ZS=/\u0000|\uFFFD/g;function vE(n){return(typeof n=="string"?n:""+n).replace(WS,`
`).replace(ZS,"")}function yE(n,a){return a=vE(a),vE(n)===a}function Ad(){}function st(n,a,l,u,f,g){switch(l){case"children":typeof u=="string"?a==="body"||a==="textarea"&&u===""||Yn(n,u):(typeof u=="number"||typeof u=="bigint")&&a!=="body"&&Yn(n,""+u);break;case"className":As(n,"class",u);break;case"tabIndex":As(n,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":As(n,l,u);break;case"style":Tl(n,u,g);break;case"data":if(a!=="object"){As(n,"data",u);break}case"src":case"href":if(u===""&&(a!=="a"||l!=="href")){n.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){n.removeAttribute(l);break}u=Kr(""+u),n.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){n.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(l==="formAction"?(a!=="input"&&st(n,a,"name",f.name,f,null),st(n,a,"formEncType",f.formEncType,f,null),st(n,a,"formMethod",f.formMethod,f,null),st(n,a,"formTarget",f.formTarget,f,null)):(st(n,a,"encType",f.encType,f,null),st(n,a,"method",f.method,f,null),st(n,a,"target",f.target,f,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){n.removeAttribute(l);break}u=Kr(""+u),n.setAttribute(l,u);break;case"onClick":u!=null&&(n.onclick=Ad);break;case"onScroll":u!=null&&Ue("scroll",n);break;case"onScrollEnd":u!=null&&Ue("scrollend",n);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=l}}break;case"multiple":n.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":n.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){n.removeAttribute("xlink:href");break}l=Kr(""+u),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(l,""+u):n.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(l,""):n.removeAttribute(l);break;case"capture":case"download":u===!0?n.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(l,u):n.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?n.setAttribute(l,u):n.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?n.removeAttribute(l):n.setAttribute(l,u);break;case"popover":Ue("beforetoggle",n),Ue("toggle",n),La(n,"popover",u);break;case"xlinkActuate":Qt(n,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Qt(n,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Qt(n,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Qt(n,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Qt(n,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Qt(n,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Qt(n,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Qt(n,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Qt(n,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":La(n,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=mf.get(l)||l,La(n,l,u))}}function Gm(n,a,l,u,f,g){switch(l){case"style":Tl(n,u,g);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=l}}break;case"children":typeof u=="string"?Yn(n,u):(typeof u=="number"||typeof u=="bigint")&&Yn(n,""+u);break;case"onScroll":u!=null&&Ue("scroll",n);break;case"onScrollEnd":u!=null&&Ue("scrollend",n);break;case"onClick":u!=null&&(n.onclick=Ad);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Br.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(f=l.endsWith("Capture"),a=l.slice(2,f?l.length-7:void 0),g=n[St]||null,g=g!=null?g[l]:null,typeof g=="function"&&n.removeEventListener(a,g,f),typeof u=="function")){typeof g!="function"&&g!==null&&(l in n?n[l]=null:n.hasAttribute(l)&&n.removeAttribute(l)),n.addEventListener(a,u,f);break e}l in n?n[l]=u:u===!0?n.setAttribute(l,""):La(n,l,u)}}}function Jt(n,a,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ue("error",n),Ue("load",n);var u=!1,f=!1,g;for(g in l)if(l.hasOwnProperty(g)){var b=l[g];if(b!=null)switch(g){case"src":u=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:st(n,a,g,b,l,null)}}f&&st(n,a,"srcSet",l.srcSet,l,null),u&&st(n,a,"src",l.src,l,null);return;case"input":Ue("invalid",n);var w=g=b=f=null,L=null,Q=null;for(u in l)if(l.hasOwnProperty(u)){var se=l[u];if(se!=null)switch(u){case"name":f=se;break;case"type":b=se;break;case"checked":L=se;break;case"defaultChecked":Q=se;break;case"value":g=se;break;case"defaultValue":w=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(i(137,a));break;default:st(n,a,u,se,l,null)}}Yi(n,g,w,L,Q,b,f,!1),$r(n);return;case"select":Ue("invalid",n),u=b=g=null;for(f in l)if(l.hasOwnProperty(f)&&(w=l[f],w!=null))switch(f){case"value":g=w;break;case"defaultValue":b=w;break;case"multiple":u=w;default:st(n,a,f,w,l,null)}a=g,l=b,n.multiple=!!u,a!=null?na(n,!!u,a,!1):l!=null&&na(n,!!u,l,!0);return;case"textarea":Ue("invalid",n),g=f=u=null;for(b in l)if(l.hasOwnProperty(b)&&(w=l[b],w!=null))switch(b){case"value":u=w;break;case"defaultValue":f=w;break;case"children":g=w;break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(i(91));break;default:st(n,a,b,w,l,null)}Qi(n,u,f,g),$r(n);return;case"option":for(L in l)if(l.hasOwnProperty(L)&&(u=l[L],u!=null))switch(L){case"selected":n.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:st(n,a,L,u,l,null)}return;case"dialog":Ue("beforetoggle",n),Ue("toggle",n),Ue("cancel",n),Ue("close",n);break;case"iframe":case"object":Ue("load",n);break;case"video":case"audio":for(u=0;u<rc.length;u++)Ue(rc[u],n);break;case"image":Ue("error",n),Ue("load",n);break;case"details":Ue("toggle",n);break;case"embed":case"source":case"link":Ue("error",n),Ue("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in l)if(l.hasOwnProperty(Q)&&(u=l[Q],u!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:st(n,a,Q,u,l,null)}return;default:if(Nl(a)){for(se in l)l.hasOwnProperty(se)&&(u=l[se],u!==void 0&&Gm(n,a,se,u,l,void 0));return}}for(w in l)l.hasOwnProperty(w)&&(u=l[w],u!=null&&st(n,a,w,u,l,null))}function JS(n,a,l,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,g=null,b=null,w=null,L=null,Q=null,se=null;for(Z in l){var oe=l[Z];if(l.hasOwnProperty(Z)&&oe!=null)switch(Z){case"checked":break;case"value":break;case"defaultValue":L=oe;default:u.hasOwnProperty(Z)||st(n,a,Z,null,u,oe)}}for(var X in u){var Z=u[X];if(oe=l[X],u.hasOwnProperty(X)&&(Z!=null||oe!=null))switch(X){case"type":g=Z;break;case"name":f=Z;break;case"checked":Q=Z;break;case"defaultChecked":se=Z;break;case"value":b=Z;break;case"defaultValue":w=Z;break;case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(i(137,a));break;default:Z!==oe&&st(n,a,X,Z,u,oe)}}On(n,b,w,L,Q,se,g,f);return;case"select":Z=b=w=X=null;for(g in l)if(L=l[g],l.hasOwnProperty(g)&&L!=null)switch(g){case"value":break;case"multiple":Z=L;default:u.hasOwnProperty(g)||st(n,a,g,null,u,L)}for(f in u)if(g=u[f],L=l[f],u.hasOwnProperty(f)&&(g!=null||L!=null))switch(f){case"value":X=g;break;case"defaultValue":w=g;break;case"multiple":b=g;default:g!==L&&st(n,a,f,g,u,L)}a=w,l=b,u=Z,X!=null?na(n,!!l,X,!1):!!u!=!!l&&(a!=null?na(n,!!l,a,!0):na(n,!!l,l?[]:"",!1));return;case"textarea":Z=X=null;for(w in l)if(f=l[w],l.hasOwnProperty(w)&&f!=null&&!u.hasOwnProperty(w))switch(w){case"value":break;case"children":break;default:st(n,a,w,null,u,f)}for(b in u)if(f=u[b],g=l[b],u.hasOwnProperty(b)&&(f!=null||g!=null))switch(b){case"value":X=f;break;case"defaultValue":Z=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==g&&st(n,a,b,f,u,g)}tt(n,X,Z);return;case"option":for(var we in l)if(X=l[we],l.hasOwnProperty(we)&&X!=null&&!u.hasOwnProperty(we))switch(we){case"selected":n.selected=!1;break;default:st(n,a,we,null,u,X)}for(L in u)if(X=u[L],Z=l[L],u.hasOwnProperty(L)&&X!==Z&&(X!=null||Z!=null))switch(L){case"selected":n.selected=X&&typeof X!="function"&&typeof X!="symbol";break;default:st(n,a,L,X,u,Z)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ne in l)X=l[Ne],l.hasOwnProperty(Ne)&&X!=null&&!u.hasOwnProperty(Ne)&&st(n,a,Ne,null,u,X);for(Q in u)if(X=u[Q],Z=l[Q],u.hasOwnProperty(Q)&&X!==Z&&(X!=null||Z!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(i(137,a));break;default:st(n,a,Q,X,u,Z)}return;default:if(Nl(a)){for(var at in l)X=l[at],l.hasOwnProperty(at)&&X!==void 0&&!u.hasOwnProperty(at)&&Gm(n,a,at,void 0,u,X);for(se in u)X=u[se],Z=l[se],!u.hasOwnProperty(se)||X===Z||X===void 0&&Z===void 0||Gm(n,a,se,X,u,Z);return}}for(var G in l)X=l[G],l.hasOwnProperty(G)&&X!=null&&!u.hasOwnProperty(G)&&st(n,a,G,null,u,X);for(oe in u)X=u[oe],Z=l[oe],!u.hasOwnProperty(oe)||X===Z||X==null&&Z==null||st(n,a,oe,X,u,Z)}var $m=null,Km=null;function Sd(n){return n.nodeType===9?n:n.ownerDocument}function _E(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function EE(n,a){if(n===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&a==="foreignObject"?0:n}function Ym(n,a){return n==="textarea"||n==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Qm=null;function ew(){var n=window.event;return n&&n.type==="popstate"?n===Qm?!1:(Qm=n,!0):(Qm=null,!1)}var bE=typeof setTimeout=="function"?setTimeout:void 0,tw=typeof clearTimeout=="function"?clearTimeout:void 0,TE=typeof Promise=="function"?Promise:void 0,nw=typeof queueMicrotask=="function"?queueMicrotask:typeof TE<"u"?function(n){return TE.resolve(null).then(n).catch(sw)}:bE;function sw(n){setTimeout(function(){throw n})}function ni(n){return n==="head"}function NE(n,a){var l=a,u=0,f=0;do{var g=l.nextSibling;if(n.removeChild(l),g&&g.nodeType===8)if(l=g.data,l==="/$"){if(0<u&&8>u){l=u;var b=n.ownerDocument;if(l&1&&lc(b.documentElement),l&2&&lc(b.body),l&4)for(l=b.head,lc(l),b=l.firstChild;b;){var w=b.nextSibling,L=b.nodeName;b[Hi]||L==="SCRIPT"||L==="STYLE"||L==="LINK"&&b.rel.toLowerCase()==="stylesheet"||l.removeChild(b),b=w}}if(f===0){n.removeChild(g),gc(a);return}f--}else l==="$"||l==="$?"||l==="$!"?f++:u=l.charCodeAt(0)-48;else u=0;l=g}while(l);gc(a)}function Xm(n){var a=n.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var l=a;switch(a=a.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Xm(l),Va(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}n.removeChild(l)}}function aw(n,a,l,u){for(;n.nodeType===1;){var f=l;if(n.nodeName.toLowerCase()!==a.toLowerCase()){if(!u&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(u){if(!n[Hi])switch(a){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(g=n.getAttribute("rel"),g==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(g!==f.rel||n.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||n.getAttribute("title")!==(f.title==null?null:f.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(g=n.getAttribute("src"),(g!==(f.src==null?null:f.src)||n.getAttribute("type")!==(f.type==null?null:f.type)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&g&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(a==="input"&&n.type==="hidden"){var g=f.name==null?null:""+f.name;if(f.type==="hidden"&&n.getAttribute("name")===g)return n}else return n;if(n=fs(n.nextSibling),n===null)break}return null}function iw(n,a,l){if(a==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!l||(n=fs(n.nextSibling),n===null))return null;return n}function Wm(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState==="complete"}function rw(n,a){var l=n.ownerDocument;if(n.data!=="$?"||l.readyState==="complete")a();else{var u=function(){a(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),n._reactRetry=u}}function fs(n){for(;n!=null;n=n.nextSibling){var a=n.nodeType;if(a===1||a===3)break;if(a===8){if(a=n.data,a==="$"||a==="$!"||a==="$?"||a==="F!"||a==="F")break;if(a==="/$")return null}}return n}var Zm=null;function xE(n){n=n.previousSibling;for(var a=0;n;){if(n.nodeType===8){var l=n.data;if(l==="$"||l==="$!"||l==="$?"){if(a===0)return n;a--}else l==="/$"&&a++}n=n.previousSibling}return null}function AE(n,a,l){switch(a=Sd(l),n){case"html":if(n=a.documentElement,!n)throw Error(i(452));return n;case"head":if(n=a.head,!n)throw Error(i(453));return n;case"body":if(n=a.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function lc(n){for(var a=n.attributes;a.length;)n.removeAttributeNode(a[0]);Va(n)}var as=new Map,SE=new Set;function wd(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var ba=te.d;te.d={f:ow,r:lw,D:cw,C:uw,L:dw,m:hw,X:mw,S:fw,M:pw};function ow(){var n=ba.f(),a=yd();return n||a}function lw(n){var a=Ns(n);a!==null&&a.tag===5&&a.type==="form"?$y(a):ba.r(n)}var Co=typeof document>"u"?null:document;function wE(n,a,l){var u=Co;if(u&&typeof a=="string"&&a){var f=wt(a);f='link[rel="'+n+'"][href="'+f+'"]',typeof l=="string"&&(f+='[crossorigin="'+l+'"]'),SE.has(f)||(SE.add(f),n={rel:n,crossOrigin:l,href:a},u.querySelector(f)===null&&(a=u.createElement("link"),Jt(a,"link",n),Tt(a),u.head.appendChild(a)))}}function cw(n){ba.D(n),wE("dns-prefetch",n,null)}function uw(n,a){ba.C(n,a),wE("preconnect",n,a)}function dw(n,a,l){ba.L(n,a,l);var u=Co;if(u&&n&&a){var f='link[rel="preload"][as="'+wt(a)+'"]';a==="image"&&l&&l.imageSrcSet?(f+='[imagesrcset="'+wt(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(f+='[imagesizes="'+wt(l.imageSizes)+'"]')):f+='[href="'+wt(n)+'"]';var g=f;switch(a){case"style":g=jo(n);break;case"script":g=Io(n)}as.has(g)||(n=_({rel:"preload",href:a==="image"&&l&&l.imageSrcSet?void 0:n,as:a},l),as.set(g,n),u.querySelector(f)!==null||a==="style"&&u.querySelector(cc(g))||a==="script"&&u.querySelector(uc(g))||(a=u.createElement("link"),Jt(a,"link",n),Tt(a),u.head.appendChild(a)))}}function hw(n,a){ba.m(n,a);var l=Co;if(l&&n){var u=a&&typeof a.as=="string"?a.as:"script",f='link[rel="modulepreload"][as="'+wt(u)+'"][href="'+wt(n)+'"]',g=f;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=Io(n)}if(!as.has(g)&&(n=_({rel:"modulepreload",href:n},a),as.set(g,n),l.querySelector(f)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(uc(g)))return}u=l.createElement("link"),Jt(u,"link",n),Tt(u),l.head.appendChild(u)}}}function fw(n,a,l){ba.S(n,a,l);var u=Co;if(u&&n){var f=gn(u).hoistableStyles,g=jo(n);a=a||"default";var b=f.get(g);if(!b){var w={loading:0,preload:null};if(b=u.querySelector(cc(g)))w.loading=5;else{n=_({rel:"stylesheet",href:n,"data-precedence":a},l),(l=as.get(g))&&Jm(n,l);var L=b=u.createElement("link");Tt(L),Jt(L,"link",n),L._p=new Promise(function(Q,se){L.onload=Q,L.onerror=se}),L.addEventListener("load",function(){w.loading|=1}),L.addEventListener("error",function(){w.loading|=2}),w.loading|=4,Cd(b,a,u)}b={type:"stylesheet",instance:b,count:1,state:w},f.set(g,b)}}}function mw(n,a){ba.X(n,a);var l=Co;if(l&&n){var u=gn(l).hoistableScripts,f=Io(n),g=u.get(f);g||(g=l.querySelector(uc(f)),g||(n=_({src:n,async:!0},a),(a=as.get(f))&&ep(n,a),g=l.createElement("script"),Tt(g),Jt(g,"link",n),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(f,g))}}function pw(n,a){ba.M(n,a);var l=Co;if(l&&n){var u=gn(l).hoistableScripts,f=Io(n),g=u.get(f);g||(g=l.querySelector(uc(f)),g||(n=_({src:n,async:!0,type:"module"},a),(a=as.get(f))&&ep(n,a),g=l.createElement("script"),Tt(g),Jt(g,"link",n),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(f,g))}}function CE(n,a,l,u){var f=(f=Ce.current)?wd(f):null;if(!f)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(a=jo(l.href),l=gn(f).hoistableStyles,u=l.get(a),u||(u={type:"style",instance:null,count:0,state:null},l.set(a,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){n=jo(l.href);var g=gn(f).hoistableStyles,b=g.get(n);if(b||(f=f.ownerDocument||f,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(n,b),(g=f.querySelector(cc(n)))&&!g._p&&(b.instance=g,b.state.loading=5),as.has(n)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},as.set(n,l),g||gw(f,n,l,b.state))),a&&u===null)throw Error(i(528,""));return b}if(a&&u!==null)throw Error(i(529,""));return null;case"script":return a=l.async,l=l.src,typeof l=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Io(l),l=gn(f).hoistableScripts,u=l.get(a),u||(u={type:"script",instance:null,count:0,state:null},l.set(a,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function jo(n){return'href="'+wt(n)+'"'}function cc(n){return'link[rel="stylesheet"]['+n+"]"}function jE(n){return _({},n,{"data-precedence":n.precedence,precedence:null})}function gw(n,a,l,u){n.querySelector('link[rel="preload"][as="style"]['+a+"]")?u.loading=1:(a=n.createElement("link"),u.preload=a,a.addEventListener("load",function(){return u.loading|=1}),a.addEventListener("error",function(){return u.loading|=2}),Jt(a,"link",l),Tt(a),n.head.appendChild(a))}function Io(n){return'[src="'+wt(n)+'"]'}function uc(n){return"script[async]"+n}function IE(n,a,l){if(a.count++,a.instance===null)switch(a.type){case"style":var u=n.querySelector('style[data-href~="'+wt(l.href)+'"]');if(u)return a.instance=u,Tt(u),u;var f=_({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(n.ownerDocument||n).createElement("style"),Tt(u),Jt(u,"style",f),Cd(u,l.precedence,n),a.instance=u;case"stylesheet":f=jo(l.href);var g=n.querySelector(cc(f));if(g)return a.state.loading|=4,a.instance=g,Tt(g),g;u=jE(l),(f=as.get(f))&&Jm(u,f),g=(n.ownerDocument||n).createElement("link"),Tt(g);var b=g;return b._p=new Promise(function(w,L){b.onload=w,b.onerror=L}),Jt(g,"link",u),a.state.loading|=4,Cd(g,l.precedence,n),a.instance=g;case"script":return g=Io(l.src),(f=n.querySelector(uc(g)))?(a.instance=f,Tt(f),f):(u=l,(f=as.get(g))&&(u=_({},l),ep(u,f)),n=n.ownerDocument||n,f=n.createElement("script"),Tt(f),Jt(f,"link",u),n.head.appendChild(f),a.instance=f);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(u=a.instance,a.state.loading|=4,Cd(u,l.precedence,n));return a.instance}function Cd(n,a,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=u.length?u[u.length-1]:null,g=f,b=0;b<u.length;b++){var w=u[b];if(w.dataset.precedence===a)g=w;else if(g!==f)break}g?g.parentNode.insertBefore(n,g.nextSibling):(a=l.nodeType===9?l.head:l,a.insertBefore(n,a.firstChild))}function Jm(n,a){n.crossOrigin==null&&(n.crossOrigin=a.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=a.referrerPolicy),n.title==null&&(n.title=a.title)}function ep(n,a){n.crossOrigin==null&&(n.crossOrigin=a.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=a.referrerPolicy),n.integrity==null&&(n.integrity=a.integrity)}var jd=null;function RE(n,a,l){if(jd===null){var u=new Map,f=jd=new Map;f.set(l,u)}else f=jd,u=f.get(l),u||(u=new Map,f.set(l,u));if(u.has(n))return u;for(u.set(n,null),l=l.getElementsByTagName(n),f=0;f<l.length;f++){var g=l[f];if(!(g[Hi]||g[Dt]||n==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var b=g.getAttribute(a)||"";b=n+b;var w=u.get(b);w?w.push(g):u.set(b,[g])}}return u}function DE(n,a,l){n=n.ownerDocument||n,n.head.insertBefore(l,a==="title"?n.querySelector("head > title"):null)}function vw(n,a,l){if(l===1||a.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return n=a.disabled,typeof a.precedence=="string"&&n==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function OE(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}var dc=null;function yw(){}function _w(n,a,l){if(dc===null)throw Error(i(475));var u=dc;if(a.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var f=jo(l.href),g=n.querySelector(cc(f));if(g){n=g._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(u.count++,u=Id.bind(u),n.then(u,u)),a.state.loading|=4,a.instance=g,Tt(g);return}g=n.ownerDocument||n,l=jE(l),(f=as.get(f))&&Jm(l,f),g=g.createElement("link"),Tt(g);var b=g;b._p=new Promise(function(w,L){b.onload=w,b.onerror=L}),Jt(g,"link",l),a.instance=g}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(a,n),(n=a.state.preload)&&(a.state.loading&3)===0&&(u.count++,a=Id.bind(u),n.addEventListener("load",a),n.addEventListener("error",a))}}function Ew(){if(dc===null)throw Error(i(475));var n=dc;return n.stylesheets&&n.count===0&&tp(n,n.stylesheets),0<n.count?function(a){var l=setTimeout(function(){if(n.stylesheets&&tp(n,n.stylesheets),n.unsuspend){var u=n.unsuspend;n.unsuspend=null,u()}},6e4);return n.unsuspend=a,function(){n.unsuspend=null,clearTimeout(l)}}:null}function Id(){if(this.count--,this.count===0){if(this.stylesheets)tp(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Rd=null;function tp(n,a){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Rd=new Map,a.forEach(bw,n),Rd=null,Id.call(n))}function bw(n,a){if(!(a.state.loading&4)){var l=Rd.get(n);if(l)var u=l.get(null);else{l=new Map,Rd.set(n,l);for(var f=n.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<f.length;g++){var b=f[g];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(l.set(b.dataset.precedence,b),u=b)}u&&l.set(null,u)}f=a.instance,b=f.getAttribute("data-precedence"),g=l.get(b)||u,g===u&&l.set(null,f),l.set(b,f),this.count++,u=Id.bind(this),f.addEventListener("load",u),f.addEventListener("error",u),g?g.parentNode.insertBefore(f,g.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(f,n.firstChild)),a.state.loading|=4}}var hc={$$typeof:F,Provider:null,Consumer:null,_currentValue:ce,_currentValue2:ce,_threadCount:0};function Tw(n,a,l,u,f,g,b,w){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ws(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ws(0),this.hiddenUpdates=Ws(null),this.identifierPrefix=u,this.onUncaughtError=f,this.onCaughtError=g,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=w,this.incompleteTransitions=new Map}function ME(n,a,l,u,f,g,b,w,L,Q,se,oe){return n=new Tw(n,a,l,b,w,L,Q,oe),a=1,g===!0&&(a|=24),g=Pn(3,null,null,a),n.current=g,g.stateNode=n,a=kf(),a.refCount++,n.pooledCache=a,a.refCount++,g.memoizedState={element:u,isDehydrated:l,cache:a},Ff(g),n}function PE(n){return n?(n=ro,n):ro}function kE(n,a,l,u,f,g){f=PE(f),u.context===null?u.context=f:u.pendingContext=f,u=za(a),u.payload={element:l},g=g===void 0?null:g,g!==null&&(u.callback=g),l=Ha(n,u,a),l!==null&&(Fn(l,n,a),Bl(l,n,a))}function VE(n,a){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var l=n.retryLane;n.retryLane=l!==0&&l<a?l:a}}function np(n,a){VE(n,a),(n=n.alternate)&&VE(n,a)}function LE(n){if(n.tag===13){var a=io(n,67108864);a!==null&&Fn(a,n,67108864),np(n,67108864)}}var Dd=!0;function Nw(n,a,l,u){var f=H.T;H.T=null;var g=te.p;try{te.p=2,sp(n,a,l,u)}finally{te.p=g,H.T=f}}function xw(n,a,l,u){var f=H.T;H.T=null;var g=te.p;try{te.p=8,sp(n,a,l,u)}finally{te.p=g,H.T=f}}function sp(n,a,l,u){if(Dd){var f=ap(u);if(f===null)Hm(n,a,u,Od,l),FE(n,u);else if(Sw(f,n,a,l,u))u.stopPropagation();else if(FE(n,u),a&4&&-1<Aw.indexOf(n)){for(;f!==null;){var g=Ns(f);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var b=ls(g.pendingLanes);if(b!==0){var w=g;for(w.pendingLanes|=2,w.entangledLanes|=2;b;){var L=1<<31-ln(b);w.entanglements[1]|=L,b&=~L}Vs(g),(Je&6)===0&&(gd=$n()+500,ic(0))}}break;case 13:w=io(g,2),w!==null&&Fn(w,g,2),yd(),np(g,2)}if(g=ap(u),g===null&&Hm(n,a,u,Od,l),g===f)break;f=g}f!==null&&u.stopPropagation()}else Hm(n,a,u,null,l)}}function ap(n){return n=Qn(n),ip(n)}var Od=null;function ip(n){if(Od=null,n=Js(n),n!==null){var a=c(n);if(a===null)n=null;else{var l=a.tag;if(l===13){if(n=d(a),n!==null)return n;n=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;n=null}else a!==n&&(n=null)}}return Od=n,null}function UE(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(lf()){case ul:return 2;case Lr:return 8;case Ui:case cf:return 32;case Ur:return 268435456;default:return 32}default:return 32}}var rp=!1,si=null,ai=null,ii=null,fc=new Map,mc=new Map,ri=[],Aw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function FE(n,a){switch(n){case"focusin":case"focusout":si=null;break;case"dragenter":case"dragleave":ai=null;break;case"mouseover":case"mouseout":ii=null;break;case"pointerover":case"pointerout":fc.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":mc.delete(a.pointerId)}}function pc(n,a,l,u,f,g){return n===null||n.nativeEvent!==g?(n={blockedOn:a,domEventName:l,eventSystemFlags:u,nativeEvent:g,targetContainers:[f]},a!==null&&(a=Ns(a),a!==null&&LE(a)),n):(n.eventSystemFlags|=u,a=n.targetContainers,f!==null&&a.indexOf(f)===-1&&a.push(f),n)}function Sw(n,a,l,u,f){switch(a){case"focusin":return si=pc(si,n,a,l,u,f),!0;case"dragenter":return ai=pc(ai,n,a,l,u,f),!0;case"mouseover":return ii=pc(ii,n,a,l,u,f),!0;case"pointerover":var g=f.pointerId;return fc.set(g,pc(fc.get(g)||null,n,a,l,u,f)),!0;case"gotpointercapture":return g=f.pointerId,mc.set(g,pc(mc.get(g)||null,n,a,l,u,f)),!0}return!1}function qE(n){var a=Js(n.target);if(a!==null){var l=c(a);if(l!==null){if(a=l.tag,a===13){if(a=d(l),a!==null){n.blockedOn=a,yu(n.priority,function(){if(l.tag===13){var u=Un();u=Ma(u);var f=io(l,u);f!==null&&Fn(f,l,u),np(l,u)}});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){n.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Md(n){if(n.blockedOn!==null)return!1;for(var a=n.targetContainers;0<a.length;){var l=ap(n.nativeEvent);if(l===null){l=n.nativeEvent;var u=new l.constructor(l.type,l);sa=u,l.target.dispatchEvent(u),sa=null}else return a=Ns(l),a!==null&&LE(a),n.blockedOn=l,!1;a.shift()}return!0}function BE(n,a,l){Md(n)&&l.delete(a)}function ww(){rp=!1,si!==null&&Md(si)&&(si=null),ai!==null&&Md(ai)&&(ai=null),ii!==null&&Md(ii)&&(ii=null),fc.forEach(BE),mc.forEach(BE)}function Pd(n,a){n.blockedOn===a&&(n.blockedOn=null,rp||(rp=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,ww)))}var kd=null;function zE(n){kd!==n&&(kd=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){kd===n&&(kd=null);for(var a=0;a<n.length;a+=3){var l=n[a],u=n[a+1],f=n[a+2];if(typeof u!="function"){if(ip(u||l)===null)continue;break}var g=Ns(l);g!==null&&(n.splice(a,3),a-=3,im(g,{pending:!0,data:f,method:l.method,action:u},u,f))}}))}function gc(n){function a(L){return Pd(L,n)}si!==null&&Pd(si,n),ai!==null&&Pd(ai,n),ii!==null&&Pd(ii,n),fc.forEach(a),mc.forEach(a);for(var l=0;l<ri.length;l++){var u=ri[l];u.blockedOn===n&&(u.blockedOn=null)}for(;0<ri.length&&(l=ri[0],l.blockedOn===null);)qE(l),l.blockedOn===null&&ri.shift();if(l=(n.ownerDocument||n).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var f=l[u],g=l[u+1],b=f[St]||null;if(typeof g=="function")b||zE(l);else if(b){var w=null;if(g&&g.hasAttribute("formAction")){if(f=g,b=g[St]||null)w=b.formAction;else if(ip(f)!==null)continue}else w=b.action;typeof w=="function"?l[u+1]=w:(l.splice(u,3),u-=3),zE(l)}}}function op(n){this._internalRoot=n}Vd.prototype.render=op.prototype.render=function(n){var a=this._internalRoot;if(a===null)throw Error(i(409));var l=a.current,u=Un();kE(l,u,n,a,null,null)},Vd.prototype.unmount=op.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var a=n.containerInfo;kE(n.current,2,null,n,null,null),yd(),a[Kn]=null}};function Vd(n){this._internalRoot=n}Vd.prototype.unstable_scheduleHydration=function(n){if(n){var a=Pa();n={blockedOn:null,target:n,priority:a};for(var l=0;l<ri.length&&a!==0&&a<ri[l].priority;l++);ri.splice(l,0,n),l===0&&qE(n)}};var HE=e.version;if(HE!=="19.1.0")throw Error(i(527,HE,"19.1.0"));te.findDOMNode=function(n){var a=n._reactInternals;if(a===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=p(a),n=n!==null?v(n):null,n=n===null?null:n.stateNode,n};var Cw={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:H,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ld=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ld.isDisabled&&Ld.supportsFiber)try{yt=Ld.inject(Cw),Ze=Ld}catch{}}return yc.createRoot=function(n,a){if(!o(n))throw Error(i(299));var l=!1,u="",f=r_,g=o_,b=l_,w=null;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(u=a.identifierPrefix),a.onUncaughtError!==void 0&&(f=a.onUncaughtError),a.onCaughtError!==void 0&&(g=a.onCaughtError),a.onRecoverableError!==void 0&&(b=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(w=a.unstable_transitionCallbacks)),a=ME(n,1,!1,null,null,l,u,f,g,b,w,null),n[Kn]=a.current,zm(n),new op(a)},yc.hydrateRoot=function(n,a,l){if(!o(n))throw Error(i(299));var u=!1,f="",g=r_,b=o_,w=l_,L=null,Q=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(g=l.onUncaughtError),l.onCaughtError!==void 0&&(b=l.onCaughtError),l.onRecoverableError!==void 0&&(w=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(L=l.unstable_transitionCallbacks),l.formState!==void 0&&(Q=l.formState)),a=ME(n,1,!0,a,l??null,u,f,g,b,w,L,Q),a.context=PE(null),l=a.current,u=Un(),u=Ma(u),f=za(u),f.callback=null,Ha(l,f,u),l=u,a.current.lanes=l,Zs(a,l),Vs(a),n[Kn]=a.current,zm(n),new Vd(a)},yc.version="19.1.0",yc}var eb;function Lw(){if(eb)return up.exports;eb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),up.exports=Vw(),up.exports}var Uw=Lw();const Fw=()=>{};var tb={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mN=function(s){const e=[];let t=0;for(let i=0;i<s.length;i++){let o=s.charCodeAt(i);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(s.charCodeAt(++i)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},qw=function(s){const e=[];let t=0,i=0;for(;t<s.length;){const o=s[t++];if(o<128)e[i++]=String.fromCharCode(o);else if(o>191&&o<224){const c=s[t++];e[i++]=String.fromCharCode((o&31)<<6|c&63)}else if(o>239&&o<365){const c=s[t++],d=s[t++],m=s[t++],p=((o&7)<<18|(c&63)<<12|(d&63)<<6|m&63)-65536;e[i++]=String.fromCharCode(55296+(p>>10)),e[i++]=String.fromCharCode(56320+(p&1023))}else{const c=s[t++],d=s[t++];e[i++]=String.fromCharCode((o&15)<<12|(c&63)<<6|d&63)}}return e.join("")},pN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let o=0;o<s.length;o+=3){const c=s[o],d=o+1<s.length,m=d?s[o+1]:0,p=o+2<s.length,v=p?s[o+2]:0,_=c>>2,T=(c&3)<<4|m>>4;let x=(m&15)<<2|v>>6,C=v&63;p||(C=64,d||(x=64)),i.push(t[_],t[T],t[x],t[C])}return i.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(mN(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):qw(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let o=0;o<s.length;){const c=t[s.charAt(o++)],m=o<s.length?t[s.charAt(o)]:0;++o;const v=o<s.length?t[s.charAt(o)]:64;++o;const T=o<s.length?t[s.charAt(o)]:64;if(++o,c==null||m==null||v==null||T==null)throw new Bw;const x=c<<2|m>>4;if(i.push(x),v!==64){const C=m<<4&240|v>>2;if(i.push(C),T!==64){const N=v<<6&192|T;i.push(N)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class Bw extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const zw=function(s){const e=mN(s);return pN.encodeByteArray(e,!0)},rh=function(s){return zw(s).replace(/\./g,"")},gN=function(s){try{return pN.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hw(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gw=()=>Hw().__FIREBASE_DEFAULTS__,$w=()=>{if(typeof process>"u"||typeof tb>"u")return;const s=tb.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},Kw=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&gN(s[1]);return e&&JSON.parse(e)},Dh=()=>{try{return Fw()||Gw()||$w()||Kw()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},vN=s=>{var e,t;return(t=(e=Dh())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[s]},yN=s=>{const e=vN(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},_N=()=>{var s;return(s=Dh())===null||s===void 0?void 0:s.config},EN=s=>{var e;return(e=Dh())===null||e===void 0?void 0:e[`_${s}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yw{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dr(s){return s.endsWith(".cloudworkstations.dev")}async function mg(s){return(await fetch(s,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bN(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",o=s.iat||0,c=s.sub||s.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:o,exp:o+3600,auth_time:o,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}}},s);return[rh(JSON.stringify(t)),rh(JSON.stringify(d)),""].join(".")}const Ac={};function Qw(){const s={prod:[],emulator:[]};for(const e of Object.keys(Ac))Ac[e]?s.emulator.push(e):s.prod.push(e);return s}function Xw(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let nb=!1;function pg(s,e){if(typeof window>"u"||typeof document>"u"||!Dr(window.location.host)||Ac[s]===e||Ac[s]||nb)return;Ac[s]=e;function t(x){return`__firebase__banner__${x}`}const i="__firebase__banner",c=Qw().prod.length>0;function d(){const x=document.getElementById(i);x&&x.remove()}function m(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function p(x,C){x.setAttribute("width","24"),x.setAttribute("id",C),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function v(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{nb=!0,d()},x}function _(x,C){x.setAttribute("id",C),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function T(){const x=Xw(i),C=t("text"),N=document.getElementById(C)||document.createElement("span"),M=t("learnmore"),S=document.getElementById(M)||document.createElement("a"),U=t("preprendIcon"),$=document.getElementById(U)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const F=x.element;m(F),_(S,M);const V=v();p($,U),F.append($,N,S,V),document.body.appendChild(F)}c?(N.innerText="Preview backend disconnected.",$.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):($.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,N.innerText="Preview backend running in this workspace."),N.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",T):T()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Ww(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pn())}function Zw(){var s;const e=(s=Dh())===null||s===void 0?void 0:s.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Jw(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function TN(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function eC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function tC(){const s=pn();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function nC(){return!Zw()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function gg(){try{return typeof indexedDB=="object"}catch{return!1}}function vg(){return new Promise((s,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(i);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(i),s(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var c;e(((c=o.error)===null||c===void 0?void 0:c.message)||"")}}catch(t){e(t)}})}function NN(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sC="FirebaseError";class os extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=sC,Object.setPrototypeOf(this,os.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ji.prototype.create)}}class ji{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},o=`${this.service}/${e}`,c=this.errors[e],d=c?aC(c,i):"Error",m=`${this.serviceName}: ${d} (${o}).`;return new os(o,m,i)}}function aC(s,e){return s.replace(iC,(t,i)=>{const o=e[i];return o!=null?String(o):`<${i}?>`})}const iC=/\{\$([^}]+)}/g;function rC(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function _i(s,e){if(s===e)return!0;const t=Object.keys(s),i=Object.keys(e);for(const o of t){if(!i.includes(o))return!1;const c=s[o],d=e[o];if(sb(c)&&sb(d)){if(!_i(c,d))return!1}else if(c!==d)return!1}for(const o of i)if(!t.includes(o))return!1;return!0}function sb(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qc(s){const e=[];for(const[t,i]of Object.entries(s))Array.isArray(i)?i.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function _c(s){const e={};return s.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[o,c]=i.split("=");e[decodeURIComponent(o)]=decodeURIComponent(c)}}),e}function Ec(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function oC(s,e){const t=new lC(s,e);return t.subscribe.bind(t)}class lC{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let o;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");cC(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:i},o.next===void 0&&(o.next=mp),o.error===void 0&&(o.error=mp),o.complete===void 0&&(o.complete=mp);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function cC(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function mp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uC=1e3,dC=2,hC=4*60*60*1e3,fC=.5;function ab(s,e=uC,t=dC){const i=e*Math.pow(t,s),o=Math.round(fC*i*(Math.random()-.5)*2);return Math.min(hC,i+o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ut(s){return s&&s._delegate?s._delegate:s}class Gn{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Er="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new Yw;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&i.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e?.identifier),o=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(c){if(o)return null;throw c}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(gC(e))try{this.getOrInitializeService({instanceIdentifier:Er})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:o});i.resolve(c)}catch{}}}}clearInstance(e=Er){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Er){return this.instances.has(e)}getOptions(e=Er){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[c,d]of this.instancesDeferred.entries()){const m=this.normalizeInstanceIdentifier(c);i===m&&d.resolve(o)}return o}onInit(e,t){var i;const o=this.normalizeInstanceIdentifier(t),c=(i=this.onInitCallbacks.get(o))!==null&&i!==void 0?i:new Set;c.add(e),this.onInitCallbacks.set(o,c);const d=this.instances.get(o);return d&&e(d,o),()=>{c.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const o of i)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:pC(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Er){return this.component?this.component.multipleInstances?e:Er:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function pC(s){return s===Er?void 0:s}function gC(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new mC(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fe;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(Fe||(Fe={}));const yC={debug:Fe.DEBUG,verbose:Fe.VERBOSE,info:Fe.INFO,warn:Fe.WARN,error:Fe.ERROR,silent:Fe.SILENT},_C=Fe.INFO,EC={[Fe.DEBUG]:"log",[Fe.VERBOSE]:"log",[Fe.INFO]:"info",[Fe.WARN]:"warn",[Fe.ERROR]:"error"},bC=(s,e,...t)=>{if(e<s.logLevel)return;const i=new Date().toISOString(),o=EC[e];if(o)console[o](`[${i}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Xc{constructor(e){this.name=e,this._logLevel=_C,this._logHandler=bC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Fe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?yC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Fe.DEBUG,...e),this._logHandler(this,Fe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Fe.VERBOSE,...e),this._logHandler(this,Fe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Fe.INFO,...e),this._logHandler(this,Fe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Fe.WARN,...e),this._logHandler(this,Fe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Fe.ERROR,...e),this._logHandler(this,Fe.ERROR,...e)}}const TC=(s,e)=>e.some(t=>s instanceof t);let ib,rb;function NC(){return ib||(ib=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function xC(){return rb||(rb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const xN=new WeakMap,Pp=new WeakMap,AN=new WeakMap,pp=new WeakMap,yg=new WeakMap;function AC(s){const e=new Promise((t,i)=>{const o=()=>{s.removeEventListener("success",c),s.removeEventListener("error",d)},c=()=>{t(pi(s.result)),o()},d=()=>{i(s.error),o()};s.addEventListener("success",c),s.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&xN.set(t,s)}).catch(()=>{}),yg.set(e,s),e}function SC(s){if(Pp.has(s))return;const e=new Promise((t,i)=>{const o=()=>{s.removeEventListener("complete",c),s.removeEventListener("error",d),s.removeEventListener("abort",d)},c=()=>{t(),o()},d=()=>{i(s.error||new DOMException("AbortError","AbortError")),o()};s.addEventListener("complete",c),s.addEventListener("error",d),s.addEventListener("abort",d)});Pp.set(s,e)}let kp={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return Pp.get(s);if(e==="objectStoreNames")return s.objectStoreNames||AN.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return pi(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function wC(s){kp=s(kp)}function CC(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=s.call(gp(this),e,...t);return AN.set(i,e.sort?e.sort():[e]),pi(i)}:xC().includes(s)?function(...e){return s.apply(gp(this),e),pi(xN.get(this))}:function(...e){return pi(s.apply(gp(this),e))}}function jC(s){return typeof s=="function"?CC(s):(s instanceof IDBTransaction&&SC(s),TC(s,NC())?new Proxy(s,kp):s)}function pi(s){if(s instanceof IDBRequest)return AC(s);if(pp.has(s))return pp.get(s);const e=jC(s);return e!==s&&(pp.set(s,e),yg.set(e,s)),e}const gp=s=>yg.get(s);function SN(s,e,{blocked:t,upgrade:i,blocking:o,terminated:c}={}){const d=indexedDB.open(s,e),m=pi(d);return i&&d.addEventListener("upgradeneeded",p=>{i(pi(d.result),p.oldVersion,p.newVersion,pi(d.transaction),p)}),t&&d.addEventListener("blocked",p=>t(p.oldVersion,p.newVersion,p)),m.then(p=>{c&&p.addEventListener("close",()=>c()),o&&p.addEventListener("versionchange",v=>o(v.oldVersion,v.newVersion,v))}).catch(()=>{}),m}const IC=["get","getKey","getAll","getAllKeys","count"],RC=["put","add","delete","clear"],vp=new Map;function ob(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(vp.get(e))return vp.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,o=RC.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(o||IC.includes(t)))return;const c=async function(d,...m){const p=this.transaction(d,o?"readwrite":"readonly");let v=p.store;return i&&(v=v.index(m.shift())),(await Promise.all([v[t](...m),o&&p.done]))[0]};return vp.set(e,c),c}wC(s=>({...s,get:(e,t,i)=>ob(e,t)||s.get(e,t,i),has:(e,t)=>!!ob(e,t)||s.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(OC(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function OC(s){const e=s.getComponent();return e?.type==="VERSION"}const Vp="@firebase/app",lb="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wa=new Xc("@firebase/app"),MC="@firebase/app-compat",PC="@firebase/analytics-compat",kC="@firebase/analytics",VC="@firebase/app-check-compat",LC="@firebase/app-check",UC="@firebase/auth",FC="@firebase/auth-compat",qC="@firebase/database",BC="@firebase/data-connect",zC="@firebase/database-compat",HC="@firebase/functions",GC="@firebase/functions-compat",$C="@firebase/installations",KC="@firebase/installations-compat",YC="@firebase/messaging",QC="@firebase/messaging-compat",XC="@firebase/performance",WC="@firebase/performance-compat",ZC="@firebase/remote-config",JC="@firebase/remote-config-compat",ej="@firebase/storage",tj="@firebase/storage-compat",nj="@firebase/firestore",sj="@firebase/ai",aj="@firebase/firestore-compat",ij="firebase",rj="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lp="[DEFAULT]",oj={[Vp]:"fire-core",[MC]:"fire-core-compat",[kC]:"fire-analytics",[PC]:"fire-analytics-compat",[LC]:"fire-app-check",[VC]:"fire-app-check-compat",[UC]:"fire-auth",[FC]:"fire-auth-compat",[qC]:"fire-rtdb",[BC]:"fire-data-connect",[zC]:"fire-rtdb-compat",[HC]:"fire-fn",[GC]:"fire-fn-compat",[$C]:"fire-iid",[KC]:"fire-iid-compat",[YC]:"fire-fcm",[QC]:"fire-fcm-compat",[XC]:"fire-perf",[WC]:"fire-perf-compat",[ZC]:"fire-rc",[JC]:"fire-rc-compat",[ej]:"fire-gcs",[tj]:"fire-gcs-compat",[nj]:"fire-fst",[aj]:"fire-fst-compat",[sj]:"fire-vertex","fire-js":"fire-js",[ij]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oh=new Map,lj=new Map,Up=new Map;function cb(s,e){try{s.container.addComponent(e)}catch(t){wa.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function is(s){const e=s.name;if(Up.has(e))return wa.debug(`There were multiple attempts to register component ${e}.`),!1;Up.set(e,s);for(const t of oh.values())cb(t,s);for(const t of lj.values())cb(t,s);return!0}function Ra(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function Cn(s){return s==null?!1:s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},gi=new ji("app","Firebase",cj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uj{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Gn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw gi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Or=rj;function wN(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const i=Object.assign({name:Lp,automaticDataCollectionEnabled:!0},e),o=i.name;if(typeof o!="string"||!o)throw gi.create("bad-app-name",{appName:String(o)});if(t||(t=_N()),!t)throw gi.create("no-options");const c=oh.get(o);if(c){if(_i(t,c.options)&&_i(i,c.config))return c;throw gi.create("duplicate-app",{appName:o})}const d=new vC(o);for(const p of Up.values())d.addComponent(p);const m=new uj(t,i,d);return oh.set(o,m),m}function Wc(s=Lp){const e=oh.get(s);if(!e&&s===Lp&&_N())return wN();if(!e)throw gi.create("no-app",{appName:s});return e}function mn(s,e,t){var i;let o=(i=oj[s])!==null&&i!==void 0?i:s;t&&(o+=`-${t}`);const c=o.match(/\s|\//),d=e.match(/\s|\//);if(c||d){const m=[`Unable to register library "${o}" with version "${e}":`];c&&m.push(`library name "${o}" contains illegal characters (whitespace or "/")`),c&&d&&m.push("and"),d&&m.push(`version name "${e}" contains illegal characters (whitespace or "/")`),wa.warn(m.join(" "));return}is(new Gn(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dj="firebase-heartbeat-database",hj=1,Vc="firebase-heartbeat-store";let yp=null;function CN(){return yp||(yp=SN(dj,hj,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(Vc)}catch(t){console.warn(t)}}}}).catch(s=>{throw gi.create("idb-open",{originalErrorMessage:s.message})})),yp}async function fj(s){try{const t=(await CN()).transaction(Vc),i=await t.objectStore(Vc).get(jN(s));return await t.done,i}catch(e){if(e instanceof os)wa.warn(e.message);else{const t=gi.create("idb-get",{originalErrorMessage:e?.message});wa.warn(t.message)}}}async function ub(s,e){try{const i=(await CN()).transaction(Vc,"readwrite");await i.objectStore(Vc).put(e,jN(s)),await i.done}catch(t){if(t instanceof os)wa.warn(t.message);else{const i=gi.create("idb-set",{originalErrorMessage:t?.message});wa.warn(i.message)}}}function jN(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mj=1024,pj=30;class gj{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new yj(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),c=db();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===c||this._heartbeatsCache.heartbeats.some(d=>d.date===c))return;if(this._heartbeatsCache.heartbeats.push({date:c,agent:o}),this._heartbeatsCache.heartbeats.length>pj){const d=_j(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){wa.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=db(),{heartbeatsToSend:i,unsentEntries:o}=vj(this._heartbeatsCache.heartbeats),c=rh(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),c}catch(t){return wa.warn(t),""}}}function db(){return new Date().toISOString().substring(0,10)}function vj(s,e=mj){const t=[];let i=s.slice();for(const o of s){const c=t.find(d=>d.agent===o.agent);if(c){if(c.dates.push(o.date),hb(t)>e){c.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),hb(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class yj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return gg()?vg().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await fj(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return ub(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return ub(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function hb(s){return rh(JSON.stringify({version:2,heartbeats:s})).length}function _j(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let i=1;i<s.length;i++)s[i].date<t&&(t=s[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ej(s){is(new Gn("platform-logger",e=>new DC(e),"PRIVATE")),is(new Gn("heartbeat",e=>new gj(e),"PRIVATE")),mn(Vp,lb,s),mn(Vp,lb,"esm2017"),mn("fire-js","")}Ej("");function _g(s,e){var t={};for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&e.indexOf(i)<0&&(t[i]=s[i]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(s);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(s,i[o])&&(t[i[o]]=s[i[o]]);return t}function IN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const bj=IN,RN=new ji("auth","Firebase",IN());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lh=new Xc("@firebase/auth");function Tj(s,...e){lh.logLevel<=Fe.WARN&&lh.warn(`Auth (${Or}): ${s}`,...e)}function Yd(s,...e){lh.logLevel<=Fe.ERROR&&lh.error(`Auth (${Or}): ${s}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rs(s,...e){throw bg(s,...e)}function _s(s,...e){return bg(s,...e)}function Eg(s,e,t){const i=Object.assign(Object.assign({},bj()),{[e]:t});return new ji("auth","Firebase",i).create(e,{appName:s.name})}function Sa(s){return Eg(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Nj(s,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&rs(s,"argument-error"),Eg(s,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function bg(s,...e){if(typeof s!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=s.name),s._errorFactory.create(t,...i)}return RN.create(s,...e)}function Se(s,e,...t){if(!s)throw bg(e,...t)}function xa(s){const e="INTERNAL ASSERTION FAILED: "+s;throw Yd(e),new Error(e)}function Ca(s,e){s||xa(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fp(){var s;return typeof self<"u"&&((s=self.location)===null||s===void 0?void 0:s.href)||""}function xj(){return fb()==="http:"||fb()==="https:"}function fb(){var s;return typeof self<"u"&&((s=self.location)===null||s===void 0?void 0:s.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aj(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(xj()||TN()||"connection"in navigator)?navigator.onLine:!0}function Sj(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ca(t>e,"Short delay should be less than long delay!"),this.isMobile=Ww()||eC()}get(){return Aj()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tg(s,e){Ca(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DN{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;xa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;xa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;xa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wj={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cj=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],jj=new Zc(3e4,6e4);function Ii(s,e){return s.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:s.tenantId}):e}async function Ri(s,e,t,i,o={}){return ON(s,o,async()=>{let c={},d={};i&&(e==="GET"?d=i:c={body:JSON.stringify(i)});const m=Qc(Object.assign({key:s.config.apiKey},d)).slice(1),p=await s._getAdditionalHeaders();p["Content-Type"]="application/json",s.languageCode&&(p["X-Firebase-Locale"]=s.languageCode);const v=Object.assign({method:e,headers:p},c);return Jw()||(v.referrerPolicy="no-referrer"),s.emulatorConfig&&Dr(s.emulatorConfig.host)&&(v.credentials="include"),DN.fetch()(await MN(s,s.config.apiHost,t,m),v)})}async function ON(s,e,t){s._canInitEmulator=!1;const i=Object.assign(Object.assign({},wj),e);try{const o=new Rj(s),c=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const d=await c.json();if("needConfirmation"in d)throw Ud(s,"account-exists-with-different-credential",d);if(c.ok&&!("errorMessage"in d))return d;{const m=c.ok?d.errorMessage:d.error.message,[p,v]=m.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ud(s,"credential-already-in-use",d);if(p==="EMAIL_EXISTS")throw Ud(s,"email-already-in-use",d);if(p==="USER_DISABLED")throw Ud(s,"user-disabled",d);const _=i[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(v)throw Eg(s,_,v);rs(s,_)}}catch(o){if(o instanceof os)throw o;rs(s,"network-request-failed",{message:String(o)})}}async function Jc(s,e,t,i,o={}){const c=await Ri(s,e,t,i,o);return"mfaPendingCredential"in c&&rs(s,"multi-factor-auth-required",{_serverResponse:c}),c}async function MN(s,e,t,i){const o=`${e}${t}?${i}`,c=s,d=c.config.emulator?Tg(s.config,o):`${s.config.apiScheme}://${o}`;return Cj.includes(t)&&(await c._persistenceManagerAvailable,c._getPersistenceType()==="COOKIE")?c._getPersistence()._getFinalTarget(d).toString():d}function Ij(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Rj{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(_s(this.auth,"network-request-failed")),jj.get())})}}function Ud(s,e,t){const i={appName:s.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const o=_s(s,e,i);return o.customData._tokenResponse=t,o}function mb(s){return s!==void 0&&s.enterprise!==void 0}class Dj{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Ij(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Oj(s,e){return Ri(s,"GET","/v2/recaptchaConfig",Ii(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mj(s,e){return Ri(s,"POST","/v1/accounts:delete",e)}async function ch(s,e){return Ri(s,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sc(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Pj(s,e=!1){const t=ut(s),i=await t.getIdToken(e),o=Ng(i);Se(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const c=typeof o.firebase=="object"?o.firebase:void 0,d=c?.sign_in_provider;return{claims:o,token:i,authTime:Sc(_p(o.auth_time)),issuedAtTime:Sc(_p(o.iat)),expirationTime:Sc(_p(o.exp)),signInProvider:d||null,signInSecondFactor:c?.sign_in_second_factor||null}}function _p(s){return Number(s)*1e3}function Ng(s){const[e,t,i]=s.split(".");if(e===void 0||t===void 0||i===void 0)return Yd("JWT malformed, contained fewer than 3 sections"),null;try{const o=gN(t);return o?JSON.parse(o):(Yd("Failed to decode base64 JWT payload"),null)}catch(o){return Yd("Caught error parsing JWT payload as JSON",o?.toString()),null}}function pb(s){const e=Ng(s);return Se(e,"internal-error"),Se(typeof e.exp<"u","internal-error"),Se(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lc(s,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof os&&kj(i)&&s.auth.currentUser===s&&await s.auth.signOut(),i}}function kj({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vj{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const o=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,o)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qp{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Sc(this.lastLoginAt),this.creationTime=Sc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uh(s){var e;const t=s.auth,i=await s.getIdToken(),o=await Lc(s,ch(t,{idToken:i}));Se(o?.users.length,t,"internal-error");const c=o.users[0];s._notifyReloadListener(c);const d=!((e=c.providerUserInfo)===null||e===void 0)&&e.length?PN(c.providerUserInfo):[],m=Uj(s.providerData,d),p=s.isAnonymous,v=!(s.email&&c.passwordHash)&&!m?.length,_=p?v:!1,T={uid:c.localId,displayName:c.displayName||null,photoURL:c.photoUrl||null,email:c.email||null,emailVerified:c.emailVerified||!1,phoneNumber:c.phoneNumber||null,tenantId:c.tenantId||null,providerData:m,metadata:new qp(c.createdAt,c.lastLoginAt),isAnonymous:_};Object.assign(s,T)}async function Lj(s){const e=ut(s);await uh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Uj(s,e){return[...s.filter(i=>!e.some(o=>o.providerId===i.providerId)),...e]}function PN(s){return s.map(e=>{var{providerId:t}=e,i=_g(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fj(s,e){const t=await ON(s,{},async()=>{const i=Qc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:c}=s.config,d=await MN(s,o,"/v1/token",`key=${c}`),m=await s._getAdditionalHeaders();m["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:m,body:i};return s.emulatorConfig&&Dr(s.emulatorConfig.host)&&(p.credentials="include"),DN.fetch()(d,p)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function qj(s,e){return Ri(s,"POST","/v2/accounts:revokeToken",Ii(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Se(e.idToken,"internal-error"),Se(typeof e.idToken<"u","internal-error"),Se(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):pb(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Se(e.length!==0,"internal-error");const t=pb(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Se(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:o,expiresIn:c}=await Fj(e,t);this.updateTokensAndExpiration(i,o,Number(c))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:o,expirationTime:c}=t,d=new Fo;return i&&(Se(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),o&&(Se(typeof o=="string","internal-error",{appName:e}),d.accessToken=o),c&&(Se(typeof c=="number","internal-error",{appName:e}),d.expirationTime=c),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Fo,this.toJSON())}_performRefresh(){return xa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function li(s,e){Se(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class vs{constructor(e){var{uid:t,auth:i,stsTokenManager:o}=e,c=_g(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Vj(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=o,this.accessToken=o.accessToken,this.displayName=c.displayName||null,this.email=c.email||null,this.emailVerified=c.emailVerified||!1,this.phoneNumber=c.phoneNumber||null,this.photoURL=c.photoURL||null,this.isAnonymous=c.isAnonymous||!1,this.tenantId=c.tenantId||null,this.providerData=c.providerData?[...c.providerData]:[],this.metadata=new qp(c.createdAt||void 0,c.lastLoginAt||void 0)}async getIdToken(e){const t=await Lc(this,this.stsTokenManager.getToken(this.auth,e));return Se(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Pj(this,e)}reload(){return Lj(this)}_assign(e){this!==e&&(Se(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new vs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Se(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await uh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Cn(this.auth.app))return Promise.reject(Sa(this.auth));const e=await this.getIdToken();return await Lc(this,Mj(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,o,c,d,m,p,v,_;const T=(i=t.displayName)!==null&&i!==void 0?i:void 0,x=(o=t.email)!==null&&o!==void 0?o:void 0,C=(c=t.phoneNumber)!==null&&c!==void 0?c:void 0,N=(d=t.photoURL)!==null&&d!==void 0?d:void 0,M=(m=t.tenantId)!==null&&m!==void 0?m:void 0,S=(p=t._redirectEventId)!==null&&p!==void 0?p:void 0,U=(v=t.createdAt)!==null&&v!==void 0?v:void 0,$=(_=t.lastLoginAt)!==null&&_!==void 0?_:void 0,{uid:F,emailVerified:V,isAnonymous:B,providerData:ee,stsTokenManager:D}=t;Se(F&&D,e,"internal-error");const A=Fo.fromJSON(this.name,D);Se(typeof F=="string",e,"internal-error"),li(T,e.name),li(x,e.name),Se(typeof V=="boolean",e,"internal-error"),Se(typeof B=="boolean",e,"internal-error"),li(C,e.name),li(N,e.name),li(M,e.name),li(S,e.name),li(U,e.name),li($,e.name);const R=new vs({uid:F,auth:e,email:x,emailVerified:V,displayName:T,isAnonymous:B,photoURL:N,phoneNumber:C,tenantId:M,stsTokenManager:A,createdAt:U,lastLoginAt:$});return ee&&Array.isArray(ee)&&(R.providerData=ee.map(I=>Object.assign({},I))),S&&(R._redirectEventId=S),R}static async _fromIdTokenResponse(e,t,i=!1){const o=new Fo;o.updateFromServerResponse(t);const c=new vs({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:i});return await uh(c),c}static async _fromGetAccountInfoResponse(e,t,i){const o=t.users[0];Se(o.localId!==void 0,"internal-error");const c=o.providerUserInfo!==void 0?PN(o.providerUserInfo):[],d=!(o.email&&o.passwordHash)&&!c?.length,m=new Fo;m.updateFromIdToken(i);const p=new vs({uid:o.localId,auth:e,stsTokenManager:m,isAnonymous:d}),v={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new qp(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!c?.length};return Object.assign(p,v),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gb=new Map;function Aa(s){Ca(s instanceof Function,"Expected a class definition");let e=gb.get(s);return e?(Ca(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,gb.set(s,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}kN.type="NONE";const vb=kN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qd(s,e,t){return`firebase:${s}:${e}:${t}`}class qo{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:o,name:c}=this.auth;this.fullUserKey=Qd(this.userKey,o.apiKey,c),this.fullPersistenceKey=Qd("persistence",o.apiKey,c),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await ch(this.auth,{idToken:e}).catch(()=>{});return t?vs._fromGetAccountInfoResponse(this.auth,t,e):null}return vs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new qo(Aa(vb),e,i);const o=(await Promise.all(t.map(async v=>{if(await v._isAvailable())return v}))).filter(v=>v);let c=o[0]||Aa(vb);const d=Qd(i,e.config.apiKey,e.name);let m=null;for(const v of t)try{const _=await v._get(d);if(_){let T;if(typeof _=="string"){const x=await ch(e,{idToken:_}).catch(()=>{});if(!x)break;T=await vs._fromGetAccountInfoResponse(e,x,_)}else T=vs._fromJSON(e,_);v!==c&&(m=T),c=v;break}}catch{}const p=o.filter(v=>v._shouldAllowMigration);return!c._shouldAllowMigration||!p.length?new qo(c,e,i):(c=p[0],m&&await c._set(d,m.toJSON()),await Promise.all(t.map(async v=>{if(v!==c)try{await v._remove(d)}catch{}})),new qo(c,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yb(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(FN(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(VN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(BN(e))return"Blackberry";if(zN(e))return"Webos";if(LN(e))return"Safari";if((e.includes("chrome/")||UN(e))&&!e.includes("edge/"))return"Chrome";if(qN(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=s.match(t);if(i?.length===2)return i[1]}return"Other"}function VN(s=pn()){return/firefox\//i.test(s)}function LN(s=pn()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function UN(s=pn()){return/crios\//i.test(s)}function FN(s=pn()){return/iemobile/i.test(s)}function qN(s=pn()){return/android/i.test(s)}function BN(s=pn()){return/blackberry/i.test(s)}function zN(s=pn()){return/webos/i.test(s)}function xg(s=pn()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function Bj(s=pn()){var e;return xg(s)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function zj(){return tC()&&document.documentMode===10}function HN(s=pn()){return xg(s)||qN(s)||zN(s)||BN(s)||/windows phone/i.test(s)||FN(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GN(s,e=[]){let t;switch(s){case"Browser":t=yb(pn());break;case"Worker":t=`${yb(pn())}-${s}`;break;default:t=s}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Or}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hj{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=c=>new Promise((d,m)=>{try{const p=e(c);d(p)}catch(p){m(p)}});i.onAbort=t,this.queue.push(i);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gj(s,e={}){return Ri(s,"GET","/v2/passwordPolicy",Ii(s,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $j=6;class Kj{constructor(e){var t,i,o,c;const d=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=d.minPasswordLength)!==null&&t!==void 0?t:$j,d.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=d.maxPasswordLength),d.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=d.containsLowercaseCharacter),d.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=d.containsUppercaseCharacter),d.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=d.containsNumericCharacter),d.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=d.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(o=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&o!==void 0?o:"",this.forceUpgradeOnSignin=(c=e.forceUpgradeOnSignin)!==null&&c!==void 0?c:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,o,c,d,m;const p={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,p),this.validatePasswordCharacterOptions(e,p),p.isValid&&(p.isValid=(t=p.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),p.isValid&&(p.isValid=(i=p.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),p.isValid&&(p.isValid=(o=p.containsLowercaseLetter)!==null&&o!==void 0?o:!0),p.isValid&&(p.isValid=(c=p.containsUppercaseLetter)!==null&&c!==void 0?c:!0),p.isValid&&(p.isValid=(d=p.containsNumericCharacter)!==null&&d!==void 0?d:!0),p.isValid&&(p.isValid=(m=p.containsNonAlphanumericCharacter)!==null&&m!==void 0?m:!0),p}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let o=0;o<e.length;o++)i=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,o,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yj{constructor(e,t,i,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new _b(this),this.idTokenSubscription=new _b(this),this.beforeStateQueue=new Hj(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=RN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(c=>this._resolvePersistenceManagerAvailable=c)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Aa(t)),this._initializationPromise=this.queue(async()=>{var i,o,c;if(!this._deleted&&(this.persistenceManager=await qo.create(this,e),(i=this._resolvePersistenceManagerAvailable)===null||i===void 0||i.call(this),!this._deleted)){if(!((o=this._popupRedirectResolver)===null||o===void 0)&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((c=this.currentUser)===null||c===void 0?void 0:c.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await ch(this,{idToken:e}),i=await vs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Cn(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(m=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(m,m))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let o=i,c=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,m=o?._redirectEventId,p=await this.tryRedirectSignIn(e);(!d||d===m)&&p?.user&&(o=p.user,c=!0)}if(!o)return this.directlySetCurrentUser(null);if(!o._redirectEventId){if(c)try{await this.beforeStateQueue.runMiddleware(o)}catch(d){o=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return o?this.reloadAndSetCurrentUserOrClear(o):this.directlySetCurrentUser(null)}return Se(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===o._redirectEventId?this.directlySetCurrentUser(o):this.reloadAndSetCurrentUserOrClear(o)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await uh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Sj()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Cn(this.app))return Promise.reject(Sa(this));const t=e?ut(e):null;return t&&Se(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Se(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Cn(this.app)?Promise.reject(Sa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Cn(this.app)?Promise.reject(Sa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Aa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Gj(this),t=new Kj(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ji("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await qj(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Aa(e)||this._popupRedirectResolver;Se(t,this,"argument-error"),this.redirectPersistenceManager=await qo.create(this,[Aa(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,o){if(this._deleted)return()=>{};const c=typeof t=="function"?t:t.next.bind(t);let d=!1;const m=this._isInitialized?Promise.resolve():this._initializationPromise;if(Se(m,this,"internal-error"),m.then(()=>{d||c(this.currentUser)}),typeof t=="function"){const p=e.addObserver(t,i,o);return()=>{d=!0,p()}}else{const p=e.addObserver(t);return()=>{d=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Se(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=GN(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());i&&(t["X-Firebase-Client"]=i);const o=await this._getAppCheckToken();return o&&(t["X-Firebase-AppCheck"]=o),t}async _getAppCheckToken(){var e;if(Cn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&Tj(`Error while retrieving App Check token: ${t.error}`),t?.token}}function Di(s){return ut(s)}class _b{constructor(e){this.auth=e,this.observer=null,this.addObserver=oC(t=>this.observer=t)}get next(){return Se(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Oh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Qj(s){Oh=s}function $N(s){return Oh.loadJS(s)}function Xj(){return Oh.recaptchaEnterpriseScript}function Wj(){return Oh.gapiScript}function Zj(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class Jj{constructor(){this.enterprise=new eI}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class eI{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const tI="recaptcha-enterprise",KN="NO_RECAPTCHA";class nI{constructor(e){this.type=tI,this.auth=Di(e)}async verify(e="verify",t=!1){async function i(c){if(!t){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(d,m)=>{Oj(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)m(new Error("recaptcha Enterprise site key undefined"));else{const v=new Dj(p);return c.tenantId==null?c._agentRecaptchaConfig=v:c._tenantRecaptchaConfigs[c.tenantId]=v,d(v.siteKey)}}).catch(p=>{m(p)})})}function o(c,d,m){const p=window.grecaptcha;mb(p)?p.enterprise.ready(()=>{p.enterprise.execute(c,{action:e}).then(v=>{d(v)}).catch(()=>{d(KN)})}):m(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Jj().execute("siteKey",{action:"verify"}):new Promise((c,d)=>{i(this.auth).then(m=>{if(!t&&mb(window.grecaptcha))o(m,c,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let p=Xj();p.length!==0&&(p+=m),$N(p).then(()=>{o(m,c,d)}).catch(v=>{d(v)})}}).catch(m=>{d(m)})})}}async function Eb(s,e,t,i=!1,o=!1){const c=new nI(s);let d;if(o)d=KN;else try{d=await c.verify(t)}catch{d=await c.verify(t,!0)}const m=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in m){const p=m.phoneEnrollmentInfo.phoneNumber,v=m.phoneEnrollmentInfo.recaptchaToken;Object.assign(m,{phoneEnrollmentInfo:{phoneNumber:p,recaptchaToken:v,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in m){const p=m.phoneSignInInfo.recaptchaToken;Object.assign(m,{phoneSignInInfo:{recaptchaToken:p,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return m}return i?Object.assign(m,{captchaResp:d}):Object.assign(m,{captchaResponse:d}),Object.assign(m,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(m,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),m}async function Bp(s,e,t,i,o){var c;if(!((c=s._getRecaptchaConfig())===null||c===void 0)&&c.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await Eb(s,e,t,t==="getOobCode");return i(s,d)}else return i(s,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const m=await Eb(s,e,t,t==="getOobCode");return i(s,m)}else return Promise.reject(d)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sI(s,e){const t=Ra(s,"auth");if(t.isInitialized()){const o=t.getImmediate(),c=t.getOptions();if(_i(c,e??{}))return o;rs(o,"already-initialized")}return t.initialize({options:e})}function aI(s,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Aa);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(i,e?.popupRedirectResolver)}function iI(s,e,t){const i=Di(s);Se(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const o=!1,c=YN(e),{host:d,port:m}=rI(e),p=m===null?"":`:${m}`,v={url:`${c}//${d}${p}/`},_=Object.freeze({host:d,port:m,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!i._canInitEmulator){Se(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Se(_i(v,i.config.emulator)&&_i(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=v,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,Dr(d)?(mg(`${c}//${d}${p}`),pg("Auth",!0)):oI()}function YN(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function rI(s){const e=YN(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(i);if(o){const c=o[1];return{host:c,port:bb(i.substr(c.length+1))}}else{const[c,d]=i.split(":");return{host:c,port:bb(d)}}}function bb(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function oI(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return xa("not implemented")}_getIdTokenResponse(e){return xa("not implemented")}_linkToIdToken(e,t){return xa("not implemented")}_getReauthenticationResolver(e){return xa("not implemented")}}async function lI(s,e){return Ri(s,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cI(s,e){return Jc(s,"POST","/v1/accounts:signInWithPassword",Ii(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uI(s,e){return Jc(s,"POST","/v1/accounts:signInWithEmailLink",Ii(s,e))}async function dI(s,e){return Jc(s,"POST","/v1/accounts:signInWithEmailLink",Ii(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc extends Ag{constructor(e,t,i,o=null){super("password",i),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new Uc(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Uc(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Bp(e,t,"signInWithPassword",cI);case"emailLink":return uI(e,{email:this._email,oobCode:this._password});default:rs(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Bp(e,i,"signUpPassword",lI);case"emailLink":return dI(e,{idToken:t,email:this._email,oobCode:this._password});default:rs(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bo(s,e){return Jc(s,"POST","/v1/accounts:signInWithIdp",Ii(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hI="http://localhost";class Ar extends Ag{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ar(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):rs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:o}=t,c=_g(t,["providerId","signInMethod"]);if(!i||!o)return null;const d=new Ar(i,o);return d.idToken=c.idToken||void 0,d.accessToken=c.accessToken||void 0,d.secret=c.secret,d.nonce=c.nonce,d.pendingToken=c.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Bo(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Bo(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Bo(e,t)}buildRequest(){const e={requestUri:hI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Qc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fI(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function mI(s){const e=_c(Ec(s)).link,t=e?_c(Ec(e)).deep_link_id:null,i=_c(Ec(s)).deep_link_id;return(i?_c(Ec(i)).link:null)||i||t||e||s}class Sg{constructor(e){var t,i,o,c,d,m;const p=_c(Ec(e)),v=(t=p.apiKey)!==null&&t!==void 0?t:null,_=(i=p.oobCode)!==null&&i!==void 0?i:null,T=fI((o=p.mode)!==null&&o!==void 0?o:null);Se(v&&_&&T,"argument-error"),this.apiKey=v,this.operation=T,this.code=_,this.continueUrl=(c=p.continueUrl)!==null&&c!==void 0?c:null,this.languageCode=(d=p.lang)!==null&&d!==void 0?d:null,this.tenantId=(m=p.tenantId)!==null&&m!==void 0?m:null}static parseLink(e){const t=mI(e);try{return new Sg(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(){this.providerId=tl.PROVIDER_ID}static credential(e,t){return Uc._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=Sg.parseLink(t);return Se(i,"argument-error"),Uc._fromEmailAndCode(e,i.code,i.tenantId)}}tl.PROVIDER_ID="password";tl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";tl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu extends wg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui extends eu{constructor(){super("facebook.com")}static credential(e){return Ar._fromParams({providerId:ui.PROVIDER_ID,signInMethod:ui.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ui.credentialFromTaggedObject(e)}static credentialFromError(e){return ui.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ui.credential(e.oauthAccessToken)}catch{return null}}}ui.FACEBOOK_SIGN_IN_METHOD="facebook.com";ui.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na extends eu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ar._fromParams({providerId:Na.PROVIDER_ID,signInMethod:Na.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Na.credentialFromTaggedObject(e)}static credentialFromError(e){return Na.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Na.credential(t,i)}catch{return null}}}Na.GOOGLE_SIGN_IN_METHOD="google.com";Na.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di extends eu{constructor(){super("github.com")}static credential(e){return Ar._fromParams({providerId:di.PROVIDER_ID,signInMethod:di.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return di.credentialFromTaggedObject(e)}static credentialFromError(e){return di.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return di.credential(e.oauthAccessToken)}catch{return null}}}di.GITHUB_SIGN_IN_METHOD="github.com";di.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi extends eu{constructor(){super("twitter.com")}static credential(e,t){return Ar._fromParams({providerId:hi.PROVIDER_ID,signInMethod:hi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return hi.credentialFromTaggedObject(e)}static credentialFromError(e){return hi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return hi.credential(t,i)}catch{return null}}}hi.TWITTER_SIGN_IN_METHOD="twitter.com";hi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pI(s,e){return Jc(s,"POST","/v1/accounts:signUp",Ii(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,o=!1){const c=await vs._fromIdTokenResponse(e,i,o),d=Tb(i);return new Sr({user:c,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const o=Tb(i);return new Sr({user:e,providerId:o,_tokenResponse:i,operationType:t})}}function Tb(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dh extends os{constructor(e,t,i,o){var c;super(t.code,t.message),this.operationType=i,this.user=o,Object.setPrototypeOf(this,dh.prototype),this.customData={appName:e.name,tenantId:(c=e.tenantId)!==null&&c!==void 0?c:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,o){return new dh(e,t,i,o)}}function QN(s,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?dh._fromErrorAndOperation(s,c,e,i):c})}async function gI(s,e,t=!1){const i=await Lc(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Sr._forOperation(s,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vI(s,e,t=!1){const{auth:i}=s;if(Cn(i.app))return Promise.reject(Sa(i));const o="reauthenticate";try{const c=await Lc(s,QN(i,o,e,s),t);Se(c.idToken,i,"internal-error");const d=Ng(c.idToken);Se(d,i,"internal-error");const{sub:m}=d;return Se(s.uid===m,i,"user-mismatch"),Sr._forOperation(s,o,c)}catch(c){throw c?.code==="auth/user-not-found"&&rs(i,"user-mismatch"),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XN(s,e,t=!1){if(Cn(s.app))return Promise.reject(Sa(s));const i="signIn",o=await QN(s,i,e),c=await Sr._fromIdTokenResponse(s,i,o);return t||await s._updateCurrentUser(c.user),c}async function yI(s,e){return XN(Di(s),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WN(s){const e=Di(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function _I(s,e,t){if(Cn(s.app))return Promise.reject(Sa(s));const i=Di(s),d=await Bp(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",pI).catch(p=>{throw p.code==="auth/password-does-not-meet-requirements"&&WN(s),p}),m=await Sr._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(m.user),m}function EI(s,e,t){return Cn(s.app)?Promise.reject(Sa(s)):yI(ut(s),tl.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&WN(s),i})}function bI(s,e,t,i){return ut(s).onIdTokenChanged(e,t,i)}function TI(s,e,t){return ut(s).beforeAuthStateChanged(e,t)}function NI(s,e,t,i){return ut(s).onAuthStateChanged(e,t,i)}function xI(s){return ut(s).signOut()}const hh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZN{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(hh,"1"),this.storage.removeItem(hh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AI=1e3,SI=10;class JN extends ZN{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=HN(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),o=this.localCache[t];i!==o&&e(t,o,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,m,p)=>{this.notifyListeners(d,p)});return}const i=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},c=this.storage.getItem(i);zj()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,SI):o()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},AI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}JN.type="LOCAL";const wI=JN;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ex extends ZN{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}ex.type="SESSION";const tx=ex;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CI(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const i=new Mh(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:o,data:c}=t.data,d=this.handlersMap[o];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const m=Array.from(d).map(async v=>v(t.origin,c)),p=await CI(m);t.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:p})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Mh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cg(s="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return s+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let c,d;return new Promise((m,p)=>{const v=Cg("",20);o.port1.start();const _=setTimeout(()=>{p(new Error("unsupported_event"))},i);d={messageChannel:o,onMessage(T){const x=T;if(x.data.eventId===v)switch(x.data.status){case"ack":clearTimeout(_),c=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),m(x.data.response);break;default:clearTimeout(_),clearTimeout(c),p(new Error("invalid_response"));break}}},this.handlers.add(d),o.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:v,data:t},[o.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qs(){return window}function II(s){qs().location.href=s}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nx(){return typeof qs().WorkerGlobalScope<"u"&&typeof qs().importScripts=="function"}async function RI(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function DI(){var s;return((s=navigator?.serviceWorker)===null||s===void 0?void 0:s.controller)||null}function OI(){return nx()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sx="firebaseLocalStorageDb",MI=1,fh="firebaseLocalStorage",ax="fbase_key";class tu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Ph(s,e){return s.transaction([fh],e?"readwrite":"readonly").objectStore(fh)}function PI(){const s=indexedDB.deleteDatabase(sx);return new tu(s).toPromise()}function zp(){const s=indexedDB.open(sx,MI);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const i=s.result;try{i.createObjectStore(fh,{keyPath:ax})}catch(o){t(o)}}),s.addEventListener("success",async()=>{const i=s.result;i.objectStoreNames.contains(fh)?e(i):(i.close(),await PI(),e(await zp()))})})}async function Nb(s,e,t){const i=Ph(s,!0).put({[ax]:e,value:t});return new tu(i).toPromise()}async function kI(s,e){const t=Ph(s,!1).get(e),i=await new tu(t).toPromise();return i===void 0?null:i.value}function xb(s,e){const t=Ph(s,!0).delete(e);return new tu(t).toPromise()}const VI=800,LI=3;class ix{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await zp(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>LI)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return nx()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Mh._getInstance(OI()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await RI(),!this.activeServiceWorker)return;this.sender=new jI(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((t=i[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||DI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await zp();return await Nb(e,hh,"1"),await xb(e,hh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>Nb(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>kI(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>xb(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const c=Ph(o,!1).getAll();return new tu(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:o,value:c}of e)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(c)&&(this.notifyListeners(o,c),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),VI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}ix.type="LOCAL";const UI=ix;new Zc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rx(s,e){return e?Aa(e):(Se(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jg extends Ag{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Bo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Bo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Bo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function FI(s){return XN(s.auth,new jg(s),s.bypassAuthState)}function qI(s){const{auth:e,user:t}=s;return Se(t,e,"internal-error"),vI(t,new jg(s),s.bypassAuthState)}async function BI(s){const{auth:e,user:t}=s;return Se(t,e,"internal-error"),gI(t,new jg(s),s.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ox{constructor(e,t,i,o,c=!1){this.auth=e,this.resolver=i,this.user=o,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:o,tenantId:c,error:d,type:m}=e;if(d){this.reject(d);return}const p={auth:this.auth,requestUri:t,sessionId:i,tenantId:c||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(m)(p))}catch(v){this.reject(v)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return FI;case"linkViaPopup":case"linkViaRedirect":return BI;case"reauthViaPopup":case"reauthViaRedirect":return qI;default:rs(this.auth,"internal-error")}}resolve(e){Ca(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ca(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zI=new Zc(2e3,1e4);async function HI(s,e,t){if(Cn(s.app))return Promise.reject(_s(s,"operation-not-supported-in-this-environment"));const i=Di(s);Nj(s,e,wg);const o=rx(i,t);return new br(i,"signInViaPopup",e,o).executeNotNull()}class br extends ox{constructor(e,t,i,o,c){super(e,t,o,c),this.provider=i,this.authWindow=null,this.pollId=null,br.currentPopupAction&&br.currentPopupAction.cancel(),br.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Se(e,this.auth,"internal-error"),e}async onExecution(){Ca(this.filter.length===1,"Popup operations only handle one event");const e=Cg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(_s(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(_s(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,br.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if(!((i=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_s(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,zI.get())};e()}}br.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GI="pendingRedirect",Xd=new Map;class $I extends ox{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Xd.get(this.auth._key());if(!e){try{const i=await KI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Xd.set(this.auth._key(),e)}return this.bypassAuthState||Xd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function KI(s,e){const t=XI(e),i=QI(s);if(!await i._isAvailable())return!1;const o=await i._get(t)==="true";return await i._remove(t),o}function YI(s,e){Xd.set(s._key(),e)}function QI(s){return Aa(s._redirectPersistence)}function XI(s){return Qd(GI,s.config.apiKey,s.name)}async function WI(s,e,t=!1){if(Cn(s.app))return Promise.reject(Sa(s));const i=Di(s),o=rx(i,e),d=await new $I(i,o,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZI=10*60*1e3;class JI{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!eR(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!lx(e)){const o=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(_s(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=ZI&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ab(e))}saveEventToCache(e){this.cachedEventUids.add(Ab(e)),this.lastProcessedEventTime=Date.now()}}function Ab(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function lx({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function eR(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return lx(s);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tR(s,e={}){return Ri(s,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nR=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,sR=/^https?/;async function aR(s){if(s.config.emulator)return;const{authorizedDomains:e}=await tR(s);for(const t of e)try{if(iR(t))return}catch{}rs(s,"unauthorized-domain")}function iR(s){const e=Fp(),{protocol:t,hostname:i}=new URL(e);if(s.startsWith("chrome-extension://")){const d=new URL(s);return d.hostname===""&&i===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!sR.test(t))return!1;if(nR.test(s))return i===s;const o=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rR=new Zc(3e4,6e4);function Sb(){const s=qs().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function oR(s){return new Promise((e,t)=>{var i,o,c;function d(){Sb(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Sb(),t(_s(s,"network-request-failed"))},timeout:rR.get()})}if(!((o=(i=qs().gapi)===null||i===void 0?void 0:i.iframes)===null||o===void 0)&&o.Iframe)e(gapi.iframes.getContext());else if(!((c=qs().gapi)===null||c===void 0)&&c.load)d();else{const m=Zj("iframefcb");return qs()[m]=()=>{gapi.load?d():t(_s(s,"network-request-failed"))},$N(`${Wj()}?onload=${m}`).catch(p=>t(p))}}).catch(e=>{throw Wd=null,e})}let Wd=null;function lR(s){return Wd=Wd||oR(s),Wd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cR=new Zc(5e3,15e3),uR="__/auth/iframe",dR="emulator/auth/iframe",hR={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},fR=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function mR(s){const e=s.config;Se(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?Tg(e,dR):`https://${s.config.authDomain}/${uR}`,i={apiKey:e.apiKey,appName:s.name,v:Or},o=fR.get(s.config.apiHost);o&&(i.eid=o);const c=s._getFrameworks();return c.length&&(i.fw=c.join(",")),`${t}?${Qc(i).slice(1)}`}async function pR(s){const e=await lR(s),t=qs().gapi;return Se(t,s,"internal-error"),e.open({where:document.body,url:mR(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:hR,dontclear:!0},i=>new Promise(async(o,c)=>{await i.restyle({setHideOnLeave:!1});const d=_s(s,"network-request-failed"),m=qs().setTimeout(()=>{c(d)},cR.get());function p(){qs().clearTimeout(m),o(i)}i.ping(p).then(p,()=>{c(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gR={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},vR=500,yR=600,_R="_blank",ER="http://localhost";class wb{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function bR(s,e,t,i=vR,o=yR){const c=Math.max((window.screen.availHeight-o)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let m="";const p=Object.assign(Object.assign({},gR),{width:i.toString(),height:o.toString(),top:c,left:d}),v=pn().toLowerCase();t&&(m=UN(v)?_R:t),VN(v)&&(e=e||ER,p.scrollbars="yes");const _=Object.entries(p).reduce((x,[C,N])=>`${x}${C}=${N},`,"");if(Bj(v)&&m!=="_self")return TR(e||"",m),new wb(null);const T=window.open(e||"",m,_);Se(T,s,"popup-blocked");try{T.focus()}catch{}return new wb(T)}function TR(s,e){const t=document.createElement("a");t.href=s,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NR="__/auth/handler",xR="emulator/auth/handler",AR=encodeURIComponent("fac");async function Cb(s,e,t,i,o,c){Se(s.config.authDomain,s,"auth-domain-config-required"),Se(s.config.apiKey,s,"invalid-api-key");const d={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:i,v:Or,eventId:o};if(e instanceof wg){e.setDefaultLanguage(s.languageCode),d.providerId=e.providerId||"",rC(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,T]of Object.entries({}))d[_]=T}if(e instanceof eu){const _=e.getScopes().filter(T=>T!=="");_.length>0&&(d.scopes=_.join(","))}s.tenantId&&(d.tid=s.tenantId);const m=d;for(const _ of Object.keys(m))m[_]===void 0&&delete m[_];const p=await s._getAppCheckToken(),v=p?`#${AR}=${encodeURIComponent(p)}`:"";return`${SR(s)}?${Qc(m).slice(1)}${v}`}function SR({config:s}){return s.emulator?Tg(s,xR):`https://${s.authDomain}/${NR}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ep="webStorageSupport";class wR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=tx,this._completeRedirectFn=WI,this._overrideRedirectResult=YI}async _openPopup(e,t,i,o){var c;Ca((c=this.eventManagers[e._key()])===null||c===void 0?void 0:c.manager,"_initialize() not called before _openPopup()");const d=await Cb(e,t,i,Fp(),o);return bR(e,d,Cg())}async _openRedirect(e,t,i,o){await this._originValidation(e);const c=await Cb(e,t,i,Fp(),o);return II(c),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:c}=this.eventManagers[t];return o?Promise.resolve(o):(Ca(c,"If manager is not set, promise should be"),c)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await pR(e),i=new JI(e);return t.register("authEvent",o=>(Se(o?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ep,{type:Ep},o=>{var c;const d=(c=o?.[0])===null||c===void 0?void 0:c[Ep];d!==void 0&&t(!!d),rs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=aR(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return HN()||LN()||xg()}}const CR=wR;var jb="@firebase/auth",Ib="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Se(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IR(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function RR(s){is(new Gn("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:d,authDomain:m}=i.options;Se(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const p={apiKey:d,authDomain:m,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:GN(s)},v=new Yj(i,o,c,p);return aI(v,t),v},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),is(new Gn("auth-internal",e=>{const t=Di(e.getProvider("auth").getImmediate());return(i=>new jR(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),mn(jb,Ib,IR(s)),mn(jb,Ib,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DR=5*60,OR=EN("authIdTokenMaxAge")||DR;let Rb=null;const MR=s=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>OR)return;const o=t?.token;Rb!==o&&(Rb=o,await fetch(s,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function PR(s=Wc()){const e=Ra(s,"auth");if(e.isInitialized())return e.getImmediate();const t=sI(s,{popupRedirectResolver:CR,persistence:[UI,wI,tx]}),i=EN("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const c=new URL(i,location.origin);if(location.origin===c.origin){const d=MR(c.toString());TI(t,d,()=>d(t.currentUser)),bI(t,m=>d(m))}}const o=vN("auth");return o&&iI(t,`http://${o}`),t}function kR(){var s,e;return(e=(s=document.getElementsByTagName("head"))===null||s===void 0?void 0:s[0])!==null&&e!==void 0?e:document}Qj({loadJS(s){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",s),i.onload=e,i.onerror=o=>{const c=_s("internal-error");c.customData=o,t(c)},i.type="text/javascript",i.charset="UTF-8",kR().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});RR("Browser");var VR="firebase",LR="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mn(VR,LR,"app");var Db=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var vi,cx;(function(){var s;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(D,A){function R(){}R.prototype=A.prototype,D.D=A.prototype,D.prototype=new R,D.prototype.constructor=D,D.C=function(I,k,P){for(var O=Array(arguments.length-2),Ve=2;Ve<arguments.length;Ve++)O[Ve-2]=arguments[Ve];return A.prototype[k].apply(I,O)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(D,A,R){R||(R=0);var I=Array(16);if(typeof A=="string")for(var k=0;16>k;++k)I[k]=A.charCodeAt(R++)|A.charCodeAt(R++)<<8|A.charCodeAt(R++)<<16|A.charCodeAt(R++)<<24;else for(k=0;16>k;++k)I[k]=A[R++]|A[R++]<<8|A[R++]<<16|A[R++]<<24;A=D.g[0],R=D.g[1],k=D.g[2];var P=D.g[3],O=A+(P^R&(k^P))+I[0]+3614090360&4294967295;A=R+(O<<7&4294967295|O>>>25),O=P+(k^A&(R^k))+I[1]+3905402710&4294967295,P=A+(O<<12&4294967295|O>>>20),O=k+(R^P&(A^R))+I[2]+606105819&4294967295,k=P+(O<<17&4294967295|O>>>15),O=R+(A^k&(P^A))+I[3]+3250441966&4294967295,R=k+(O<<22&4294967295|O>>>10),O=A+(P^R&(k^P))+I[4]+4118548399&4294967295,A=R+(O<<7&4294967295|O>>>25),O=P+(k^A&(R^k))+I[5]+1200080426&4294967295,P=A+(O<<12&4294967295|O>>>20),O=k+(R^P&(A^R))+I[6]+2821735955&4294967295,k=P+(O<<17&4294967295|O>>>15),O=R+(A^k&(P^A))+I[7]+4249261313&4294967295,R=k+(O<<22&4294967295|O>>>10),O=A+(P^R&(k^P))+I[8]+1770035416&4294967295,A=R+(O<<7&4294967295|O>>>25),O=P+(k^A&(R^k))+I[9]+2336552879&4294967295,P=A+(O<<12&4294967295|O>>>20),O=k+(R^P&(A^R))+I[10]+4294925233&4294967295,k=P+(O<<17&4294967295|O>>>15),O=R+(A^k&(P^A))+I[11]+2304563134&4294967295,R=k+(O<<22&4294967295|O>>>10),O=A+(P^R&(k^P))+I[12]+1804603682&4294967295,A=R+(O<<7&4294967295|O>>>25),O=P+(k^A&(R^k))+I[13]+4254626195&4294967295,P=A+(O<<12&4294967295|O>>>20),O=k+(R^P&(A^R))+I[14]+2792965006&4294967295,k=P+(O<<17&4294967295|O>>>15),O=R+(A^k&(P^A))+I[15]+1236535329&4294967295,R=k+(O<<22&4294967295|O>>>10),O=A+(k^P&(R^k))+I[1]+4129170786&4294967295,A=R+(O<<5&4294967295|O>>>27),O=P+(R^k&(A^R))+I[6]+3225465664&4294967295,P=A+(O<<9&4294967295|O>>>23),O=k+(A^R&(P^A))+I[11]+643717713&4294967295,k=P+(O<<14&4294967295|O>>>18),O=R+(P^A&(k^P))+I[0]+3921069994&4294967295,R=k+(O<<20&4294967295|O>>>12),O=A+(k^P&(R^k))+I[5]+3593408605&4294967295,A=R+(O<<5&4294967295|O>>>27),O=P+(R^k&(A^R))+I[10]+38016083&4294967295,P=A+(O<<9&4294967295|O>>>23),O=k+(A^R&(P^A))+I[15]+3634488961&4294967295,k=P+(O<<14&4294967295|O>>>18),O=R+(P^A&(k^P))+I[4]+3889429448&4294967295,R=k+(O<<20&4294967295|O>>>12),O=A+(k^P&(R^k))+I[9]+568446438&4294967295,A=R+(O<<5&4294967295|O>>>27),O=P+(R^k&(A^R))+I[14]+3275163606&4294967295,P=A+(O<<9&4294967295|O>>>23),O=k+(A^R&(P^A))+I[3]+4107603335&4294967295,k=P+(O<<14&4294967295|O>>>18),O=R+(P^A&(k^P))+I[8]+1163531501&4294967295,R=k+(O<<20&4294967295|O>>>12),O=A+(k^P&(R^k))+I[13]+2850285829&4294967295,A=R+(O<<5&4294967295|O>>>27),O=P+(R^k&(A^R))+I[2]+4243563512&4294967295,P=A+(O<<9&4294967295|O>>>23),O=k+(A^R&(P^A))+I[7]+1735328473&4294967295,k=P+(O<<14&4294967295|O>>>18),O=R+(P^A&(k^P))+I[12]+2368359562&4294967295,R=k+(O<<20&4294967295|O>>>12),O=A+(R^k^P)+I[5]+4294588738&4294967295,A=R+(O<<4&4294967295|O>>>28),O=P+(A^R^k)+I[8]+2272392833&4294967295,P=A+(O<<11&4294967295|O>>>21),O=k+(P^A^R)+I[11]+1839030562&4294967295,k=P+(O<<16&4294967295|O>>>16),O=R+(k^P^A)+I[14]+4259657740&4294967295,R=k+(O<<23&4294967295|O>>>9),O=A+(R^k^P)+I[1]+2763975236&4294967295,A=R+(O<<4&4294967295|O>>>28),O=P+(A^R^k)+I[4]+1272893353&4294967295,P=A+(O<<11&4294967295|O>>>21),O=k+(P^A^R)+I[7]+4139469664&4294967295,k=P+(O<<16&4294967295|O>>>16),O=R+(k^P^A)+I[10]+3200236656&4294967295,R=k+(O<<23&4294967295|O>>>9),O=A+(R^k^P)+I[13]+681279174&4294967295,A=R+(O<<4&4294967295|O>>>28),O=P+(A^R^k)+I[0]+3936430074&4294967295,P=A+(O<<11&4294967295|O>>>21),O=k+(P^A^R)+I[3]+3572445317&4294967295,k=P+(O<<16&4294967295|O>>>16),O=R+(k^P^A)+I[6]+76029189&4294967295,R=k+(O<<23&4294967295|O>>>9),O=A+(R^k^P)+I[9]+3654602809&4294967295,A=R+(O<<4&4294967295|O>>>28),O=P+(A^R^k)+I[12]+3873151461&4294967295,P=A+(O<<11&4294967295|O>>>21),O=k+(P^A^R)+I[15]+530742520&4294967295,k=P+(O<<16&4294967295|O>>>16),O=R+(k^P^A)+I[2]+3299628645&4294967295,R=k+(O<<23&4294967295|O>>>9),O=A+(k^(R|~P))+I[0]+4096336452&4294967295,A=R+(O<<6&4294967295|O>>>26),O=P+(R^(A|~k))+I[7]+1126891415&4294967295,P=A+(O<<10&4294967295|O>>>22),O=k+(A^(P|~R))+I[14]+2878612391&4294967295,k=P+(O<<15&4294967295|O>>>17),O=R+(P^(k|~A))+I[5]+4237533241&4294967295,R=k+(O<<21&4294967295|O>>>11),O=A+(k^(R|~P))+I[12]+1700485571&4294967295,A=R+(O<<6&4294967295|O>>>26),O=P+(R^(A|~k))+I[3]+2399980690&4294967295,P=A+(O<<10&4294967295|O>>>22),O=k+(A^(P|~R))+I[10]+4293915773&4294967295,k=P+(O<<15&4294967295|O>>>17),O=R+(P^(k|~A))+I[1]+2240044497&4294967295,R=k+(O<<21&4294967295|O>>>11),O=A+(k^(R|~P))+I[8]+1873313359&4294967295,A=R+(O<<6&4294967295|O>>>26),O=P+(R^(A|~k))+I[15]+4264355552&4294967295,P=A+(O<<10&4294967295|O>>>22),O=k+(A^(P|~R))+I[6]+2734768916&4294967295,k=P+(O<<15&4294967295|O>>>17),O=R+(P^(k|~A))+I[13]+1309151649&4294967295,R=k+(O<<21&4294967295|O>>>11),O=A+(k^(R|~P))+I[4]+4149444226&4294967295,A=R+(O<<6&4294967295|O>>>26),O=P+(R^(A|~k))+I[11]+3174756917&4294967295,P=A+(O<<10&4294967295|O>>>22),O=k+(A^(P|~R))+I[2]+718787259&4294967295,k=P+(O<<15&4294967295|O>>>17),O=R+(P^(k|~A))+I[9]+3951481745&4294967295,D.g[0]=D.g[0]+A&4294967295,D.g[1]=D.g[1]+(k+(O<<21&4294967295|O>>>11))&4294967295,D.g[2]=D.g[2]+k&4294967295,D.g[3]=D.g[3]+P&4294967295}i.prototype.u=function(D,A){A===void 0&&(A=D.length);for(var R=A-this.blockSize,I=this.B,k=this.h,P=0;P<A;){if(k==0)for(;P<=R;)o(this,D,P),P+=this.blockSize;if(typeof D=="string"){for(;P<A;)if(I[k++]=D.charCodeAt(P++),k==this.blockSize){o(this,I),k=0;break}}else for(;P<A;)if(I[k++]=D[P++],k==this.blockSize){o(this,I),k=0;break}}this.h=k,this.o+=A},i.prototype.v=function(){var D=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);D[0]=128;for(var A=1;A<D.length-8;++A)D[A]=0;var R=8*this.o;for(A=D.length-8;A<D.length;++A)D[A]=R&255,R/=256;for(this.u(D),D=Array(16),A=R=0;4>A;++A)for(var I=0;32>I;I+=8)D[R++]=this.g[A]>>>I&255;return D};function c(D,A){var R=m;return Object.prototype.hasOwnProperty.call(R,D)?R[D]:R[D]=A(D)}function d(D,A){this.h=A;for(var R=[],I=!0,k=D.length-1;0<=k;k--){var P=D[k]|0;I&&P==A||(R[k]=P,I=!1)}this.g=R}var m={};function p(D){return-128<=D&&128>D?c(D,function(A){return new d([A|0],0>A?-1:0)}):new d([D|0],0>D?-1:0)}function v(D){if(isNaN(D)||!isFinite(D))return T;if(0>D)return S(v(-D));for(var A=[],R=1,I=0;D>=R;I++)A[I]=D/R|0,R*=4294967296;return new d(A,0)}function _(D,A){if(D.length==0)throw Error("number format error: empty string");if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(D.charAt(0)=="-")return S(_(D.substring(1),A));if(0<=D.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=v(Math.pow(A,8)),I=T,k=0;k<D.length;k+=8){var P=Math.min(8,D.length-k),O=parseInt(D.substring(k,k+P),A);8>P?(P=v(Math.pow(A,P)),I=I.j(P).add(v(O))):(I=I.j(R),I=I.add(v(O)))}return I}var T=p(0),x=p(1),C=p(16777216);s=d.prototype,s.m=function(){if(M(this))return-S(this).m();for(var D=0,A=1,R=0;R<this.g.length;R++){var I=this.i(R);D+=(0<=I?I:4294967296+I)*A,A*=4294967296}return D},s.toString=function(D){if(D=D||10,2>D||36<D)throw Error("radix out of range: "+D);if(N(this))return"0";if(M(this))return"-"+S(this).toString(D);for(var A=v(Math.pow(D,6)),R=this,I="";;){var k=V(R,A).g;R=U(R,k.j(A));var P=((0<R.g.length?R.g[0]:R.h)>>>0).toString(D);if(R=k,N(R))return P+I;for(;6>P.length;)P="0"+P;I=P+I}},s.i=function(D){return 0>D?0:D<this.g.length?this.g[D]:this.h};function N(D){if(D.h!=0)return!1;for(var A=0;A<D.g.length;A++)if(D.g[A]!=0)return!1;return!0}function M(D){return D.h==-1}s.l=function(D){return D=U(this,D),M(D)?-1:N(D)?0:1};function S(D){for(var A=D.g.length,R=[],I=0;I<A;I++)R[I]=~D.g[I];return new d(R,~D.h).add(x)}s.abs=function(){return M(this)?S(this):this},s.add=function(D){for(var A=Math.max(this.g.length,D.g.length),R=[],I=0,k=0;k<=A;k++){var P=I+(this.i(k)&65535)+(D.i(k)&65535),O=(P>>>16)+(this.i(k)>>>16)+(D.i(k)>>>16);I=O>>>16,P&=65535,O&=65535,R[k]=O<<16|P}return new d(R,R[R.length-1]&-2147483648?-1:0)};function U(D,A){return D.add(S(A))}s.j=function(D){if(N(this)||N(D))return T;if(M(this))return M(D)?S(this).j(S(D)):S(S(this).j(D));if(M(D))return S(this.j(S(D)));if(0>this.l(C)&&0>D.l(C))return v(this.m()*D.m());for(var A=this.g.length+D.g.length,R=[],I=0;I<2*A;I++)R[I]=0;for(I=0;I<this.g.length;I++)for(var k=0;k<D.g.length;k++){var P=this.i(I)>>>16,O=this.i(I)&65535,Ve=D.i(k)>>>16,ae=D.i(k)&65535;R[2*I+2*k]+=O*ae,$(R,2*I+2*k),R[2*I+2*k+1]+=P*ae,$(R,2*I+2*k+1),R[2*I+2*k+1]+=O*Ve,$(R,2*I+2*k+1),R[2*I+2*k+2]+=P*Ve,$(R,2*I+2*k+2)}for(I=0;I<A;I++)R[I]=R[2*I+1]<<16|R[2*I];for(I=A;I<2*A;I++)R[I]=0;return new d(R,0)};function $(D,A){for(;(D[A]&65535)!=D[A];)D[A+1]+=D[A]>>>16,D[A]&=65535,A++}function F(D,A){this.g=D,this.h=A}function V(D,A){if(N(A))throw Error("division by zero");if(N(D))return new F(T,T);if(M(D))return A=V(S(D),A),new F(S(A.g),S(A.h));if(M(A))return A=V(D,S(A)),new F(S(A.g),A.h);if(30<D.g.length){if(M(D)||M(A))throw Error("slowDivide_ only works with positive integers.");for(var R=x,I=A;0>=I.l(D);)R=B(R),I=B(I);var k=ee(R,1),P=ee(I,1);for(I=ee(I,2),R=ee(R,2);!N(I);){var O=P.add(I);0>=O.l(D)&&(k=k.add(R),P=O),I=ee(I,1),R=ee(R,1)}return A=U(D,k.j(A)),new F(k,A)}for(k=T;0<=D.l(A);){for(R=Math.max(1,Math.floor(D.m()/A.m())),I=Math.ceil(Math.log(R)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),P=v(R),O=P.j(A);M(O)||0<O.l(D);)R-=I,P=v(R),O=P.j(A);N(P)&&(P=x),k=k.add(P),D=U(D,O)}return new F(k,D)}s.A=function(D){return V(this,D).h},s.and=function(D){for(var A=Math.max(this.g.length,D.g.length),R=[],I=0;I<A;I++)R[I]=this.i(I)&D.i(I);return new d(R,this.h&D.h)},s.or=function(D){for(var A=Math.max(this.g.length,D.g.length),R=[],I=0;I<A;I++)R[I]=this.i(I)|D.i(I);return new d(R,this.h|D.h)},s.xor=function(D){for(var A=Math.max(this.g.length,D.g.length),R=[],I=0;I<A;I++)R[I]=this.i(I)^D.i(I);return new d(R,this.h^D.h)};function B(D){for(var A=D.g.length+1,R=[],I=0;I<A;I++)R[I]=D.i(I)<<1|D.i(I-1)>>>31;return new d(R,D.h)}function ee(D,A){var R=A>>5;A%=32;for(var I=D.g.length-R,k=[],P=0;P<I;P++)k[P]=0<A?D.i(P+R)>>>A|D.i(P+R+1)<<32-A:D.i(P+R);return new d(k,D.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,cx=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=v,d.fromString=_,vi=d}).apply(typeof Db<"u"?Db:typeof self<"u"?self:typeof window<"u"?window:{});var Fd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ux,bc,dx,Zd,Hp,hx,fx,mx;(function(){var s,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,y,E){return h==Array.prototype||h==Object.prototype||(h[y]=E.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Fd=="object"&&Fd];for(var y=0;y<h.length;++y){var E=h[y];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var i=t(this);function o(h,y){if(y)e:{var E=i;h=h.split(".");for(var j=0;j<h.length-1;j++){var K=h[j];if(!(K in E))break e;E=E[K]}h=h[h.length-1],j=E[h],y=y(j),y!=j&&y!=null&&e(E,h,{configurable:!0,writable:!0,value:y})}}function c(h,y){h instanceof String&&(h+="");var E=0,j=!1,K={next:function(){if(!j&&E<h.length){var J=E++;return{value:y(J,h[J]),done:!1}}return j=!0,{done:!0,value:void 0}}};return K[Symbol.iterator]=function(){return K},K}o("Array.prototype.values",function(h){return h||function(){return c(this,function(y,E){return E})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},m=this||self;function p(h){var y=typeof h;return y=y!="object"?y:h?Array.isArray(h)?"array":y:"null",y=="array"||y=="object"&&typeof h.length=="number"}function v(h){var y=typeof h;return y=="object"&&h!=null||y=="function"}function _(h,y,E){return h.call.apply(h.bind,arguments)}function T(h,y,E){if(!h)throw Error();if(2<arguments.length){var j=Array.prototype.slice.call(arguments,2);return function(){var K=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(K,j),h.apply(y,K)}}return function(){return h.apply(y,arguments)}}function x(h,y,E){return x=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_:T,x.apply(null,arguments)}function C(h,y){var E=Array.prototype.slice.call(arguments,1);return function(){var j=E.slice();return j.push.apply(j,arguments),h.apply(this,j)}}function N(h,y){function E(){}E.prototype=y.prototype,h.aa=y.prototype,h.prototype=new E,h.prototype.constructor=h,h.Qb=function(j,K,J){for(var de=Array(arguments.length-2),ze=2;ze<arguments.length;ze++)de[ze-2]=arguments[ze];return y.prototype[K].apply(j,de)}}function M(h){const y=h.length;if(0<y){const E=Array(y);for(let j=0;j<y;j++)E[j]=h[j];return E}return[]}function S(h,y){for(let E=1;E<arguments.length;E++){const j=arguments[E];if(p(j)){const K=h.length||0,J=j.length||0;h.length=K+J;for(let de=0;de<J;de++)h[K+de]=j[de]}else h.push(j)}}class U{constructor(y,E){this.i=y,this.j=E,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function $(h){return/^[\s\xa0]*$/.test(h)}function F(){var h=m.navigator;return h&&(h=h.userAgent)?h:""}function V(h){return V[" "](h),h}V[" "]=function(){};var B=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function ee(h,y,E){for(const j in h)y.call(E,h[j],j,h)}function D(h,y){for(const E in h)y.call(void 0,h[E],E,h)}function A(h){const y={};for(const E in h)y[E]=h[E];return y}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(h,y){let E,j;for(let K=1;K<arguments.length;K++){j=arguments[K];for(E in j)h[E]=j[E];for(let J=0;J<R.length;J++)E=R[J],Object.prototype.hasOwnProperty.call(j,E)&&(h[E]=j[E])}}function k(h){var y=1;h=h.split(":");const E=[];for(;0<y&&h.length;)E.push(h.shift()),y--;return h.length&&E.push(h.join(":")),E}function P(h){m.setTimeout(()=>{throw h},0)}function O(){var h=ge;let y=null;return h.g&&(y=h.g,h.g=h.g.next,h.g||(h.h=null),y.next=null),y}class Ve{constructor(){this.h=this.g=null}add(y,E){const j=ae.get();j.set(y,E),this.h?this.h.next=j:this.g=j,this.h=j}}var ae=new U(()=>new H,h=>h.reset());class H{constructor(){this.next=this.g=this.h=null}set(y,E){this.h=y,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let te,ce=!1,ge=new Ve,q=()=>{const h=m.Promise.resolve(void 0);te=()=>{h.then(ne)}};var ne=()=>{for(var h;h=O();){try{h.h.call(h.g)}catch(E){P(E)}var y=ae;y.j(h),100>y.h&&(y.h++,h.next=y.g,y.g=h)}ce=!1};function he(){this.s=this.s,this.C=this.C}he.prototype.s=!1,he.prototype.ma=function(){this.s||(this.s=!0,this.N())},he.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ue(h,y){this.type=h,this.g=this.target=y,this.defaultPrevented=!1}ue.prototype.h=function(){this.defaultPrevented=!0};var be=function(){if(!m.addEventListener||!Object.defineProperty)return!1;var h=!1,y=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const E=()=>{};m.addEventListener("test",E,y),m.removeEventListener("test",E,y)}catch{}return h}();function Pe(h,y){if(ue.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var E=this.type=h.type,j=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=y,y=h.relatedTarget){if(B){e:{try{V(y.nodeName);var K=!0;break e}catch{}K=!1}K||(y=null)}}else E=="mouseover"?y=h.fromElement:E=="mouseout"&&(y=h.toElement);this.relatedTarget=y,j?(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:Ce[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&Pe.aa.h.call(this)}}N(Pe,ue);var Ce={2:"touch",3:"pen",4:"mouse"};Pe.prototype.h=function(){Pe.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var qt="closure_listenable_"+(1e6*Math.random()|0),ot=0;function bs(h,y,E,j,K){this.listener=h,this.proxy=null,this.src=y,this.type=E,this.capture=!!j,this.ha=K,this.key=++ot,this.da=this.fa=!1}function Oa(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Xs(h){this.src=h,this.g={},this.h=0}Xs.prototype.add=function(h,y,E,j,K){var J=h.toString();h=this.g[J],h||(h=this.g[J]=[],this.h++);var de=Vi(h,y,j,K);return-1<de?(y=h[de],E||(y.fa=!1)):(y=new bs(y,this.src,J,!!j,K),y.fa=E,h.push(y)),y};function ki(h,y){var E=y.type;if(E in h.g){var j=h.g[E],K=Array.prototype.indexOf.call(j,y,void 0),J;(J=0<=K)&&Array.prototype.splice.call(j,K,1),J&&(Oa(y),h.g[E].length==0&&(delete h.g[E],h.h--))}}function Vi(h,y,E,j){for(var K=0;K<h.length;++K){var J=h[K];if(!J.da&&J.listener==y&&J.capture==!!E&&J.ha==j)return K}return-1}var Li="closure_lm_"+(1e6*Math.random()|0),cl={};function pu(h,y,E,j,K){if(Array.isArray(y)){for(var J=0;J<y.length;J++)pu(h,y[J],E,j,K);return null}return E=gu(E),h&&h[qt]?h.K(y,E,v(j)?!!j.capture:!1,K):$n(h,y,E,!1,j,K)}function $n(h,y,E,j,K,J){if(!y)throw Error("Invalid event type");var de=v(K)?!!K.capture:!!K,ze=Ur(h);if(ze||(h[Li]=ze=new Xs(h)),E=ze.add(y,E,j,de,J),E.proxy)return E;if(j=lf(),E.proxy=j,j.src=h,j.listener=E,h.addEventListener)be||(K=de),K===void 0&&(K=!1),h.addEventListener(y.toString(),j,K);else if(h.attachEvent)h.attachEvent(Ui(y.toString()),j);else if(h.addListener&&h.removeListener)h.addListener(j);else throw Error("addEventListener and attachEvent are unavailable.");return E}function lf(){function h(E){return y.call(h.src,h.listener,E)}const y=cf;return h}function ul(h,y,E,j,K){if(Array.isArray(y))for(var J=0;J<y.length;J++)ul(h,y[J],E,j,K);else j=v(j)?!!j.capture:!!j,E=gu(E),h&&h[qt]?(h=h.i,y=String(y).toString(),y in h.g&&(J=h.g[y],E=Vi(J,E,j,K),-1<E&&(Oa(J[E]),Array.prototype.splice.call(J,E,1),J.length==0&&(delete h.g[y],h.h--)))):h&&(h=Ur(h))&&(y=h.g[y.toString()],h=-1,y&&(h=Vi(y,E,j,K)),(E=-1<h?y[h]:null)&&Lr(E))}function Lr(h){if(typeof h!="number"&&h&&!h.da){var y=h.src;if(y&&y[qt])ki(y.i,h);else{var E=h.type,j=h.proxy;y.removeEventListener?y.removeEventListener(E,j,h.capture):y.detachEvent?y.detachEvent(Ui(E),j):y.addListener&&y.removeListener&&y.removeListener(j),(E=Ur(y))?(ki(E,h),E.h==0&&(E.src=null,y[Li]=null)):Oa(h)}}}function Ui(h){return h in cl?cl[h]:cl[h]="on"+h}function cf(h,y){if(h.da)h=!0;else{y=new Pe(y,this);var E=h.listener,j=h.ha||h.src;h.fa&&Lr(h),h=E.call(j,y)}return h}function Ur(h){return h=h[Li],h instanceof Xs?h:null}var dl="__closure_events_fn_"+(1e9*Math.random()>>>0);function gu(h){return typeof h=="function"?h:(h[dl]||(h[dl]=function(y){return h.handleEvent(y)}),h[dl])}function yt(){he.call(this),this.i=new Xs(this),this.M=this,this.F=null}N(yt,he),yt.prototype[qt]=!0,yt.prototype.removeEventListener=function(h,y,E,j){ul(this,h,y,E,j)};function Ze(h,y){var E,j=h.F;if(j)for(E=[];j;j=j.F)E.push(j);if(h=h.M,j=y.type||y,typeof y=="string")y=new ue(y,h);else if(y instanceof ue)y.target=y.target||h;else{var K=y;y=new ue(j,h),I(y,K)}if(K=!0,E)for(var J=E.length-1;0<=J;J--){var de=y.g=E[J];K=Dn(de,j,!0,y)&&K}if(de=y.g=h,K=Dn(de,j,!0,y)&&K,K=Dn(de,j,!1,y)&&K,E)for(J=0;J<E.length;J++)de=y.g=E[J],K=Dn(de,j,!1,y)&&K}yt.prototype.N=function(){if(yt.aa.N.call(this),this.i){var h=this.i,y;for(y in h.g){for(var E=h.g[y],j=0;j<E.length;j++)Oa(E[j]);delete h.g[y],h.h--}}this.F=null},yt.prototype.K=function(h,y,E,j){return this.i.add(String(h),y,!1,E,j)},yt.prototype.L=function(h,y,E,j){return this.i.add(String(h),y,!0,E,j)};function Dn(h,y,E,j){if(y=h.i.g[String(y)],!y)return!0;y=y.concat();for(var K=!0,J=0;J<y.length;++J){var de=y[J];if(de&&!de.da&&de.capture==E){var ze=de.listener,Ot=de.ha||de.src;de.fa&&ki(h.i,de),K=ze.call(Ot,j)!==!1&&K}}return K&&!j.defaultPrevented}function ln(h,y,E){if(typeof h=="function")E&&(h=x(h,E));else if(h&&typeof h.handleEvent=="function")h=x(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:m.setTimeout(h,y||0)}function vu(h){h.g=ln(()=>{h.g=null,h.i&&(h.i=!1,vu(h))},h.l);const y=h.h;h.h=null,h.m.apply(null,y)}class uf extends he{constructor(y,E){super(),this.m=y,this.l=E,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:vu(this)}N(){super.N(),this.g&&(m.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Fi(h){he.call(this),this.h=h,this.g={}}N(Fi,he);var qi=[];function Bi(h){ee(h.g,function(y,E){this.g.hasOwnProperty(E)&&Lr(y)},h),h.g={}}Fi.prototype.N=function(){Fi.aa.N.call(this),Bi(this)},Fi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ls=m.JSON.stringify,Fr=m.JSON.parse,zi=class{stringify(h){return m.JSON.stringify(h,void 0)}parse(h){return m.JSON.parse(h,void 0)}};function hl(){}hl.prototype.h=null;function fl(h){return h.h||(h.h=h.i())}function ml(){}var Ws={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Zs(){ue.call(this,"d")}N(Zs,ue);function pl(){ue.call(this,"c")}N(pl,ue);var Ts={},gl=null;function Ma(){return gl=gl||new yt}Ts.La="serverreachability";function qr(h){ue.call(this,Ts.La,h)}N(qr,ue);function Pa(h){const y=Ma();Ze(y,new qr(y))}Ts.STAT_EVENT="statevent";function yu(h,y){ue.call(this,Ts.STAT_EVENT,h),this.stat=y}N(yu,ue);function dt(h){const y=Ma();Ze(y,new yu(y,h))}Ts.Ma="timingevent";function Dt(h,y){ue.call(this,Ts.Ma,h),this.size=y}N(Dt,ue);function St(h,y){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return m.setTimeout(function(){h()},y)}function Kn(){this.g=!0}Kn.prototype.xa=function(){this.g=!1};function vl(h,y,E,j,K,J){h.info(function(){if(h.g)if(J)for(var de="",ze=J.split("&"),Ot=0;Ot<ze.length;Ot++){var He=ze[Ot].split("=");if(1<He.length){var zt=He[0];He=He[1];var Mt=zt.split("_");de=2<=Mt.length&&Mt[1]=="type"?de+(zt+"="+He+"&"):de+(zt+"=redacted&")}}else de=null;else de=J;return"XMLHTTP REQ ("+j+") [attempt "+K+"]: "+y+`
`+E+`
`+de})}function df(h,y,E,j,K,J,de){h.info(function(){return"XMLHTTP RESP ("+j+") [ attempt "+K+"]: "+y+`
`+E+`
`+J+" "+de})}function ka(h,y,E,j){h.info(function(){return"XMLHTTP TEXT ("+y+"): "+Hi(h,E)+(j?" "+j:"")})}function _u(h,y){h.info(function(){return"TIMEOUT: "+y})}Kn.prototype.info=function(){};function Hi(h,y){if(!h.g)return y;if(!y)return null;try{var E=JSON.parse(y);if(E){for(h=0;h<E.length;h++)if(Array.isArray(E[h])){var j=E[h];if(!(2>j.length)){var K=j[1];if(Array.isArray(K)&&!(1>K.length)){var J=K[0];if(J!="noop"&&J!="stop"&&J!="close")for(var de=1;de<K.length;de++)K[de]=""}}}}return ls(E)}catch{return y}}var Va={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Js={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ns;function xs(){}N(xs,hl),xs.prototype.g=function(){return new XMLHttpRequest},xs.prototype.i=function(){return{}},Ns=new xs;function gn(h,y,E,j){this.j=h,this.i=y,this.l=E,this.R=j||1,this.U=new Fi(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Tt}function Tt(){this.i=null,this.g="",this.h=!1}var yl={},Br={};function cs(h,y,E){h.L=1,h.v=Qi(On(y)),h.m=E,h.P=!0,ea(h,null)}function ea(h,y){h.F=Date.now(),Gi(h),h.A=On(h.v);var E=h.A,j=h.R;Array.isArray(j)||(j=[String(j)]),xl(E.i,"t",j),h.C=0,E=h.j.J,h.h=new Tt,h.g=Pu(h.j,E?y:null,!h.m),0<h.O&&(h.M=new uf(x(h.Y,h,h.g),h.O)),y=h.U,E=h.g,j=h.ca;var K="readystatechange";Array.isArray(K)||(K&&(qi[0]=K.toString()),K=qi);for(var J=0;J<K.length;J++){var de=pu(E,K[J],j||y.handleEvent,!1,y.h||y);if(!de)break;y.g[de.key]=de}y=h.H?A(h.H):{},h.m?(h.u||(h.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,y)):(h.u="GET",h.g.ea(h.A,h.u,null,y)),Pa(),vl(h.i,h.u,h.A,h.l,h.R,h.m)}gn.prototype.ca=function(h){h=h.target;const y=this.M;y&&Wn(h)==3?y.j():this.Y(h)},gn.prototype.Y=function(h){try{if(h==this.g)e:{const Mt=Wn(this.g);var y=this.g.Ba();const la=this.g.Z();if(!(3>Mt)&&(Mt!=3||this.g&&(this.h.h||this.g.oa()||wu(this.g)))){this.J||Mt!=4||y==7||(y==8||0>=la?Pa(3):Pa(2)),La(this);var E=this.g.Z();this.X=E;t:if(Eu(this)){var j=wu(this.g);h="";var K=j.length,J=Wn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Qt(this),As(this);var de="";break t}this.h.i=new m.TextDecoder}for(y=0;y<K;y++)this.h.h=!0,h+=this.h.i.decode(j[y],{stream:!(J&&y==K-1)});j.length=0,this.h.g+=h,this.C=0,de=this.h.g}else de=this.g.oa();if(this.o=E==200,df(this.i,this.u,this.A,this.l,this.R,Mt,E),this.o){if(this.T&&!this.K){t:{if(this.g){var ze,Ot=this.g;if((ze=Ot.g?Ot.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$(ze)){var He=ze;break t}}He=null}if(E=He)ka(this.i,this.l,E,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,$i(this,E);else{this.o=!1,this.s=3,dt(12),Qt(this),As(this);break e}}if(this.P){E=!0;let Xt;for(;!this.J&&this.C<de.length;)if(Xt=bu(this,de),Xt==Br){Mt==4&&(this.s=4,dt(14),E=!1),ka(this.i,this.l,null,"[Incomplete Response]");break}else if(Xt==yl){this.s=4,dt(15),ka(this.i,this.l,de,"[Invalid Chunk]"),E=!1;break}else ka(this.i,this.l,Xt,null),$i(this,Xt);if(Eu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Mt!=4||de.length!=0||this.h.h||(this.s=1,dt(16),E=!1),this.o=this.o&&E,!E)ka(this.i,this.l,de,"[Invalid Chunked Response]"),Qt(this),As(this);else if(0<de.length&&!this.W){this.W=!0;var zt=this.j;zt.g==this&&zt.ba&&!zt.M&&(zt.j.info("Great, no buffering proxy detected. Bytes received: "+de.length),sr(zt),zt.M=!0,dt(11))}}else ka(this.i,this.l,de,null),$i(this,de);Mt==4&&Qt(this),this.o&&!this.J&&(Mt==4?Du(this.j,this):(this.o=!1,Gi(this)))}else gf(this.g),E==400&&0<de.indexOf("Unknown SID")?(this.s=3,dt(12)):(this.s=0,dt(13)),Qt(this),As(this)}}}catch{}finally{}};function Eu(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function bu(h,y){var E=h.C,j=y.indexOf(`
`,E);return j==-1?Br:(E=Number(y.substring(E,j)),isNaN(E)?yl:(j+=1,j+E>y.length?Br:(y=y.slice(j,j+E),h.C=j+E,y)))}gn.prototype.cancel=function(){this.J=!0,Qt(this)};function Gi(h){h.S=Date.now()+h.I,Tu(h,h.I)}function Tu(h,y){if(h.B!=null)throw Error("WatchDog timer not null");h.B=St(x(h.ba,h),y)}function La(h){h.B&&(m.clearTimeout(h.B),h.B=null)}gn.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(_u(this.i,this.A),this.L!=2&&(Pa(),dt(17)),Qt(this),this.s=2,As(this)):Tu(this,this.S-h)};function As(h){h.j.G==0||h.J||Du(h.j,h)}function Qt(h){La(h);var y=h.M;y&&typeof y.ma=="function"&&y.ma(),h.M=null,Bi(h.U),h.g&&(y=h.g,h.g=null,y.abort(),y.ma())}function $i(h,y){try{var E=h.j;if(E.G!=0&&(E.g==h||_l(E.h,h))){if(!h.K&&_l(E.h,h)&&E.G==3){try{var j=E.Da.g.parse(y)}catch{j=null}if(Array.isArray(j)&&j.length==3){var K=j;if(K[0]==0){e:if(!E.u){if(E.g)if(E.g.F+3e3<h.F)eo(E),Zr(E);else break e;jl(E),dt(18)}}else E.za=K[1],0<E.za-E.T&&37500>K[2]&&E.F&&E.v==0&&!E.C&&(E.C=St(x(E.Za,E),6e3));if(1>=Hr(E.h)&&E.ca){try{E.ca()}catch{}E.ca=void 0}}else oa(E,11)}else if((h.K||E.g==h)&&eo(E),!$(y))for(K=E.Da.g.parse(y),y=0;y<K.length;y++){let He=K[y];if(E.T=He[0],He=He[1],E.G==2)if(He[0]=="c"){E.K=He[1],E.ia=He[2];const zt=He[3];zt!=null&&(E.la=zt,E.j.info("VER="+E.la));const Mt=He[4];Mt!=null&&(E.Aa=Mt,E.j.info("SVER="+E.Aa));const la=He[5];la!=null&&typeof la=="number"&&0<la&&(j=1.5*la,E.L=j,E.j.info("backChannelRequestTimeoutMs_="+j)),j=E;const Xt=h.g;if(Xt){const Ds=Xt.g?Xt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ds){var J=j.h;J.g||Ds.indexOf("spdy")==-1&&Ds.indexOf("quic")==-1&&Ds.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(Gr(J,J.h),J.h=null))}if(j.D){const Rl=Xt.g?Xt.g.getResponseHeader("X-HTTP-Session-Id"):null;Rl&&(j.ya=Rl,tt(j.I,j.D,Rl))}}E.G=3,E.l&&E.l.ua(),E.ba&&(E.R=Date.now()-h.F,E.j.info("Handshake RTT: "+E.R+"ms")),j=E;var de=h;if(j.qa=Mu(j,j.J?j.ia:null,j.W),de.K){vn(j.h,de);var ze=de,Ot=j.L;Ot&&(ze.I=Ot),ze.B&&(La(ze),Gi(ze)),j.g=de}else Iu(j);0<E.i.length&&Jr(E)}else He[0]!="stop"&&He[0]!="close"||oa(E,7);else E.G==3&&(He[0]=="stop"||He[0]=="close"?He[0]=="stop"?oa(E,7):wl(E):He[0]!="noop"&&E.l&&E.l.ta(He),E.v=0)}}Pa(4)}catch{}}var Nu=class{constructor(h,y){this.g=h,this.map=y}};function ta(h){this.l=h||10,m.PerformanceNavigationTiming?(h=m.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(m.chrome&&m.chrome.loadTimes&&m.chrome.loadTimes()&&m.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function zr(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Hr(h){return h.h?1:h.g?h.g.size:0}function _l(h,y){return h.h?h.h==y:h.g?h.g.has(y):!1}function Gr(h,y){h.g?h.g.add(y):h.h=y}function vn(h,y){h.h&&h.h==y?h.h=null:h.g&&h.g.has(y)&&h.g.delete(y)}ta.prototype.cancel=function(){if(this.i=El(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function El(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let y=h.i;for(const E of h.g.values())y=y.concat(E.D);return y}return M(h.i)}function hf(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(p(h)){for(var y=[],E=h.length,j=0;j<E;j++)y.push(h[j]);return y}y=[],E=0;for(j in h)y[E++]=h[j];return y}function $r(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(p(h)||typeof h=="string"){var y=[];h=h.length;for(var E=0;E<h;E++)y.push(E);return y}y=[],E=0;for(const j in h)y[E++]=j;return y}}}function bl(h,y){if(h.forEach&&typeof h.forEach=="function")h.forEach(y,void 0);else if(p(h)||typeof h=="string")Array.prototype.forEach.call(h,y,void 0);else for(var E=$r(h),j=hf(h),K=j.length,J=0;J<K;J++)y.call(void 0,j[J],E&&E[J],h)}var Ki=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ff(h,y){if(h){h=h.split("&");for(var E=0;E<h.length;E++){var j=h[E].indexOf("="),K=null;if(0<=j){var J=h[E].substring(0,j);K=h[E].substring(j+1)}else J=h[E];y(J,K?decodeURIComponent(K.replace(/\+/g," ")):"")}}}function wt(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof wt){this.h=h.h,Yi(this,h.j),this.o=h.o,this.g=h.g,Ua(this,h.s),this.l=h.l;var y=h.i,E=new sa;E.i=y.i,y.g&&(E.g=new Map(y.g),E.h=y.h),na(this,E),this.m=h.m}else h&&(y=String(h).match(Ki))?(this.h=!1,Yi(this,y[1]||"",!0),this.o=Yn(y[2]||""),this.g=Yn(y[3]||"",!0),Ua(this,y[4]),this.l=Yn(y[5]||"",!0),na(this,y[6]||"",!0),this.m=Yn(y[7]||"")):(this.h=!1,this.i=new sa(null,this.h))}wt.prototype.toString=function(){var h=[],y=this.j;y&&h.push(Xi(y,Tl,!0),":");var E=this.g;return(E||y=="file")&&(h.push("//"),(y=this.o)&&h.push(Xi(y,Tl,!0),"@"),h.push(encodeURIComponent(String(E)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.s,E!=null&&h.push(":",String(E))),(E=this.l)&&(this.g&&E.charAt(0)!="/"&&h.push("/"),h.push(Xi(E,E.charAt(0)=="/"?mf:Nl,!0))),(E=this.i.toString())&&h.push("?",E),(E=this.m)&&h.push("#",Xi(E,Kr)),h.join("")};function On(h){return new wt(h)}function Yi(h,y,E){h.j=E?Yn(y,!0):y,h.j&&(h.j=h.j.replace(/:$/,""))}function Ua(h,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);h.s=y}else h.s=null}function na(h,y,E){y instanceof sa?(h.i=y,Au(h.i,h.h)):(E||(y=Xi(y,pf)),h.i=new sa(y,h.h))}function tt(h,y,E){h.i.set(y,E)}function Qi(h){return tt(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Yn(h,y){return h?y?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Xi(h,y,E){return typeof h=="string"?(h=encodeURI(h).replace(y,xu),E&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function xu(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Tl=/[#\/\?@]/g,Nl=/[#\?:]/g,mf=/[#\?]/g,pf=/[#\?@]/g,Kr=/#/g;function sa(h,y){this.h=this.g=null,this.i=h||null,this.j=!!y}function Qn(h){h.g||(h.g=new Map,h.h=0,h.i&&ff(h.i,function(y,E){h.add(decodeURIComponent(y.replace(/\+/g," ")),E)}))}s=sa.prototype,s.add=function(h,y){Qn(this),this.i=null,h=Ss(this,h);var E=this.g.get(h);return E||this.g.set(h,E=[]),E.push(y),this.h+=1,this};function aa(h,y){Qn(h),y=Ss(h,y),h.g.has(y)&&(h.i=null,h.h-=h.g.get(y).length,h.g.delete(y))}function ia(h,y){return Qn(h),y=Ss(h,y),h.g.has(y)}s.forEach=function(h,y){Qn(this),this.g.forEach(function(E,j){E.forEach(function(K){h.call(y,K,j,this)},this)},this)},s.na=function(){Qn(this);const h=Array.from(this.g.values()),y=Array.from(this.g.keys()),E=[];for(let j=0;j<y.length;j++){const K=h[j];for(let J=0;J<K.length;J++)E.push(y[j])}return E},s.V=function(h){Qn(this);let y=[];if(typeof h=="string")ia(this,h)&&(y=y.concat(this.g.get(Ss(this,h))));else{h=Array.from(this.g.values());for(let E=0;E<h.length;E++)y=y.concat(h[E])}return y},s.set=function(h,y){return Qn(this),this.i=null,h=Ss(this,h),ia(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[y]),this.h+=1,this},s.get=function(h,y){return h?(h=this.V(h),0<h.length?String(h[0]):y):y};function xl(h,y,E){aa(h,y),0<E.length&&(h.i=null,h.g.set(Ss(h,y),M(E)),h.h+=E.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],y=Array.from(this.g.keys());for(var E=0;E<y.length;E++){var j=y[E];const J=encodeURIComponent(String(j)),de=this.V(j);for(j=0;j<de.length;j++){var K=J;de[j]!==""&&(K+="="+encodeURIComponent(String(de[j]))),h.push(K)}}return this.i=h.join("&")};function Ss(h,y){return y=String(y),h.j&&(y=y.toLowerCase()),y}function Au(h,y){y&&!h.j&&(Qn(h),h.i=null,h.g.forEach(function(E,j){var K=j.toLowerCase();j!=K&&(aa(this,j),xl(this,K,E))},h)),h.j=y}function Wi(h,y){const E=new Kn;if(m.Image){const j=new Image;j.onload=C(Xn,E,"TestLoadImage: loaded",!0,y,j),j.onerror=C(Xn,E,"TestLoadImage: error",!1,y,j),j.onabort=C(Xn,E,"TestLoadImage: abort",!1,y,j),j.ontimeout=C(Xn,E,"TestLoadImage: timeout",!1,y,j),m.setTimeout(function(){j.ontimeout&&j.ontimeout()},1e4),j.src=h}else y(!1)}function us(h,y){const E=new Kn,j=new AbortController,K=setTimeout(()=>{j.abort(),Xn(E,"TestPingServer: timeout",!1,y)},1e4);fetch(h,{signal:j.signal}).then(J=>{clearTimeout(K),J.ok?Xn(E,"TestPingServer: ok",!0,y):Xn(E,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(K),Xn(E,"TestPingServer: error",!1,y)})}function Xn(h,y,E,j,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),j(E)}catch{}}function Zi(){this.g=new zi}function ws(h,y,E){const j=E||"";try{bl(h,function(K,J){let de=K;v(K)&&(de=ls(K)),y.push(j+J+"="+encodeURIComponent(de))})}catch(K){throw y.push(j+"type="+encodeURIComponent("_badmap")),K}}function Fa(h){this.l=h.Ub||null,this.j=h.eb||!1}N(Fa,hl),Fa.prototype.g=function(){return new ra(this.l,this.j)},Fa.prototype.i=function(h){return function(){return h}}({});function ra(h,y){yt.call(this),this.D=h,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}N(ra,yt),s=ra.prototype,s.open=function(h,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=y,this.readyState=1,js(this)},s.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(y.body=h),(this.D||m).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Cs(this)),this.readyState=0},s.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,js(this)),this.g&&(this.readyState=3,js(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof m.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Al(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Al(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}s.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var y=h.value?h.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!h.done}))&&(this.response=this.responseText+=y)}h.done?Cs(this):js(this),this.readyState==3&&Al(this)}},s.Ra=function(h){this.g&&(this.response=this.responseText=h,Cs(this))},s.Qa=function(h){this.g&&(this.response=h,Cs(this))},s.ga=function(){this.g&&Cs(this)};function Cs(h){h.readyState=4,h.l=null,h.j=null,h.v=null,js(h)}s.setRequestHeader=function(h,y){this.u.append(h,y)},s.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],y=this.h.entries();for(var E=y.next();!E.done;)E=E.value,h.push(E[0]+": "+E[1]),E=y.next();return h.join(`\r
`)};function js(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(ra.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Sl(h){let y="";return ee(h,function(E,j){y+=j,y+=":",y+=E,y+=`\r
`}),y}function Bt(h,y,E){e:{for(j in E){var j=!1;break e}j=!0}j||(E=Sl(E),typeof h=="string"?E!=null&&encodeURIComponent(String(E)):tt(h,y,E))}function We(h){yt.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}N(We,yt);var Yr=/^https?$/i,Ji=["POST","PUT"];s=We.prototype,s.Ha=function(h){this.J=h},s.ea=function(h,y,E,j){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);y=y?y.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ns.g(),this.v=this.o?fl(this.o):fl(Ns),this.g.onreadystatechange=x(this.Ea,this);try{this.B=!0,this.g.open(y,String(h),!0),this.B=!1}catch(J){Su(this,J);return}if(h=E||"",E=new Map(this.headers),j)if(Object.getPrototypeOf(j)===Object.prototype)for(var K in j)E.set(K,j[K]);else if(typeof j.keys=="function"&&typeof j.get=="function")for(const J of j.keys())E.set(J,j.get(J));else throw Error("Unknown input type for opt_headers: "+String(j));j=Array.from(E.keys()).find(J=>J.toLowerCase()=="content-type"),K=m.FormData&&h instanceof m.FormData,!(0<=Array.prototype.indexOf.call(Ji,y,void 0))||j||K||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,de]of E)this.g.setRequestHeader(J,de);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{er(this),this.u=!0,this.g.send(h),this.u=!1}catch(J){Su(this,J)}};function Su(h,y){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=y,h.m=5,Qr(h),Is(h)}function Qr(h){h.A||(h.A=!0,Ze(h,"complete"),Ze(h,"error"))}s.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,Ze(this,"complete"),Ze(this,"abort"),Is(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Is(this,!0)),We.aa.N.call(this)},s.Ea=function(){this.s||(this.B||this.u||this.j?Xr(this):this.bb())},s.bb=function(){Xr(this)};function Xr(h){if(h.h&&typeof d<"u"&&(!h.v[1]||Wn(h)!=4||h.Z()!=2)){if(h.u&&Wn(h)==4)ln(h.Ea,0,h);else if(Ze(h,"readystatechange"),Wn(h)==4){h.h=!1;try{const de=h.Z();e:switch(de){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var E;if(!(E=y)){var j;if(j=de===0){var K=String(h.D).match(Ki)[1]||null;!K&&m.self&&m.self.location&&(K=m.self.location.protocol.slice(0,-1)),j=!Yr.test(K?K.toLowerCase():"")}E=j}if(E)Ze(h,"complete"),Ze(h,"success");else{h.m=6;try{var J=2<Wn(h)?h.g.statusText:""}catch{J=""}h.l=J+" ["+h.Z()+"]",Qr(h)}}finally{Is(h)}}}}function Is(h,y){if(h.g){er(h);const E=h.g,j=h.v[0]?()=>{}:null;h.g=null,h.v=null,y||Ze(h,"ready");try{E.onreadystatechange=j}catch{}}}function er(h){h.I&&(m.clearTimeout(h.I),h.I=null)}s.isActive=function(){return!!this.g};function Wn(h){return h.g?h.g.readyState:0}s.Z=function(){try{return 2<Wn(this)?this.g.status:-1}catch{return-1}},s.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.Oa=function(h){if(this.g){var y=this.g.responseText;return h&&y.indexOf(h)==0&&(y=y.substring(h.length)),Fr(y)}};function wu(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function gf(h){const y={};h=(h.g&&2<=Wn(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let j=0;j<h.length;j++){if($(h[j]))continue;var E=k(h[j]);const K=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const J=y[K]||[];y[K]=J,J.push(E)}D(y,function(j){return j.join(", ")})}s.Ba=function(){return this.m},s.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function tr(h,y,E){return E&&E.internalChannelParams&&E.internalChannelParams[h]||y}function Wr(h){this.Aa=0,this.i=[],this.j=new Kn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=tr("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=tr("baseRetryDelayMs",5e3,h),this.cb=tr("retryDelaySeedMs",1e4,h),this.Wa=tr("forwardChannelMaxRetries",2,h),this.wa=tr("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new ta(h&&h.concurrentRequestLimit),this.Da=new Zi,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}s=Wr.prototype,s.la=8,s.G=1,s.connect=function(h,y,E,j){dt(0),this.W=h,this.H=y||{},E&&j!==void 0&&(this.H.OSID=E,this.H.OAID=j),this.F=this.X,this.I=Mu(this,null,this.W),Jr(this)};function wl(h){if(Cu(h),h.G==3){var y=h.U++,E=On(h.I);if(tt(E,"SID",h.K),tt(E,"RID",y),tt(E,"TYPE","terminate"),nr(h,E),y=new gn(h,h.j,y),y.L=2,y.v=Qi(On(E)),E=!1,m.navigator&&m.navigator.sendBeacon)try{E=m.navigator.sendBeacon(y.v.toString(),"")}catch{}!E&&m.Image&&(new Image().src=y.v,E=!0),E||(y.g=Pu(y.j,null),y.g.ea(y.v)),y.F=Date.now(),Gi(y)}Ou(h)}function Zr(h){h.g&&(sr(h),h.g.cancel(),h.g=null)}function Cu(h){Zr(h),h.u&&(m.clearTimeout(h.u),h.u=null),eo(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&m.clearTimeout(h.s),h.s=null)}function Jr(h){if(!zr(h.h)&&!h.s){h.s=!0;var y=h.Ga;te||q(),ce||(te(),ce=!0),ge.add(y,h),h.B=0}}function vf(h,y){return Hr(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=y.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=St(x(h.Ga,h,y),Il(h,h.B)),h.B++,!0)}s.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const K=new gn(this,this.j,h);let J=this.o;if(this.S&&(J?(J=A(J),I(J,this.S)):J=this.S),this.m!==null||this.O||(K.H=J,J=null),this.P)e:{for(var y=0,E=0;E<this.i.length;E++){t:{var j=this.i[E];if("__data__"in j.map&&(j=j.map.__data__,typeof j=="string")){j=j.length;break t}j=void 0}if(j===void 0)break;if(y+=j,4096<y){y=E;break e}if(y===4096||E===this.i.length-1){y=E+1;break e}}y=1e3}else y=1e3;y=ju(this,K,y),E=On(this.I),tt(E,"RID",h),tt(E,"CVER",22),this.D&&tt(E,"X-HTTP-Session-Id",this.D),nr(this,E),J&&(this.O?y="headers="+encodeURIComponent(String(Sl(J)))+"&"+y:this.m&&Bt(E,this.m,J)),Gr(this.h,K),this.Ua&&tt(E,"TYPE","init"),this.P?(tt(E,"$req",y),tt(E,"SID","null"),K.T=!0,cs(K,E,null)):cs(K,E,y),this.G=2}}else this.G==3&&(h?Cl(this,h):this.i.length==0||zr(this.h)||Cl(this))};function Cl(h,y){var E;y?E=y.l:E=h.U++;const j=On(h.I);tt(j,"SID",h.K),tt(j,"RID",E),tt(j,"AID",h.T),nr(h,j),h.m&&h.o&&Bt(j,h.m,h.o),E=new gn(h,h.j,E,h.B+1),h.m===null&&(E.H=h.o),y&&(h.i=y.D.concat(h.i)),y=ju(h,E,1e3),E.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Gr(h.h,E),cs(E,j,y)}function nr(h,y){h.H&&ee(h.H,function(E,j){tt(y,j,E)}),h.l&&bl({},function(E,j){tt(y,j,E)})}function ju(h,y,E){E=Math.min(h.i.length,E);var j=h.l?x(h.l.Na,h.l,h):null;e:{var K=h.i;let J=-1;for(;;){const de=["count="+E];J==-1?0<E?(J=K[0].g,de.push("ofs="+J)):J=0:de.push("ofs="+J);let ze=!0;for(let Ot=0;Ot<E;Ot++){let He=K[Ot].g;const zt=K[Ot].map;if(He-=J,0>He)J=Math.max(0,K[Ot].g-100),ze=!1;else try{ws(zt,de,"req"+He+"_")}catch{j&&j(zt)}}if(ze){j=de.join("&");break e}}}return h=h.i.splice(0,E),y.D=h,j}function Iu(h){if(!h.g&&!h.u){h.Y=1;var y=h.Fa;te||q(),ce||(te(),ce=!0),ge.add(y,h),h.v=0}}function jl(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=St(x(h.Fa,h),Il(h,h.v)),h.v++,!0)}s.Fa=function(){if(this.u=null,Ru(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=St(x(this.ab,this),h)}},s.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,dt(10),Zr(this),Ru(this))};function sr(h){h.A!=null&&(m.clearTimeout(h.A),h.A=null)}function Ru(h){h.g=new gn(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var y=On(h.qa);tt(y,"RID","rpc"),tt(y,"SID",h.K),tt(y,"AID",h.T),tt(y,"CI",h.F?"0":"1"),!h.F&&h.ja&&tt(y,"TO",h.ja),tt(y,"TYPE","xmlhttp"),nr(h,y),h.m&&h.o&&Bt(y,h.m,h.o),h.L&&(h.g.I=h.L);var E=h.g;h=h.ia,E.L=1,E.v=Qi(On(y)),E.m=null,E.P=!0,ea(E,h)}s.Za=function(){this.C!=null&&(this.C=null,Zr(this),jl(this),dt(19))};function eo(h){h.C!=null&&(m.clearTimeout(h.C),h.C=null)}function Du(h,y){var E=null;if(h.g==y){eo(h),sr(h),h.g=null;var j=2}else if(_l(h.h,y))E=y.D,vn(h.h,y),j=1;else return;if(h.G!=0){if(y.o)if(j==1){E=y.m?y.m.length:0,y=Date.now()-y.F;var K=h.B;j=Ma(),Ze(j,new Dt(j,E)),Jr(h)}else Iu(h);else if(K=y.s,K==3||K==0&&0<y.X||!(j==1&&vf(h,y)||j==2&&jl(h)))switch(E&&0<E.length&&(y=h.h,y.i=y.i.concat(E)),K){case 1:oa(h,5);break;case 4:oa(h,10);break;case 3:oa(h,6);break;default:oa(h,2)}}}function Il(h,y){let E=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(E*=2),E*y}function oa(h,y){if(h.j.info("Error code "+y),y==2){var E=x(h.fb,h),j=h.Xa;const K=!j;j=new wt(j||"//www.google.com/images/cleardot.gif"),m.location&&m.location.protocol=="http"||Yi(j,"https"),Qi(j),K?Wi(j.toString(),E):us(j.toString(),E)}else dt(2);h.G=0,h.l&&h.l.sa(y),Ou(h),Cu(h)}s.fb=function(h){h?(this.j.info("Successfully pinged google.com"),dt(2)):(this.j.info("Failed to ping google.com"),dt(1))};function Ou(h){if(h.G=0,h.ka=[],h.l){const y=El(h.h);(y.length!=0||h.i.length!=0)&&(S(h.ka,y),S(h.ka,h.i),h.h.i.length=0,M(h.i),h.i.length=0),h.l.ra()}}function Mu(h,y,E){var j=E instanceof wt?On(E):new wt(E);if(j.g!="")y&&(j.g=y+"."+j.g),Ua(j,j.s);else{var K=m.location;j=K.protocol,y=y?y+"."+K.hostname:K.hostname,K=+K.port;var J=new wt(null);j&&Yi(J,j),y&&(J.g=y),K&&Ua(J,K),E&&(J.l=E),j=J}return E=h.D,y=h.ya,E&&y&&tt(j,E,y),tt(j,"VER",h.la),nr(h,j),j}function Pu(h,y,E){if(y&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=h.Ca&&!h.pa?new We(new Fa({eb:E})):new We(h.pa),y.Ha(h.J),y}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function ku(){}s=ku.prototype,s.ua=function(){},s.ta=function(){},s.sa=function(){},s.ra=function(){},s.isActive=function(){return!0},s.Na=function(){};function to(){}to.prototype.g=function(h,y){return new yn(h,y)};function yn(h,y){yt.call(this),this.g=new Wr(y),this.l=h,this.h=y&&y.messageUrlParams||null,h=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(h?h["X-WebChannel-Content-Type"]=y.messageContentType:h={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(h?h["X-WebChannel-Client-Profile"]=y.va:h={"X-WebChannel-Client-Profile":y.va}),this.g.S=h,(h=y&&y.Sb)&&!$(h)&&(this.g.m=h),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!$(y)&&(this.g.D=y,h=this.h,h!==null&&y in h&&(h=this.h,y in h&&delete h[y])),this.j=new Rs(this)}N(yn,yt),yn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){wl(this.g)},yn.prototype.o=function(h){var y=this.g;if(typeof h=="string"){var E={};E.__data__=h,h=E}else this.u&&(E={},E.__data__=ls(h),h=E);y.i.push(new Nu(y.Ya++,h)),y.G==3&&Jr(y)},yn.prototype.N=function(){this.g.l=null,delete this.j,wl(this.g),delete this.g,yn.aa.N.call(this)};function Vu(h){Zs.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var y=h.__sm__;if(y){e:{for(const E in y){h=E;break e}h=void 0}(this.i=h)&&(h=this.i,y=y!==null&&h in y?y[h]:void 0),this.data=y}else this.data=h}N(Vu,Zs);function Lu(){pl.call(this),this.status=1}N(Lu,pl);function Rs(h){this.g=h}N(Rs,ku),Rs.prototype.ua=function(){Ze(this.g,"a")},Rs.prototype.ta=function(h){Ze(this.g,new Vu(h))},Rs.prototype.sa=function(h){Ze(this.g,new Lu)},Rs.prototype.ra=function(){Ze(this.g,"b")},to.prototype.createWebChannel=to.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,mx=function(){return new to},fx=function(){return Ma()},hx=Ts,Hp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Va.NO_ERROR=0,Va.TIMEOUT=8,Va.HTTP_ERROR=6,Zd=Va,Js.COMPLETE="complete",dx=Js,ml.EventType=Ws,Ws.OPEN="a",Ws.CLOSE="b",Ws.ERROR="c",Ws.MESSAGE="d",yt.prototype.listen=yt.prototype.K,bc=ml,We.prototype.listenOnce=We.prototype.L,We.prototype.getLastError=We.prototype.Ka,We.prototype.getLastErrorCode=We.prototype.Ba,We.prototype.getStatus=We.prototype.Z,We.prototype.getResponseJson=We.prototype.Oa,We.prototype.getResponseText=We.prototype.oa,We.prototype.send=We.prototype.ea,We.prototype.setWithCredentials=We.prototype.Ha,ux=We}).apply(typeof Fd<"u"?Fd:typeof self<"u"?self:typeof window<"u"?window:{});const Ob="@firebase/firestore",Mb="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}hn.UNAUTHENTICATED=new hn(null),hn.GOOGLE_CREDENTIALS=new hn("google-credentials-uid"),hn.FIRST_PARTY=new hn("first-party-uid"),hn.MOCK_USER=new hn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nl="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wr=new Xc("@firebase/firestore");function Oo(){return wr.logLevel}function me(s,...e){if(wr.logLevel<=Fe.DEBUG){const t=e.map(Ig);wr.debug(`Firestore (${nl}): ${s}`,...t)}}function ja(s,...e){if(wr.logLevel<=Fe.ERROR){const t=e.map(Ig);wr.error(`Firestore (${nl}): ${s}`,...t)}}function $o(s,...e){if(wr.logLevel<=Fe.WARN){const t=e.map(Ig);wr.warn(`Firestore (${nl}): ${s}`,...t)}}function Ig(s){if(typeof s=="string")return s;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(s)}catch{return s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Te(s,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,px(s,i,t)}function px(s,e,t){let i=`FIRESTORE (${nl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw ja(i),new Error(i)}function Ke(s,e,t,i){let o="Unexpected state";typeof t=="string"?o=t:i=t,s||px(e,o,i)}function je(s,e){return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class fe extends os{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gx{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class UR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(hn.UNAUTHENTICATED))}shutdown(){}}class FR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class qR{constructor(e){this.t=e,this.currentUser=hn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ke(this.o===void 0,42304);let i=this.i;const o=p=>this.i!==i?(i=this.i,t(p)):Promise.resolve();let c=new Bs;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new Bs,e.enqueueRetryable(()=>o(this.currentUser))};const d=()=>{const p=c;e.enqueueRetryable(async()=>{await p.promise,await o(this.currentUser)})},m=p=>{me("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit(p=>m(p)),setTimeout(()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?m(p):(me("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new Bs)}},0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(me("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ke(typeof i.accessToken=="string",31837,{l:i}),new gx(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ke(e===null||typeof e=="string",2055,{h:e}),new hn(e)}}class BR{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=hn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class zR{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new BR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(hn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Pb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class HR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Cn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ke(this.o===void 0,3512);const i=c=>{c.error!=null&&me("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const d=c.token!==this.m;return this.m=c.token,me("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable(()=>i(c))};const o=c=>{me("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(c=>o(c)),setTimeout(()=>{if(!this.appCheck){const c=this.V.getImmediate({optional:!0});c?o(c):me("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Pb(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ke(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Pb(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GR(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<s;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vx(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yx{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const o=GR(40);for(let c=0;c<o.length;++c)i.length<20&&o[c]<t&&(i+=e.charAt(o[c]%62))}return i}}function Me(s,e){return s<e?-1:s>e?1:0}function Gp(s,e){let t=0;for(;t<s.length&&t<e.length;){const i=s.codePointAt(t),o=e.codePointAt(t);if(i!==o){if(i<128&&o<128)return Me(i,o);{const c=vx(),d=$R(c.encode(kb(s,t)),c.encode(kb(e,t)));return d!==0?d:Me(i,o)}}t+=i>65535?2:1}return Me(s.length,e.length)}function kb(s,e){return s.codePointAt(e)>65535?s.substring(e,e+2):s.substring(e,e+1)}function $R(s,e){for(let t=0;t<s.length&&t<e.length;++t)if(s[t]!==e[t])return Me(s[t],e[t]);return Me(s.length,e.length)}function Ko(s,e,t){return s.length===e.length&&s.every((i,o)=>t(i,e[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vb=-62135596800,Lb=1e6;class Vt{static now(){return Vt.fromMillis(Date.now())}static fromDate(e){return Vt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*Lb);return new Vt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new fe(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new fe(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Vb)throw new fe(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new fe(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Lb}_compareTo(e){return this.seconds===e.seconds?Me(this.nanoseconds,e.nanoseconds):Me(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-Vb;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{static fromTimestamp(e){return new Ae(e)}static min(){return new Ae(new Vt(0,0))}static max(){return new Ae(new Vt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ub="__name__";class Us{constructor(e,t,i){t===void 0?t=0:t>e.length&&Te(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Te(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Us.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Us?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let o=0;o<i;o++){const c=Us.compareSegments(e.get(o),t.get(o));if(c!==0)return c}return Me(e.length,t.length)}static compareSegments(e,t){const i=Us.isNumericId(e),o=Us.isNumericId(t);return i&&!o?-1:!i&&o?1:i&&o?Us.extractNumericId(e).compare(Us.extractNumericId(t)):Gp(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return vi.fromString(e.substring(4,e.length-2))}}class rt extends Us{construct(e,t,i){return new rt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new fe(re.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(o=>o.length>0))}return new rt(t)}static emptyPath(){return new rt([])}}const KR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class sn extends Us{construct(e,t,i){return new sn(e,t,i)}static isValidIdentifier(e){return KR.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),sn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Ub}static keyField(){return new sn([Ub])}static fromServerFormat(e){const t=[];let i="",o=0;const c=()=>{if(i.length===0)throw new fe(re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;o<e.length;){const m=e[o];if(m==="\\"){if(o+1===e.length)throw new fe(re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[o+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new fe(re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=p,o+=2}else m==="`"?(d=!d,o++):m!=="."||d?(i+=m,o++):(c(),o++)}if(c(),d)throw new fe(re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new sn(t)}static emptyPath(){return new sn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ee{constructor(e){this.path=e}static fromPath(e){return new Ee(rt.fromString(e))}static fromName(e){return new Ee(rt.fromString(e).popFirst(5))}static empty(){return new Ee(rt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&rt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return rt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ee(new rt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fc=-1;function YR(s,e){const t=s.toTimestamp().seconds,i=s.toTimestamp().nanoseconds+1,o=Ae.fromTimestamp(i===1e9?new Vt(t+1,0):new Vt(t,i));return new Ei(o,Ee.empty(),e)}function QR(s){return new Ei(s.readTime,s.key,Fc)}class Ei{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Ei(Ae.min(),Ee.empty(),Fc)}static max(){return new Ei(Ae.max(),Ee.empty(),Fc)}}function XR(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=Ee.comparator(s.documentKey,e.documentKey),t!==0?t:Me(s.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ZR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sl(s){if(s.code!==re.FAILED_PRECONDITION||s.message!==WR)throw s;me("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Te(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new le((i,o)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(i,o)},this.catchCallback=c=>{this.wrapFailure(t,c).next(i,o)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof le?t:le.resolve(t)}catch(t){return le.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):le.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):le.reject(t)}static resolve(e){return new le((t,i)=>{t(e)})}static reject(e){return new le((t,i)=>{i(e)})}static waitFor(e){return new le((t,i)=>{let o=0,c=0,d=!1;e.forEach(m=>{++o,m.next(()=>{++c,d&&c===o&&t()},p=>i(p))}),d=!0,c===o&&t()})}static or(e){let t=le.resolve(!1);for(const i of e)t=t.next(o=>o?le.resolve(o):i());return t}static forEach(e,t){const i=[];return e.forEach((o,c)=>{i.push(t.call(this,o,c))}),this.waitFor(i)}static mapArray(e,t){return new le((i,o)=>{const c=e.length,d=new Array(c);let m=0;for(let p=0;p<c;p++){const v=p;t(e[v]).next(_=>{d[v]=_,++m,m===c&&i(d)},_=>o(_))}})}static doWhile(e,t){return new le((i,o)=>{const c=()=>{e()===!0?t().next(()=>{c()},o):i()};c()})}}function JR(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function al(s){return s.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ue(i),this.ce=i=>t.writeSequenceNumber(i))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}kh.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rg=-1;function nu(s){return s==null}function mh(s){return s===0&&1/s==-1/0}function e1(s){return typeof s=="number"&&Number.isInteger(s)&&!mh(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _x="";function t1(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=Fb(e)),e=n1(s.get(t),e);return Fb(e)}function n1(s,e){let t=e;const i=s.length;for(let o=0;o<i;o++){const c=s.charAt(o);switch(c){case"\0":t+="";break;case _x:t+="";break;default:t+=c}}return t}function Fb(s){return s+_x+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qb(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function Oi(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function Ex(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e,t){this.comparator=e,this.root=t||nn.EMPTY}insert(e,t){return new vt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,nn.BLACK,null,null))}remove(e){return new vt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,nn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const o=this.comparator(e,i.key);if(o===0)return t+i.left.size;o<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new qd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new qd(this.root,e,this.comparator,!1)}getReverseIterator(){return new qd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new qd(this.root,e,this.comparator,!0)}}class qd{constructor(e,t,i,o){this.isReverse=o,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=t?i(e.key,t):1,t&&o&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class nn{constructor(e,t,i,o,c){this.key=e,this.value=t,this.color=i??nn.RED,this.left=o??nn.EMPTY,this.right=c??nn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,o,c){return new nn(e??this.key,t??this.value,i??this.color,o??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let o=this;const c=i(e,o.key);return o=c<0?o.copy(null,null,null,o.left.insert(e,t,i),null):c===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,i)),o.fixUp()}removeMin(){if(this.left.isEmpty())return nn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return nn.EMPTY;i=o.right.min(),o=o.copy(i.key,i.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,nn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,nn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Te(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Te(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Te(27949);return e+(this.isRed()?0:1)}}nn.EMPTY=null,nn.RED=!0,nn.BLACK=!1;nn.EMPTY=new class{constructor(){this.size=0}get key(){throw Te(57766)}get value(){throw Te(16141)}get color(){throw Te(16727)}get left(){throw Te(29726)}get right(){throw Te(36894)}copy(e,t,i,o,c){return this}insert(e,t,i){return new nn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e){this.comparator=e,this.data=new vt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const o=i.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Bb(this.data.getIterator())}getIteratorFrom(e){return new Bb(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof Lt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=i.getNext().key;if(this.comparator(o,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Lt(this.comparator);return t.data=e,t}}class Bb{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e){this.fields=e,e.sort(sn.comparator)}static empty(){return new qn([])}unionWith(e){let t=new Lt(sn.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new qn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ko(this.fields,e.fields,(t,i)=>t.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(o){try{return atob(o)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new bx("Invalid base64 string: "+c):c}}(e);return new on(t)}static fromUint8Array(e){const t=function(o){let c="";for(let d=0;d<o.length;++d)c+=String.fromCharCode(o[d]);return c}(e);return new on(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Me(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}on.EMPTY_BYTE_STRING=new on("");const s1=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function bi(s){if(Ke(!!s,39018),typeof s=="string"){let e=0;const t=s1.exec(s);if(Ke(!!t,46558,{timestamp:s}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const i=new Date(s);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:At(s.seconds),nanos:At(s.nanos)}}function At(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function Ti(s){return typeof s=="string"?on.fromBase64String(s):on.fromUint8Array(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tx="server_timestamp",Nx="__type__",xx="__previous_value__",Ax="__local_write_time__";function Dg(s){var e,t;return((t=(((e=s?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Nx])===null||t===void 0?void 0:t.stringValue)===Tx}function Vh(s){const e=s.mapValue.fields[xx];return Dg(e)?Vh(e):e}function qc(s){const e=bi(s.mapValue.fields[Ax].timestampValue);return new Vt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a1{constructor(e,t,i,o,c,d,m,p,v,_){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=o,this.ssl=c,this.forceLongPolling=d,this.autoDetectLongPolling=m,this.longPollingOptions=p,this.useFetchStreams=v,this.isUsingEmulator=_}}const ph="(default)";class Bc{constructor(e,t){this.projectId=e,this.database=t||ph}static empty(){return new Bc("","")}get isDefaultDatabase(){return this.database===ph}isEqual(e){return e instanceof Bc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sx="__type__",i1="__max__",Bd={mapValue:{}},wx="__vector__",gh="value";function Ni(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?Dg(s)?4:o1(s)?9007199254740991:r1(s)?10:11:Te(28295,{value:s})}function Gs(s,e){if(s===e)return!0;const t=Ni(s);if(t!==Ni(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return qc(s).isEqual(qc(e));case 3:return function(o,c){if(typeof o.timestampValue=="string"&&typeof c.timestampValue=="string"&&o.timestampValue.length===c.timestampValue.length)return o.timestampValue===c.timestampValue;const d=bi(o.timestampValue),m=bi(c.timestampValue);return d.seconds===m.seconds&&d.nanos===m.nanos}(s,e);case 5:return s.stringValue===e.stringValue;case 6:return function(o,c){return Ti(o.bytesValue).isEqual(Ti(c.bytesValue))}(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return function(o,c){return At(o.geoPointValue.latitude)===At(c.geoPointValue.latitude)&&At(o.geoPointValue.longitude)===At(c.geoPointValue.longitude)}(s,e);case 2:return function(o,c){if("integerValue"in o&&"integerValue"in c)return At(o.integerValue)===At(c.integerValue);if("doubleValue"in o&&"doubleValue"in c){const d=At(o.doubleValue),m=At(c.doubleValue);return d===m?mh(d)===mh(m):isNaN(d)&&isNaN(m)}return!1}(s,e);case 9:return Ko(s.arrayValue.values||[],e.arrayValue.values||[],Gs);case 10:case 11:return function(o,c){const d=o.mapValue.fields||{},m=c.mapValue.fields||{};if(qb(d)!==qb(m))return!1;for(const p in d)if(d.hasOwnProperty(p)&&(m[p]===void 0||!Gs(d[p],m[p])))return!1;return!0}(s,e);default:return Te(52216,{left:s})}}function zc(s,e){return(s.values||[]).find(t=>Gs(t,e))!==void 0}function Yo(s,e){if(s===e)return 0;const t=Ni(s),i=Ni(e);if(t!==i)return Me(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Me(s.booleanValue,e.booleanValue);case 2:return function(c,d){const m=At(c.integerValue||c.doubleValue),p=At(d.integerValue||d.doubleValue);return m<p?-1:m>p?1:m===p?0:isNaN(m)?isNaN(p)?0:-1:1}(s,e);case 3:return zb(s.timestampValue,e.timestampValue);case 4:return zb(qc(s),qc(e));case 5:return Gp(s.stringValue,e.stringValue);case 6:return function(c,d){const m=Ti(c),p=Ti(d);return m.compareTo(p)}(s.bytesValue,e.bytesValue);case 7:return function(c,d){const m=c.split("/"),p=d.split("/");for(let v=0;v<m.length&&v<p.length;v++){const _=Me(m[v],p[v]);if(_!==0)return _}return Me(m.length,p.length)}(s.referenceValue,e.referenceValue);case 8:return function(c,d){const m=Me(At(c.latitude),At(d.latitude));return m!==0?m:Me(At(c.longitude),At(d.longitude))}(s.geoPointValue,e.geoPointValue);case 9:return Hb(s.arrayValue,e.arrayValue);case 10:return function(c,d){var m,p,v,_;const T=c.fields||{},x=d.fields||{},C=(m=T[gh])===null||m===void 0?void 0:m.arrayValue,N=(p=x[gh])===null||p===void 0?void 0:p.arrayValue,M=Me(((v=C?.values)===null||v===void 0?void 0:v.length)||0,((_=N?.values)===null||_===void 0?void 0:_.length)||0);return M!==0?M:Hb(C,N)}(s.mapValue,e.mapValue);case 11:return function(c,d){if(c===Bd.mapValue&&d===Bd.mapValue)return 0;if(c===Bd.mapValue)return 1;if(d===Bd.mapValue)return-1;const m=c.fields||{},p=Object.keys(m),v=d.fields||{},_=Object.keys(v);p.sort(),_.sort();for(let T=0;T<p.length&&T<_.length;++T){const x=Gp(p[T],_[T]);if(x!==0)return x;const C=Yo(m[p[T]],v[_[T]]);if(C!==0)return C}return Me(p.length,_.length)}(s.mapValue,e.mapValue);default:throw Te(23264,{Pe:t})}}function zb(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return Me(s,e);const t=bi(s),i=bi(e),o=Me(t.seconds,i.seconds);return o!==0?o:Me(t.nanos,i.nanos)}function Hb(s,e){const t=s.values||[],i=e.values||[];for(let o=0;o<t.length&&o<i.length;++o){const c=Yo(t[o],i[o]);if(c)return c}return Me(t.length,i.length)}function Qo(s){return $p(s)}function $p(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?function(t){const i=bi(t);return`time(${i.seconds},${i.nanos})`}(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?function(t){return Ti(t).toBase64()}(s.bytesValue):"referenceValue"in s?function(t){return Ee.fromName(t).toString()}(s.referenceValue):"geoPointValue"in s?function(t){return`geo(${t.latitude},${t.longitude})`}(s.geoPointValue):"arrayValue"in s?function(t){let i="[",o=!0;for(const c of t.values||[])o?o=!1:i+=",",i+=$p(c);return i+"]"}(s.arrayValue):"mapValue"in s?function(t){const i=Object.keys(t.fields||{}).sort();let o="{",c=!0;for(const d of i)c?c=!1:o+=",",o+=`${d}:${$p(t.fields[d])}`;return o+"}"}(s.mapValue):Te(61005,{value:s})}function Jd(s){switch(Ni(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Vh(s);return e?16+Jd(e):16;case 5:return 2*s.stringValue.length;case 6:return Ti(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((o,c)=>o+Jd(c),0)}(s.arrayValue);case 10:case 11:return function(i){let o=0;return Oi(i.fields,(c,d)=>{o+=c.length+Jd(d)}),o}(s.mapValue);default:throw Te(13486,{value:s})}}function Gb(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function Kp(s){return!!s&&"integerValue"in s}function Og(s){return!!s&&"arrayValue"in s}function $b(s){return!!s&&"nullValue"in s}function Kb(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function eh(s){return!!s&&"mapValue"in s}function r1(s){var e,t;return((t=(((e=s?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Sx])===null||t===void 0?void 0:t.stringValue)===wx}function wc(s){if(s.geoPointValue)return{geoPointValue:Object.assign({},s.geoPointValue)};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:Object.assign({},s.timestampValue)};if(s.mapValue){const e={mapValue:{fields:{}}};return Oi(s.mapValue.fields,(t,i)=>e.mapValue.fields[t]=wc(i)),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=wc(s.arrayValue.values[t]);return e}return Object.assign({},s)}function o1(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===i1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e){this.value=e}static empty(){return new Tn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!eh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=wc(t)}setAll(e){let t=sn.emptyPath(),i={},o=[];e.forEach((d,m)=>{if(!t.isImmediateParentOf(m)){const p=this.getFieldsMap(t);this.applyChanges(p,i,o),i={},o=[],t=m.popLast()}d?i[m.lastSegment()]=wc(d):o.push(m.lastSegment())});const c=this.getFieldsMap(t);this.applyChanges(c,i,o)}delete(e){const t=this.field(e.popLast());eh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Gs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let o=t.mapValue.fields[e.get(i)];eh(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,i){Oi(t,(o,c)=>e[o]=c);for(const o of i)delete e[o]}clone(){return new Tn(wc(this.value))}}function Cx(s){const e=[];return Oi(s.fields,(t,i)=>{const o=new sn([t]);if(eh(i)){const c=Cx(i.mapValue).fields;if(c.length===0)e.push(o);else for(const d of c)e.push(o.child(d))}else e.push(o)}),new qn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e,t,i,o,c,d,m){this.key=e,this.documentType=t,this.version=i,this.readTime=o,this.createTime=c,this.data=d,this.documentState=m}static newInvalidDocument(e){return new Yt(e,0,Ae.min(),Ae.min(),Ae.min(),Tn.empty(),0)}static newFoundDocument(e,t,i,o){return new Yt(e,1,t,Ae.min(),i,o,0)}static newNoDocument(e,t){return new Yt(e,2,t,Ae.min(),Ae.min(),Tn.empty(),0)}static newUnknownDocument(e,t){return new Yt(e,3,t,Ae.min(),Ae.min(),Tn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ae.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Tn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Tn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ae.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Yt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Yt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vh{constructor(e,t){this.position=e,this.inclusive=t}}function Yb(s,e,t){let i=0;for(let o=0;o<s.position.length;o++){const c=e[o],d=s.position[o];if(c.field.isKeyField()?i=Ee.comparator(Ee.fromName(d.referenceValue),t.key):i=Yo(d,t.data.field(c.field)),c.dir==="desc"&&(i*=-1),i!==0)break}return i}function Qb(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!Gs(s.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hc{constructor(e,t="asc"){this.field=e,this.dir=t}}function l1(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jx{}class Rt extends jx{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new u1(e,t,i):t==="array-contains"?new f1(e,i):t==="in"?new m1(e,i):t==="not-in"?new p1(e,i):t==="array-contains-any"?new g1(e,i):new Rt(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new d1(e,i):new h1(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Yo(t,this.value)):t!==null&&Ni(this.value)===Ni(t)&&this.matchesComparison(Yo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Te(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Es extends jx{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new Es(e,t)}matches(e){return Ix(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function Ix(s){return s.op==="and"}function Rx(s){return c1(s)&&Ix(s)}function c1(s){for(const e of s.filters)if(e instanceof Es)return!1;return!0}function Yp(s){if(s instanceof Rt)return s.field.canonicalString()+s.op.toString()+Qo(s.value);if(Rx(s))return s.filters.map(e=>Yp(e)).join(",");{const e=s.filters.map(t=>Yp(t)).join(",");return`${s.op}(${e})`}}function Dx(s,e){return s instanceof Rt?function(i,o){return o instanceof Rt&&i.op===o.op&&i.field.isEqual(o.field)&&Gs(i.value,o.value)}(s,e):s instanceof Es?function(i,o){return o instanceof Es&&i.op===o.op&&i.filters.length===o.filters.length?i.filters.reduce((c,d,m)=>c&&Dx(d,o.filters[m]),!0):!1}(s,e):void Te(19439)}function Ox(s){return s instanceof Rt?function(t){return`${t.field.canonicalString()} ${t.op} ${Qo(t.value)}`}(s):s instanceof Es?function(t){return t.op.toString()+" {"+t.getFilters().map(Ox).join(" ,")+"}"}(s):"Filter"}class u1 extends Rt{constructor(e,t,i){super(e,t,i),this.key=Ee.fromName(i.referenceValue)}matches(e){const t=Ee.comparator(e.key,this.key);return this.matchesComparison(t)}}class d1 extends Rt{constructor(e,t){super(e,"in",t),this.keys=Mx("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class h1 extends Rt{constructor(e,t){super(e,"not-in",t),this.keys=Mx("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Mx(s,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>Ee.fromName(i.referenceValue))}class f1 extends Rt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Og(t)&&zc(t.arrayValue,this.value)}}class m1 extends Rt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&zc(this.value.arrayValue,t)}}class p1 extends Rt{constructor(e,t){super(e,"not-in",t)}matches(e){if(zc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!zc(this.value.arrayValue,t)}}class g1 extends Rt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Og(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>zc(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v1{constructor(e,t=null,i=[],o=[],c=null,d=null,m=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=o,this.limit=c,this.startAt=d,this.endAt=m,this.Ie=null}}function Xb(s,e=null,t=[],i=[],o=null,c=null,d=null){return new v1(s,e,t,i,o,c,d)}function Mg(s){const e=je(s);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>Yp(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(c){return c.field.canonicalString()+c.dir}(i)).join(","),nu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>Qo(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>Qo(i)).join(",")),e.Ie=t}return e.Ie}function Pg(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!l1(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!Dx(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!Qb(s.startAt,e.startAt)&&Qb(s.endAt,e.endAt)}function Qp(s){return Ee.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(e,t=null,i=[],o=[],c=null,d="F",m=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=o,this.limit=c,this.limitType=d,this.startAt=m,this.endAt=p,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function y1(s,e,t,i,o,c,d,m){return new il(s,e,t,i,o,c,d,m)}function Lh(s){return new il(s)}function Wb(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function Px(s){return s.collectionGroup!==null}function Cc(s){const e=je(s);if(e.Ee===null){e.Ee=[];const t=new Set;for(const c of e.explicitOrderBy)e.Ee.push(c),t.add(c.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let m=new Lt(sn.comparator);return d.filters.forEach(p=>{p.getFlattenedFilters().forEach(v=>{v.isInequality()&&(m=m.add(v.field))})}),m})(e).forEach(c=>{t.has(c.canonicalString())||c.isKeyField()||e.Ee.push(new Hc(c,i))}),t.has(sn.keyField().canonicalString())||e.Ee.push(new Hc(sn.keyField(),i))}return e.Ee}function zs(s){const e=je(s);return e.de||(e.de=_1(e,Cc(s))),e.de}function _1(s,e){if(s.limitType==="F")return Xb(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map(o=>{const c=o.dir==="desc"?"asc":"desc";return new Hc(o.field,c)});const t=s.endAt?new vh(s.endAt.position,s.endAt.inclusive):null,i=s.startAt?new vh(s.startAt.position,s.startAt.inclusive):null;return Xb(s.path,s.collectionGroup,e,s.filters,s.limit,t,i)}}function Xp(s,e){const t=s.filters.concat([e]);return new il(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function Wp(s,e,t){return new il(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function Uh(s,e){return Pg(zs(s),zs(e))&&s.limitType===e.limitType}function kx(s){return`${Mg(zs(s))}|lt:${s.limitType}`}function Mo(s){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(o=>Ox(o)).join(", ")}]`),nu(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(o=>function(d){return`${d.field.canonicalString()} (${d.dir})`}(o)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(o=>Qo(o)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(o=>Qo(o)).join(",")),`Target(${i})`}(zs(s))}; limitType=${s.limitType})`}function Fh(s,e){return e.isFoundDocument()&&function(i,o){const c=o.key.path;return i.collectionGroup!==null?o.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(c):Ee.isDocumentKey(i.path)?i.path.isEqual(c):i.path.isImmediateParentOf(c)}(s,e)&&function(i,o){for(const c of Cc(i))if(!c.field.isKeyField()&&o.data.field(c.field)===null)return!1;return!0}(s,e)&&function(i,o){for(const c of i.filters)if(!c.matches(o))return!1;return!0}(s,e)&&function(i,o){return!(i.startAt&&!function(d,m,p){const v=Yb(d,m,p);return d.inclusive?v<=0:v<0}(i.startAt,Cc(i),o)||i.endAt&&!function(d,m,p){const v=Yb(d,m,p);return d.inclusive?v>=0:v>0}(i.endAt,Cc(i),o))}(s,e)}function E1(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function Vx(s){return(e,t)=>{let i=!1;for(const o of Cc(s)){const c=b1(o,e,t);if(c!==0)return c;i=i||o.field.isKeyField()}return 0}}function b1(s,e,t){const i=s.field.isKeyField()?Ee.comparator(e.key,t.key):function(c,d,m){const p=d.data.field(c),v=m.data.field(c);return p!==null&&v!==null?Yo(p,v):Te(42886)}(s.field,e,t);switch(s.dir){case"asc":return i;case"desc":return-1*i;default:return Te(19790,{direction:s.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[o,c]of i)if(this.equalsFn(o,e))return c}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),o=this.inner[i];if(o===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let c=0;c<o.length;c++)if(this.equalsFn(o[c][0],e))return void(o[c]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return i.length===1?delete this.inner[t]:i.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Oi(this.inner,(t,i)=>{for(const[o,c]of i)e(o,c)})}isEmpty(){return Ex(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T1=new vt(Ee.comparator);function Ia(){return T1}const Lx=new vt(Ee.comparator);function Tc(...s){let e=Lx;for(const t of s)e=e.insert(t.key,t);return e}function Ux(s){let e=Lx;return s.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function Tr(){return jc()}function Fx(){return jc()}function jc(){return new Mr(s=>s.toString(),(s,e)=>s.isEqual(e))}const N1=new vt(Ee.comparator),x1=new Lt(Ee.comparator);function Be(...s){let e=x1;for(const t of s)e=e.add(t);return e}const A1=new Lt(Me);function S1(){return A1}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kg(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:mh(e)?"-0":e}}function qx(s){return{integerValue:""+s}}function w1(s,e){return e1(e)?qx(e):kg(s,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(){this._=void 0}}function C1(s,e,t){return s instanceof Gc?function(o,c){const d={fields:{[Nx]:{stringValue:Tx},[Ax]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return c&&Dg(c)&&(c=Vh(c)),c&&(d.fields[xx]=c),{mapValue:d}}(t,e):s instanceof $c?zx(s,e):s instanceof Kc?Hx(s,e):function(o,c){const d=Bx(o,c),m=Zb(d)+Zb(o.Re);return Kp(d)&&Kp(o.Re)?qx(m):kg(o.serializer,m)}(s,e)}function j1(s,e,t){return s instanceof $c?zx(s,e):s instanceof Kc?Hx(s,e):t}function Bx(s,e){return s instanceof yh?function(i){return Kp(i)||function(c){return!!c&&"doubleValue"in c}(i)}(e)?e:{integerValue:0}:null}class Gc extends qh{}class $c extends qh{constructor(e){super(),this.elements=e}}function zx(s,e){const t=Gx(e);for(const i of s.elements)t.some(o=>Gs(o,i))||t.push(i);return{arrayValue:{values:t}}}class Kc extends qh{constructor(e){super(),this.elements=e}}function Hx(s,e){let t=Gx(e);for(const i of s.elements)t=t.filter(o=>!Gs(o,i));return{arrayValue:{values:t}}}class yh extends qh{constructor(e,t){super(),this.serializer=e,this.Re=t}}function Zb(s){return At(s.integerValue||s.doubleValue)}function Gx(s){return Og(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I1{constructor(e,t){this.field=e,this.transform=t}}function R1(s,e){return s.field.isEqual(e.field)&&function(i,o){return i instanceof $c&&o instanceof $c||i instanceof Kc&&o instanceof Kc?Ko(i.elements,o.elements,Gs):i instanceof yh&&o instanceof yh?Gs(i.Re,o.Re):i instanceof Gc&&o instanceof Gc}(s.transform,e.transform)}class D1{constructor(e,t){this.version=e,this.transformResults=t}}class an{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new an}static exists(e){return new an(void 0,e)}static updateTime(e){return new an(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function th(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class Bh{}function $x(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new zh(s.key,an.none()):new su(s.key,s.data,an.none());{const t=s.data,i=Tn.empty();let o=new Lt(sn.comparator);for(let c of e.fields)if(!o.has(c)){let d=t.field(c);d===null&&c.length>1&&(c=c.popLast(),d=t.field(c)),d===null?i.delete(c):i.set(c,d),o=o.add(c)}return new Mi(s.key,i,new qn(o.toArray()),an.none())}}function O1(s,e,t){s instanceof su?function(o,c,d){const m=o.value.clone(),p=eT(o.fieldTransforms,c,d.transformResults);m.setAll(p),c.convertToFoundDocument(d.version,m).setHasCommittedMutations()}(s,e,t):s instanceof Mi?function(o,c,d){if(!th(o.precondition,c))return void c.convertToUnknownDocument(d.version);const m=eT(o.fieldTransforms,c,d.transformResults),p=c.data;p.setAll(Kx(o)),p.setAll(m),c.convertToFoundDocument(d.version,p).setHasCommittedMutations()}(s,e,t):function(o,c,d){c.convertToNoDocument(d.version).setHasCommittedMutations()}(0,e,t)}function Ic(s,e,t,i){return s instanceof su?function(c,d,m,p){if(!th(c.precondition,d))return m;const v=c.value.clone(),_=tT(c.fieldTransforms,p,d);return v.setAll(_),d.convertToFoundDocument(d.version,v).setHasLocalMutations(),null}(s,e,t,i):s instanceof Mi?function(c,d,m,p){if(!th(c.precondition,d))return m;const v=tT(c.fieldTransforms,p,d),_=d.data;return _.setAll(Kx(c)),_.setAll(v),d.convertToFoundDocument(d.version,_).setHasLocalMutations(),m===null?null:m.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map(T=>T.field))}(s,e,t,i):function(c,d,m){return th(c.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):m}(s,e,t)}function M1(s,e){let t=null;for(const i of s.fieldTransforms){const o=e.data.field(i.field),c=Bx(i.transform,o||null);c!=null&&(t===null&&(t=Tn.empty()),t.set(i.field,c))}return t||null}function Jb(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!function(i,o){return i===void 0&&o===void 0||!(!i||!o)&&Ko(i,o,(c,d)=>R1(c,d))}(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class su extends Bh{constructor(e,t,i,o=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Mi extends Bh{constructor(e,t,i,o,c=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=o,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function Kx(s){const e=new Map;return s.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=s.data.field(t);e.set(t,i)}}),e}function eT(s,e,t){const i=new Map;Ke(s.length===t.length,32656,{Ve:t.length,me:s.length});for(let o=0;o<t.length;o++){const c=s[o],d=c.transform,m=e.data.field(c.field);i.set(c.field,j1(d,m,t[o]))}return i}function tT(s,e,t){const i=new Map;for(const o of s){const c=o.transform,d=t.data.field(o.field);i.set(o.field,C1(c,d,e))}return i}class zh extends Bh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Yx extends Bh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P1{constructor(e,t,i,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=o}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const c=this.mutations[o];c.key.isEqual(e.key)&&O1(c,e,i[o])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Ic(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Ic(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=Fx();return this.mutations.forEach(o=>{const c=e.get(o.key),d=c.overlayedDocument;let m=this.applyToLocalView(d,c.mutatedFields);m=t.has(o.key)?null:m;const p=$x(d,m);p!==null&&i.set(o.key,p),d.isValidDocument()||d.convertToNoDocument(Ae.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Be())}isEqual(e){return this.batchId===e.batchId&&Ko(this.mutations,e.mutations,(t,i)=>Jb(t,i))&&Ko(this.baseMutations,e.baseMutations,(t,i)=>Jb(t,i))}}class Vg{constructor(e,t,i,o){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=o}static from(e,t,i){Ke(e.mutations.length===i.length,58842,{fe:e.mutations.length,ge:i.length});let o=function(){return N1}();const c=e.mutations;for(let d=0;d<c.length;d++)o=o.insert(c[d].key,i[d].version);return new Vg(e,t,i,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var It,$e;function Qx(s){switch(s){case re.OK:return Te(64938);case re.CANCELLED:case re.UNKNOWN:case re.DEADLINE_EXCEEDED:case re.RESOURCE_EXHAUSTED:case re.INTERNAL:case re.UNAVAILABLE:case re.UNAUTHENTICATED:return!1;case re.INVALID_ARGUMENT:case re.NOT_FOUND:case re.ALREADY_EXISTS:case re.PERMISSION_DENIED:case re.FAILED_PRECONDITION:case re.ABORTED:case re.OUT_OF_RANGE:case re.UNIMPLEMENTED:case re.DATA_LOSS:return!0;default:return Te(15467,{code:s})}}function Xx(s){if(s===void 0)return ja("GRPC error has no .code"),re.UNKNOWN;switch(s){case It.OK:return re.OK;case It.CANCELLED:return re.CANCELLED;case It.UNKNOWN:return re.UNKNOWN;case It.DEADLINE_EXCEEDED:return re.DEADLINE_EXCEEDED;case It.RESOURCE_EXHAUSTED:return re.RESOURCE_EXHAUSTED;case It.INTERNAL:return re.INTERNAL;case It.UNAVAILABLE:return re.UNAVAILABLE;case It.UNAUTHENTICATED:return re.UNAUTHENTICATED;case It.INVALID_ARGUMENT:return re.INVALID_ARGUMENT;case It.NOT_FOUND:return re.NOT_FOUND;case It.ALREADY_EXISTS:return re.ALREADY_EXISTS;case It.PERMISSION_DENIED:return re.PERMISSION_DENIED;case It.FAILED_PRECONDITION:return re.FAILED_PRECONDITION;case It.ABORTED:return re.ABORTED;case It.OUT_OF_RANGE:return re.OUT_OF_RANGE;case It.UNIMPLEMENTED:return re.UNIMPLEMENTED;case It.DATA_LOSS:return re.DATA_LOSS;default:return Te(39323,{code:s})}}($e=It||(It={}))[$e.OK=0]="OK",$e[$e.CANCELLED=1]="CANCELLED",$e[$e.UNKNOWN=2]="UNKNOWN",$e[$e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$e[$e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$e[$e.NOT_FOUND=5]="NOT_FOUND",$e[$e.ALREADY_EXISTS=6]="ALREADY_EXISTS",$e[$e.PERMISSION_DENIED=7]="PERMISSION_DENIED",$e[$e.UNAUTHENTICATED=16]="UNAUTHENTICATED",$e[$e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$e[$e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$e[$e.ABORTED=10]="ABORTED",$e[$e.OUT_OF_RANGE=11]="OUT_OF_RANGE",$e[$e.UNIMPLEMENTED=12]="UNIMPLEMENTED",$e[$e.INTERNAL=13]="INTERNAL",$e[$e.UNAVAILABLE=14]="UNAVAILABLE",$e[$e.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L1=new vi([4294967295,4294967295],0);function nT(s){const e=vx().encode(s),t=new cx;return t.update(e),new Uint8Array(t.digest())}function sT(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),o=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new vi([t,i],0),new vi([o,c],0)]}class Lg{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Nc(`Invalid padding: ${t}`);if(i<0)throw new Nc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Nc(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Nc(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=vi.fromNumber(this.pe)}we(e,t,i){let o=e.add(t.multiply(vi.fromNumber(i)));return o.compare(L1)===1&&(o=new vi([o.getBits(0),o.getBits(1)],0)),o.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=nT(e),[i,o]=sT(t);for(let c=0;c<this.hashCount;c++){const d=this.we(i,o,c);if(!this.be(d))return!1}return!0}static create(e,t,i){const o=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),d=new Lg(c,o,t);return i.forEach(m=>d.insert(m)),d}insert(e){if(this.pe===0)return;const t=nT(e),[i,o]=sT(t);for(let c=0;c<this.hashCount;c++){const d=this.we(i,o,c);this.Se(d)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class Nc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(e,t,i,o,c){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=o,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const o=new Map;return o.set(e,au.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Hh(Ae.min(),o,new vt(Me),Ia(),Be())}}class au{constructor(e,t,i,o,c){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=o,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new au(i,t,Be(),Be(),Be())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nh{constructor(e,t,i,o){this.De=e,this.removedTargetIds=t,this.key=i,this.ve=o}}class Wx{constructor(e,t){this.targetId=e,this.Ce=t}}class Zx{constructor(e,t,i=on.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=o}}class aT{constructor(){this.Fe=0,this.Me=iT(),this.xe=on.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Be(),t=Be(),i=Be();return this.Me.forEach((o,c)=>{switch(c){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:i=i.add(o);break;default:Te(38017,{changeType:c})}}),new au(this.xe,this.Oe,e,t,i)}Qe(){this.Ne=!1,this.Me=iT()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Ke(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class U1{constructor(e){this.ze=e,this.je=new Map,this.He=Ia(),this.Je=zd(),this.Ye=zd(),this.Ze=new vt(Me)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const i=this.rt(t);switch(e.state){case 0:this.it(t)&&i.ke(e.resumeToken);break;case 1:i.We(),i.Be||i.Qe(),i.ke(e.resumeToken);break;case 2:i.We(),i.Be||this.removeTarget(t);break;case 3:this.it(t)&&(i.Ge(),i.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),i.ke(e.resumeToken));break;default:Te(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((i,o)=>{this.it(o)&&t(o)})}ot(e){const t=e.targetId,i=e.Ce.count,o=this._t(t);if(o){const c=o.target;if(Qp(c))if(i===0){const d=new Ee(c.path);this.tt(t,d,Yt.newNoDocument(d,Ae.min()))}else Ke(i===1,20013,{expectedCount:i});else{const d=this.ut(t);if(d!==i){const m=this.ct(e),p=m?this.lt(m,e,d):1;if(p!==0){this.st(t);const v=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,v)}}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:o=0},hashCount:c=0}=t;let d,m;try{d=Ti(i).toUint8Array()}catch(p){if(p instanceof bx)return $o("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{m=new Lg(d,o,c)}catch(p){return $o(p instanceof Nc?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return m.pe===0?null:m}lt(e,t,i){return t.Ce.count===i-this.Tt(e,t.targetId)?0:2}Tt(e,t){const i=this.ze.getRemoteKeysForTarget(t);let o=0;return i.forEach(c=>{const d=this.ze.Pt(),m=`projects/${d.projectId}/databases/${d.database}/documents/${c.path.canonicalString()}`;e.mightContain(m)||(this.tt(t,c,null),o++)}),o}It(e){const t=new Map;this.je.forEach((c,d)=>{const m=this._t(d);if(m){if(c.current&&Qp(m.target)){const p=new Ee(m.target.path);this.Et(p).has(d)||this.dt(d,p)||this.tt(d,p,Yt.newNoDocument(p,e))}c.Le&&(t.set(d,c.qe()),c.Qe())}});let i=Be();this.Ye.forEach((c,d)=>{let m=!0;d.forEachWhile(p=>{const v=this._t(p);return!v||v.purpose==="TargetPurposeLimboResolution"||(m=!1,!1)}),m&&(i=i.add(c))}),this.He.forEach((c,d)=>d.setReadTime(e));const o=new Hh(e,t,this.Ze,this.He,i);return this.He=Ia(),this.Je=zd(),this.Ye=zd(),this.Ze=new vt(Me),o}et(e,t){if(!this.it(e))return;const i=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,i),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,i){if(!this.it(e))return;const o=this.rt(e);this.dt(e,t)?o.$e(t,1):o.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),i&&(this.He=this.He.insert(t,i))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new aT,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new Lt(Me),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new Lt(Me),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||me("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new aT),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function zd(){return new vt(Ee.comparator)}function iT(){return new vt(Ee.comparator)}const F1={asc:"ASCENDING",desc:"DESCENDING"},q1={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},B1={and:"AND",or:"OR"};class z1{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Zp(s,e){return s.useProto3Json||nu(e)?e:{value:e}}function _h(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Jx(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function H1(s,e){return _h(s,e.toTimestamp())}function zn(s){return Ke(!!s,49232),Ae.fromTimestamp(function(t){const i=bi(t);return new Vt(i.seconds,i.nanos)}(s))}function Ug(s,e){return Jp(s,e).canonicalString()}function Jp(s,e){const t=function(o){return new rt(["projects",o.projectId,"databases",o.database])}(s).child("documents");return e===void 0?t:t.child(e)}function e0(s){const e=rt.fromString(s);return Ke(r0(e),10190,{key:e.toString()}),e}function Eh(s,e){return Ug(s.databaseId,e.path)}function Rc(s,e){const t=e0(e);if(t.get(1)!==s.databaseId.projectId)throw new fe(re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new fe(re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new Ee(n0(t))}function t0(s,e){return Ug(s.databaseId,e)}function G1(s){const e=e0(s);return e.length===4?rt.emptyPath():n0(e)}function eg(s){return new rt(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function n0(s){return Ke(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function rT(s,e,t){return{name:Eh(s,e),fields:t.value.mapValue.fields}}function $1(s,e){return"found"in e?function(i,o){Ke(!!o.found,43571),o.found.name,o.found.updateTime;const c=Rc(i,o.found.name),d=zn(o.found.updateTime),m=o.found.createTime?zn(o.found.createTime):Ae.min(),p=new Tn({mapValue:{fields:o.found.fields}});return Yt.newFoundDocument(c,d,m,p)}(s,e):"missing"in e?function(i,o){Ke(!!o.missing,3894),Ke(!!o.readTime,22933);const c=Rc(i,o.missing),d=zn(o.readTime);return Yt.newNoDocument(c,d)}(s,e):Te(7234,{result:e})}function K1(s,e){let t;if("targetChange"in e){e.targetChange;const i=function(v){return v==="NO_CHANGE"?0:v==="ADD"?1:v==="REMOVE"?2:v==="CURRENT"?3:v==="RESET"?4:Te(39313,{state:v})}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],c=function(v,_){return v.useProto3Json?(Ke(_===void 0||typeof _=="string",58123),on.fromBase64String(_||"")):(Ke(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),on.fromUint8Array(_||new Uint8Array))}(s,e.targetChange.resumeToken),d=e.targetChange.cause,m=d&&function(v){const _=v.code===void 0?re.UNKNOWN:Xx(v.code);return new fe(_,v.message||"")}(d);t=new Zx(i,o,c,m||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const o=Rc(s,i.document.name),c=zn(i.document.updateTime),d=i.document.createTime?zn(i.document.createTime):Ae.min(),m=new Tn({mapValue:{fields:i.document.fields}}),p=Yt.newFoundDocument(o,c,d,m),v=i.targetIds||[],_=i.removedTargetIds||[];t=new nh(v,_,p.key,p)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const o=Rc(s,i.document),c=i.readTime?zn(i.readTime):Ae.min(),d=Yt.newNoDocument(o,c),m=i.removedTargetIds||[];t=new nh([],m,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const o=Rc(s,i.document),c=i.removedTargetIds||[];t=new nh([],c,o,null)}else{if(!("filter"in e))return Te(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:o=0,unchangedNames:c}=i,d=new V1(o,c),m=i.targetId;t=new Wx(m,d)}}return t}function s0(s,e){let t;if(e instanceof su)t={update:rT(s,e.key,e.value)};else if(e instanceof zh)t={delete:Eh(s,e.key)};else if(e instanceof Mi)t={update:rT(s,e.key,e.data),updateMask:nD(e.fieldMask)};else{if(!(e instanceof Yx))return Te(16599,{ft:e.type});t={verify:Eh(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(c,d){const m=d.transform;if(m instanceof Gc)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(m instanceof $c)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:m.elements}};if(m instanceof Kc)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:m.elements}};if(m instanceof yh)return{fieldPath:d.field.canonicalString(),increment:m.Re};throw Te(20930,{transform:d.transform})}(0,i))),e.precondition.isNone||(t.currentDocument=function(o,c){return c.updateTime!==void 0?{updateTime:H1(o,c.updateTime)}:c.exists!==void 0?{exists:c.exists}:Te(27497)}(s,e.precondition)),t}function Y1(s,e){return s&&s.length>0?(Ke(e!==void 0,14353),s.map(t=>function(o,c){let d=o.updateTime?zn(o.updateTime):zn(c);return d.isEqual(Ae.min())&&(d=zn(c)),new D1(d,o.transformResults||[])}(t,e))):[]}function Q1(s,e){return{documents:[t0(s,e.path)]}}function X1(s,e){const t={structuredQuery:{}},i=e.path;let o;e.collectionGroup!==null?(o=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=t0(s,o);const c=function(v){if(v.length!==0)return i0(Es.create(v,"and"))}(e.filters);c&&(t.structuredQuery.where=c);const d=function(v){if(v.length!==0)return v.map(_=>function(x){return{field:Po(x.field),direction:J1(x.dir)}}(_))}(e.orderBy);d&&(t.structuredQuery.orderBy=d);const m=Zp(s,e.limit);return m!==null&&(t.structuredQuery.limit=m),e.startAt&&(t.structuredQuery.startAt=function(v){return{before:v.inclusive,values:v.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(v){return{before:!v.inclusive,values:v.position}}(e.endAt)),{gt:t,parent:o}}function W1(s){let e=G1(s.parent);const t=s.structuredQuery,i=t.from?t.from.length:0;let o=null;if(i>0){Ke(i===1,65062);const _=t.from[0];_.allDescendants?o=_.collectionId:e=e.child(_.collectionId)}let c=[];t.where&&(c=function(T){const x=a0(T);return x instanceof Es&&Rx(x)?x.getFilters():[x]}(t.where));let d=[];t.orderBy&&(d=function(T){return T.map(x=>function(N){return new Hc(ko(N.field),function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(N.direction))}(x))}(t.orderBy));let m=null;t.limit&&(m=function(T){let x;return x=typeof T=="object"?T.value:T,nu(x)?null:x}(t.limit));let p=null;t.startAt&&(p=function(T){const x=!!T.before,C=T.values||[];return new vh(C,x)}(t.startAt));let v=null;return t.endAt&&(v=function(T){const x=!T.before,C=T.values||[];return new vh(C,x)}(t.endAt)),y1(e,o,d,c,m,"F",p,v)}function Z1(s,e){const t=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Te(28987,{purpose:o})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function a0(s){return s.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=ko(t.unaryFilter.field);return Rt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const o=ko(t.unaryFilter.field);return Rt.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=ko(t.unaryFilter.field);return Rt.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=ko(t.unaryFilter.field);return Rt.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Te(61313);default:return Te(60726)}}(s):s.fieldFilter!==void 0?function(t){return Rt.create(ko(t.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Te(58110);default:return Te(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(s):s.compositeFilter!==void 0?function(t){return Es.create(t.compositeFilter.filters.map(i=>a0(i)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return Te(1026)}}(t.compositeFilter.op))}(s):Te(30097,{filter:s})}function J1(s){return F1[s]}function eD(s){return q1[s]}function tD(s){return B1[s]}function Po(s){return{fieldPath:s.canonicalString()}}function ko(s){return sn.fromServerFormat(s.fieldPath)}function i0(s){return s instanceof Rt?function(t){if(t.op==="=="){if(Kb(t.value))return{unaryFilter:{field:Po(t.field),op:"IS_NAN"}};if($b(t.value))return{unaryFilter:{field:Po(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Kb(t.value))return{unaryFilter:{field:Po(t.field),op:"IS_NOT_NAN"}};if($b(t.value))return{unaryFilter:{field:Po(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Po(t.field),op:eD(t.op),value:t.value}}}(s):s instanceof Es?function(t){const i=t.getFilters().map(o=>i0(o));return i.length===1?i[0]:{compositeFilter:{op:tD(t.op),filters:i}}}(s):Te(54877,{filter:s})}function nD(s){const e=[];return s.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function r0(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e,t,i,o,c=Ae.min(),d=Ae.min(),m=on.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=o,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=m,this.expectedCount=p}withSequenceNumber(e){return new mi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new mi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new mi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new mi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sD{constructor(e){this.wt=e}}function aD(s){const e=W1({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?Wp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iD{constructor(){this.Cn=new rD}addToCollectionParentIndex(e,t){return this.Cn.add(t),le.resolve()}getCollectionParents(e,t){return le.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return le.resolve()}deleteFieldIndex(e,t){return le.resolve()}deleteAllFieldIndexes(e){return le.resolve()}createTargetIndexes(e,t){return le.resolve()}getDocumentsMatchingTarget(e,t){return le.resolve(null)}getIndexType(e,t){return le.resolve(0)}getFieldIndexes(e,t){return le.resolve([])}getNextCollectionGroupToUpdate(e){return le.resolve(null)}getMinOffset(e,t){return le.resolve(Ei.min())}getMinOffsetFromCollectionGroup(e,t){return le.resolve(Ei.min())}updateCollectionGroup(e,t,i){return le.resolve()}updateIndexEntries(e,t){return le.resolve()}}class rD{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t]||new Lt(rt.comparator),c=!o.has(i);return this.index[t]=o.add(i),c}has(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t];return o&&o.has(i)}getEntries(e){return(this.index[e]||new Lt(rt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},o0=41943040;class wn{static withCacheSize(e){return new wn(e,wn.DEFAULT_COLLECTION_PERCENTILE,wn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wn.DEFAULT_COLLECTION_PERCENTILE=10,wn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,wn.DEFAULT=new wn(o0,wn.DEFAULT_COLLECTION_PERCENTILE,wn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),wn.DISABLED=new wn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new Xo(0)}static lr(){return new Xo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lT="LruGarbageCollector",oD=1048576;function cT([s,e],[t,i]){const o=Me(s,t);return o===0?Me(e,i):o}class lD{constructor(e){this.Er=e,this.buffer=new Lt(cT),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();cT(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class cD{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){me(lT,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){al(t)?me(lT,"Ignoring IndexedDB error during garbage collection: ",t):await sl(t)}await this.mr(3e5)})}}class uD{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return le.resolve(kh.le);const i=new lD(t);return this.gr.forEachTarget(e,o=>i.Rr(o.sequenceNumber)).next(()=>this.gr.yr(e,o=>i.Rr(o))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.gr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(me("LruGarbageCollector","Garbage collection skipped; disabled"),le.resolve(oT)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(me("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),oT):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let i,o,c,d,m,p,v;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(T=>(T>this.params.maximumSequenceNumbersToCollect?(me("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${T}`),o=this.params.maximumSequenceNumbersToCollect):o=T,d=Date.now(),this.nthSequenceNumber(e,o))).next(T=>(i=T,m=Date.now(),this.removeTargets(e,i,t))).next(T=>(c=T,p=Date.now(),this.removeOrphanedDocuments(e,i))).next(T=>(v=Date.now(),Oo()<=Fe.DEBUG&&me("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-_}ms
	Determined least recently used ${o} in `+(m-d)+`ms
	Removed ${c} targets in `+(p-m)+`ms
	Removed ${T} documents in `+(v-p)+`ms
Total Duration: ${v-_}ms`),le.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:c,documentsRemoved:T})))}}function dD(s,e){return new uD(s,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(){this.changes=new Mr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Yt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?le.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mD{constructor(e,t,i,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=o}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(o=>(i=o,this.remoteDocumentCache.getEntry(e,t))).next(o=>(i!==null&&Ic(i.mutation,o,qn.empty(),Vt.now()),o))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,Be()).next(()=>i))}getLocalViewOfDocuments(e,t,i=Be()){const o=Tr();return this.populateOverlays(e,o,t).next(()=>this.computeViews(e,t,o,i).next(c=>{let d=Tc();return c.forEach((m,p)=>{d=d.insert(m,p.overlayedDocument)}),d}))}getOverlayedDocuments(e,t){const i=Tr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,Be()))}populateOverlays(e,t,i){const o=[];return i.forEach(c=>{t.has(c)||o.push(c)}),this.documentOverlayCache.getOverlays(e,o).next(c=>{c.forEach((d,m)=>{t.set(d,m)})})}computeViews(e,t,i,o){let c=Ia();const d=jc(),m=function(){return jc()}();return t.forEach((p,v)=>{const _=i.get(v.key);o.has(v.key)&&(_===void 0||_.mutation instanceof Mi)?c=c.insert(v.key,v):_!==void 0?(d.set(v.key,_.mutation.getFieldMask()),Ic(_.mutation,v,_.mutation.getFieldMask(),Vt.now())):d.set(v.key,qn.empty())}),this.recalculateAndSaveOverlays(e,c).next(p=>(p.forEach((v,_)=>d.set(v,_)),t.forEach((v,_)=>{var T;return m.set(v,new fD(_,(T=d.get(v))!==null&&T!==void 0?T:null))}),m))}recalculateAndSaveOverlays(e,t){const i=jc();let o=new vt((d,m)=>d-m),c=Be();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(d=>{for(const m of d)m.keys().forEach(p=>{const v=t.get(p);if(v===null)return;let _=i.get(p)||qn.empty();_=m.applyToLocalView(v,_),i.set(p,_);const T=(o.get(m.batchId)||Be()).add(p);o=o.insert(m.batchId,T)})}).next(()=>{const d=[],m=o.getReverseIterator();for(;m.hasNext();){const p=m.getNext(),v=p.key,_=p.value,T=Fx();_.forEach(x=>{if(!c.has(x)){const C=$x(t.get(x),i.get(x));C!==null&&T.set(x,C),c=c.add(x)}}),d.push(this.documentOverlayCache.saveOverlays(e,v,T))}return le.waitFor(d)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,o){return function(d){return Ee.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Px(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,o):this.getDocumentsMatchingCollectionQuery(e,t,i,o)}getNextDocuments(e,t,i,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,o).next(c=>{const d=o-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,o-c.size):le.resolve(Tr());let m=Fc,p=c;return d.next(v=>le.forEach(v,(_,T)=>(m<T.largestBatchId&&(m=T.largestBatchId),c.get(_)?le.resolve():this.remoteDocumentCache.getEntry(e,_).next(x=>{p=p.insert(_,x)}))).next(()=>this.populateOverlays(e,v,c)).next(()=>this.computeViews(e,p,v,Be())).next(_=>({batchId:m,changes:Ux(_)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ee(t)).next(i=>{let o=Tc();return i.isFoundDocument()&&(o=o.insert(i.key,i)),o})}getDocumentsMatchingCollectionGroupQuery(e,t,i,o){const c=t.collectionGroup;let d=Tc();return this.indexManager.getCollectionParents(e,c).next(m=>le.forEach(m,p=>{const v=function(T,x){return new il(x,null,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,T.startAt,T.endAt)}(t,p.child(c));return this.getDocumentsMatchingCollectionQuery(e,v,i,o).next(_=>{_.forEach((T,x)=>{d=d.insert(T,x)})})}).next(()=>d))}getDocumentsMatchingCollectionQuery(e,t,i,o){let c;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(d=>(c=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,c,o))).next(d=>{c.forEach((p,v)=>{const _=v.getKey();d.get(_)===null&&(d=d.insert(_,Yt.newInvalidDocument(_)))});let m=Tc();return d.forEach((p,v)=>{const _=c.get(p);_!==void 0&&Ic(_.mutation,v,qn.empty(),Vt.now()),Fh(t,v)&&(m=m.insert(p,v))}),m})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return le.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(o){return{id:o.id,version:o.version,createTime:zn(o.createTime)}}(t)),le.resolve()}getNamedQuery(e,t){return le.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(o){return{name:o.name,query:aD(o.bundledQuery),readTime:zn(o.readTime)}}(t)),le.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gD{constructor(){this.overlays=new vt(Ee.comparator),this.Qr=new Map}getOverlay(e,t){return le.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Tr();return le.forEach(t,o=>this.getOverlay(e,o).next(c=>{c!==null&&i.set(o,c)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((o,c)=>{this.St(e,t,c)}),le.resolve()}removeOverlaysForBatchId(e,t,i){const o=this.Qr.get(i);return o!==void 0&&(o.forEach(c=>this.overlays=this.overlays.remove(c)),this.Qr.delete(i)),le.resolve()}getOverlaysForCollection(e,t,i){const o=Tr(),c=t.length+1,d=new Ee(t.child("")),m=this.overlays.getIteratorFrom(d);for(;m.hasNext();){const p=m.getNext().value,v=p.getKey();if(!t.isPrefixOf(v.path))break;v.path.length===c&&p.largestBatchId>i&&o.set(p.getKey(),p)}return le.resolve(o)}getOverlaysForCollectionGroup(e,t,i,o){let c=new vt((v,_)=>v-_);const d=this.overlays.getIterator();for(;d.hasNext();){const v=d.getNext().value;if(v.getKey().getCollectionGroup()===t&&v.largestBatchId>i){let _=c.get(v.largestBatchId);_===null&&(_=Tr(),c=c.insert(v.largestBatchId,_)),_.set(v.getKey(),v)}}const m=Tr(),p=c.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach((v,_)=>m.set(v,_)),!(m.size()>=o)););return le.resolve(m)}St(e,t,i){const o=this.overlays.get(i.key);if(o!==null){const d=this.Qr.get(o.largestBatchId).delete(i.key);this.Qr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new k1(t,i));let c=this.Qr.get(t);c===void 0&&(c=Be(),this.Qr.set(t,c)),this.Qr.set(t,c.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vD{constructor(){this.sessionToken=on.EMPTY_BYTE_STRING}getSessionToken(e){return le.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,le.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fg{constructor(){this.$r=new Lt(Kt.Ur),this.Kr=new Lt(Kt.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const i=new Kt(e,t);this.$r=this.$r.add(i),this.Kr=this.Kr.add(i)}Gr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.zr(new Kt(e,t))}jr(e,t){e.forEach(i=>this.removeReference(i,t))}Hr(e){const t=new Ee(new rt([])),i=new Kt(t,e),o=new Kt(t,e+1),c=[];return this.Kr.forEachInRange([i,o],d=>{this.zr(d),c.push(d.key)}),c}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new Ee(new rt([])),i=new Kt(t,e),o=new Kt(t,e+1);let c=Be();return this.Kr.forEachInRange([i,o],d=>{c=c.add(d.key)}),c}containsKey(e){const t=new Kt(e,0),i=this.$r.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Kt{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return Ee.comparator(e.key,t.key)||Me(e.Zr,t.Zr)}static Wr(e,t){return Me(e.Zr,t.Zr)||Ee.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yD{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new Lt(Kt.Ur)}checkEmpty(e){return le.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,o){const c=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new P1(c,t,i,o);this.mutationQueue.push(d);for(const m of o)this.Xr=this.Xr.add(new Kt(m.key,c)),this.indexManager.addToCollectionParentIndex(e,m.key.path.popLast());return le.resolve(d)}lookupMutationBatch(e,t){return le.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,o=this.ti(i),c=o<0?0:o;return le.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return le.resolve(this.mutationQueue.length===0?Rg:this.nr-1)}getAllMutationBatches(e){return le.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Kt(t,0),o=new Kt(t,Number.POSITIVE_INFINITY),c=[];return this.Xr.forEachInRange([i,o],d=>{const m=this.ei(d.Zr);c.push(m)}),le.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Lt(Me);return t.forEach(o=>{const c=new Kt(o,0),d=new Kt(o,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([c,d],m=>{i=i.add(m.Zr)})}),le.resolve(this.ni(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,o=i.length+1;let c=i;Ee.isDocumentKey(c)||(c=c.child(""));const d=new Kt(new Ee(c),0);let m=new Lt(Me);return this.Xr.forEachWhile(p=>{const v=p.key.path;return!!i.isPrefixOf(v)&&(v.length===o&&(m=m.add(p.Zr)),!0)},d),le.resolve(this.ni(m))}ni(e){const t=[];return e.forEach(i=>{const o=this.ei(i);o!==null&&t.push(o)}),t}removeMutationBatch(e,t){Ke(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Xr;return le.forEach(t.mutations,o=>{const c=new Kt(o.key,t.batchId);return i=i.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.Xr=i})}sr(e){}containsKey(e,t){const i=new Kt(t,0),o=this.Xr.firstAfterOrEqual(i);return le.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,le.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _D{constructor(e){this.ii=e,this.docs=function(){return new vt(Ee.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,o=this.docs.get(i),c=o?o.size:0,d=this.ii(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-c,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return le.resolve(i?i.document.mutableCopy():Yt.newInvalidDocument(t))}getEntries(e,t){let i=Ia();return t.forEach(o=>{const c=this.docs.get(o);i=i.insert(o,c?c.document.mutableCopy():Yt.newInvalidDocument(o))}),le.resolve(i)}getDocumentsMatchingQuery(e,t,i,o){let c=Ia();const d=t.path,m=new Ee(d.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(m);for(;p.hasNext();){const{key:v,value:{document:_}}=p.getNext();if(!d.isPrefixOf(v.path))break;v.path.length>d.length+1||XR(QR(_),i)<=0||(o.has(_.key)||Fh(t,_))&&(c=c.insert(_.key,_.mutableCopy()))}return le.resolve(c)}getAllFromCollectionGroup(e,t,i,o){Te(9500)}si(e,t){return le.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new ED(this)}getSize(e){return le.resolve(this.size)}}class ED extends hD{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((i,o)=>{o.isValidDocument()?t.push(this.Br.addEntry(e,o)):this.Br.removeEntry(i)}),le.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bD{constructor(e){this.persistence=e,this.oi=new Mr(t=>Mg(t),Pg),this.lastRemoteSnapshotVersion=Ae.min(),this.highestTargetId=0,this._i=0,this.ai=new Fg,this.targetCount=0,this.ui=Xo.cr()}forEachTarget(e,t){return this.oi.forEach((i,o)=>t(o)),le.resolve()}getLastRemoteSnapshotVersion(e){return le.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return le.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),le.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this._i&&(this._i=t),le.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new Xo(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,le.resolve()}updateTargetData(e,t){return this.Tr(t),le.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,le.resolve()}removeTargets(e,t,i){let o=0;const c=[];return this.oi.forEach((d,m)=>{m.sequenceNumber<=t&&i.get(m.targetId)===null&&(this.oi.delete(d),c.push(this.removeMatchingKeysForTargetId(e,m.targetId)),o++)}),le.waitFor(c).next(()=>o)}getTargetCount(e){return le.resolve(this.targetCount)}getTargetData(e,t){const i=this.oi.get(t)||null;return le.resolve(i)}addMatchingKeys(e,t,i){return this.ai.Gr(t,i),le.resolve()}removeMatchingKeys(e,t,i){this.ai.jr(t,i);const o=this.persistence.referenceDelegate,c=[];return o&&t.forEach(d=>{c.push(o.markPotentiallyOrphaned(e,d))}),le.waitFor(c)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),le.resolve()}getMatchingKeysForTargetId(e,t){const i=this.ai.Yr(t);return le.resolve(i)}containsKey(e,t){return le.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l0{constructor(e,t){this.ci={},this.overlays={},this.li=new kh(0),this.hi=!1,this.hi=!0,this.Pi=new vD,this.referenceDelegate=e(this),this.Ti=new bD(this),this.indexManager=new iD,this.remoteDocumentCache=function(o){return new _D(o)}(i=>this.referenceDelegate.Ii(i)),this.serializer=new sD(t),this.Ei=new pD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new gD,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ci[e.toKey()];return i||(i=new yD(t,this.referenceDelegate),this.ci[e.toKey()]=i),i}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,i){me("MemoryPersistence","Starting transaction:",e);const o=new TD(this.li.next());return this.referenceDelegate.di(),i(o).next(c=>this.referenceDelegate.Ai(o).next(()=>c)).toPromise().then(c=>(o.raiseOnCommittedEvent(),c))}Ri(e,t){return le.or(Object.values(this.ci).map(i=>()=>i.containsKey(e,t)))}}class TD extends ZR{constructor(e){super(),this.currentSequenceNumber=e}}class qg{constructor(e){this.persistence=e,this.Vi=new Fg,this.mi=null}static fi(e){return new qg(e)}get gi(){if(this.mi)return this.mi;throw Te(60996)}addReference(e,t,i){return this.Vi.addReference(i,t),this.gi.delete(i.toString()),le.resolve()}removeReference(e,t,i){return this.Vi.removeReference(i,t),this.gi.add(i.toString()),le.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),le.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(o=>this.gi.add(o.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(o=>{o.forEach(c=>this.gi.add(c.toString()))}).next(()=>i.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return le.forEach(this.gi,i=>{const o=Ee.fromPath(i);return this.pi(e,o).next(c=>{c||t.removeEntry(o,Ae.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(i=>{i?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return le.or([()=>le.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class bh{constructor(e,t){this.persistence=e,this.yi=new Mr(i=>t1(i.path),(i,o)=>i.isEqual(o)),this.garbageCollector=dD(this,t)}static fi(e,t){return new bh(e,t)}di(){}Ai(e){return le.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(o=>i+o))}br(e){let t=0;return this.yr(e,i=>{t++}).next(()=>t)}yr(e,t){return le.forEach(this.yi,(i,o)=>this.Dr(e,i,o).next(c=>c?le.resolve():t(o)))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const o=this.persistence.getRemoteDocumentCache(),c=o.newChangeBuffer();return o.si(e,d=>this.Dr(e,d,t).next(m=>{m||(i++,c.removeEntry(d,Ae.min()))})).next(()=>c.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),le.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.yi.set(i,e.currentSequenceNumber),le.resolve()}removeReference(e,t,i){return this.yi.set(i,e.currentSequenceNumber),le.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),le.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Jd(e.data.value)),t}Dr(e,t,i){return le.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.yi.get(t);return le.resolve(o!==void 0&&o>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bg{constructor(e,t,i,o){this.targetId=e,this.fromCache=t,this.ds=i,this.As=o}static Rs(e,t){let i=Be(),o=Be();for(const c of t.docChanges)switch(c.type){case 0:i=i.add(c.doc.key);break;case 1:o=o.add(c.doc.key)}return new Bg(e,t.fromCache,i,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xD{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return nC()?8:JR(pn())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,i,o){const c={result:null};return this.ws(e,t).next(d=>{c.result=d}).next(()=>{if(!c.result)return this.bs(e,t,o,i).next(d=>{c.result=d})}).next(()=>{if(c.result)return;const d=new ND;return this.Ss(e,t,d).next(m=>{if(c.result=m,this.fs)return this.Ds(e,t,d,m.size)})}).next(()=>c.result)}Ds(e,t,i,o){return i.documentReadCount<this.gs?(Oo()<=Fe.DEBUG&&me("QueryEngine","SDK will not create cache indexes for query:",Mo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),le.resolve()):(Oo()<=Fe.DEBUG&&me("QueryEngine","Query:",Mo(t),"scans",i.documentReadCount,"local documents and returns",o,"documents as results."),i.documentReadCount>this.ps*o?(Oo()<=Fe.DEBUG&&me("QueryEngine","The SDK decides to create cache indexes for query:",Mo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,zs(t))):le.resolve())}ws(e,t){if(Wb(t))return le.resolve(null);let i=zs(t);return this.indexManager.getIndexType(e,i).next(o=>o===0?null:(t.limit!==null&&o===1&&(t=Wp(t,null,"F"),i=zs(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(c=>{const d=Be(...c);return this.ys.getDocuments(e,d).next(m=>this.indexManager.getMinOffset(e,i).next(p=>{const v=this.vs(t,m);return this.Cs(t,v,d,p.readTime)?this.ws(e,Wp(t,null,"F")):this.Fs(e,v,t,p)}))})))}bs(e,t,i,o){return Wb(t)||o.isEqual(Ae.min())?le.resolve(null):this.ys.getDocuments(e,i).next(c=>{const d=this.vs(t,c);return this.Cs(t,d,i,o)?le.resolve(null):(Oo()<=Fe.DEBUG&&me("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Mo(t)),this.Fs(e,d,t,YR(o,Fc)).next(m=>m))})}vs(e,t){let i=new Lt(Vx(e));return t.forEach((o,c)=>{Fh(e,c)&&(i=i.add(c))}),i}Cs(e,t,i,o){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const c=e.limitType==="F"?t.last():t.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(o)>0)}Ss(e,t,i){return Oo()<=Fe.DEBUG&&me("QueryEngine","Using full collection scan to execute query:",Mo(t)),this.ys.getDocumentsMatchingQuery(e,t,Ei.min(),i)}Fs(e,t,i,o){return this.ys.getDocumentsMatchingQuery(e,i,o).next(c=>(t.forEach(d=>{c=c.insert(d.key,d)}),c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zg="LocalStore",AD=3e8;class SD{constructor(e,t,i,o){this.persistence=e,this.Ms=t,this.serializer=o,this.xs=new vt(Me),this.Os=new Mr(c=>Mg(c),Pg),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(i)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new mD(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function wD(s,e,t,i){return new SD(s,e,t,i)}async function c0(s,e){const t=je(s);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let o;return t.mutationQueue.getAllMutationBatches(i).next(c=>(o=c,t.Ls(e),t.mutationQueue.getAllMutationBatches(i))).next(c=>{const d=[],m=[];let p=Be();for(const v of o){d.push(v.batchId);for(const _ of v.mutations)p=p.add(_.key)}for(const v of c){m.push(v.batchId);for(const _ of v.mutations)p=p.add(_.key)}return t.localDocuments.getDocuments(i,p).next(v=>({ks:v,removedBatchIds:d,addedBatchIds:m}))})})}function CD(s,e){const t=je(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const o=e.batch.keys(),c=t.Bs.newChangeBuffer({trackRemovals:!0});return function(m,p,v,_){const T=v.batch,x=T.keys();let C=le.resolve();return x.forEach(N=>{C=C.next(()=>_.getEntry(p,N)).next(M=>{const S=v.docVersions.get(N);Ke(S!==null,48541),M.version.compareTo(S)<0&&(T.applyToRemoteDocument(M,v),M.isValidDocument()&&(M.setReadTime(v.commitVersion),_.addEntry(M)))})}),C.next(()=>m.mutationQueue.removeMutationBatch(p,T))}(t,i,e,c).next(()=>c.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,o,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(m){let p=Be();for(let v=0;v<m.mutationResults.length;++v)m.mutationResults[v].transformResults.length>0&&(p=p.add(m.batch.mutations[v].key));return p}(e))).next(()=>t.localDocuments.getDocuments(i,o))})}function u0(s){const e=je(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function jD(s,e){const t=je(s),i=e.snapshotVersion;let o=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",c=>{const d=t.Bs.newChangeBuffer({trackRemovals:!0});o=t.xs;const m=[];e.targetChanges.forEach((_,T)=>{const x=o.get(T);if(!x)return;m.push(t.Ti.removeMatchingKeys(c,_.removedDocuments,T).next(()=>t.Ti.addMatchingKeys(c,_.addedDocuments,T)));let C=x.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(T)!==null?C=C.withResumeToken(on.EMPTY_BYTE_STRING,Ae.min()).withLastLimboFreeSnapshotVersion(Ae.min()):_.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(_.resumeToken,i)),o=o.insert(T,C),function(M,S,U){return M.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=AD?!0:U.addedDocuments.size+U.modifiedDocuments.size+U.removedDocuments.size>0}(x,C,_)&&m.push(t.Ti.updateTargetData(c,C))});let p=Ia(),v=Be();if(e.documentUpdates.forEach(_=>{e.resolvedLimboDocuments.has(_)&&m.push(t.persistence.referenceDelegate.updateLimboDocument(c,_))}),m.push(ID(c,d,e.documentUpdates).next(_=>{p=_.qs,v=_.Qs})),!i.isEqual(Ae.min())){const _=t.Ti.getLastRemoteSnapshotVersion(c).next(T=>t.Ti.setTargetsMetadata(c,c.currentSequenceNumber,i));m.push(_)}return le.waitFor(m).next(()=>d.apply(c)).next(()=>t.localDocuments.getLocalViewOfDocuments(c,p,v)).next(()=>p)}).then(c=>(t.xs=o,c))}function ID(s,e,t){let i=Be(),o=Be();return t.forEach(c=>i=i.add(c)),e.getEntries(s,i).next(c=>{let d=Ia();return t.forEach((m,p)=>{const v=c.get(m);p.isFoundDocument()!==v.isFoundDocument()&&(o=o.add(m)),p.isNoDocument()&&p.version.isEqual(Ae.min())?(e.removeEntry(m,p.readTime),d=d.insert(m,p)):!v.isValidDocument()||p.version.compareTo(v.version)>0||p.version.compareTo(v.version)===0&&v.hasPendingWrites?(e.addEntry(p),d=d.insert(m,p)):me(zg,"Ignoring outdated watch update for ",m,". Current version:",v.version," Watch version:",p.version)}),{qs:d,Qs:o}})}function RD(s,e){const t=je(s);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=Rg),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function DD(s,e){const t=je(s);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let o;return t.Ti.getTargetData(i,e).next(c=>c?(o=c,le.resolve(o)):t.Ti.allocateTargetId(i).next(d=>(o=new mi(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.Ti.addTargetData(i,o).next(()=>o))))}).then(i=>{const o=t.xs.get(i.targetId);return(o===null||i.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.xs=t.xs.insert(i.targetId,i),t.Os.set(e,i.targetId)),i})}async function tg(s,e,t){const i=je(s),o=i.xs.get(e),c=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",c,d=>i.persistence.referenceDelegate.removeTarget(d,o))}catch(d){if(!al(d))throw d;me(zg,`Failed to update sequence numbers for target ${e}: ${d}`)}i.xs=i.xs.remove(e),i.Os.delete(o.target)}function uT(s,e,t){const i=je(s);let o=Ae.min(),c=Be();return i.persistence.runTransaction("Execute query","readwrite",d=>function(p,v,_){const T=je(p),x=T.Os.get(_);return x!==void 0?le.resolve(T.xs.get(x)):T.Ti.getTargetData(v,_)}(i,d,zs(e)).next(m=>{if(m)return o=m.lastLimboFreeSnapshotVersion,i.Ti.getMatchingKeysForTargetId(d,m.targetId).next(p=>{c=p})}).next(()=>i.Ms.getDocumentsMatchingQuery(d,e,t?o:Ae.min(),t?c:Be())).next(m=>(OD(i,E1(e),m),{documents:m,$s:c})))}function OD(s,e,t){let i=s.Ns.get(e)||Ae.min();t.forEach((o,c)=>{c.readTime.compareTo(i)>0&&(i=c.readTime)}),s.Ns.set(e,i)}class dT{constructor(){this.activeTargetIds=S1()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class MD{constructor(){this.xo=new dT,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,i){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new dT,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PD{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hT="ConnectivityMonitor";class fT{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){me(hT,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){me(hT,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hd=null;function ng(){return Hd===null?Hd=function(){return 268435456+Math.round(2147483648*Math.random())}():Hd++,"0x"+Hd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bp="RestConnection",kD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class VD{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${i}/databases/${o}`,this.Go=this.databaseId.database===ph?`project_id=${i}`:`project_id=${i}&database_id=${o}`}zo(e,t,i,o,c){const d=ng(),m=this.jo(e,t.toUriEncodedString());me(bp,`Sending RPC '${e}' ${d}:`,m,i);const p={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(p,o,c);const{host:v}=new URL(m),_=Dr(v);return this.Jo(e,m,p,i,_).then(T=>(me(bp,`Received RPC '${e}' ${d}: `,T),T),T=>{throw $o(bp,`RPC '${e}' ${d} failed with error: `,T,"url: ",m,"request:",i),T})}Yo(e,t,i,o,c,d){return this.zo(e,t,i,o,c)}Ho(e,t,i){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+nl}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((o,c)=>e[c]=o),i&&i.headers.forEach((o,c)=>e[c]=o)}jo(e,t){const i=kD[e];return`${this.Ko}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LD{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dn="WebChannelConnection";class UD extends VD{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,o,c){const d=ng();return new Promise((m,p)=>{const v=new ux;v.setWithCredentials(!0),v.listenOnce(dx.COMPLETE,()=>{try{switch(v.getLastErrorCode()){case Zd.NO_ERROR:const T=v.getResponseJson();me(dn,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(T)),m(T);break;case Zd.TIMEOUT:me(dn,`RPC '${e}' ${d} timed out`),p(new fe(re.DEADLINE_EXCEEDED,"Request time out"));break;case Zd.HTTP_ERROR:const x=v.getStatus();if(me(dn,`RPC '${e}' ${d} failed with status:`,x,"response text:",v.getResponseText()),x>0){let C=v.getResponseJson();Array.isArray(C)&&(C=C[0]);const N=C?.error;if(N&&N.status&&N.message){const M=function(U){const $=U.toLowerCase().replace(/_/g,"-");return Object.values(re).indexOf($)>=0?$:re.UNKNOWN}(N.status);p(new fe(M,N.message))}else p(new fe(re.UNKNOWN,"Server responded with status "+v.getStatus()))}else p(new fe(re.UNAVAILABLE,"Connection failed."));break;default:Te(9055,{h_:e,streamId:d,P_:v.getLastErrorCode(),T_:v.getLastError()})}}finally{me(dn,`RPC '${e}' ${d} completed.`)}});const _=JSON.stringify(o);me(dn,`RPC '${e}' ${d} sending request:`,o),v.send(t,"POST",_,i,15)})}I_(e,t,i){const o=ng(),c=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=mx(),m=fx(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},v=this.longPollingOptions.timeoutSeconds;v!==void 0&&(p.longPollingTimeout=Math.round(1e3*v)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Ho(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const _=c.join("");me(dn,`Creating RPC '${e}' stream ${o}: ${_}`,p);const T=d.createWebChannel(_,p);this.E_(T);let x=!1,C=!1;const N=new LD({Zo:S=>{C?me(dn,`Not sending because RPC '${e}' stream ${o} is closed:`,S):(x||(me(dn,`Opening RPC '${e}' stream ${o} transport.`),T.open(),x=!0),me(dn,`RPC '${e}' stream ${o} sending:`,S),T.send(S))},Xo:()=>T.close()}),M=(S,U,$)=>{S.listen(U,F=>{try{$(F)}catch(V){setTimeout(()=>{throw V},0)}})};return M(T,bc.EventType.OPEN,()=>{C||(me(dn,`RPC '${e}' stream ${o} transport opened.`),N.__())}),M(T,bc.EventType.CLOSE,()=>{C||(C=!0,me(dn,`RPC '${e}' stream ${o} transport closed`),N.u_(),this.d_(T))}),M(T,bc.EventType.ERROR,S=>{C||(C=!0,$o(dn,`RPC '${e}' stream ${o} transport errored. Name:`,S.name,"Message:",S.message),N.u_(new fe(re.UNAVAILABLE,"The operation could not be completed")))}),M(T,bc.EventType.MESSAGE,S=>{var U;if(!C){const $=S.data[0];Ke(!!$,16349);const F=$,V=F?.error||((U=F[0])===null||U===void 0?void 0:U.error);if(V){me(dn,`RPC '${e}' stream ${o} received error:`,V);const B=V.status;let ee=function(R){const I=It[R];if(I!==void 0)return Xx(I)}(B),D=V.message;ee===void 0&&(ee=re.INTERNAL,D="Unknown error status: "+B+" with message "+V.message),C=!0,N.u_(new fe(ee,D)),T.close()}else me(dn,`RPC '${e}' stream ${o} received:`,$),N.c_($)}}),M(m,hx.STAT_EVENT,S=>{S.stat===Hp.PROXY?me(dn,`RPC '${e}' stream ${o} detected buffering proxy`):S.stat===Hp.NOPROXY&&me(dn,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{N.a_()},0),N}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}function Tp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gh(s){return new z1(s,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg{constructor(e,t,i=1e3,o=1.5,c=6e4){this.xi=e,this.timerId=t,this.A_=i,this.R_=o,this.V_=c,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),i=Math.max(0,Date.now()-this.g_),o=Math.max(0,t-i);o>0&&me("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,o,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mT="PersistentStream";class d0{constructor(e,t,i,o,c,d,m,p){this.xi=e,this.S_=i,this.D_=o,this.connection=c,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=m,this.listener=p,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new Hg(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===re.RESOURCE_EXHAUSTED?(ja(t.toString()),ja("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,o])=>{this.v_===t&&this.z_(i,o)},i=>{e(()=>{const o=new fe(re.UNKNOWN,"Fetching auth token failed: "+i.message);return this.j_(o)})})}z_(e,t){const i=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{i(()=>this.listener.e_())}),this.stream.n_(()=>{i(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(o=>{i(()=>this.j_(o))}),this.stream.onMessage(o=>{i(()=>++this.M_==1?this.J_(o):this.onNext(o))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return me(mT,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(me(mT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class FD extends d0{constructor(e,t,i,o,c,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,o,d),this.serializer=c}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=K1(this.serializer,e),i=function(c){if(!("targetChange"in c))return Ae.min();const d=c.targetChange;return d.targetIds&&d.targetIds.length?Ae.min():d.readTime?zn(d.readTime):Ae.min()}(e);return this.listener.Y_(t,i)}Z_(e){const t={};t.database=eg(this.serializer),t.addTarget=function(c,d){let m;const p=d.target;if(m=Qp(p)?{documents:Q1(c,p)}:{query:X1(c,p).gt},m.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){m.resumeToken=Jx(c,d.resumeToken);const v=Zp(c,d.expectedCount);v!==null&&(m.expectedCount=v)}else if(d.snapshotVersion.compareTo(Ae.min())>0){m.readTime=_h(c,d.snapshotVersion.toTimestamp());const v=Zp(c,d.expectedCount);v!==null&&(m.expectedCount=v)}return m}(this.serializer,e);const i=Z1(this.serializer,e);i&&(t.labels=i),this.Q_(t)}X_(e){const t={};t.database=eg(this.serializer),t.removeTarget=e,this.Q_(t)}}class qD extends d0{constructor(e,t,i,o,c,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,o,d),this.serializer=c}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return Ke(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ke(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){Ke(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=Y1(e.writeResults,e.commitTime),i=zn(e.commitTime);return this.listener.ra(i,t)}ia(){const e={};e.database=eg(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>s0(this.serializer,i))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BD{}class zD extends BD{constructor(e,t,i,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=o,this.sa=!1}oa(){if(this.sa)throw new fe(re.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,i,o){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,d])=>this.connection.zo(e,Jp(t,i),o,c,d)).catch(c=>{throw c.name==="FirebaseError"?(c.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new fe(re.UNKNOWN,c.toString())})}Yo(e,t,i,o,c){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([d,m])=>this.connection.Yo(e,Jp(t,i),o,d,m,c)).catch(d=>{throw d.name==="FirebaseError"?(d.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new fe(re.UNKNOWN,d.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class HD{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(ja(t),this.ua=!1):me("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cr="RemoteStore";class GD{constructor(e,t,i,o,c){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=c,this.Ra.No(d=>{i.enqueueAndForget(async()=>{Pr(this)&&(me(Cr,"Restarting streams for network reachability change."),await async function(p){const v=je(p);v.da.add(4),await iu(v),v.Va.set("Unknown"),v.da.delete(4),await $h(v)}(this))})}),this.Va=new HD(i,o)}}async function $h(s){if(Pr(s))for(const e of s.Aa)await e(!0)}async function iu(s){for(const e of s.Aa)await e(!1)}function h0(s,e){const t=je(s);t.Ea.has(e.targetId)||(t.Ea.set(e.targetId,e),Yg(t)?Kg(t):rl(t).N_()&&$g(t,e))}function Gg(s,e){const t=je(s),i=rl(t);t.Ea.delete(e),i.N_()&&f0(t,e),t.Ea.size===0&&(i.N_()?i.k_():Pr(t)&&t.Va.set("Unknown"))}function $g(s,e){if(s.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ae.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}rl(s).Z_(e)}function f0(s,e){s.ma.Ke(e),rl(s).X_(e)}function Kg(s){s.ma=new U1({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>s.Ea.get(e)||null,Pt:()=>s.datastore.serializer.databaseId}),rl(s).start(),s.Va.ca()}function Yg(s){return Pr(s)&&!rl(s).O_()&&s.Ea.size>0}function Pr(s){return je(s).da.size===0}function m0(s){s.ma=void 0}async function $D(s){s.Va.set("Online")}async function KD(s){s.Ea.forEach((e,t)=>{$g(s,e)})}async function YD(s,e){m0(s),Yg(s)?(s.Va.Pa(e),Kg(s)):s.Va.set("Unknown")}async function QD(s,e,t){if(s.Va.set("Online"),e instanceof Zx&&e.state===2&&e.cause)try{await async function(o,c){const d=c.cause;for(const m of c.targetIds)o.Ea.has(m)&&(await o.remoteSyncer.rejectListen(m,d),o.Ea.delete(m),o.ma.removeTarget(m))}(s,e)}catch(i){me(Cr,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Th(s,i)}else if(e instanceof nh?s.ma.Xe(e):e instanceof Wx?s.ma.ot(e):s.ma.nt(e),!t.isEqual(Ae.min()))try{const i=await u0(s.localStore);t.compareTo(i)>=0&&await function(c,d){const m=c.ma.It(d);return m.targetChanges.forEach((p,v)=>{if(p.resumeToken.approximateByteSize()>0){const _=c.Ea.get(v);_&&c.Ea.set(v,_.withResumeToken(p.resumeToken,d))}}),m.targetMismatches.forEach((p,v)=>{const _=c.Ea.get(p);if(!_)return;c.Ea.set(p,_.withResumeToken(on.EMPTY_BYTE_STRING,_.snapshotVersion)),f0(c,p);const T=new mi(_.target,p,v,_.sequenceNumber);$g(c,T)}),c.remoteSyncer.applyRemoteEvent(m)}(s,t)}catch(i){me(Cr,"Failed to raise snapshot:",i),await Th(s,i)}}async function Th(s,e,t){if(!al(e))throw e;s.da.add(1),await iu(s),s.Va.set("Offline"),t||(t=()=>u0(s.localStore)),s.asyncQueue.enqueueRetryable(async()=>{me(Cr,"Retrying IndexedDB access"),await t(),s.da.delete(1),await $h(s)})}function p0(s,e){return e().catch(t=>Th(s,t,e))}async function Kh(s){const e=je(s),t=xi(e);let i=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:Rg;for(;XD(e);)try{const o=await RD(e.localStore,i);if(o===null){e.Ia.length===0&&t.k_();break}i=o.batchId,WD(e,o)}catch(o){await Th(e,o)}g0(e)&&v0(e)}function XD(s){return Pr(s)&&s.Ia.length<10}function WD(s,e){s.Ia.push(e);const t=xi(s);t.N_()&&t.ea&&t.ta(e.mutations)}function g0(s){return Pr(s)&&!xi(s).O_()&&s.Ia.length>0}function v0(s){xi(s).start()}async function ZD(s){xi(s).ia()}async function JD(s){const e=xi(s);for(const t of s.Ia)e.ta(t.mutations)}async function eO(s,e,t){const i=s.Ia.shift(),o=Vg.from(i,e,t);await p0(s,()=>s.remoteSyncer.applySuccessfulWrite(o)),await Kh(s)}async function tO(s,e){e&&xi(s).ea&&await async function(i,o){if(function(d){return Qx(d)&&d!==re.ABORTED}(o.code)){const c=i.Ia.shift();xi(i).L_(),await p0(i,()=>i.remoteSyncer.rejectFailedWrite(c.batchId,o)),await Kh(i)}}(s,e),g0(s)&&v0(s)}async function pT(s,e){const t=je(s);t.asyncQueue.verifyOperationInProgress(),me(Cr,"RemoteStore received new credentials");const i=Pr(t);t.da.add(3),await iu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await $h(t)}async function nO(s,e){const t=je(s);e?(t.da.delete(2),await $h(t)):e||(t.da.add(2),await iu(t),t.Va.set("Unknown"))}function rl(s){return s.fa||(s.fa=function(t,i,o){const c=je(t);return c.oa(),new FD(i,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)}(s.datastore,s.asyncQueue,{e_:$D.bind(null,s),n_:KD.bind(null,s),i_:YD.bind(null,s),Y_:QD.bind(null,s)}),s.Aa.push(async e=>{e?(s.fa.L_(),Yg(s)?Kg(s):s.Va.set("Unknown")):(await s.fa.stop(),m0(s))})),s.fa}function xi(s){return s.ga||(s.ga=function(t,i,o){const c=je(t);return c.oa(),new qD(i,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)}(s.datastore,s.asyncQueue,{e_:()=>Promise.resolve(),n_:ZD.bind(null,s),i_:tO.bind(null,s),na:JD.bind(null,s),ra:eO.bind(null,s)}),s.Aa.push(async e=>{e?(s.ga.L_(),await Kh(s)):(await s.ga.stop(),s.Ia.length>0&&(me(Cr,`Stopping write stream with ${s.Ia.length} pending writes`),s.Ia=[]))})),s.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qg{constructor(e,t,i,o,c){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=o,this.removalCallback=c,this.deferred=new Bs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(d=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,o,c){const d=Date.now()+i,m=new Qg(e,t,d,o,c);return m.start(i),m}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new fe(re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Xg(s,e){if(ja("AsyncQueue",`${e}: ${s}`),al(s))return new fe(re.UNAVAILABLE,`${e}: ${s}`);throw s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{static emptySet(e){return new zo(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Ee.comparator(t.key,i.key):(t,i)=>Ee.comparator(t.key,i.key),this.keyedMap=Tc(),this.sortedSet=new vt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof zo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=i.getNext().key;if(!o.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new zo;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gT{constructor(){this.pa=new vt(Ee.comparator)}track(e){const t=e.doc.key,i=this.pa.get(t);i?e.type!==0&&i.type===3?this.pa=this.pa.insert(t,e):e.type===3&&i.type!==1?this.pa=this.pa.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.pa=this.pa.remove(t):e.type===1&&i.type===2?this.pa=this.pa.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):Te(63341,{Vt:e,ya:i}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal((t,i)=>{e.push(i)}),e}}class Wo{constructor(e,t,i,o,c,d,m,p,v){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=o,this.mutatedKeys=c,this.fromCache=d,this.syncStateChanged=m,this.excludesMetadataChanges=p,this.hasCachedResults=v}static fromInitialDocuments(e,t,i,o,c){const d=[];return t.forEach(m=>{d.push({type:0,doc:m})}),new Wo(e,t,zo.emptySet(t),d,i,o,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Uh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==i[o].type||!t[o].doc.isEqual(i[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class aO{constructor(){this.queries=vT(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const o=je(t),c=o.queries;o.queries=vT(),c.forEach((d,m)=>{for(const p of m.Sa)p.onError(i)})})(this,new fe(re.ABORTED,"Firestore shutting down"))}}function vT(){return new Mr(s=>kx(s),Uh)}async function Wg(s,e){const t=je(s);let i=3;const o=e.query;let c=t.queries.get(o);c?!c.Da()&&e.va()&&(i=2):(c=new sO,i=e.va()?0:1);try{switch(i){case 0:c.ba=await t.onListen(o,!0);break;case 1:c.ba=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(d){const m=Xg(d,`Initialization of query '${Mo(e.query)}' failed`);return void e.onError(m)}t.queries.set(o,c),c.Sa.push(e),e.Fa(t.onlineState),c.ba&&e.Ma(c.ba)&&Jg(t)}async function Zg(s,e){const t=je(s),i=e.query;let o=3;const c=t.queries.get(i);if(c){const d=c.Sa.indexOf(e);d>=0&&(c.Sa.splice(d,1),c.Sa.length===0?o=e.va()?0:1:!c.Da()&&e.va()&&(o=2))}switch(o){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function iO(s,e){const t=je(s);let i=!1;for(const o of e){const c=o.query,d=t.queries.get(c);if(d){for(const m of d.Sa)m.Ma(o)&&(i=!0);d.ba=o}}i&&Jg(t)}function rO(s,e,t){const i=je(s),o=i.queries.get(e);if(o)for(const c of o.Sa)c.onError(t);i.queries.delete(e)}function Jg(s){s.Ca.forEach(e=>{e.next()})}var sg,yT;(yT=sg||(sg={})).xa="default",yT.Cache="cache";class ev{constructor(e,t,i){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=i||{}}Ma(e){if(!this.options.includeMetadataChanges){const i=[];for(const o of e.docChanges)o.type!==3&&i.push(o);e=new Wo(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache||!this.va())return!0;const i=t!=="Offline";return(!this.options.Qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}qa(e){e=Wo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==sg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0{constructor(e){this.key=e}}class _0{constructor(e){this.key=e}}class oO{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Be(),this.mutatedKeys=Be(),this.Za=Vx(e),this.Xa=new zo(this.Za)}get eu(){return this.Ha}tu(e,t){const i=t?t.nu:new gT,o=t?t.Xa:this.Xa;let c=t?t.mutatedKeys:this.mutatedKeys,d=o,m=!1;const p=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,v=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((_,T)=>{const x=o.get(_),C=Fh(this.query,T)?T:null,N=!!x&&this.mutatedKeys.has(x.key),M=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let S=!1;x&&C?x.data.isEqual(C.data)?N!==M&&(i.track({type:3,doc:C}),S=!0):this.ru(x,C)||(i.track({type:2,doc:C}),S=!0,(p&&this.Za(C,p)>0||v&&this.Za(C,v)<0)&&(m=!0)):!x&&C?(i.track({type:0,doc:C}),S=!0):x&&!C&&(i.track({type:1,doc:x}),S=!0,(p||v)&&(m=!0)),S&&(C?(d=d.add(C),c=M?c.add(_):c.delete(_)):(d=d.delete(_),c=c.delete(_)))}),this.query.limit!==null)for(;d.size>this.query.limit;){const _=this.query.limitType==="F"?d.last():d.first();d=d.delete(_.key),c=c.delete(_.key),i.track({type:1,doc:_})}return{Xa:d,nu:i,Cs:m,mutatedKeys:c}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,o){const c=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const d=e.nu.wa();d.sort((_,T)=>function(C,N){const M=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Te(20277,{Vt:S})}};return M(C)-M(N)}(_.type,T.type)||this.Za(_.doc,T.doc)),this.iu(i),o=o!=null&&o;const m=t&&!o?this.su():[],p=this.Ya.size===0&&this.current&&!o?1:0,v=p!==this.Ja;return this.Ja=p,d.length!==0||v?{snapshot:new Wo(this.query,e.Xa,c,d,e.mutatedKeys,p===0,v,!1,!!i&&i.resumeToken.approximateByteSize()>0),ou:m}:{ou:m}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new gT,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=Be(),this.Xa.forEach(i=>{this._u(i.key)&&(this.Ya=this.Ya.add(i.key))});const t=[];return e.forEach(i=>{this.Ya.has(i)||t.push(new _0(i))}),this.Ya.forEach(i=>{e.has(i)||t.push(new y0(i))}),t}au(e){this.Ha=e.$s,this.Ya=Be();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return Wo.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const tv="SyncEngine";class lO{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class cO{constructor(e){this.key=e,this.cu=!1}}class uO{constructor(e,t,i,o,c,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=o,this.currentUser=c,this.maxConcurrentLimboResolutions=d,this.lu={},this.hu=new Mr(m=>kx(m),Uh),this.Pu=new Map,this.Tu=new Set,this.Iu=new vt(Ee.comparator),this.Eu=new Map,this.du=new Fg,this.Au={},this.Ru=new Map,this.Vu=Xo.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function dO(s,e,t=!0){const i=A0(s);let o;const c=i.hu.get(e);return c?(i.sharedClientState.addLocalQueryTarget(c.targetId),o=c.view.uu()):o=await E0(i,e,t,!0),o}async function hO(s,e){const t=A0(s);await E0(t,e,!0,!1)}async function E0(s,e,t,i){const o=await DD(s.localStore,zs(e)),c=o.targetId,d=s.sharedClientState.addLocalQueryTarget(c,t);let m;return i&&(m=await fO(s,e,c,d==="current",o.resumeToken)),s.isPrimaryClient&&t&&h0(s.remoteStore,o),m}async function fO(s,e,t,i,o){s.fu=(T,x,C)=>async function(M,S,U,$){let F=S.view.tu(U);F.Cs&&(F=await uT(M.localStore,S.query,!1).then(({documents:D})=>S.view.tu(D,F)));const V=$&&$.targetChanges.get(S.targetId),B=$&&$.targetMismatches.get(S.targetId)!=null,ee=S.view.applyChanges(F,M.isPrimaryClient,V,B);return ET(M,S.targetId,ee.ou),ee.snapshot}(s,T,x,C);const c=await uT(s.localStore,e,!0),d=new oO(e,c.$s),m=d.tu(c.documents),p=au.createSynthesizedTargetChangeForCurrentChange(t,i&&s.onlineState!=="Offline",o),v=d.applyChanges(m,s.isPrimaryClient,p);ET(s,t,v.ou);const _=new lO(e,t,d);return s.hu.set(e,_),s.Pu.has(t)?s.Pu.get(t).push(e):s.Pu.set(t,[e]),v.snapshot}async function mO(s,e,t){const i=je(s),o=i.hu.get(e),c=i.Pu.get(o.targetId);if(c.length>1)return i.Pu.set(o.targetId,c.filter(d=>!Uh(d,e))),void i.hu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(o.targetId),i.sharedClientState.isActiveQueryTarget(o.targetId)||await tg(i.localStore,o.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(o.targetId),t&&Gg(i.remoteStore,o.targetId),ag(i,o.targetId)}).catch(sl)):(ag(i,o.targetId),await tg(i.localStore,o.targetId,!0))}async function pO(s,e){const t=je(s),i=t.hu.get(e),o=t.Pu.get(i.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Gg(t.remoteStore,i.targetId))}async function gO(s,e,t){const i=NO(s);try{const o=await function(d,m){const p=je(d),v=Vt.now(),_=m.reduce((C,N)=>C.add(N.key),Be());let T,x;return p.persistence.runTransaction("Locally write mutations","readwrite",C=>{let N=Ia(),M=Be();return p.Bs.getEntries(C,_).next(S=>{N=S,N.forEach((U,$)=>{$.isValidDocument()||(M=M.add(U))})}).next(()=>p.localDocuments.getOverlayedDocuments(C,N)).next(S=>{T=S;const U=[];for(const $ of m){const F=M1($,T.get($.key).overlayedDocument);F!=null&&U.push(new Mi($.key,F,Cx(F.value.mapValue),an.exists(!0)))}return p.mutationQueue.addMutationBatch(C,v,U,m)}).next(S=>{x=S;const U=S.applyToLocalDocumentSet(T,M);return p.documentOverlayCache.saveOverlays(C,S.batchId,U)})}).then(()=>({batchId:x.batchId,changes:Ux(T)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(o.batchId),function(d,m,p){let v=d.Au[d.currentUser.toKey()];v||(v=new vt(Me)),v=v.insert(m,p),d.Au[d.currentUser.toKey()]=v}(i,o.batchId,t),await ru(i,o.changes),await Kh(i.remoteStore)}catch(o){const c=Xg(o,"Failed to persist write");t.reject(c)}}async function b0(s,e){const t=je(s);try{const i=await jD(t.localStore,e);e.targetChanges.forEach((o,c)=>{const d=t.Eu.get(c);d&&(Ke(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.cu=!0:o.modifiedDocuments.size>0?Ke(d.cu,14607):o.removedDocuments.size>0&&(Ke(d.cu,42227),d.cu=!1))}),await ru(t,i,e)}catch(i){await sl(i)}}function _T(s,e,t){const i=je(s);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const o=[];i.hu.forEach((c,d)=>{const m=d.view.Fa(e);m.snapshot&&o.push(m.snapshot)}),function(d,m){const p=je(d);p.onlineState=m;let v=!1;p.queries.forEach((_,T)=>{for(const x of T.Sa)x.Fa(m)&&(v=!0)}),v&&Jg(p)}(i.eventManager,e),o.length&&i.lu.Y_(o),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function vO(s,e,t){const i=je(s);i.sharedClientState.updateQueryState(e,"rejected",t);const o=i.Eu.get(e),c=o&&o.key;if(c){let d=new vt(Ee.comparator);d=d.insert(c,Yt.newNoDocument(c,Ae.min()));const m=Be().add(c),p=new Hh(Ae.min(),new Map,new vt(Me),d,m);await b0(i,p),i.Iu=i.Iu.remove(c),i.Eu.delete(e),nv(i)}else await tg(i.localStore,e,!1).then(()=>ag(i,e,t)).catch(sl)}async function yO(s,e){const t=je(s),i=e.batch.batchId;try{const o=await CD(t.localStore,e);N0(t,i,null),T0(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await ru(t,o)}catch(o){await sl(o)}}async function _O(s,e,t){const i=je(s);try{const o=await function(d,m){const p=je(d);return p.persistence.runTransaction("Reject batch","readwrite-primary",v=>{let _;return p.mutationQueue.lookupMutationBatch(v,m).next(T=>(Ke(T!==null,37113),_=T.keys(),p.mutationQueue.removeMutationBatch(v,T))).next(()=>p.mutationQueue.performConsistencyCheck(v)).next(()=>p.documentOverlayCache.removeOverlaysForBatchId(v,_,m)).next(()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(v,_)).next(()=>p.localDocuments.getDocuments(v,_))})}(i.localStore,e);N0(i,e,t),T0(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await ru(i,o)}catch(o){await sl(o)}}function T0(s,e){(s.Ru.get(e)||[]).forEach(t=>{t.resolve()}),s.Ru.delete(e)}function N0(s,e,t){const i=je(s);let o=i.Au[i.currentUser.toKey()];if(o){const c=o.get(e);c&&(t?c.reject(t):c.resolve(),o=o.remove(e)),i.Au[i.currentUser.toKey()]=o}}function ag(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const i of s.Pu.get(e))s.hu.delete(i),t&&s.lu.gu(i,t);s.Pu.delete(e),s.isPrimaryClient&&s.du.Hr(e).forEach(i=>{s.du.containsKey(i)||x0(s,i)})}function x0(s,e){s.Tu.delete(e.path.canonicalString());const t=s.Iu.get(e);t!==null&&(Gg(s.remoteStore,t),s.Iu=s.Iu.remove(e),s.Eu.delete(t),nv(s))}function ET(s,e,t){for(const i of t)i instanceof y0?(s.du.addReference(i.key,e),EO(s,i)):i instanceof _0?(me(tv,"Document no longer in limbo: "+i.key),s.du.removeReference(i.key,e),s.du.containsKey(i.key)||x0(s,i.key)):Te(19791,{pu:i})}function EO(s,e){const t=e.key,i=t.path.canonicalString();s.Iu.get(t)||s.Tu.has(i)||(me(tv,"New document in limbo: "+t),s.Tu.add(i),nv(s))}function nv(s){for(;s.Tu.size>0&&s.Iu.size<s.maxConcurrentLimboResolutions;){const e=s.Tu.values().next().value;s.Tu.delete(e);const t=new Ee(rt.fromString(e)),i=s.Vu.next();s.Eu.set(i,new cO(t)),s.Iu=s.Iu.insert(t,i),h0(s.remoteStore,new mi(zs(Lh(t.path)),i,"TargetPurposeLimboResolution",kh.le))}}async function ru(s,e,t){const i=je(s),o=[],c=[],d=[];i.hu.isEmpty()||(i.hu.forEach((m,p)=>{d.push(i.fu(p,e,t).then(v=>{var _;if((v||t)&&i.isPrimaryClient){const T=v?!v.fromCache:(_=t?.targetChanges.get(p.targetId))===null||_===void 0?void 0:_.current;i.sharedClientState.updateQueryState(p.targetId,T?"current":"not-current")}if(v){o.push(v);const T=Bg.Rs(p.targetId,v);c.push(T)}}))}),await Promise.all(d),i.lu.Y_(o),await async function(p,v){const _=je(p);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",T=>le.forEach(v,x=>le.forEach(x.ds,C=>_.persistence.referenceDelegate.addReference(T,x.targetId,C)).next(()=>le.forEach(x.As,C=>_.persistence.referenceDelegate.removeReference(T,x.targetId,C)))))}catch(T){if(!al(T))throw T;me(zg,"Failed to update sequence numbers: "+T)}for(const T of v){const x=T.targetId;if(!T.fromCache){const C=_.xs.get(x),N=C.snapshotVersion,M=C.withLastLimboFreeSnapshotVersion(N);_.xs=_.xs.insert(x,M)}}}(i.localStore,c))}async function bO(s,e){const t=je(s);if(!t.currentUser.isEqual(e)){me(tv,"User change. New user:",e.toKey());const i=await c0(t.localStore,e);t.currentUser=e,function(c,d){c.Ru.forEach(m=>{m.forEach(p=>{p.reject(new fe(re.CANCELLED,d))})}),c.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await ru(t,i.ks)}}function TO(s,e){const t=je(s),i=t.Eu.get(e);if(i&&i.cu)return Be().add(i.key);{let o=Be();const c=t.Pu.get(e);if(!c)return o;for(const d of c){const m=t.hu.get(d);o=o.unionWith(m.view.eu)}return o}}function A0(s){const e=je(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=b0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=TO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=vO.bind(null,e),e.lu.Y_=iO.bind(null,e.eventManager),e.lu.gu=rO.bind(null,e.eventManager),e}function NO(s){const e=je(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=yO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=_O.bind(null,e),e}class Nh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Gh(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return wD(this.persistence,new xD,e.initialUser,this.serializer)}Su(e){return new l0(qg.fi,this.serializer)}bu(e){return new MD}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Nh.provider={build:()=>new Nh};class xO extends Nh{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){Ke(this.persistence.referenceDelegate instanceof bh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new cD(i,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?wn.withCacheSize(this.cacheSizeBytes):wn.DEFAULT;return new l0(i=>bh.fi(i,t),this.serializer)}}class ig{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>_T(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=bO.bind(null,this.syncEngine),await nO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new aO}()}createDatastore(e){const t=Gh(e.databaseInfo.databaseId),i=function(c){return new UD(c)}(e.databaseInfo);return function(c,d,m,p){return new zD(c,d,m,p)}(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return function(i,o,c,d,m){return new GD(i,o,c,d,m)}(this.localStore,this.datastore,e.asyncQueue,t=>_T(this.syncEngine,t,0),function(){return fT.C()?new fT:new PD}())}createSyncEngine(e,t){return function(o,c,d,m,p,v,_){const T=new uO(o,c,d,m,p,v);return _&&(T.mu=!0),T}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(o){const c=je(o);me(Cr,"RemoteStore shutting down."),c.da.add(5),await iu(c),c.Ra.shutdown(),c.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}ig.provider={build:()=>new ig};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):ja("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AO{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new fe(re.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(o,c){const d=je(o),m={documents:c.map(T=>Eh(d.serializer,T))},p=await d.Yo("BatchGetDocuments",d.serializer.databaseId,rt.emptyPath(),m,c.length),v=new Map;p.forEach(T=>{const x=$1(d.serializer,T);v.set(x.key.toString(),x)});const _=[];return c.forEach(T=>{const x=v.get(T.toString());Ke(!!x,55234,{key:T}),_.push(x)}),_}(this.datastore,e);return t.forEach(i=>this.recordVersion(i)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new zh(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,i)=>{const o=Ee.fromPath(i);this.mutations.push(new Yx(o,this.precondition(o)))}),await async function(i,o){const c=je(i),d={writes:o.map(m=>s0(c.serializer,m))};await c.zo("Commit",c.serializer.databaseId,rt.emptyPath(),d)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Te(50498,{Uu:e.constructor.name});t=Ae.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new fe(re.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Ae.min())?an.exists(!1):an.updateTime(t):an.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ae.min()))throw new fe(re.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return an.updateTime(t)}return an.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SO{constructor(e,t,i,o,c){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=o,this.deferred=c,this.Ku=i.maxAttempts,this.x_=new Hg(this.asyncQueue,"transaction_retry")}Wu(){this.Ku-=1,this.Gu()}Gu(){this.x_.y_(async()=>{const e=new AO(this.datastore),t=this.zu(e);t&&t.then(i=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(i)}).catch(o=>{this.ju(o)}))}).catch(i=>{this.ju(i)})})}zu(e){try{const t=this.updateFunction(e);return!nu(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ju(e){this.Ku>0&&this.Hu(e)?(this.Ku-=1,this.asyncQueue.enqueueAndForget(()=>(this.Gu(),Promise.resolve()))):this.deferred.reject(e)}Hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!Qx(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ai="FirestoreClient";class wO{constructor(e,t,i,o,c){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=o,this.user=hn.UNAUTHENTICATED,this.clientId=yx.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(i,async d=>{me(Ai,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d}),this.appCheckCredentials.start(i,d=>(me(Ai,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Bs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Xg(t,"Failed to shutdown persistence");e.reject(i)}}),e.promise}}async function Np(s,e){s.asyncQueue.verifyOperationInProgress(),me(Ai,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let i=t.initialUser;s.setCredentialChangeListener(async o=>{i.isEqual(o)||(await c0(e.localStore,o),i=o)}),e.persistence.setDatabaseDeletedListener(()=>s.terminate()),s._offlineComponents=e}async function bT(s,e){s.asyncQueue.verifyOperationInProgress();const t=await CO(s);me(Ai,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener(i=>pT(e.remoteStore,i)),s.setAppCheckTokenChangeListener((i,o)=>pT(e.remoteStore,o)),s._onlineComponents=e}async function CO(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){me(Ai,"Using user provided OfflineComponentProvider");try{await Np(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(o){return o.name==="FirebaseError"?o.code===re.FAILED_PRECONDITION||o.code===re.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(t))throw t;$o("Error using user provided cache. Falling back to memory cache: "+t),await Np(s,new Nh)}}else me(Ai,"Using default OfflineComponentProvider"),await Np(s,new xO(void 0));return s._offlineComponents}async function av(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(me(Ai,"Using user provided OnlineComponentProvider"),await bT(s,s._uninitializedComponentsProvider._online)):(me(Ai,"Using default OnlineComponentProvider"),await bT(s,new ig))),s._onlineComponents}function jO(s){return av(s).then(e=>e.syncEngine)}function IO(s){return av(s).then(e=>e.datastore)}async function xh(s){const e=await av(s),t=e.eventManager;return t.onListen=dO.bind(null,e.syncEngine),t.onUnlisten=mO.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=hO.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=pO.bind(null,e.syncEngine),t}function RO(s,e,t={}){const i=new Bs;return s.asyncQueue.enqueueAndForget(async()=>function(c,d,m,p,v){const _=new sv({next:x=>{_.xu(),d.enqueueAndForget(()=>Zg(c,T));const C=x.docs.has(m);!C&&x.fromCache?v.reject(new fe(re.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&x.fromCache&&p&&p.source==="server"?v.reject(new fe(re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):v.resolve(x)},error:x=>v.reject(x)}),T=new ev(Lh(m.path),_,{includeMetadataChanges:!0,Qa:!0});return Wg(c,T)}(await xh(s),s.asyncQueue,e,t,i)),i.promise}function DO(s,e,t={}){const i=new Bs;return s.asyncQueue.enqueueAndForget(async()=>function(c,d,m,p,v){const _=new sv({next:x=>{_.xu(),d.enqueueAndForget(()=>Zg(c,T)),x.fromCache&&p.source==="server"?v.reject(new fe(re.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):v.resolve(x)},error:x=>v.reject(x)}),T=new ev(m,_,{includeMetadataChanges:!0,Qa:!0});return Wg(c,T)}(await xh(s),s.asyncQueue,e,t,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S0(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TT=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w0(s,e,t){if(!t)throw new fe(re.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function OO(s,e,t,i){if(e===!0&&i===!0)throw new fe(re.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function NT(s){if(!Ee.isDocumentKey(s))throw new fe(re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function xT(s){if(Ee.isDocumentKey(s))throw new fe(re.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function Yh(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=function(i){return i.constructor?i.constructor.name:null}(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":Te(12329,{type:typeof s})}function Nn(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new fe(re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Yh(s);throw new fe(re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C0="firestore.googleapis.com",AT=!0;class ST{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new fe(re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=C0,this.ssl=AT}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:AT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=o0;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<oD)throw new fe(re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}OO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=S0((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(c){if(c.timeoutSeconds!==void 0){if(isNaN(c.timeoutSeconds))throw new fe(re.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (must not be NaN)`);if(c.timeoutSeconds<5)throw new fe(re.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (minimum allowed value is 5)`);if(c.timeoutSeconds>30)throw new fe(re.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,o){return i.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Qh{constructor(e,t,i,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ST({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new fe(re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new fe(re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ST(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new UR;switch(i.type){case"firstParty":return new zR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new fe(re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const i=TT.get(t);i&&(me("ComponentProvider","Removing Datastore"),TT.delete(t),i.terminate())}(this),Promise.resolve()}}function MO(s,e,t,i={}){var o;s=Nn(s,Qh);const c=Dr(e),d=s._getSettings(),m=Object.assign(Object.assign({},d),{emulatorOptions:s._getEmulatorOptions()}),p=`${e}:${t}`;c&&(mg(`https://${p}`),pg("Firestore",!0)),d.host!==C0&&d.host!==p&&$o("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const v=Object.assign(Object.assign({},d),{host:p,ssl:c,emulatorOptions:i});if(!_i(v,m)&&(s._setSettings(v),i.mockUserToken)){let _,T;if(typeof i.mockUserToken=="string")_=i.mockUserToken,T=hn.MOCK_USER;else{_=bN(i.mockUserToken,(o=s._app)===null||o===void 0?void 0:o.options.projectId);const x=i.mockUserToken.sub||i.mockUserToken.user_id;if(!x)throw new fe(re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");T=new hn(x)}s._authCredentials=new FR(new gx(_,T))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Pi(this.firestore,e,this._query)}}class rn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new yi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new rn(this.firestore,e,this._key)}}class yi extends Pi{constructor(e,t,i){super(e,t,Lh(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new rn(this.firestore,null,new Ee(e))}withConverter(e){return new yi(this.firestore,e,this._path)}}function pt(s,e,...t){if(s=ut(s),w0("collection","path",e),s instanceof Qh){const i=rt.fromString(e,...t);return xT(i),new yi(s,null,i)}{if(!(s instanceof rn||s instanceof yi))throw new fe(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(rt.fromString(e,...t));return xT(i),new yi(s.firestore,null,i)}}function Ft(s,e,...t){if(s=ut(s),arguments.length===1&&(e=yx.newId()),w0("doc","path",e),s instanceof Qh){const i=rt.fromString(e,...t);return NT(i),new rn(s,null,new Ee(i))}{if(!(s instanceof rn||s instanceof yi))throw new fe(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(rt.fromString(e,...t));return NT(i),new rn(s.firestore,s instanceof yi?s.converter:null,new Ee(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wT="AsyncQueue";class CT{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new Hg(this,"async_queue_retry"),this.rc=()=>{const i=Tp();i&&me(wT,"Visibility state changed to "+i.visibilityState),this.x_.b_()},this.sc=e;const t=Tp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=Tp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new Bs;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!al(e))throw e;me(wT,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(i=>{throw this.Xu=i,this.ec=!1,ja("INTERNAL UNHANDLED ERROR: ",jT(i)),i}).then(i=>(this.ec=!1,i))));return this.sc=t,t}enqueueAfterDelay(e,t,i){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const o=Qg.createAndSchedule(this,e,t,i,c=>this.uc(c));return this.Zu.push(o),o}oc(){this.Xu&&Te(47125,{cc:jT(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function jT(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IT(s){return function(t,i){if(typeof t!="object"||t===null)return!1;const o=t;for(const c of i)if(c in o&&typeof o[c]=="function")return!0;return!1}(s,["next","error","complete"])}class $s extends Qh{constructor(e,t,i,o){super(e,t,i,o),this.type="firestore",this._queue=new CT,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new CT(e),this._firestoreClient=void 0,await e}}}function PO(s,e){const t=typeof s=="object"?s:Wc(),i=typeof s=="string"?s:ph,o=Ra(t,"firestore").getImmediate({identifier:i});if(!o._initialized){const c=yN("firestore");c&&MO(o,...c)}return o}function ou(s){if(s._terminated)throw new fe(re.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||kO(s),s._firestoreClient}function kO(s){var e,t,i;const o=s._freezeSettings(),c=function(m,p,v,_){return new a1(m,p,v,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,S0(_.experimentalLongPollingOptions),_.useFetchStreams,_.isUsingEmulator)}(s._databaseId,((e=s._app)===null||e===void 0?void 0:e.options.appId)||"",s._persistenceKey,o);s._componentsProvider||!((t=o.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=o.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(s._componentsProvider={_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider}),s._firestoreClient=new wO(s._authCredentials,s._appCheckCredentials,s._queue,c,s._componentsProvider&&function(m){const p=m?._online.build();return{_offline:m?._offline.build(p),_online:p}}(s._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new jr(on.fromBase64String(e))}catch(t){throw new fe(re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new jr(on.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new fe(re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new sn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new fe(re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new fe(re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Me(this._lat,e._lat)||Me(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,o){if(i.length!==o.length)return!1;for(let c=0;c<i.length;++c)if(i[c]!==o[c])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VO=/^__.*__$/;class LO{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Mi(e,this.data,this.fieldMask,t,this.fieldTransforms):new su(e,this.data,t,this.fieldTransforms)}}class j0{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Mi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function I0(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Te(40011,{Ic:s})}}class ov{constructor(e,t,i,o,c,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=o,c===void 0&&this.Ec(),this.fieldTransforms=c||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new ov(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:i,Rc:!1});return o.Vc(e),o}mc(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:i,Rc:!1});return o.Ec(),o}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return Ah(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(I0(this.Ic)&&VO.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class UO{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Gh(e)}bc(e,t,i,o=!1){return new ov({Ic:e,methodName:t,wc:i,path:sn.emptyPath(),Rc:!1,yc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function cu(s){const e=s._freezeSettings(),t=Gh(s._databaseId);return new UO(s._databaseId,!!e.ignoreUndefinedProperties,t)}function lv(s,e,t,i,o,c={}){const d=s.bc(c.merge||c.mergeFields?2:0,e,t,o);uv("Data must be an object, but it was:",d,i);const m=O0(i,d);let p,v;if(c.merge)p=new qn(d.fieldMask),v=d.fieldTransforms;else if(c.mergeFields){const _=[];for(const T of c.mergeFields){const x=rg(e,T,t);if(!d.contains(x))throw new fe(re.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);P0(_,x)||_.push(x)}p=new qn(_),v=d.fieldTransforms.filter(T=>p.covers(T.field))}else p=null,v=d.fieldTransforms;return new LO(new Tn(m),p,v)}class Wh extends Xh{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Wh}}class cv extends Xh{_toFieldTransform(e){return new I1(e.path,new Gc)}isEqual(e){return e instanceof cv}}function R0(s,e,t,i){const o=s.bc(1,e,t);uv("Data must be an object, but it was:",o,i);const c=[],d=Tn.empty();Oi(i,(p,v)=>{const _=dv(e,p,t);v=ut(v);const T=o.mc(_);if(v instanceof Wh)c.push(_);else{const x=uu(v,T);x!=null&&(c.push(_),d.set(_,x))}});const m=new qn(c);return new j0(d,m,o.fieldTransforms)}function D0(s,e,t,i,o,c){const d=s.bc(1,e,t),m=[rg(e,i,t)],p=[o];if(c.length%2!=0)throw new fe(re.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<c.length;x+=2)m.push(rg(e,c[x])),p.push(c[x+1]);const v=[],_=Tn.empty();for(let x=m.length-1;x>=0;--x)if(!P0(v,m[x])){const C=m[x];let N=p[x];N=ut(N);const M=d.mc(C);if(N instanceof Wh)v.push(C);else{const S=uu(N,M);S!=null&&(v.push(C),_.set(C,S))}}const T=new qn(v);return new j0(_,T,d.fieldTransforms)}function FO(s,e,t,i=!1){return uu(t,s.bc(i?4:3,e))}function uu(s,e){if(M0(s=ut(s)))return uv("Unsupported field value:",e,s),O0(s,e);if(s instanceof Xh)return function(i,o){if(!I0(o.Ic))throw o.gc(`${i._methodName}() can only be used with update() and set()`);if(!o.path)throw o.gc(`${i._methodName}() is not currently supported inside arrays`);const c=i._toFieldTransform(o);c&&o.fieldTransforms.push(c)}(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(i,o){const c=[];let d=0;for(const m of i){let p=uu(m,o.fc(d));p==null&&(p={nullValue:"NULL_VALUE"}),c.push(p),d++}return{arrayValue:{values:c}}}(s,e)}return function(i,o){if((i=ut(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return w1(o.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const c=Vt.fromDate(i);return{timestampValue:_h(o.serializer,c)}}if(i instanceof Vt){const c=new Vt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:_h(o.serializer,c)}}if(i instanceof iv)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof jr)return{bytesValue:Jx(o.serializer,i._byteString)};if(i instanceof rn){const c=o.databaseId,d=i.firestore._databaseId;if(!d.isEqual(c))throw o.gc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:Ug(i.firestore._databaseId||o.databaseId,i._key.path)}}if(i instanceof rv)return function(d,m){return{mapValue:{fields:{[Sx]:{stringValue:wx},[gh]:{arrayValue:{values:d.toArray().map(v=>{if(typeof v!="number")throw m.gc("VectorValues must only contain numeric values.");return kg(m.serializer,v)})}}}}}}(i,o);throw o.gc(`Unsupported field value: ${Yh(i)}`)}(s,e)}function O0(s,e){const t={};return Ex(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Oi(s,(i,o)=>{const c=uu(o,e.Ac(i));c!=null&&(t[i]=c)}),{mapValue:{fields:t}}}function M0(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof Vt||s instanceof iv||s instanceof jr||s instanceof rn||s instanceof Xh||s instanceof rv)}function uv(s,e,t){if(!M0(t)||!function(o){return typeof o=="object"&&o!==null&&(Object.getPrototypeOf(o)===Object.prototype||Object.getPrototypeOf(o)===null)}(t)){const i=Yh(t);throw i==="an object"?e.gc(s+" a custom object"):e.gc(s+" "+i)}}function rg(s,e,t){if((e=ut(e))instanceof lu)return e._internalPath;if(typeof e=="string")return dv(s,e);throw Ah("Field path arguments must be of type string or ",s,!1,void 0,t)}const qO=new RegExp("[~\\*/\\[\\]]");function dv(s,e,t){if(e.search(qO)>=0)throw Ah(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new lu(...e.split("."))._internalPath}catch{throw Ah(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Ah(s,e,t,i,o){const c=i&&!i.isEmpty(),d=o!==void 0;let m=`Function ${e}() called with invalid data`;t&&(m+=" (via `toFirestore()`)"),m+=". ";let p="";return(c||d)&&(p+=" (found",c&&(p+=` in field ${i}`),d&&(p+=` in document ${o}`),p+=")"),new fe(re.INVALID_ARGUMENT,m+s+p)}function P0(s,e){return s.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh{constructor(e,t,i,o,c){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=o,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new rn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new BO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Zh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class BO extends Sh{data(){return super.data()}}function Zh(s,e){return typeof e=="string"?dv(s,e):e instanceof lu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k0(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new fe(re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class hv{}class V0 extends hv{}function Xe(s,e,...t){let i=[];e instanceof hv&&i.push(e),i=i.concat(t),function(c){const d=c.filter(p=>p instanceof fv).length,m=c.filter(p=>p instanceof Jh).length;if(d>1||d>0&&m>0)throw new fe(re.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const o of i)s=o._apply(s);return s}class Jh extends V0{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Jh(e,t,i)}_apply(e){const t=this._parse(e);return L0(e._query,t),new Pi(e.firestore,e.converter,Xp(e._query,t))}_parse(e){const t=cu(e.firestore);return function(c,d,m,p,v,_,T){let x;if(v.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new fe(re.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){DT(T,_);const N=[];for(const M of T)N.push(RT(p,c,M));x={arrayValue:{values:N}}}else x=RT(p,c,T)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||DT(T,_),x=FO(m,d,T,_==="in"||_==="not-in");return Rt.create(v,_,x)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function mt(s,e,t){const i=e,o=Zh("where",s);return Jh._create(o,i,t)}class fv extends hv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new fv(e,t)}_parse(e){const t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:Es.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(o,c){let d=o;const m=c.getFlattenedFilters();for(const p of m)L0(d,p),d=Xp(d,p)}(e._query,t),new Pi(e.firestore,e.converter,Xp(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class mv extends V0{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new mv(e,t)}_apply(e){const t=function(o,c,d){if(o.startAt!==null)throw new fe(re.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new fe(re.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Hc(c,d)}(e._query,this._field,this._direction);return new Pi(e.firestore,e.converter,function(o,c){const d=o.explicitOrderBy.concat([c]);return new il(o.path,o.collectionGroup,d,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)}(e._query,t))}}function Ys(s,e="asc"){const t=e,i=Zh("orderBy",s);return mv._create(i,t)}function RT(s,e,t){if(typeof(t=ut(t))=="string"){if(t==="")throw new fe(re.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Px(e)&&t.indexOf("/")!==-1)throw new fe(re.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(rt.fromString(t));if(!Ee.isDocumentKey(i))throw new fe(re.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Gb(s,new Ee(i))}if(t instanceof rn)return Gb(s,t._key);throw new fe(re.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Yh(t)}.`)}function DT(s,e){if(!Array.isArray(s)||s.length===0)throw new fe(re.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function L0(s,e){const t=function(o,c){for(const d of o)for(const m of d.getFlattenedFilters())if(c.indexOf(m.op)>=0)return m.op;return null}(s.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new fe(re.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new fe(re.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class U0{convertValue(e,t="none"){switch(Ni(e)){case 0:return null;case 1:return e.booleanValue;case 2:return At(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ti(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Te(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Oi(e,(o,c)=>{i[o]=this.convertValue(c,t)}),i}convertVectorValue(e){var t,i,o;const c=(o=(i=(t=e.fields)===null||t===void 0?void 0:t[gh].arrayValue)===null||i===void 0?void 0:i.values)===null||o===void 0?void 0:o.map(d=>At(d.doubleValue));return new rv(c)}convertGeoPoint(e){return new iv(At(e.latitude),At(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=Vh(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(qc(e));default:return null}}convertTimestamp(e){const t=bi(e);return new Vt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=rt.fromString(e);Ke(r0(i),9688,{name:e});const o=new Bc(i.get(1),i.get(3)),c=new Ee(i.popFirst(5));return o.isEqual(t)||ja(`Document ${c} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pv(s,e,t){let i;return i=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,i}class zO extends U0{constructor(e){super(),this.firestore=e}convertBytes(e){return new jr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new rn(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class gv extends Sh{constructor(e,t,i,o,c,d){super(e,t,i,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new sh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Zh("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}}class sh extends gv{data(e={}){return super.data(e)}}class F0{constructor(e,t,i,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new Vo(o.hasPendingWrites,o.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new sh(this._firestore,this._userDataWriter,i.key,i,new Vo(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new fe(re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(o,c){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map(m=>{const p=new sh(o._firestore,o._userDataWriter,m.doc.key,m.doc,new Vo(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);return m.doc,{type:"added",doc:p,oldIndex:-1,newIndex:d++}})}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(m=>c||m.type!==3).map(m=>{const p=new sh(o._firestore,o._userDataWriter,m.doc.key,m.doc,new Vo(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);let v=-1,_=-1;return m.type!==0&&(v=d.indexOf(m.doc.key),d=d.delete(m.doc.key)),m.type!==1&&(d=d.add(m.doc),_=d.indexOf(m.doc.key)),{type:HO(m.type),doc:p,oldIndex:v,newIndex:_}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function HO(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Te(61501,{type:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kr(s){s=Nn(s,rn);const e=Nn(s.firestore,$s);return RO(ou(e),s._key).then(t=>B0(e,s,t))}class ef extends U0{constructor(e){super(),this.firestore=e}convertBytes(e){return new jr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new rn(this.firestore,null,t)}}function Rn(s){s=Nn(s,Pi);const e=Nn(s.firestore,$s),t=ou(e),i=new ef(e);return k0(s._query),DO(t,s._query).then(o=>new F0(e,i,s,o))}function vv(s,e,t){s=Nn(s,rn);const i=Nn(s.firestore,$s),o=pv(s.converter,e,t);return tf(i,[lv(cu(i),"setDoc",s._key,o,s.converter!==null,t).toMutation(s._key,an.none())])}function Vr(s,e,t,...i){s=Nn(s,rn);const o=Nn(s.firestore,$s),c=cu(o);let d;return d=typeof(e=ut(e))=="string"||e instanceof lu?D0(c,"updateDoc",s._key,e,t,i):R0(c,"updateDoc",s._key,e),tf(o,[d.toMutation(s._key,an.exists(!0))])}function q0(s){return tf(Nn(s.firestore,$s),[new zh(s._key,an.none())])}function yv(s,e){const t=Nn(s.firestore,$s),i=Ft(s),o=pv(s.converter,e);return tf(t,[lv(cu(s.firestore),"addDoc",i._key,o,s.converter!==null,{}).toMutation(i._key,an.exists(!1))]).then(()=>i)}function du(s,...e){var t,i,o;s=ut(s);let c={includeMetadataChanges:!1,source:"default"},d=0;typeof e[d]!="object"||IT(e[d])||(c=e[d],d++);const m={includeMetadataChanges:c.includeMetadataChanges,source:c.source};if(IT(e[d])){const T=e[d];e[d]=(t=T.next)===null||t===void 0?void 0:t.bind(T),e[d+1]=(i=T.error)===null||i===void 0?void 0:i.bind(T),e[d+2]=(o=T.complete)===null||o===void 0?void 0:o.bind(T)}let p,v,_;if(s instanceof rn)v=Nn(s.firestore,$s),_=Lh(s._key.path),p={next:T=>{e[d]&&e[d](B0(v,s,T))},error:e[d+1],complete:e[d+2]};else{const T=Nn(s,Pi);v=Nn(T.firestore,$s),_=T._query;const x=new ef(v);p={next:C=>{e[d]&&e[d](new F0(v,x,T,C))},error:e[d+1],complete:e[d+2]},k0(s._query)}return function(x,C,N,M){const S=new sv(M),U=new ev(C,S,N);return x.asyncQueue.enqueueAndForget(async()=>Wg(await xh(x),U)),()=>{S.xu(),x.asyncQueue.enqueueAndForget(async()=>Zg(await xh(x),U))}}(ou(v),_,m,p)}function tf(s,e){return function(i,o){const c=new Bs;return i.asyncQueue.enqueueAndForget(async()=>gO(await jO(i),o,c)),c.promise}(ou(s),e)}function B0(s,e,t){const i=t.docs.get(e._key),o=new ef(s);return new gv(s,o,e._key,i,new Vo(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GO={maxAttempts:5};function xc(s,e){if((s=ut(s)).firestore!==e)throw new fe(re.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $O{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=cu(e)}get(e){const t=xc(e,this._firestore),i=new zO(this._firestore);return this._transaction.lookup([t._key]).then(o=>{if(!o||o.length!==1)return Te(24041);const c=o[0];if(c.isFoundDocument())return new Sh(this._firestore,i,c.key,c,t.converter);if(c.isNoDocument())return new Sh(this._firestore,i,t._key,null,t.converter);throw Te(18433,{doc:c})})}set(e,t,i){const o=xc(e,this._firestore),c=pv(o.converter,t,i),d=lv(this._dataReader,"Transaction.set",o._key,c,o.converter!==null,i);return this._transaction.set(o._key,d),this}update(e,t,i,...o){const c=xc(e,this._firestore);let d;return d=typeof(t=ut(t))=="string"||t instanceof lu?D0(this._dataReader,"Transaction.update",c._key,t,i,o):R0(this._dataReader,"Transaction.update",c._key,t),this._transaction.update(c._key,d),this}delete(e){const t=xc(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KO extends $O{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=xc(e,this._firestore),i=new ef(this._firestore);return super.get(e).then(o=>new gv(this._firestore,i,t._key,o._document,new Vo(!1,!1),t.converter))}}function z0(s,e,t){s=Nn(s,$s);const i=Object.assign(Object.assign({},GO),t);return function(c){if(c.maxAttempts<1)throw new fe(re.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(c,d,m){const p=new Bs;return c.asyncQueue.enqueueAndForget(async()=>{const v=await IO(c);new SO(c.asyncQueue,v,m,d,p).Wu()}),p.promise}(ou(s),o=>e(new KO(s,o)),i)}function jn(){return new cv("serverTimestamp")}(function(e,t=!0){(function(o){nl=o})(Or),is(new Gn("firestore",(i,{instanceIdentifier:o,options:c})=>{const d=i.getProvider("app").getImmediate(),m=new $s(new qR(i.getProvider("auth-internal")),new HR(d,i.getProvider("app-check-internal")),function(v,_){if(!Object.prototype.hasOwnProperty.apply(v.options,["projectId"]))throw new fe(re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Bc(v.options.projectId,_)}(d,o),d);return c=Object.assign({useFetchStreams:t},c),m._setSettings(c),m},"PUBLIC").setMultipleInstances(!0)),mn(Ob,Mb,e),mn(Ob,Mb,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H0="firebasestorage.googleapis.com",YO="storageBucket",QO=2*60*1e3,XO=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs extends os{constructor(e,t,i=0){super(xp(e),`Firebase Storage: ${t} (${xp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Qs.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return xp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ks;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ks||(Ks={}));function xp(s){return"storage/"+s}function WO(){const s="An unknown error occurred, please check the error payload for server response.";return new Qs(Ks.UNKNOWN,s)}function ZO(){return new Qs(Ks.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function JO(){return new Qs(Ks.CANCELED,"User canceled the upload/download.")}function eM(s){return new Qs(Ks.INVALID_URL,"Invalid URL '"+s+"'.")}function tM(s){return new Qs(Ks.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function OT(s){return new Qs(Ks.INVALID_ARGUMENT,s)}function G0(){return new Qs(Ks.APP_DELETED,"The Firebase app was deleted.")}function nM(s){return new Qs(Ks.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=ys.makeFromUrl(e,t)}catch{return new ys(e,"")}if(i.path==="")return i;throw tM(e)}static makeFromUrl(e,t){let i=null;const o="([A-Za-z0-9.\\-_]+)";function c(V){V.path.charAt(V.path.length-1)==="/"&&(V.path_=V.path_.slice(0,-1))}const d="(/(.*))?$",m=new RegExp("^gs://"+o+d,"i"),p={bucket:1,path:3};function v(V){V.path_=decodeURIComponent(V.path)}const _="v[A-Za-z0-9_]+",T=t.replace(/[.]/g,"\\."),x="(/([^?#]*).*)?$",C=new RegExp(`^https?://${T}/${_}/b/${o}/o${x}`,"i"),N={bucket:1,path:3},M=t===H0?"(?:storage.googleapis.com|storage.cloud.google.com)":t,S="([^?#]*)",U=new RegExp(`^https?://${M}/${o}/${S}`,"i"),F=[{regex:m,indices:p,postModify:c},{regex:C,indices:N,postModify:v},{regex:U,indices:{bucket:1,path:2},postModify:v}];for(let V=0;V<F.length;V++){const B=F[V],ee=B.regex.exec(e);if(ee){const D=ee[B.indices.bucket];let A=ee[B.indices.path];A||(A=""),i=new ys(D,A),B.postModify(i);break}}if(i==null)throw eM(e);return i}}class sM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aM(s,e,t){let i=1,o=null,c=null,d=!1,m=0;function p(){return m===2}let v=!1;function _(...S){v||(v=!0,e.apply(null,S))}function T(S){o=setTimeout(()=>{o=null,s(C,p())},S)}function x(){c&&clearTimeout(c)}function C(S,...U){if(v){x();return}if(S){x(),_.call(null,S,...U);return}if(p()||d){x(),_.call(null,S,...U);return}i<64&&(i*=2);let F;m===1?(m=2,F=0):F=(i+Math.random())*1e3,T(F)}let N=!1;function M(S){N||(N=!0,x(),!v&&(o!==null?(S||(m=2),clearTimeout(o),T(0)):S||(m=1)))}return T(0),c=setTimeout(()=>{d=!0,M(!0)},t),M}function iM(s){s(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rM(s){return s!==void 0}function MT(s,e,t,i){if(i<e)throw OT(`Invalid value for '${s}'. Expected ${e} or greater.`);if(i>t)throw OT(`Invalid value for '${s}'. Expected ${t} or less.`)}function oM(s){const e=encodeURIComponent;let t="?";for(const i in s)if(s.hasOwnProperty(i)){const o=e(i)+"="+e(s[i]);t=t+o+"&"}return t=t.slice(0,-1),t}var wh;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(wh||(wh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lM(s,e){const t=s>=500&&s<600,o=[408,429].indexOf(s)!==-1,c=e.indexOf(s)!==-1;return t||o||c}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cM{constructor(e,t,i,o,c,d,m,p,v,_,T,x=!0,C=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=o,this.successCodes_=c,this.additionalRetryCodes_=d,this.callback_=m,this.errorCallback_=p,this.timeout_=v,this.progressCallback_=_,this.connectionFactory_=T,this.retry=x,this.isUsingEmulator=C,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((N,M)=>{this.resolve_=N,this.reject_=M,this.start_()})}start_(){const e=(i,o)=>{if(o){i(!1,new Gd(!1,null,!0));return}const c=this.connectionFactory_();this.pendingConnection_=c;const d=m=>{const p=m.loaded,v=m.lengthComputable?m.total:-1;this.progressCallback_!==null&&this.progressCallback_(p,v)};this.progressCallback_!==null&&c.addUploadProgressListener(d),c.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&c.removeUploadProgressListener(d),this.pendingConnection_=null;const m=c.getErrorCode()===wh.NO_ERROR,p=c.getStatus();if(!m||lM(p,this.additionalRetryCodes_)&&this.retry){const _=c.getErrorCode()===wh.ABORT;i(!1,new Gd(!1,null,_));return}const v=this.successCodes_.indexOf(p)!==-1;i(!0,new Gd(v,c))})},t=(i,o)=>{const c=this.resolve_,d=this.reject_,m=o.connection;if(o.wasSuccessCode)try{const p=this.callback_(m,m.getResponse());rM(p)?c(p):c()}catch(p){d(p)}else if(m!==null){const p=WO();p.serverResponse=m.getErrorText(),this.errorCallback_?d(this.errorCallback_(m,p)):d(p)}else if(o.canceled){const p=this.appDelete_?G0():JO();d(p)}else{const p=ZO();d(p)}};this.canceled_?t(!1,new Gd(!1,null,!0)):this.backoffId_=aM(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&iM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Gd{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function uM(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function dM(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function hM(s,e){e&&(s["X-Firebase-GMPID"]=e)}function fM(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function mM(s,e,t,i,o,c,d=!0,m=!1){const p=oM(s.urlParams),v=s.url+p,_=Object.assign({},s.headers);return hM(_,e),uM(_,t),dM(_,c),fM(_,i),new cM(v,s.method,_,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,o,d,m)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pM(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function gM(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{constructor(e,t){this._service=e,t instanceof ys?this._location=t:this._location=ys.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Ch(e,t)}get root(){const e=new ys(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return gM(this._location.path)}get storage(){return this._service}get parent(){const e=pM(this._location.path);if(e===null)return null;const t=new ys(this._location.bucket,e);return new Ch(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw nM(e)}}function PT(s,e){const t=e?.[YO];return t==null?null:ys.makeFromBucketSpec(t,s)}function vM(s,e,t,i={}){s.host=`${e}:${t}`;const o=Dr(e);o&&(mg(`https://${s.host}/b`),pg("Storage",!0)),s._isUsingEmulator=!0,s._protocol=o?"https":"http";const{mockUserToken:c}=i;c&&(s._overrideAuthToken=typeof c=="string"?c:bN(c,s.app.options.projectId))}class yM{constructor(e,t,i,o,c,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=o,this._firebaseVersion=c,this._isUsingEmulator=d,this._bucket=null,this._host=H0,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=QO,this._maxUploadRetryTime=XO,this._requests=new Set,o!=null?this._bucket=ys.makeFromBucketSpec(o,this._host):this._bucket=PT(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ys.makeFromBucketSpec(this._url,e):this._bucket=PT(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){MT("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){MT("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Cn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ch(this,e)}_makeRequest(e,t,i,o,c=!0){if(this._deleted)return new sM(G0());{const d=mM(e,this._appId,i,o,t,this._firebaseVersion,c,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,o).getPromise()}}const kT="@firebase/storage",VT="0.13.13";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $0="storage";function _M(s=Wc(),e){s=ut(s);const i=Ra(s,$0).getImmediate({identifier:e}),o=yN("storage");return o&&EM(i,...o),i}function EM(s,e,t,i={}){vM(s,e,t,i)}function bM(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),i=s.getProvider("auth-internal"),o=s.getProvider("app-check-internal");return new yM(t,i,o,e,Or)}function TM(){is(new Gn($0,bM,"PUBLIC").setMultipleInstances(!0)),mn(kT,VT,""),mn(kT,VT,"esm2017")}TM();const K0="@firebase/installations",_v="0.6.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y0=1e4,Q0=`w:${_v}`,X0="FIS_v2",NM="https://firebaseinstallations.googleapis.com/v1",xM=60*60*1e3,AM="installations",SM="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wM={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Ir=new ji(AM,SM,wM);function W0(s){return s instanceof os&&s.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z0({projectId:s}){return`${NM}/projects/${s}/installations`}function J0(s){return{token:s.token,requestStatus:2,expiresIn:jM(s.expiresIn),creationTime:Date.now()}}async function eA(s,e){const i=(await e.json()).error;return Ir.create("request-failed",{requestName:s,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function tA({apiKey:s}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s})}function CM(s,{refreshToken:e}){const t=tA(s);return t.append("Authorization",IM(e)),t}async function nA(s){const e=await s();return e.status>=500&&e.status<600?s():e}function jM(s){return Number(s.replace("s","000"))}function IM(s){return`${X0} ${s}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RM({appConfig:s,heartbeatServiceProvider:e},{fid:t}){const i=Z0(s),o=tA(s),c=e.getImmediate({optional:!0});if(c){const v=await c.getHeartbeatsHeader();v&&o.append("x-firebase-client",v)}const d={fid:t,authVersion:X0,appId:s.appId,sdkVersion:Q0},m={method:"POST",headers:o,body:JSON.stringify(d)},p=await nA(()=>fetch(i,m));if(p.ok){const v=await p.json();return{fid:v.fid||t,registrationStatus:2,refreshToken:v.refreshToken,authToken:J0(v.authToken)}}else throw await eA("Create Installation",p)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sA(s){return new Promise(e=>{setTimeout(e,s)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DM(s){return btoa(String.fromCharCode(...s)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OM=/^[cdef][\w-]{21}$/,og="";function MM(){try{const s=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(s),s[0]=112+s[0]%16;const t=PM(s);return OM.test(t)?t:og}catch{return og}}function PM(s){return DM(s).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nf(s){return`${s.appName}!${s.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aA=new Map;function iA(s,e){const t=nf(s);rA(t,e),kM(t,e)}function rA(s,e){const t=aA.get(s);if(t)for(const i of t)i(e)}function kM(s,e){const t=VM();t&&t.postMessage({key:s,fid:e}),LM()}let Nr=null;function VM(){return!Nr&&"BroadcastChannel"in self&&(Nr=new BroadcastChannel("[Firebase] FID Change"),Nr.onmessage=s=>{rA(s.data.key,s.data.fid)}),Nr}function LM(){aA.size===0&&Nr&&(Nr.close(),Nr=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UM="firebase-installations-database",FM=1,Rr="firebase-installations-store";let Ap=null;function Ev(){return Ap||(Ap=SN(UM,FM,{upgrade:(s,e)=>{switch(e){case 0:s.createObjectStore(Rr)}}})),Ap}async function jh(s,e){const t=nf(s),o=(await Ev()).transaction(Rr,"readwrite"),c=o.objectStore(Rr),d=await c.get(t);return await c.put(e,t),await o.done,(!d||d.fid!==e.fid)&&iA(s,e.fid),e}async function oA(s){const e=nf(s),i=(await Ev()).transaction(Rr,"readwrite");await i.objectStore(Rr).delete(e),await i.done}async function sf(s,e){const t=nf(s),o=(await Ev()).transaction(Rr,"readwrite"),c=o.objectStore(Rr),d=await c.get(t),m=e(d);return m===void 0?await c.delete(t):await c.put(m,t),await o.done,m&&(!d||d.fid!==m.fid)&&iA(s,m.fid),m}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bv(s){let e;const t=await sf(s.appConfig,i=>{const o=qM(i),c=BM(s,o);return e=c.registrationPromise,c.installationEntry});return t.fid===og?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function qM(s){const e=s||{fid:MM(),registrationStatus:0};return lA(e)}function BM(s,e){if(e.registrationStatus===0){if(!navigator.onLine){const o=Promise.reject(Ir.create("app-offline"));return{installationEntry:e,registrationPromise:o}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=zM(s,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:HM(s)}:{installationEntry:e}}async function zM(s,e){try{const t=await RM(s,e);return jh(s.appConfig,t)}catch(t){throw W0(t)&&t.customData.serverCode===409?await oA(s.appConfig):await jh(s.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function HM(s){let e=await LT(s.appConfig);for(;e.registrationStatus===1;)await sA(100),e=await LT(s.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await bv(s);return i||t}return e}function LT(s){return sf(s,e=>{if(!e)throw Ir.create("installation-not-found");return lA(e)})}function lA(s){return GM(s)?{fid:s.fid,registrationStatus:0}:s}function GM(s){return s.registrationStatus===1&&s.registrationTime+Y0<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $M({appConfig:s,heartbeatServiceProvider:e},t){const i=KM(s,t),o=CM(s,t),c=e.getImmediate({optional:!0});if(c){const v=await c.getHeartbeatsHeader();v&&o.append("x-firebase-client",v)}const d={installation:{sdkVersion:Q0,appId:s.appId}},m={method:"POST",headers:o,body:JSON.stringify(d)},p=await nA(()=>fetch(i,m));if(p.ok){const v=await p.json();return J0(v)}else throw await eA("Generate Auth Token",p)}function KM(s,{fid:e}){return`${Z0(s)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tv(s,e=!1){let t;const i=await sf(s.appConfig,c=>{if(!cA(c))throw Ir.create("not-registered");const d=c.authToken;if(!e&&XM(d))return c;if(d.requestStatus===1)return t=YM(s,e),c;{if(!navigator.onLine)throw Ir.create("app-offline");const m=ZM(c);return t=QM(s,m),m}});return t?await t:i.authToken}async function YM(s,e){let t=await UT(s.appConfig);for(;t.authToken.requestStatus===1;)await sA(100),t=await UT(s.appConfig);const i=t.authToken;return i.requestStatus===0?Tv(s,e):i}function UT(s){return sf(s,e=>{if(!cA(e))throw Ir.create("not-registered");const t=e.authToken;return JM(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function QM(s,e){try{const t=await $M(s,e),i=Object.assign(Object.assign({},e),{authToken:t});return await jh(s.appConfig,i),t}catch(t){if(W0(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await oA(s.appConfig);else{const i=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await jh(s.appConfig,i)}throw t}}function cA(s){return s!==void 0&&s.registrationStatus===2}function XM(s){return s.requestStatus===2&&!WM(s)}function WM(s){const e=Date.now();return e<s.creationTime||s.creationTime+s.expiresIn<e+xM}function ZM(s){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},s),{authToken:e})}function JM(s){return s.requestStatus===1&&s.requestTime+Y0<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eP(s){const e=s,{installationEntry:t,registrationPromise:i}=await bv(e);return i?i.catch(console.error):Tv(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tP(s,e=!1){const t=s;return await nP(t),(await Tv(t,e)).token}async function nP(s){const{registrationPromise:e}=await bv(s);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sP(s){if(!s||!s.options)throw Sp("App Configuration");if(!s.name)throw Sp("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!s.options[t])throw Sp(t);return{appName:s.name,projectId:s.options.projectId,apiKey:s.options.apiKey,appId:s.options.appId}}function Sp(s){return Ir.create("missing-app-config-values",{valueName:s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uA="installations",aP="installations-internal",iP=s=>{const e=s.getProvider("app").getImmediate(),t=sP(e),i=Ra(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},rP=s=>{const e=s.getProvider("app").getImmediate(),t=Ra(e,uA).getImmediate();return{getId:()=>eP(t),getToken:o=>tP(t,o)}};function oP(){is(new Gn(uA,iP,"PUBLIC")),is(new Gn(aP,rP,"PRIVATE"))}oP();mn(K0,_v);mn(K0,_v,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ih="analytics",lP="firebase_id",cP="origin",uP=60*1e3,dP="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Nv="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const In=new Xc("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hP={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Hn=new ji("analytics","Analytics",hP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fP(s){if(!s.startsWith(Nv)){const e=Hn.create("invalid-gtag-resource",{gtagURL:s});return In.warn(e.message),""}return s}function dA(s){return Promise.all(s.map(e=>e.catch(t=>t)))}function mP(s,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(s,e)),t}function pP(s,e){const t=mP("firebase-js-sdk-policy",{createScriptURL:fP}),i=document.createElement("script"),o=`${Nv}?l=${s}&id=${e}`;i.src=t?t?.createScriptURL(o):o,i.async=!0,document.head.appendChild(i)}function gP(s){let e=[];return Array.isArray(window[s])?e=window[s]:window[s]=e,e}async function vP(s,e,t,i,o,c){const d=i[o];try{if(d)await e[d];else{const p=(await dA(t)).find(v=>v.measurementId===o);p&&await e[p.appId]}}catch(m){In.error(m)}s("config",o,c)}async function yP(s,e,t,i,o){try{let c=[];if(o&&o.send_to){let d=o.send_to;Array.isArray(d)||(d=[d]);const m=await dA(t);for(const p of d){const v=m.find(T=>T.measurementId===p),_=v&&e[v.appId];if(_)c.push(_);else{c=[];break}}}c.length===0&&(c=Object.values(e)),await Promise.all(c),s("event",i,o||{})}catch(c){In.error(c)}}function _P(s,e,t,i){async function o(c,...d){try{if(c==="event"){const[m,p]=d;await yP(s,e,t,m,p)}else if(c==="config"){const[m,p]=d;await vP(s,e,t,i,m,p)}else if(c==="consent"){const[m,p]=d;s("consent",m,p)}else if(c==="get"){const[m,p,v]=d;s("get",m,p,v)}else if(c==="set"){const[m]=d;s("set",m)}else s(c,...d)}catch(m){In.error(m)}}return o}function EP(s,e,t,i,o){let c=function(...d){window[i].push(arguments)};return window[o]&&typeof window[o]=="function"&&(c=window[o]),window[o]=_P(c,s,e,t),{gtagCore:c,wrappedGtag:window[o]}}function bP(s){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(Nv)&&t.src.includes(s))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TP=30,NP=1e3;class xP{constructor(e={},t=NP){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const hA=new xP;function AP(s){return new Headers({Accept:"application/json","x-goog-api-key":s})}async function SP(s){var e;const{appId:t,apiKey:i}=s,o={method:"GET",headers:AP(i)},c=dP.replace("{app-id}",t),d=await fetch(c,o);if(d.status!==200&&d.status!==304){let m="";try{const p=await d.json();!((e=p.error)===null||e===void 0)&&e.message&&(m=p.error.message)}catch{}throw Hn.create("config-fetch-failed",{httpStatus:d.status,responseMessage:m})}return d.json()}async function wP(s,e=hA,t){const{appId:i,apiKey:o,measurementId:c}=s.options;if(!i)throw Hn.create("no-app-id");if(!o){if(c)return{measurementId:c,appId:i};throw Hn.create("no-api-key")}const d=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},m=new IP;return setTimeout(async()=>{m.abort()},uP),fA({appId:i,apiKey:o,measurementId:c},d,m,e)}async function fA(s,{throttleEndTimeMillis:e,backoffCount:t},i,o=hA){var c;const{appId:d,measurementId:m}=s;try{await CP(i,e)}catch(p){if(m)return In.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${m} provided in the "measurementId" field in the local Firebase config. [${p?.message}]`),{appId:d,measurementId:m};throw p}try{const p=await SP(s);return o.deleteThrottleMetadata(d),p}catch(p){const v=p;if(!jP(v)){if(o.deleteThrottleMetadata(d),m)return In.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${m} provided in the "measurementId" field in the local Firebase config. [${v?.message}]`),{appId:d,measurementId:m};throw p}const _=Number((c=v?.customData)===null||c===void 0?void 0:c.httpStatus)===503?ab(t,o.intervalMillis,TP):ab(t,o.intervalMillis),T={throttleEndTimeMillis:Date.now()+_,backoffCount:t+1};return o.setThrottleMetadata(d,T),In.debug(`Calling attemptFetch again in ${_} millis`),fA(s,T,i,o)}}function CP(s,e){return new Promise((t,i)=>{const o=Math.max(e-Date.now(),0),c=setTimeout(t,o);s.addEventListener(()=>{clearTimeout(c),i(Hn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function jP(s){if(!(s instanceof os)||!s.customData)return!1;const e=Number(s.customData.httpStatus);return e===429||e===500||e===503||e===504}class IP{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function RP(s,e,t,i,o){if(o&&o.global){s("event",t,i);return}else{const c=await e,d=Object.assign(Object.assign({},i),{send_to:c});s("event",t,d)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DP(){if(gg())try{await vg()}catch(s){return In.warn(Hn.create("indexeddb-unavailable",{errorInfo:s?.toString()}).message),!1}else return In.warn(Hn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function OP(s,e,t,i,o,c,d){var m;const p=wP(s);p.then(C=>{t[C.measurementId]=C.appId,s.options.measurementId&&C.measurementId!==s.options.measurementId&&In.warn(`The measurement ID in the local Firebase config (${s.options.measurementId}) does not match the measurement ID fetched from the server (${C.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(C=>In.error(C)),e.push(p);const v=DP().then(C=>{if(C)return i.getId()}),[_,T]=await Promise.all([p,v]);bP(c)||pP(c,_.measurementId),o("js",new Date);const x=(m=d?.config)!==null&&m!==void 0?m:{};return x[cP]="firebase",x.update=!0,T!=null&&(x[lP]=T),o("config",_.measurementId,x),_.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MP{constructor(e){this.app=e}_delete(){return delete Dc[this.app.options.appId],Promise.resolve()}}let Dc={},FT=[];const qT={};let wp="dataLayer",PP="gtag",BT,mA,zT=!1;function kP(){const s=[];if(TN()&&s.push("This is a browser extension environment."),NN()||s.push("Cookies are not available."),s.length>0){const e=s.map((i,o)=>`(${o+1}) ${i}`).join(" "),t=Hn.create("invalid-analytics-context",{errorInfo:e});In.warn(t.message)}}function VP(s,e,t){kP();const i=s.options.appId;if(!i)throw Hn.create("no-app-id");if(!s.options.apiKey)if(s.options.measurementId)In.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${s.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Hn.create("no-api-key");if(Dc[i]!=null)throw Hn.create("already-exists",{id:i});if(!zT){gP(wp);const{wrappedGtag:c,gtagCore:d}=EP(Dc,FT,qT,wp,PP);mA=c,BT=d,zT=!0}return Dc[i]=OP(s,FT,qT,e,BT,wp,t),new MP(s)}function LP(s=Wc()){s=ut(s);const e=Ra(s,Ih);return e.isInitialized()?e.getImmediate():UP(s)}function UP(s,e={}){const t=Ra(s,Ih);if(t.isInitialized()){const o=t.getImmediate();if(_i(e,t.getOptions()))return o;throw Hn.create("already-initialized")}return t.initialize({options:e})}function FP(s,e,t,i){s=ut(s),RP(mA,Dc[s.app.options.appId],e,t,i).catch(o=>In.error(o))}const HT="@firebase/analytics",GT="0.10.16";function qP(){is(new Gn(Ih,(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("installations-internal").getImmediate();return VP(i,o,t)},"PUBLIC")),is(new Gn("analytics-internal",s,"PRIVATE")),mn(HT,GT),mn(HT,GT,"esm2017");function s(e){try{const t=e.getProvider(Ih).getImmediate();return{logEvent:(i,o,c)=>FP(t,i,o,c)}}catch(t){throw Hn.create("interop-component-reg-failed",{reason:t})}}}qP();var lg,$T,af=function(){var s=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(s&&s.responseStart>0&&s.responseStart<performance.now())return s},pA=function(s){if(document.readyState==="loading")return"loading";var e=af();if(e){if(s<e.domInteractive)return"loading";if(e.domContentLoadedEventStart===0||s<e.domContentLoadedEventStart)return"dom-interactive";if(e.domComplete===0||s<e.domComplete)return"dom-content-loaded"}return"complete"},BP=function(s){var e=s.nodeName;return s.nodeType===1?e.toLowerCase():e.toUpperCase().replace(/^#/,"")},xv=function(s,e){var t="";try{for(;s&&s.nodeType!==9;){var i=s,o=i.id?"#"+i.id:BP(i)+(i.classList&&i.classList.value&&i.classList.value.trim()&&i.classList.value.trim().length?"."+i.classList.value.trim().replace(/\s+/g,"."):"");if(t.length+o.length>(e||100)-1)return t||o;if(t=t?o+">"+t:o,i.id)break;s=i.parentNode}}catch{}return t},gA=-1,zP=function(){return gA},hu=function(s){addEventListener("pageshow",function(e){e.persisted&&(gA=e.timeStamp,s(e))},!0)},Av=function(){var s=af();return s&&s.activationStart||0},Si=function(s,e){var t=af(),i="navigate";return zP()>=0?i="back-forward-cache":t&&(document.prerendering||Av()>0?i="prerender":document.wasDiscarded?i="restore":t.type&&(i=t.type.replace(/_/g,"-"))),{name:s,value:e===void 0?-1:e,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:i}},ol=function(s,e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(s)){var i=new PerformanceObserver(function(o){Promise.resolve().then(function(){e(o.getEntries())})});return i.observe(Object.assign({type:s,buffered:!0},t||{})),i}}catch{}},wi=function(s,e,t,i){var o,c;return function(d){e.value>=0&&(d||i)&&((c=e.value-(o||0))||o===void 0)&&(o=e.value,e.delta=c,e.rating=function(m,p){return m>p[1]?"poor":m>p[0]?"needs-improvement":"good"}(e.value,t),s(e))}},Sv=function(s){requestAnimationFrame(function(){return requestAnimationFrame(function(){return s()})})},rf=function(s){document.addEventListener("visibilitychange",function(){document.visibilityState==="hidden"&&s()})},wv=function(s){var e=!1;return function(){e||(s(),e=!0)}},Lo=-1,KT=function(){return document.visibilityState!=="hidden"||document.prerendering?1/0:0},Rh=function(s){document.visibilityState==="hidden"&&Lo>-1&&(Lo=s.type==="visibilitychange"?s.timeStamp:0,HP())},YT=function(){addEventListener("visibilitychange",Rh,!0),addEventListener("prerenderingchange",Rh,!0)},HP=function(){removeEventListener("visibilitychange",Rh,!0),removeEventListener("prerenderingchange",Rh,!0)},vA=function(){return Lo<0&&(Lo=KT(),YT(),hu(function(){setTimeout(function(){Lo=KT(),YT()},0)})),{get firstHiddenTime(){return Lo}}},Cv=function(s){document.prerendering?addEventListener("prerenderingchange",function(){return s()},!0):s()},QT=[1800,3e3],GP=function(s,e){e=e||{},Cv(function(){var t,i=vA(),o=Si("FCP"),c=ol("paint",function(d){d.forEach(function(m){m.name==="first-contentful-paint"&&(c.disconnect(),m.startTime<i.firstHiddenTime&&(o.value=Math.max(m.startTime-Av(),0),o.entries.push(m),t(!0)))})});c&&(t=wi(s,o,QT,e.reportAllChanges),hu(function(d){o=Si("FCP"),t=wi(s,o,QT,e.reportAllChanges),Sv(function(){o.value=performance.now()-d.timeStamp,t(!0)})}))})},XT=[.1,.25],$P=function(s,e){(function(t,i){i=i||{},GP(wv(function(){var o,c=Si("CLS",0),d=0,m=[],p=function(_){_.forEach(function(T){if(!T.hadRecentInput){var x=m[0],C=m[m.length-1];d&&T.startTime-C.startTime<1e3&&T.startTime-x.startTime<5e3?(d+=T.value,m.push(T)):(d=T.value,m=[T])}}),d>c.value&&(c.value=d,c.entries=m,o())},v=ol("layout-shift",p);v&&(o=wi(t,c,XT,i.reportAllChanges),rf(function(){p(v.takeRecords()),o(!0)}),hu(function(){d=0,c=Si("CLS",0),o=wi(t,c,XT,i.reportAllChanges),Sv(function(){return o()})}),setTimeout(o,0))}))})(function(t){var i=function(o){var c,d={};if(o.entries.length){var m=o.entries.reduce(function(v,_){return v&&v.value>_.value?v:_});if(m&&m.sources&&m.sources.length){var p=(c=m.sources).find(function(v){return v.node&&v.node.nodeType===1})||c[0];p&&(d={largestShiftTarget:xv(p.node),largestShiftTime:m.startTime,largestShiftValue:m.value,largestShiftSource:p,largestShiftEntry:m,loadState:pA(m.startTime)})}}return Object.assign(o,{attribution:d})}(t);s(i)},e)},yA=0,Cp=1/0,$d=0,KP=function(s){s.forEach(function(e){e.interactionId&&(Cp=Math.min(Cp,e.interactionId),$d=Math.max($d,e.interactionId),yA=$d?($d-Cp)/7+1:0)})},_A=function(){return lg?yA:performance.interactionCount||0},YP=function(){"interactionCount"in performance||lg||(lg=ol("event",KP,{type:"event",buffered:!0,durationThreshold:0}))},ps=[],Oc=new Map,EA=0,QP=function(){var s=Math.min(ps.length-1,Math.floor((_A()-EA)/50));return ps[s]},bA=[],XP=function(s){if(bA.forEach(function(o){return o(s)}),s.interactionId||s.entryType==="first-input"){var e=ps[ps.length-1],t=Oc.get(s.interactionId);if(t||ps.length<10||s.duration>e.latency){if(t)s.duration>t.latency?(t.entries=[s],t.latency=s.duration):s.duration===t.latency&&s.startTime===t.entries[0].startTime&&t.entries.push(s);else{var i={id:s.interactionId,latency:s.duration,entries:[s]};Oc.set(i.id,i),ps.push(i)}ps.sort(function(o,c){return c.latency-o.latency}),ps.length>10&&ps.splice(10).forEach(function(o){return Oc.delete(o.id)})}}},jv=function(s){var e=self.requestIdleCallback||self.setTimeout,t=-1;return s=wv(s),document.visibilityState==="hidden"?s():(t=e(s),rf(s)),t},WT=[200,500],WP=function(s,e){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(e=e||{},Cv(function(){var t;YP();var i,o=Si("INP"),c=function(m){jv(function(){m.forEach(XP);var p=QP();p&&p.latency!==o.value&&(o.value=p.latency,o.entries=p.entries,i())})},d=ol("event",c,{durationThreshold:(t=e.durationThreshold)!==null&&t!==void 0?t:40});i=wi(s,o,WT,e.reportAllChanges),d&&(d.observe({type:"first-input",buffered:!0}),rf(function(){c(d.takeRecords()),i(!0)}),hu(function(){EA=_A(),ps.length=0,Oc.clear(),o=Si("INP"),i=wi(s,o,WT,e.reportAllChanges)}))}))},Ho=[],fi=[],cg=0,Iv=new WeakMap,Go=new Map,ug=-1,ZP=function(s){Ho=Ho.concat(s),TA()},TA=function(){ug<0&&(ug=jv(JP))},JP=function(){Go.size>10&&Go.forEach(function(d,m){Oc.has(m)||Go.delete(m)});var s=ps.map(function(d){return Iv.get(d.entries[0])}),e=fi.length-50;fi=fi.filter(function(d,m){return m>=e||s.includes(d)});for(var t=new Set,i=0;i<fi.length;i++){var o=fi[i];NA(o.startTime,o.processingEnd).forEach(function(d){t.add(d)})}var c=Ho.length-1-50;Ho=Ho.filter(function(d,m){return d.startTime>cg&&m>c||t.has(d)}),ug=-1};bA.push(function(s){s.interactionId&&s.target&&!Go.has(s.interactionId)&&Go.set(s.interactionId,s.target)},function(s){var e,t=s.startTime+s.duration;cg=Math.max(cg,s.processingEnd);for(var i=fi.length-1;i>=0;i--){var o=fi[i];if(Math.abs(t-o.renderTime)<=8){(e=o).startTime=Math.min(s.startTime,e.startTime),e.processingStart=Math.min(s.processingStart,e.processingStart),e.processingEnd=Math.max(s.processingEnd,e.processingEnd),e.entries.push(s);break}}e||(e={startTime:s.startTime,processingStart:s.processingStart,processingEnd:s.processingEnd,renderTime:t,entries:[s]},fi.push(e)),(s.interactionId||s.entryType==="first-input")&&Iv.set(s,e),TA()});var NA=function(s,e){for(var t,i=[],o=0;t=Ho[o];o++)if(!(t.startTime+t.duration<s)){if(t.startTime>e)break;i.push(t)}return i},ek=function(s,e){$T||($T=ol("long-animation-frame",ZP)),WP(function(t){var i=function(o){var c=o.entries[0],d=Iv.get(c),m=c.processingStart,p=d.processingEnd,v=d.entries.sort(function(S,U){return S.processingStart-U.processingStart}),_=NA(c.startTime,p),T=o.entries.find(function(S){return S.target}),x=T&&T.target||Go.get(c.interactionId),C=[c.startTime+c.duration,p].concat(_.map(function(S){return S.startTime+S.duration})),N=Math.max.apply(Math,C),M={interactionTarget:xv(x),interactionTargetElement:x,interactionType:c.name.startsWith("key")?"keyboard":"pointer",interactionTime:c.startTime,nextPaintTime:N,processedEventEntries:v,longAnimationFrameEntries:_,inputDelay:m-c.startTime,processingDuration:p-m,presentationDelay:Math.max(N-p,0),loadState:pA(c.startTime)};return Object.assign(o,{attribution:M})}(t);s(i)},e)},ZT=[2500,4e3],jp={},tk=function(s,e){(function(t,i){i=i||{},Cv(function(){var o,c=vA(),d=Si("LCP"),m=function(_){i.reportAllChanges||(_=_.slice(-1)),_.forEach(function(T){T.startTime<c.firstHiddenTime&&(d.value=Math.max(T.startTime-Av(),0),d.entries=[T],o())})},p=ol("largest-contentful-paint",m);if(p){o=wi(t,d,ZT,i.reportAllChanges);var v=wv(function(){jp[d.id]||(m(p.takeRecords()),p.disconnect(),jp[d.id]=!0,o(!0))});["keydown","click"].forEach(function(_){addEventListener(_,function(){return jv(v)},{once:!0,capture:!0})}),rf(v),hu(function(_){d=Si("LCP"),o=wi(t,d,ZT,i.reportAllChanges),Sv(function(){d.value=performance.now()-_.timeStamp,jp[d.id]=!0,o(!0)})})}})})(function(t){var i=function(o){var c={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:o.value};if(o.entries.length){var d=af();if(d){var m=d.activationStart||0,p=o.entries[o.entries.length-1],v=p.url&&performance.getEntriesByType("resource").filter(function(N){return N.name===p.url})[0],_=Math.max(0,d.responseStart-m),T=Math.max(_,v?(v.requestStart||v.startTime)-m:0),x=Math.max(T,v?v.responseEnd-m:0),C=Math.max(x,p.startTime-m);c={element:xv(p.element),timeToFirstByte:_,resourceLoadDelay:T-_,resourceLoadDuration:x-T,elementRenderDelay:C-x,navigationEntry:d,lcpEntry:p},p.url&&(c.url=p.url),v&&(c.lcpResourceEntry=v)}}return Object.assign(o,{attribution:c})}(t);s(i)},e)};const JT="@firebase/performance",dg="0.7.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xA=dg,nk="FB-PERF-TRACE-START",sk="FB-PERF-TRACE-STOP",hg="FB-PERF-TRACE-MEASURE",AA="_wt_",SA="_fp",wA="_fcp",CA="_fid",jA="_lcp",ak="lcp_element",IA="_inp",ik="inp_interactionTarget",RA="_cls",rk="cls_largestShiftTarget",DA="@firebase/performance/config",OA="@firebase/performance/configexpire",ok="performance",MA="Performance";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lk={"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."},fn=new ji(ok,MA,lk);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ci=new Xc(MA);Ci.logLevel=Fe.INFO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ip,PA;class Ut{constructor(e){if(this.window=e,!e)throw fn.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay),this.onLCP=tk,this.onINP=ek,this.onCLS=$P}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){!this.performance||!this.performance.mark||this.performance.mark(e)}measure(e,t,i){!this.performance||!this.performance.measure||this.performance.measure(e,t,i)}getEntriesByType(e){return!this.performance||!this.performance.getEntriesByType?[]:this.performance.getEntriesByType(e)}getEntriesByName(e){return!this.performance||!this.performance.getEntriesByName?[]:this.performance.getEntriesByName(e)}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return!fetch||!Promise||!NN()?(Ci.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1):gg()?!0:(Ci.info("IndexedDB is not supported by current browser"),!1)}setupObserver(e,t){if(!this.PerformanceObserver)return;new this.PerformanceObserver(o=>{for(const c of o.getEntries())t(c)}).observe({entryTypes:[e]})}static getInstance(){return Ip===void 0&&(Ip=new Ut(PA)),Ip}}function ck(s){PA=s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kA;function uk(s){const e=s.getId();return e.then(t=>{kA=t}),e}function Rv(){return kA}function dk(s){const e=s.getToken();return e.then(t=>{}),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eN(s,e){const t=s.length-e.length;if(t<0||t>1)throw fn.create("invalid String merger input");const i=[];for(let o=0;o<s.length;o++)i.push(s.charAt(o)),e.length>o&&i.push(e.charAt(o));return i.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rp;class Bn{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=eN("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=eN("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return Rp===void 0&&(Rp=new Bn),Rp}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Mc;(function(s){s[s.UNKNOWN=0]="UNKNOWN",s[s.VISIBLE=1]="VISIBLE",s[s.HIDDEN=2]="HIDDEN"})(Mc||(Mc={}));const hk=["firebase_","google_","ga_"],fk=new RegExp("^[a-zA-Z]\\w*$"),mk=40,pk=100;function gk(){const s=Ut.getInstance().navigator;return s?.serviceWorker?s.serviceWorker.controller?2:3:1}function vk(){switch(Ut.getInstance().document.visibilityState){case"visible":return Mc.VISIBLE;case"hidden":return Mc.HIDDEN;default:return Mc.UNKNOWN}}function yk(){const e=Ut.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function _k(s){return s.length===0||s.length>mk?!1:!hk.some(t=>s.startsWith(t))&&!!s.match(fk)}function Ek(s){return s.length!==0&&s.length<=pk}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VA(s){var e;const t=(e=s.options)===null||e===void 0?void 0:e.appId;if(!t)throw fn.create("no app id");return t}function bk(s){var e;const t=(e=s.options)===null||e===void 0?void 0:e.projectId;if(!t)throw fn.create("no project id");return t}function Tk(s){var e;const t=(e=s.options)===null||e===void 0?void 0:e.apiKey;if(!t)throw fn.create("no api key");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nk="0.0.1",ms={loggingEnabled:!0},xk="FIREBASE_INSTALLATIONS_AUTH";function Ak(s,e){const t=Sk();return t?(tN(t),Promise.resolve()):jk(s,e).then(tN).then(i=>wk(i),()=>{})}function Sk(){const s=Ut.getInstance().localStorage;if(!s)return;const e=s.getItem(OA);if(!e||!Ik(e))return;const t=s.getItem(DA);if(t)try{return JSON.parse(t)}catch{return}}function wk(s){const e=Ut.getInstance().localStorage;!s||!e||(e.setItem(DA,JSON.stringify(s)),e.setItem(OA,String(Date.now()+Bn.getInstance().configTimeToLive*60*60*1e3)))}const Ck="Could not fetch config, will use default configs";function jk(s,e){return dk(s.installations).then(t=>{const i=bk(s.app),o=Tk(s.app),c=`https://firebaseremoteconfig.googleapis.com/v1/projects/${i}/namespaces/fireperf:fetch?key=${o}`,d=new Request(c,{method:"POST",headers:{Authorization:`${xk} ${t}`},body:JSON.stringify({app_instance_id:e,app_instance_id_token:t,app_id:VA(s.app),app_version:xA,sdk_version:Nk})});return fetch(d).then(m=>{if(m.ok)return m.json();throw fn.create("RC response not ok")})}).catch(()=>{Ci.info(Ck)})}function tN(s){if(!s)return s;const e=Bn.getInstance(),t=s.entries||{};return t.fpr_enabled!==void 0?e.loggingEnabled=String(t.fpr_enabled)==="true":e.loggingEnabled=ms.loggingEnabled,t.fpr_log_source?e.logSource=Number(t.fpr_log_source):ms.logSource&&(e.logSource=ms.logSource),t.fpr_log_endpoint_url?e.logEndPointUrl=t.fpr_log_endpoint_url:ms.logEndPointUrl&&(e.logEndPointUrl=ms.logEndPointUrl),t.fpr_log_transport_key?e.transportKey=t.fpr_log_transport_key:ms.transportKey&&(e.transportKey=ms.transportKey),t.fpr_vc_network_request_sampling_rate!==void 0?e.networkRequestsSamplingRate=Number(t.fpr_vc_network_request_sampling_rate):ms.networkRequestsSamplingRate!==void 0&&(e.networkRequestsSamplingRate=ms.networkRequestsSamplingRate),t.fpr_vc_trace_sampling_rate!==void 0?e.tracesSamplingRate=Number(t.fpr_vc_trace_sampling_rate):ms.tracesSamplingRate!==void 0&&(e.tracesSamplingRate=ms.tracesSamplingRate),e.logTraceAfterSampling=nN(e.tracesSamplingRate),e.logNetworkAfterSampling=nN(e.networkRequestsSamplingRate),s}function Ik(s){return Number(s)>Date.now()}function nN(s){return Math.random()<=s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dv=1,Dp;function LA(s){return Dv=2,Dp=Dp||Dk(s),Dp}function Rk(){return Dv===3}function Dk(s){return Ok().then(()=>uk(s.installations)).then(e=>Ak(s,e)).then(()=>sN(),()=>sN())}function Ok(){const s=Ut.getInstance().document;return new Promise(e=>{if(s&&s.readyState!=="complete"){const t=()=>{s.readyState==="complete"&&(s.removeEventListener("readystatechange",t),e())};s.addEventListener("readystatechange",t)}else e()})}function sN(){Dv=3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UA=10*1e3,Mk=5.5*1e3,Pk=1e3,FA=3;let ah=FA,xr=[],aN=!1;function kk(){aN||(Ov(Mk),aN=!0)}function Ov(s){setTimeout(()=>{ah<=0||(xr.length>0&&qA(),Ov(UA))},s)}function qA(){const s=xr.splice(0,Pk),e=s.map(i=>({source_extension_json_proto3:i.message,event_time_ms:String(i.eventTime)})),t={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Bn.getInstance().logSource,log_event:e};Vk(t).then(()=>{ah=FA}).catch(()=>{xr=[...s,...xr],ah--,Ci.info(`Tries left: ${ah}.`),Ov(UA)})}function Vk(s){const e=Bn.getInstance().getFlTransportFullUrl(),t=JSON.stringify(s);return navigator.sendBeacon&&navigator.sendBeacon(e,t)?Promise.resolve():fetch(e,{method:"POST",body:t,keepalive:!0}).then()}function Lk(s){if(!s.eventTime||!s.message)throw fn.create("invalid cc log");xr=[...xr,s]}function Uk(s){return(...e)=>{const t=s(...e);Lk({message:t,eventTime:Date.now()})}}function Fk(){for(;xr.length>0;)qA()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pc;function BA(s,e){Pc||(Pc={send:Uk(zk),flush:Fk}),Pc.send(s,e)}function Kd(s){const e=Bn.getInstance();!e.instrumentationEnabled&&s.isAuto||!e.dataCollectionEnabled&&!s.isAuto||Ut.getInstance().requiredApisAvailable()&&(Rk()?Op(s):LA(s.performanceController).then(()=>Op(s),()=>Op(s)))}function qk(){Pc&&Pc.flush()}function Op(s){if(!Rv())return;const e=Bn.getInstance();!e.loggingEnabled||!e.logTraceAfterSampling||BA(s,1)}function Bk(s){const e=Bn.getInstance();if(!e.instrumentationEnabled)return;const t=s.url,i=e.logEndPointUrl.split("?")[0],o=e.flTransportEndpointUrl.split("?")[0];t===i||t===o||!e.loggingEnabled||!e.logNetworkAfterSampling||BA(s,0)}function zk(s,e){return e===0?Hk(s):Gk(s)}function Hk(s){const e={url:s.url,http_method:s.httpMethod||0,http_response_code:200,response_payload_bytes:s.responsePayloadBytes,client_start_time_us:s.startTimeUs,time_to_response_initiated_us:s.timeToResponseInitiatedUs,time_to_response_completed_us:s.timeToResponseCompletedUs},t={application_info:zA(s.performanceController.app),network_request_metric:e};return JSON.stringify(t)}function Gk(s){const e={name:s.name,is_auto:s.isAuto,client_start_time_us:s.startTimeUs,duration_us:s.durationUs};Object.keys(s.counters).length!==0&&(e.counters=s.counters);const t=s.getAttributes();Object.keys(t).length!==0&&(e.custom_attributes=t);const i={application_info:zA(s.performanceController.app),trace_metric:e};return JSON.stringify(i)}function zA(s){return{google_app_id:VA(s),app_instance_id:Rv(),web_app_info:{sdk_version:xA,page_url:Ut.getInstance().getUrl(),service_worker_status:gk(),visibility_state:vk(),effective_connection_type:yk()},application_process_state:0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iN(s,e){const t=e;if(!t||t.responseStart===void 0)return;const i=Ut.getInstance().getTimeOrigin(),o=Math.floor((t.startTime+i)*1e3),c=t.responseStart?Math.floor((t.responseStart-t.startTime)*1e3):void 0,d=Math.floor((t.responseEnd-t.startTime)*1e3),m=t.name&&t.name.split("?")[0],p={performanceController:s,url:m,responsePayloadBytes:t.transferSize,startTimeUs:o,timeToResponseInitiatedUs:c,timeToResponseCompletedUs:d};Bk(p)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $k=100,Kk="_",Yk=[SA,wA,CA,jA,RA,IA];function Qk(s,e){return s.length===0||s.length>$k?!1:e&&e.startsWith(AA)&&Yk.indexOf(s)>-1||!s.startsWith(Kk)}function Xk(s){const e=Math.floor(s);return e<s&&Ci.info(`Metric value should be an Integer, setting the value as : ${e}.`),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc{constructor(e,t,i=!1,o){this.performanceController=e,this.name=t,this.isAuto=i,this.state=1,this.customAttributes={},this.counters={},this.api=Ut.getInstance(),this.randomId=Math.floor(Math.random()*1e6),this.isAuto||(this.traceStartMark=`${nk}-${this.randomId}-${this.name}`,this.traceStopMark=`${sk}-${this.randomId}-${this.name}`,this.traceMeasure=o||`${hg}-${this.randomId}-${this.name}`,o&&this.calculateTraceMetrics())}start(){if(this.state!==1)throw fn.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(this.state!==2)throw fn.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Kd(this)}record(e,t,i){if(e<=0)throw fn.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw fn.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(t*1e3),this.startTimeUs=Math.floor(e*1e3),i&&i.attributes&&(this.customAttributes=Object.assign({},i.attributes)),i&&i.metrics)for(const o of Object.keys(i.metrics))isNaN(Number(i.metrics[o]))||(this.counters[o]=Math.floor(Number(i.metrics[o])));Kd(this)}incrementMetric(e,t=1){this.counters[e]===void 0?this.putMetric(e,t):this.putMetric(e,this.counters[e]+t)}putMetric(e,t){if(Qk(e,this.name))this.counters[e]=Xk(t??0);else throw fn.create("invalid custom metric name",{customMetricName:e})}getMetric(e){return this.counters[e]||0}putAttribute(e,t){const i=_k(e),o=Ek(t);if(i&&o){this.customAttributes[e]=t;return}if(!i)throw fn.create("invalid attribute name",{attributeName:e});if(!o)throw fn.create("invalid attribute value",{attributeValue:t})}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){this.customAttributes[e]!==void 0&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),t=e&&e[0];t&&(this.durationUs=Math.floor(t.duration*1e3),this.startTimeUs=Math.floor((t.startTime+this.api.getTimeOrigin())*1e3))}static createOobTrace(e,t,i,o,c){const d=Ut.getInstance().getUrl();if(!d)return;const m=new Yc(e,AA+d,!0),p=Math.floor(Ut.getInstance().getTimeOrigin()*1e3);m.setStartTime(p),t&&t[0]&&(m.setDuration(Math.floor(t[0].duration*1e3)),m.putMetric("domInteractive",Math.floor(t[0].domInteractive*1e3)),m.putMetric("domContentLoadedEventEnd",Math.floor(t[0].domContentLoadedEventEnd*1e3)),m.putMetric("loadEventEnd",Math.floor(t[0].loadEventEnd*1e3)));const v="first-paint",_="first-contentful-paint";if(i){const T=i.find(C=>C.name===v);T&&T.startTime&&m.putMetric(SA,Math.floor(T.startTime*1e3));const x=i.find(C=>C.name===_);x&&x.startTime&&m.putMetric(wA,Math.floor(x.startTime*1e3)),c&&m.putMetric(CA,Math.floor(c*1e3))}this.addWebVitalMetric(m,jA,ak,o.lcp),this.addWebVitalMetric(m,RA,rk,o.cls),this.addWebVitalMetric(m,IA,ik,o.inp),Kd(m),qk()}static addWebVitalMetric(e,t,i,o){o&&(e.putMetric(t,Math.floor(o.value*1e3)),o.elementAttribution&&e.putAttribute(i,o.elementAttribution))}static createUserTimingTrace(e,t){const i=new Yc(e,t,!1,t);Kd(i)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ih={},rN=!1,HA;function oN(s){Rv()&&(setTimeout(()=>Zk(s),0),setTimeout(()=>Wk(s),0),setTimeout(()=>Jk(s),0))}function Wk(s){const e=Ut.getInstance(),t=e.getEntriesByType("resource");for(const i of t)iN(s,i);e.setupObserver("resource",i=>iN(s,i))}function Zk(s){const e=Ut.getInstance();"onpagehide"in window?e.document.addEventListener("pagehide",()=>Mp(s)):e.document.addEventListener("unload",()=>Mp(s)),e.document.addEventListener("visibilitychange",()=>{e.document.visibilityState==="hidden"&&Mp(s)}),e.onFirstInputDelay&&e.onFirstInputDelay(t=>{HA=t}),e.onLCP(t=>{var i;ih.lcp={value:t.value,elementAttribution:(i=t.attribution)===null||i===void 0?void 0:i.element}}),e.onCLS(t=>{var i;ih.cls={value:t.value,elementAttribution:(i=t.attribution)===null||i===void 0?void 0:i.largestShiftTarget}}),e.onINP(t=>{var i;ih.inp={value:t.value,elementAttribution:(i=t.attribution)===null||i===void 0?void 0:i.interactionTarget}})}function Jk(s){const e=Ut.getInstance(),t=e.getEntriesByType("measure");for(const i of t)lN(s,i);e.setupObserver("measure",i=>lN(s,i))}function lN(s,e){const t=e.name;t.substring(0,hg.length)!==hg&&Yc.createUserTimingTrace(s,t)}function Mp(s){if(!rN){rN=!0;const e=Ut.getInstance(),t=e.getEntriesByType("navigation"),i=e.getEntriesByType("paint");setTimeout(()=>{Yc.createOobTrace(s,t,i,ih,HA)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e2{constructor(e,t){this.app=e,this.installations=t,this.initialized=!1}_init(e){this.initialized||(e?.dataCollectionEnabled!==void 0&&(this.dataCollectionEnabled=e.dataCollectionEnabled),e?.instrumentationEnabled!==void 0&&(this.instrumentationEnabled=e.instrumentationEnabled),Ut.getInstance().requiredApisAvailable()?vg().then(t=>{t&&(kk(),LA(this).then(()=>oN(this),()=>oN(this)),this.initialized=!0)}).catch(t=>{Ci.info(`Environment doesn't support IndexedDB: ${t}`)}):Ci.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){Bn.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return Bn.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){Bn.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return Bn.getInstance().dataCollectionEnabled}}const t2="[DEFAULT]";function n2(s=Wc()){return s=ut(s),Ra(s,"performance").getImmediate()}const s2=(s,{options:e})=>{const t=s.getProvider("app").getImmediate(),i=s.getProvider("installations-internal").getImmediate();if(t.name!==t2)throw fn.create("FB not default");if(typeof window>"u")throw fn.create("no window");ck(window);const o=new e2(t,i);return o._init(e),o};function a2(){is(new Gn("performance",s2,"PUBLIC")),mn(JT,dg),mn(JT,dg,"esm2017")}a2();const i2={apiKey:"AIzaSyCbU834quCY8hjSffRwljJLgZrcxK8i2F4",authDomain:"liquidacionapp-62962.firebaseapp.com",projectId:"liquidacionapp-62962",storageBucket:"liquidacionapp-62962.firebasestorage.app",messagingSenderId:"851382130132",appId:"1:851382130132:web:eaba38fab449f14fb5b241"},fu=wN(i2);typeof window<"u"&&LP(fu);typeof window<"u"&&n2(fu);const kc=PR(fu),Re=PO(fu);_M(fu);const gs={ADMIN:"admin",CONTADOR:"contador",CLIENTE:"cliente"},ft={MANAGE_INVENTORY:"canManageInventory",CREATE_MOVEMENTS:"canCreateMovements",VIEW_ALL_MOVEMENTS:"canViewAllMovements",MANAGE_VEHICLES:"canManageVehicles",MANAGE_SUPPLIERS:"canManageSuppliers",VIEW_REPORTS:"canViewReports",EXPORT_REPORTS:"canExportReports",MODIFY_SETTINGS:"canModifySettings"},r2="contacto.evert@gmail.com",GA=s=>{switch(s){case gs.ADMIN:return{[ft.MANAGE_INVENTORY]:!0,[ft.CREATE_MOVEMENTS]:!0,[ft.VIEW_ALL_MOVEMENTS]:!0,[ft.MANAGE_VEHICLES]:!0,[ft.MANAGE_SUPPLIERS]:!0,[ft.VIEW_REPORTS]:!0,[ft.EXPORT_REPORTS]:!0,[ft.MODIFY_SETTINGS]:!0};case gs.CONTADOR:return{[ft.MANAGE_INVENTORY]:!0,[ft.CREATE_MOVEMENTS]:!0,[ft.VIEW_ALL_MOVEMENTS]:!0,[ft.MANAGE_VEHICLES]:!1,[ft.MANAGE_SUPPLIERS]:!1,[ft.VIEW_REPORTS]:!0,[ft.EXPORT_REPORTS]:!0,[ft.MODIFY_SETTINGS]:!1};case gs.CLIENTE:default:return{[ft.MANAGE_INVENTORY]:!1,[ft.CREATE_MOVEMENTS]:!0,[ft.VIEW_ALL_MOVEMENTS]:!1,[ft.MANAGE_VEHICLES]:!1,[ft.MANAGE_SUPPLIERS]:!1,[ft.VIEW_REPORTS]:!1,[ft.EXPORT_REPORTS]:!1,[ft.MODIFY_SETTINGS]:!1}}},o2=s=>s===r2?gs.ADMIN:gs.CLIENTE,Zo=()=>"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/invitations",l2=()=>{const s="ABCDEFGHIJKLMNPQRSTUVWXYZ123456789";let e="";for(let t=0;t<8;t++)e+=s.charAt(Math.floor(Math.random()*s.length));return e},c2=async(s,e)=>{try{const t=await of(e);if(!t.success||t.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden crear invitaciones"};let i,o=!1,c=0;for(;!o&&c<10;){i=l2();const p=Xe(pt(Re,Zo()),mt("code","==",i));(await Rn(p)).empty&&(o=!0),c++}if(!o)return{success:!1,error:"No se pudo generar un código único"};const d=Ft(pt(Re,Zo())),m={code:i,targetEmail:s.email.toLowerCase(),targetRole:s.role||gs.CLIENTE,targetName:s.name||"",status:"pending",appContext:"combustibles",expiresAt:new Date(Date.now()+7*24*60*60*1e3),createdAt:jn(),createdBy:e,usedAt:null,usedBy:null};return await vv(d,m),console.log("🎫 Invitación creada:",{code:i,email:s.email,role:s.role}),{success:!0,invitation:{id:d.id,code:i,...m}}}catch(t){return console.error("Error creating invitation:",t),{success:!1,error:t.message}}},$A=async s=>{try{const e=Xe(pt(Re,Zo()),mt("code","==",s.toUpperCase()),mt("status","==","pending")),t=await Rn(e);if(t.empty)return{success:!1,error:"Código de invitación inválido o expirado"};const i=t.docs[0],o=i.data(),c=new Date,d=o.expiresAt.toDate();return c>d?{success:!1,error:"Código de invitación expirado"}:{success:!0,invitation:{id:i.id,...o}}}catch(e){return console.error("Error validating invitation:",e),{success:!1,error:e.message}}},u2=async(s,e)=>{try{const t=Ft(Re,Zo(),s);return await Vr(t,{status:"used",usedAt:jn(),usedBy:e}),{success:!0}}catch(t){return console.error("Error marking invitation as used:",t),{success:!1,error:t.message}}},d2=async s=>{try{const e=await of(s);if(!e.success||e.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden ver invitaciones"};const t=Xe(pt(Re,Zo())),i=await Rn(t),o=[];return i.forEach(c=>{o.push({id:c.id,...c.data()})}),o.sort((c,d)=>{const m=c.createdAt?.toDate()||new Date(0);return(d.createdAt?.toDate()||new Date(0))-m}),{success:!0,invitations:o}}catch(e){return console.error("Error getting invitations:",e),{success:!1,error:e.message}}},h2=async(s,e)=>{try{const t=await of(e);if(!t.success||t.userData.role!=="admin")return{success:!1,error:"Solo administradores pueden cancelar invitaciones"};const i=Ft(Re,Zo(),s);return await Vr(i,{status:"cancelled",cancelledAt:jn(),cancelledBy:e}),{success:!0}}catch(t){return console.error("Error cancelling invitation:",t),{success:!1,error:t.message}}},f2=s=>GA(s.targetRole),KA=async(s,e={})=>{const t=Ft(Re,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",s.uid);try{const i=await kr(t);if(i.exists())return{success:!0,userData:i.data(),isNewUser:!1};{const o=o2(s.email),c={uid:s.uid,email:s.email,displayName:s.displayName||"",photoURL:s.photoURL||"",role:o,emailVerified:s.emailVerified,combustiblesPermissions:GA(o),createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),...e};return await vv(t,c),{success:!0,userData:c,isNewUser:!0}}}catch(i){return console.error("Error creating/updating user profile:",i),{success:!1,error:i.message}}},cN=async(s,e,t={})=>{const i=Ft(Re,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",s.uid);try{const o=await kr(i);if(o.exists())return{success:!0,userData:o.data(),isNewUser:!1};const c=await $A(e);if(!c.success)return c;const d=c.invitation;if(d.targetEmail!==s.email.toLowerCase())return{success:!1,error:"El código de invitación no corresponde a este email"};const m={uid:s.uid,email:s.email,displayName:s.displayName||d.targetName||"",photoURL:s.photoURL||"",role:d.targetRole,emailVerified:s.emailVerified,combustiblesPermissions:f2(d),invitationUsed:d.id,createdAt:new Date().toISOString(),lastLogin:new Date().toISOString(),...t};return await vv(i,m),await u2(d.id,s.uid),console.log("👤 Usuario creado con invitación:",{email:s.email,role:d.targetRole,invitationCode:d.code}),{success:!0,userData:m,isNewUser:!0}}catch(o){return console.error("Error creating user profile with invitation:",o),{success:!1,error:o.message}}},of=async s=>{try{const e=Ft(Re,"artifacts/1:851382130132:web:eaba38fab449f14fb5b241/users",s),t=await kr(e);return t.exists()?{success:!0,userData:t.data()}:{success:!1,error:"Usuario no encontrado"}}catch(e){return console.error("Error fetching user profile:",e),{success:!1,error:e.message}}},YA=W.createContext(),Da=()=>{const s=W.useContext(YA);if(s===void 0)throw new Error("useCombustibles must be used within a CombustiblesProvider");return s},m2=({children:s})=>{const[e,t]=W.useState(null),[i,o]=W.useState(null),[c,d]=W.useState(!0),[m,p]=W.useState(null),[v,_]=W.useState([]),[T,x]=W.useState([]),[C,N]=W.useState([]),[M,S]=W.useState([]);W.useEffect(()=>{const R=NI(kc,async I=>{try{if(d(!0),I){t(I);let k=await of(I.uid);k.success||(k=await KA(I,{provider:"existing_account",appContext:"combustibles"})),k.success?o(k.userData):p("Error cargando perfil de usuario")}else t(null),o(null),_([]),x([]),N([]),S([])}catch(k){console.error("Error en autenticación:",k),p("Error de autenticación")}finally{d(!1)}});return()=>R()},[]);const A={user:e,userProfile:i,loading:c,error:m,hasPermission:R=>i?.combustiblesPermissions?.[R]||!1,isAdmin:()=>i?.role==="admin",isCounterOrAbove:()=>i?.role==="admin"||i?.role==="contador",inventory:v,movements:T,vehicles:C,suppliers:M,setInventory:_,setMovements:x,setVehicles:N,setSuppliers:S,refreshInventory:async()=>{console.log("Refrescando inventario...")},refreshMovements:async()=>{console.log("Refrescando movimientos...")},refreshVehicles:async()=>{console.log("Refrescando vehículos...")},refreshSuppliers:async()=>{console.log("Refrescando proveedores...")}};return r.jsx(YA.Provider,{value:A,children:s})},p2=({children:s,currentView:e,onViewChange:t})=>{const{userProfile:i,isAdmin:o,isCounterOrAbove:c}=Da(),[d,m]=W.useState(!1),p=[{id:"dashboard",name:"Dashboard",icon:"📊",description:"Vista general",requiredPermission:null},{id:"inventory",name:"Inventario",icon:"🛢️",description:"Gestión de stock",requiredPermission:"canManageInventory"},{id:"movements",name:"Movimientos",icon:"📈",description:"Entradas y salidas",requiredPermission:"canCreateMovements"},{id:"vehicles",name:"Vehículos",icon:"🚜",description:"Maquinaria forestal",requiredPermission:null},{id:"products",name:"Productos",icon:"🛢️",description:"Tipos de combustibles",requiredPermission:null},{id:"suppliers",name:"Proveedores",icon:"🏪",description:"Gestión de proveedores",requiredPermission:"canManageSuppliers"},{id:"reports",name:"Reportes",icon:"📋",description:"Análisis y reportes",requiredPermission:"canViewReports"},{id:"admin",name:"Administración",icon:"⚙️",description:"Gestión de usuarios",requiredPermission:"admin"}],v=C=>{t(C),m(!1)},_=C=>C?C==="admin"?o():i?.combustiblesPermissions?.[C]||!1:!0,T=p.filter(C=>_(C.requiredPermission)),x=async()=>{try{await xI(kc)}catch(C){console.error("Error al cerrar sesión:",C)}};return r.jsxs("div",{className:"dashboard-layout",children:[r.jsx("header",{className:"dashboard-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"sidebar-toggle",onClick:()=>m(!d),children:"☰"}),r.jsxs("div",{className:"header-title",children:[r.jsx("h1",{children:"⛽ Gestión de Combustibles"}),r.jsx("span",{className:"subtitle",children:"Forestech Colombia"})]}),r.jsxs("div",{className:"header-user",children:[r.jsxs("div",{className:"user-info",children:[r.jsx("span",{className:"user-name",children:i?.displayName||i?.email}),r.jsx("span",{className:"user-role",children:i?.role})]}),r.jsx("div",{className:"user-avatar",children:i?.photoURL?r.jsx("img",{src:i.photoURL,alt:"Avatar"}):r.jsx("div",{className:"avatar-placeholder",children:(i?.displayName||i?.email||"U").charAt(0).toUpperCase()})}),r.jsx("button",{className:"logout-button",onClick:x,title:"Cerrar sesión",children:"🚪"})]})]})}),r.jsxs("div",{className:"dashboard-body",children:[r.jsxs("aside",{className:`dashboard-sidebar ${d?"open":""}`,children:[r.jsx("nav",{className:"sidebar-nav",children:T.map(C=>r.jsxs("button",{className:`nav-item ${e===C.id?"active":""}`,onClick:()=>v(C.id),children:[r.jsx("span",{className:"nav-icon",children:C.icon}),r.jsxs("div",{className:"nav-content",children:[r.jsx("span",{className:"nav-name",children:C.name}),r.jsx("span",{className:"nav-description",children:C.description})]})]},C.id))}),r.jsx("div",{className:"sidebar-footer",children:r.jsxs("div",{className:"user-permissions",children:[r.jsx("h4",{children:"Permisos Activos:"}),r.jsxs("div",{className:"permission-list",children:[o()&&r.jsx("span",{className:"permission admin",children:"👑 Administrador"}),c()&&r.jsx("span",{className:"permission counter",children:"📊 Gestión Operativa"}),_("canManageInventory")&&r.jsx("span",{className:"permission",children:"🛢️ Inventario"}),_("canManageVehicles")&&r.jsx("span",{className:"permission",children:"🚜 Vehículos"})]})]})})]}),r.jsx("main",{className:"dashboard-main",children:r.jsx("div",{className:"main-content",children:s})})]}),d&&r.jsx("div",{className:"sidebar-overlay",onClick:()=>m(!1)})]})},bn={DIESEL:"diesel",GASOLINE:"gasoline",ACPM:"acpm",LUBRICANTS:"lubricants",TWO_STROKE:"two_stroke",MIXED:"mixed"},Jo={[bn.DIESEL]:{name:"Diésel",description:"Combustible para maquinaria pesada",unit:"galones",category:"Combustible",color:"#fbbf24",icon:"🚛",density:.85,priceUnit:"COP/galón"},[bn.GASOLINE]:{name:"Gasolina",description:"Combustible para vehículos livianos",unit:"galones",category:"Combustible",color:"#ef4444",icon:"⛽",density:.75,priceUnit:"COP/galón"},[bn.ACPM]:{name:"ACPM",description:"Aceite Combustible Para Motor",unit:"galones",category:"Combustible",color:"#8b5cf6",icon:"🚜",density:.85,priceUnit:"COP/galón"},[bn.LUBRICANTS]:{name:"Lubricantes",description:"Aceites y lubricantes para mantenimiento",unit:"litros",category:"Mantenimiento",color:"#06b6d4",icon:"🛢️",density:.9,priceUnit:"COP/litro"},[bn.TWO_STROKE]:{name:"Mezcla 2T",description:"Mezcla para motores de 2 tiempos (motosierras)",unit:"litros",category:"Especializado",color:"#10b981",icon:"🪚",density:.78,priceUnit:"COP/litro"},[bn.MIXED]:{name:"Mixto",description:"Compatible con múltiples tipos de combustible",unit:"galones",category:"Flexible",color:"#64748b",icon:"🔄",density:.8,priceUnit:"COP/galón"}},En={CRITICAL:"critical",LOW:"low",MEDIUM:"medium",HIGH:"high",FULL:"full"},Uo={[En.CRITICAL]:{label:"Crítico",color:"#dc2626",icon:"🚨",threshold:.1},[En.LOW]:{label:"Bajo",color:"#ea580c",icon:"⚠️",threshold:.25},[En.MEDIUM]:{label:"Medio",color:"#ca8a04",icon:"📊",threshold:.5},[En.HIGH]:{label:"Alto",color:"#16a34a",icon:"✅",threshold:.75},[En.FULL]:{label:"Completo",color:"#059669",icon:"🟢",threshold:1}},QA=(s,e)=>{if(e===0)return En.CRITICAL;const t=s/e;return t<Uo[En.CRITICAL].threshold?En.CRITICAL:t<Uo[En.LOW].threshold?En.LOW:t<Uo[En.MEDIUM].threshold?En.MEDIUM:t<Uo[En.HIGH].threshold?En.HIGH:En.FULL},el="combustibles_inventory",g2=async(s,e)=>{try{const t=Jo[s.fuelType];if(!t)return{success:!1,error:"Tipo de combustible no válido"};const i=Xe(pt(Re,el),mt("fuelType","==",s.fuelType),mt("location","==",s.location));if(!(await Rn(i)).empty)return{success:!1,error:`Ya existe ${t.name} en ${s.location}`};const c={fuelType:s.fuelType,name:t.name,description:s.description||t.description,currentStock:Number(s.currentStock)||0,maxCapacity:Number(s.maxCapacity),minThreshold:Number(s.minThreshold)||s.maxCapacity*.15,unit:t.unit,location:s.location,pricePerUnit:Number(s.pricePerUnit)||0,supplier:s.supplier||"",status:s.status||"active",createdAt:new Date,createdBy:e,lastUpdated:new Date,updatedBy:e};return{success:!0,data:{id:(await yv(pt(Re,el),c)).id,...c},message:`${t.name} agregado al inventario exitosamente`}}catch(t){return console.error("Error creating inventory item:",t),{success:!1,error:t.message}}},XA=async()=>{try{const s=Xe(pt(Re,el),Ys("fuelType","asc")),e=await Rn(s),t=[];return e.forEach(i=>{const o=i.data();t.push({id:i.id,...o,stockLevel:QA(o.currentStock,o.maxCapacity),stockPercentage:Math.round(o.currentStock/o.maxCapacity*100),needsRestock:o.currentStock<=o.minThreshold})}),{success:!0,data:t}}catch(s){return console.error("Error fetching inventory items:",s),{success:!1,error:s.message}}},v2=async(s,e,t)=>{try{const i=Ft(Re,el,s);if(!(await kr(i)).exists())return{success:!1,error:"Item no encontrado"};const c={...e,lastUpdated:new Date,updatedBy:t};return delete c.id,delete c.createdAt,delete c.createdBy,await Vr(i,c),{success:!0,message:"Item actualizado exitosamente",data:{id:s,...c}}}catch(i){return console.error("Error updating inventory item:",i),{success:!1,error:i.message}}},y2=async s=>{try{const e=Ft(Re,el,s);return(await kr(e)).exists()?(await q0(e),{success:!0,message:"Item eliminado exitosamente"}):{success:!1,error:"Item no encontrado"}}catch(e){return console.error("Error deleting inventory item:",e),{success:!1,error:e.message}}},WA=s=>{const e=Xe(pt(Re,el),Ys("fuelType","asc"));return du(e,t=>{const i=[];t.forEach(o=>{const c=o.data();i.push({id:o.id,...c,stockLevel:QA(c.currentStock,c.maxCapacity),stockPercentage:Math.round(c.currentStock/c.maxCapacity*100),needsRestock:c.currentStock<=c.minThreshold})}),s(i)},t=>{console.error("Error in inventory subscription:",t),s(null,t)})},_2=async()=>{try{const s=await XA();if(!s.success)return s;const e=s.data,t={totalItems:e.length,activeItems:e.filter(i=>i.status==="active").length,lowStockItems:e.filter(i=>i.needsRestock).length,totalValue:e.reduce((i,o)=>i+o.currentStock*o.pricePerUnit,0),averageStockLevel:e.length>0?Math.round(e.reduce((i,o)=>i+o.stockPercentage,0)/e.length):0,byFuelType:{}};return e.forEach(i=>{t.byFuelType[i.fuelType]||(t.byFuelType[i.fuelType]={count:0,totalStock:0,totalCapacity:0,totalValue:0}),t.byFuelType[i.fuelType].count++,t.byFuelType[i.fuelType].totalStock+=i.currentStock,t.byFuelType[i.fuelType].totalCapacity+=i.maxCapacity,t.byFuelType[i.fuelType].totalValue+=i.currentStock*i.pricePerUnit}),{success:!0,data:t}}catch(s){return console.error("Error calculating inventory stats:",s),{success:!1,error:s.message}}},ll="combustibles_movements",uN="combustibles_inventory",_e={ENTRADA:"entrada",SALIDA:"salida",TRANSFERENCIA:"transferencia",AJUSTE:"ajuste"},qe={PENDIENTE:"pendiente",COMPLETADO:"completado",CANCELADO:"cancelado"},E2=async s=>{try{A2(s);const e={...s,createdAt:jn(),updatedAt:jn(),status:qe.PENDIENTE,totalValue:JA(s),effectiveDate:s.effectiveDate||jn()},t=await z0(Re,async i=>{const o=Ft(pt(Re,ll));return i.set(o,e),await eS(i,e,o.id),o.id});return console.log("✅ Movimiento creado exitosamente:",t),t}catch(e){throw console.error("❌ Error al crear movimiento:",e),new Error(`Error al crear movimiento: ${e.message}`)}},b2=async(s={})=>{try{let e=pt(Re,ll);s.type&&(e=Xe(e,mt("type","==",s.type))),s.status&&(e=Xe(e,mt("status","==",s.status))),s.fuelType&&(e=Xe(e,mt("fuelType","==",s.fuelType))),s.vehicleId&&(e=Xe(e,mt("vehicleId","==",s.vehicleId))),e=Xe(e,Ys("createdAt","desc"));const t=await Rn(e),i=[];return t.forEach(o=>{i.push({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate?.()||o.data().createdAt,updatedAt:o.data().updatedAt?.toDate?.()||o.data().updatedAt,effectiveDate:o.data().effectiveDate?.toDate?.()||o.data().effectiveDate})}),i}catch(e){throw console.error("❌ Error al obtener movimientos:",e),new Error(`Error al obtener movimientos: ${e.message}`)}},T2=async s=>{try{if(!s)throw new Error("ID de movimiento requerido");const e=Ft(Re,ll,s),t=await kr(e);return t.exists()?{id:t.id,...t.data(),createdAt:t.data().createdAt?.toDate?.()||t.data().createdAt,updatedAt:t.data().updatedAt?.toDate?.()||t.data().updatedAt,effectiveDate:t.data().effectiveDate?.toDate?.()||t.data().effectiveDate}:null}catch(e){throw console.error("❌ Error al obtener movimiento:",e),new Error(`Error al obtener movimiento: ${e.message}`)}},ZA=async(s,e)=>{try{if(!s)throw new Error("ID de movimiento requerido");const t={...e,updatedAt:jn(),...e.quantity||e.unitPrice?{totalValue:JA(e)}:{}},i=Ft(Re,ll,s);await Vr(i,t),console.log("✅ Movimiento actualizado exitosamente")}catch(t){throw console.error("❌ Error al actualizar movimiento:",t),new Error(`Error al actualizar movimiento: ${t.message}`)}},Mv=(s,e={})=>{try{let t=pt(Re,ll);return e.type&&(t=Xe(t,mt("type","==",e.type))),e.status&&(t=Xe(t,mt("status","==",e.status))),t=Xe(t,Ys("createdAt","desc")),du(t,i=>{const o=[];i.forEach(c=>{o.push({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt,effectiveDate:c.data().effectiveDate?.toDate?.()||c.data().effectiveDate})}),s(o)},i=>{console.error("❌ Error en suscripción de movimientos:",i),s([],i)})}catch(t){throw console.error("❌ Error al configurar suscripción:",t),new Error(`Error en suscripción: ${t.message}`)}},N2=async s=>{try{const e=await T2(s);if(!e)throw new Error("Movimiento no encontrado");if(e.status!==qe.PENDIENTE)throw new Error("Solo se pueden aprobar movimientos pendientes");await z0(Re,async t=>{const i=Ft(Re,ll,s);t.update(i,{status:qe.COMPLETADO,approvedAt:jn(),updatedAt:jn()}),await eS(t,e,s)}),console.log("✅ Movimiento aprobado exitosamente")}catch(e){throw console.error("❌ Error al aprobar movimiento:",e),new Error(`Error al aprobar movimiento: ${e.message}`)}},x2=async(s={})=>{try{const e=await b2(s),t={totalMovements:e.length,byType:{},byStatus:{},byFuelType:{},totalValue:0,totalQuantity:0,averageValue:0,thisMonth:0,lastMonth:0,thisWeek:0},i=new Date,o=new Date(i.getFullYear(),i.getMonth(),1),c=new Date(i.getFullYear(),i.getMonth()-1,1),d=new Date(i.setDate(i.getDate()-i.getDay()));return e.forEach(m=>{t.byType[m.type]=(t.byType[m.type]||0)+1,t.byStatus[m.status]=(t.byStatus[m.status]||0)+1,t.byFuelType[m.fuelType]=(t.byFuelType[m.fuelType]||0)+1,t.totalValue+=m.totalValue||0,t.totalQuantity+=m.quantity||0;const p=new Date(m.createdAt);p>=o&&t.thisMonth++,p>=c&&p<o&&t.lastMonth++,p>=d&&t.thisWeek++}),t.averageValue=t.totalMovements>0?t.totalValue/t.totalMovements:0,t}catch(e){throw console.error("❌ Error al calcular estadísticas:",e),new Error(`Error al calcular estadísticas: ${e.message}`)}},A2=s=>{const e=["type","fuelType","quantity","unitPrice"];for(const t of e)if(!s[t])throw new Error(`Campo requerido: ${t}`);if(!Object.values(_e).includes(s.type))throw new Error("Tipo de movimiento inválido");if(s.quantity<=0)throw new Error("La cantidad debe ser mayor a cero");if(s.unitPrice<0)throw new Error("El precio unitario no puede ser negativo");if(s.type===_e.SALIDA&&!s.vehicleId)throw new Error("Las salidas deben tener un vehículo asociado");if(s.type===_e.TRANSFERENCIA&&!s.destinationLocation)throw new Error("Las transferencias deben tener una ubicación destino")},JA=s=>(s.quantity||0)*(s.unitPrice||0),eS=async(s,e,t)=>{try{const i=Xe(pt(Re,uN),mt("fuelType","==",e.fuelType),mt("location","==",e.location||"principal")),o=await Rn(i);if(o.empty)throw new Error(`No se encontró inventario para ${e.fuelType} en ${e.location||"ubicación principal"}`);const c=o.docs[0],d=c.data(),m=Ft(Re,uN,c.id);let p=d.currentStock;switch(e.type){case _e.ENTRADA:p+=e.quantity;break;case _e.SALIDA:if(p-=e.quantity,p<0)throw new Error("Stock insuficiente para realizar la salida");break;case _e.AJUSTE:p+=e.quantity,p<0&&(p=0);break;case _e.TRANSFERENCIA:if(p-=e.quantity,p<0)throw new Error("Stock insuficiente para realizar la transferencia");break}s.update(m,{currentStock:p,lastMovement:{movementId:t,type:e.type,quantity:e.quantity,date:jn()},updatedAt:jn()})}catch(i){throw console.error("❌ Error al actualizar inventario:",i),i}},tS="combustibles_vehicles",pe={EXCAVADORA:"excavadora",BULLDOZER:"bulldozer",CARGADOR:"cargador",CAMION:"camion",GRUA:"grua",MOTOSIERRA:"motosierra",TRACTOR:"tractor",VOLQUETA:"volqueta",OTROS:"otros"},Ie={ACTIVO:"activo",MANTENIMIENTO:"mantenimiento",INACTIVO:"inactivo",REPARACION:"reparacion"},bt={DIESEL:"Diesel",GASOLINA:"Gasolina",ACPM:"ACPM",MIXTO:"Mixto"},nS=async(s={})=>{try{let e=pt(Re,tS);s.type&&(e=Xe(e,mt("type","==",s.type))),s.status&&(e=Xe(e,mt("status","==",s.status))),s.fuelType&&(e=Xe(e,mt("fuelType","==",s.fuelType))),s.location&&(e=Xe(e,mt("currentLocation","==",s.location))),e=Xe(e,Ys("vehicleId","asc"));const t=await Rn(e),i=[];return t.forEach(o=>{i.push({id:o.id,...o.data(),createdAt:o.data().createdAt?.toDate?.()||o.data().createdAt,updatedAt:o.data().updatedAt?.toDate?.()||o.data().updatedAt,lastMovementDate:o.data().lastMovementDate?.toDate?.()||o.data().lastMovementDate,lastMaintenanceDate:o.data().lastMaintenanceDate?.toDate?.()||o.data().lastMaintenanceDate})}),i}catch(e){throw console.error("❌ Error al obtener vehículos:",e),new Error(`Error al obtener vehículos: ${e.message}`)}},sS=(s,e={})=>{try{let t=pt(Re,tS);return e.type&&(t=Xe(t,mt("type","==",e.type))),e.status&&(t=Xe(t,mt("status","==",e.status))),t=Xe(t,Ys("vehicleId","asc")),du(t,i=>{const o=[];i.forEach(c=>{o.push({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate?.()||c.data().createdAt,updatedAt:c.data().updatedAt?.toDate?.()||c.data().updatedAt,lastMovementDate:c.data().lastMovementDate?.toDate?.()||c.data().lastMovementDate,lastMaintenanceDate:c.data().lastMaintenanceDate?.toDate?.()||c.data().lastMaintenanceDate})}),s(o)},i=>{console.error("❌ Error en suscripción de vehículos:",i),s([],i)})}catch(t){throw console.error("❌ Error al configurar suscripción:",t),new Error(`Error en suscripción: ${t.message}`)}},S2=async(s={})=>{try{const e=await nS(s),t={totalVehicles:e.length,byType:{},byStatus:{},byFuelType:{},totalFuelConsumed:0,totalHoursWorked:0,averageConsumption:0,mostActiveVehicle:null,leastActiveVehicle:null};let i=0,o=1/0;return e.forEach(c=>{t.byType[c.type]=(t.byType[c.type]||0)+1,t.byStatus[c.status]=(t.byStatus[c.status]||0)+1,t.byFuelType[c.fuelType]=(t.byFuelType[c.fuelType]||0)+1,t.totalFuelConsumed+=c.totalFuelConsumed||0,t.totalHoursWorked+=c.totalHoursWorked||0;const d=c.totalMovements||0;d>i&&(i=d,t.mostActiveVehicle=c),d<o&&d>0&&(o=d,t.leastActiveVehicle=c)}),t.totalHoursWorked>0&&(t.averageConsumption=t.totalFuelConsumed/t.totalHoursWorked),t}catch(e){throw console.error("❌ Error al calcular estadísticas:",e),new Error(`Error al calcular estadísticas: ${e.message}`)}},mu="combustibles_products",dN=async s=>{try{const e={...s,createdAt:jn(),updatedAt:jn()},t=await yv(pt(Re,mu),e);return console.log("Product created with ID:",t.id),t.id}catch(e){throw console.error("Error creating product:",e),e}},w2=async(s,e)=>{try{const t=Ft(Re,mu,s);await Vr(t,{...e,updatedAt:jn()}),console.log("Product updated successfully")}catch(t){throw console.error("Error updating product:",t),t}},C2=async s=>{try{await q0(Ft(Re,mu,s)),console.log("Product deleted successfully")}catch(e){throw console.error("Error deleting product:",e),e}},j2=async()=>{try{const s=Xe(pt(Re,mu),mt("isActive","==",!0),Ys("name"));return(await Rn(s)).docs.map(t=>({id:t.id,...t.data()}))}catch(s){throw console.error("Error getting active products:",s),s}},aS=(s,e)=>{try{const t=Xe(pt(Re,mu),Ys("name"));return du(t,i=>{const o=i.docs.map(c=>({id:c.id,...c.data()}));s(o)},i=>{console.error("Error in products subscription:",i),e(i)})}catch(t){return console.error("Error setting up products subscription:",t),e(t),()=>{}}},hN=()=>{const[s,e]=W.useState({totalFuel:0,activeVehicles:0,pendingMovements:0,lowStockAlerts:0,totalProducts:0}),[t,i]=W.useState([]),[o,c]=W.useState([]),[d,m]=W.useState(!0),[p,v]=W.useState(null),[_,T]=W.useState({inventory:!1,movements:!1,vehicles:!1,products:!1});W.useEffect(()=>{m(!0),v(null);const N=WA($=>{const F=$.reduce((B,ee)=>B+(ee.currentStock||0),0),V=$.filter(B=>(B.currentStock||0)<(B.minThreshold||0)).length;e(B=>({...B,totalFuel:F,lowStockAlerts:V})),T(B=>({...B,inventory:!0}))}),M=Mv($=>{const F=$.filter(B=>B.status==="pending").length,V=$.sort((B,ee)=>ee.date.toMillis()-B.date.toMillis()).slice(0,5);e(B=>({...B,pendingMovements:F})),i(V),T(B=>({...B,movements:!0}))},$=>{console.error("Error loading movements:",$),v("Error cargando movimientos")}),S=sS($=>{const F=$.filter(V=>V.status==="active").length;e(V=>({...V,activeVehicles:F})),T(V=>({...V,vehicles:!0}))},$=>{console.error("Error loading vehicles:",$),v("Error cargando vehículos")}),U=aS($=>{const F=$.length;c($),e(V=>({...V,totalProducts:F})),T(V=>({...V,products:!0}))},$=>{console.error("Error loading products:",$),T(F=>({...F,products:!0}))});return()=>{N(),M(),S(),U()}},[]),W.useEffect(()=>{Object.values(_).every(M=>M)&&m(!1)},[_]);const x=W.useMemo(()=>N=>new Intl.NumberFormat("es-CO").format(N),[]),C=N=>{switch(N.type){case"entry":return`Entrada de ${N.quantity} ${N.unit} de ${N.fuelType}.`;case"exit":return`Salida de ${N.quantity} ${N.unit} para vehículo ${N.vehicleId||"N/A"}.`;case"transfer":return`Transferencia de ${N.quantity} ${N.unit} de ${N.fromLocation} a ${N.toLocation}.`;case"adjustment":return`Ajuste de inventario: ${N.quantity} ${N.unit} de ${N.fuelType}.`;default:return"Movimiento registrado."}};return d?r.jsxs("div",{className:"dashboard-main",children:[r.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),r.jsx("p",{className:"dashboard-subtitle",children:"Cargando datos en tiempo real..."}),r.jsx("div",{className:"loading-spinner-container",children:r.jsx("div",{className:"loading-spinner"})})]}):p?r.jsxs("div",{className:"dashboard-main",children:[r.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),r.jsxs("div",{className:"error-message",children:[r.jsxs("p",{children:["⚠️ ",p]}),r.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]})]}):r.jsxs("div",{className:"dashboard-main",children:[r.jsx("h1",{className:"dashboard-title",children:"Dashboard Operativo"}),r.jsx("p",{className:"dashboard-subtitle",children:"Resumen general del estado de combustibles y maquinaria."}),r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon fuel-icon",children:"🛢️"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Combustible Total"}),r.jsxs("h2",{children:[x(s.totalFuel)," gal"]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon vehicle-icon",children:"🚜"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Vehículos Activos"}),r.jsx("h2",{children:x(s.activeVehicles)})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon movement-icon",children:"🔄"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Movimientos Pendientes"}),r.jsx("h2",{children:x(s.pendingMovements)})]})]}),r.jsxs("div",{className:`stat-card ${s.lowStockAlerts>0?"alert":""}`,children:[r.jsx("div",{className:"stat-icon alert-icon",children:"⚠️"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("p",{children:"Alertas de Stock"}),r.jsx("h2",{children:x(s.lowStockAlerts)})]})]})]}),r.jsxs("div",{className:"dashboard-content",children:[r.jsxs("div",{className:"dashboard-widget",children:[r.jsx("h3",{children:"Actividad Reciente"}),t.length>0?r.jsx("ul",{children:t.map(N=>r.jsxs("li",{children:[r.jsx("span",{className:`movement-type-badge ${N.type}`,children:N.type}),C(N),r.jsx("span",{className:"movement-date",children:N.date.toDate().toLocaleDateString()})]},N.id))}):r.jsx("p",{children:"No hay movimientos recientes."})]}),r.jsxs("div",{className:"dashboard-widget",children:[r.jsx("h3",{children:"📦 Stock por Tipo de Producto"}),o.length>0?r.jsxs("div",{className:"products-summary",children:[o.slice(0,6).map(N=>r.jsxs("div",{className:"product-summary-item",children:[r.jsx("div",{className:"product-icon",style:{color:N.color},children:N.icon}),r.jsxs("div",{className:"product-info",children:[r.jsx("span",{className:"product-name",children:N.displayName}),r.jsxs("div",{className:"product-stats",children:[r.jsxs("span",{className:"stock-value",children:[x(N.currentStock||0)," ",N.unit]}),r.jsx("span",{className:`stock-status ${(N.currentStock||0)===0?"empty":(N.currentStock||0)<=(N.minThreshold||0)?"low":"normal"}`,children:(N.currentStock||0)===0?"🔴 Sin stock":(N.currentStock||0)<=(N.minThreshold||0)?"🟡 Stock bajo":"🟢 Normal"})]})]})]},N.id)),o.length>6&&r.jsx("div",{className:"view-all-products",children:r.jsxs("span",{children:["+",o.length-6," productos más"]})})]}):r.jsxs("div",{className:"no-products",children:[r.jsx("p",{children:"No hay productos registrados."}),r.jsx("small",{children:"Ve a la sección Productos para crear los primeros tipos de combustible."})]})]})]})]})},I2=({items:s,onEdit:e,onDelete:t,canManage:i})=>{const[o,c]=W.useState("name"),[d,m]=W.useState("asc"),p=N=>new Intl.NumberFormat("es-CO").format(N),v=N=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(N),_=N=>{const S=new Date-new Date(N.seconds?N.seconds*1e3:N),U=Math.floor(S/(1e3*60*60)),$=Math.floor(U/24);return $>0?`${$}d`:U>0?`${U}h`:"ahora"},T=N=>{o===N?m(d==="asc"?"desc":"asc"):(c(N),m("asc"))},x=[...s].sort((N,M)=>{let S=N[o],U=M[o];return o==="lastUpdated"&&(S=new Date(S.seconds?S.seconds*1e3:S),U=new Date(U.seconds?U.seconds*1e3:U)),S<U?d==="asc"?-1:1:S>U?d==="asc"?1:-1:0}),C=N=>o!==N?"↕️":d==="asc"?"↑":"↓";return r.jsxs("div",{className:"inventory-table-container",children:[r.jsx("div",{className:"table-wrapper",children:r.jsxs("table",{className:"inventory-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{onClick:()=>T("name"),className:"sortable",children:["Combustible ",C("name")]}),r.jsxs("th",{onClick:()=>T("location"),className:"sortable",children:["Ubicación ",C("location")]}),r.jsxs("th",{onClick:()=>T("currentStock"),className:"sortable",children:["Stock Actual ",C("currentStock")]}),r.jsxs("th",{onClick:()=>T("stockPercentage"),className:"sortable",children:["Nivel ",C("stockPercentage")]}),r.jsxs("th",{onClick:()=>T("pricePerUnit"),className:"sortable",children:["Precio ",C("pricePerUnit")]}),r.jsx("th",{children:"Valor Total"}),r.jsxs("th",{onClick:()=>T("status"),className:"sortable",children:["Estado ",C("status")]}),r.jsxs("th",{onClick:()=>T("lastUpdated"),className:"sortable",children:["Actualizado ",C("lastUpdated")]}),i&&r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:x.map(N=>{const M=Jo[N.fuelType],S=Uo[N.stockLevel],U=N.currentStock*N.pricePerUnit;return r.jsxs("tr",{className:N.needsRestock?"needs-restock":"",children:[r.jsx("td",{className:"fuel-cell",children:r.jsxs("div",{className:"fuel-info",children:[r.jsx("span",{className:"fuel-icon",style:{color:M?.color},children:M?.icon}),r.jsxs("div",{children:[r.jsx("div",{className:"fuel-name",children:M?.name}),r.jsx("div",{className:"fuel-type",children:N.fuelType})]})]})}),r.jsx("td",{children:N.location}),r.jsxs("td",{className:"stock-cell",children:[r.jsxs("div",{className:"stock-info",children:[r.jsx("span",{className:"stock-amount",children:p(N.currentStock)}),r.jsxs("span",{className:"stock-unit",children:["/ ",p(N.maxCapacity)," ",N.unit]})]}),N.needsRestock&&r.jsx("div",{className:"restock-indicator",children:"⚠️ Bajo mínimo"})]}),r.jsx("td",{className:"level-cell",children:r.jsxs("div",{className:"level-info",children:[r.jsxs("div",{className:"level-badge",style:{backgroundColor:S?.color,color:"white"},children:[N.stockPercentage,"%"]}),r.jsx("div",{className:"level-bar",children:r.jsx("div",{className:"level-fill",style:{width:`${N.stockPercentage}%`,backgroundColor:S?.color}})})]})}),r.jsx("td",{className:"price-cell",children:r.jsxs("div",{className:"price-info",children:[r.jsx("span",{className:"price-amount",children:v(N.pricePerUnit)}),r.jsxs("span",{className:"price-unit",children:["/ ",N.unit]})]})}),r.jsx("td",{className:"value-cell",children:r.jsx("span",{className:"total-value",children:v(U)})}),r.jsx("td",{className:"status-cell",children:r.jsxs("span",{className:`status-badge ${N.status}`,children:[r.jsx("span",{className:"status-dot"}),N.status==="active"?"Activo":N.status==="inactive"?"Inactivo":N.status==="maintenance"?"Mantenimiento":N.status]})}),r.jsx("td",{className:"updated-cell",children:r.jsx("span",{className:"time-ago",children:_(N.lastUpdated)})}),i&&r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(N),title:"Editar",children:"✏️"}),r.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>t(N),title:"Eliminar",children:"🗑️"})]})})]},N.id)})})]})}),r.jsxs("div",{className:"table-footer",children:[r.jsxs("div",{className:"table-info",children:[x.length," items ordenados por ",o,"(",d==="asc"?"ascendente":"descendente",")"]}),r.jsxs("div",{className:"table-legend",children:[r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot critical"}),"Crítico"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot low"}),"Bajo"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot normal"}),"Normal"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-dot high"}),"Alto"]})]})]})]})},R2=({items:s,onEdit:e,onDelete:t,canManage:i})=>{const o=m=>new Intl.NumberFormat("es-CO").format(m),c=m=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(m),d=m=>{const v=new Date-new Date(m.seconds?m.seconds*1e3:m),_=Math.floor(v/(1e3*60*60)),T=Math.floor(_/24);return T>0?`hace ${T} día${T>1?"s":""}`:_>0?`hace ${_} hora${_>1?"s":""}`:"hace unos minutos"};return r.jsx("div",{className:"inventory-cards-grid",children:s.map(m=>{const p=Jo[m.fuelType],v=Uo[m.stockLevel],_=m.currentStock*m.pricePerUnit;return r.jsxs("div",{className:"inventory-card",children:[r.jsxs("div",{className:"card-header",children:[r.jsxs("div",{className:"fuel-info",children:[r.jsx("span",{className:"fuel-icon",style:{color:p?.color},children:p?.icon}),r.jsxs("div",{className:"fuel-details",children:[r.jsx("h3",{children:p?.name}),r.jsx("p",{className:"location",children:m.location})]})]}),r.jsx("div",{className:"stock-status",children:r.jsxs("span",{className:"status-badge",style:{backgroundColor:v?.color,color:"white"},children:[v?.icon," ",v?.label]})})]}),r.jsxs("div",{className:"stock-progress",children:[r.jsxs("div",{className:"progress-header",children:[r.jsxs("span",{className:"stock-text",children:[o(m.currentStock)," / ",o(m.maxCapacity)," ",m.unit]}),r.jsxs("span",{className:"percentage",children:[m.stockPercentage,"%"]})]}),r.jsx("div",{className:"progress-bar",children:r.jsx("div",{className:"progress-fill",style:{width:`${m.stockPercentage}%`,backgroundColor:v?.color}})}),m.needsRestock&&r.jsxs("div",{className:"restock-warning",children:["⚠️ Bajo nivel mínimo (",o(m.minThreshold)," ",m.unit,")"]})]}),r.jsxs("div",{className:"card-metrics",children:[r.jsxs("div",{className:"metric",children:[r.jsxs("span",{className:"metric-label",children:["Precio por ",m.unit,":"]}),r.jsx("span",{className:"metric-value",children:c(m.pricePerUnit)})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Valor total:"}),r.jsx("span",{className:"metric-value",children:c(_)})]}),m.supplier&&r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Proveedor:"}),r.jsx("span",{className:"metric-value",children:m.supplier})]})]}),r.jsxs("div",{className:"card-footer",children:[r.jsxs("div",{className:"status-info",children:[r.jsx("span",{className:`status-dot ${m.status}`}),r.jsx("span",{className:"status-text",children:m.status==="active"?"Activo":m.status==="inactive"?"Inactivo":m.status==="maintenance"?"Mantenimiento":m.status})]}),r.jsxs("div",{className:"last-update",children:["Actualizado ",d(m.lastUpdated)]})]}),i&&r.jsxs("div",{className:"card-actions",children:[r.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>e(m),title:"Editar combustible",children:"✏️ Editar"}),r.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>t(m),title:"Eliminar combustible",children:"🗑️ Eliminar"})]}),m.description&&m.description!==p?.description&&r.jsx("div",{className:"card-description",children:r.jsx("p",{children:m.description})})]},m.id)})})},D2=({item:s,onClose:e,onSuccess:t})=>{const{userProfile:i}=Da(),o=!!s,[c,d]=W.useState({fuelType:"",location:"",currentStock:"",maxCapacity:"",minThreshold:"",pricePerUnit:"",supplier:"",description:"",status:"active"}),[m,p]=W.useState({}),[v,_]=W.useState(!1);W.useEffect(()=>{o&&s&&d({fuelType:s.fuelType||"",location:s.location||"",currentStock:s.currentStock||"",maxCapacity:s.maxCapacity||"",minThreshold:s.minThreshold||"",pricePerUnit:s.pricePerUnit||"",supplier:s.supplier||"",description:s.description||"",status:s.status||"active"})},[o,s]),W.useEffect(()=>{if(c.maxCapacity&&!c.minThreshold){const M=Math.round(Number(c.maxCapacity)*.15);d(S=>({...S,minThreshold:M}))}},[c.maxCapacity]);const T=M=>{const{name:S,value:U}=M.target;d($=>({...$,[S]:U})),m[S]&&p($=>({...$,[S]:null}))},x=()=>{const M={};c.fuelType||(M.fuelType="Tipo de combustible es requerido"),c.location||(M.location="Ubicación es requerida"),c.maxCapacity||(M.maxCapacity="Capacidad máxima es requerida");const S=Number(c.currentStock),U=Number(c.maxCapacity),$=Number(c.minThreshold),F=Number(c.pricePerUnit);return c.currentStock&&(isNaN(S)||S<0)&&(M.currentStock="Stock actual debe ser un número válido mayor o igual a 0"),c.maxCapacity&&(isNaN(U)||U<=0)&&(M.maxCapacity="Capacidad máxima debe ser un número válido mayor a 0"),c.minThreshold&&(isNaN($)||$<0)&&(M.minThreshold="Umbral mínimo debe ser un número válido mayor o igual a 0"),c.pricePerUnit&&(isNaN(F)||F<0)&&(M.pricePerUnit="Precio debe ser un número válido mayor o igual a 0"),S>U&&(M.currentStock="Stock actual no puede ser mayor a la capacidad máxima"),$>U&&(M.minThreshold="Umbral mínimo no puede ser mayor a la capacidad máxima"),p(M),Object.keys(M).length===0},C=async M=>{if(M.preventDefault(),!!x()){_(!0);try{let S;o?S=await v2(s.id,{location:c.location,currentStock:Number(c.currentStock)||0,maxCapacity:Number(c.maxCapacity),minThreshold:Number(c.minThreshold)||Number(c.maxCapacity)*.15,pricePerUnit:Number(c.pricePerUnit)||0,supplier:c.supplier,description:c.description,status:c.status},i.uid):S=await g2({fuelType:c.fuelType,location:c.location,currentStock:Number(c.currentStock)||0,maxCapacity:Number(c.maxCapacity),minThreshold:Number(c.minThreshold)||Number(c.maxCapacity)*.15,pricePerUnit:Number(c.pricePerUnit)||0,supplier:c.supplier,description:c.description,status:c.status},i.uid),S.success?(alert(S.message),t()):alert(`Error: ${S.error}`)}catch(S){console.error("Error saving inventory item:",S),alert("Error inesperado al guardar el item")}finally{_(!1)}}},N=Jo[c.fuelType];return r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-content inventory-modal",onClick:M=>M.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h2",{children:o?"✏️ Editar Combustible":"➕ Agregar Nuevo Combustible"}),r.jsx("button",{className:"modal-close",onClick:e,children:"✕"})]}),r.jsxs("form",{onSubmit:C,className:"modal-form",children:[r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"fuelType",children:["Tipo de Combustible *",N&&r.jsxs("span",{className:"fuel-preview",children:[N.icon," ",N.name]})]}),r.jsxs("select",{id:"fuelType",name:"fuelType",value:c.fuelType,onChange:T,disabled:o,className:m.fuelType?"error":"",required:!0,children:[r.jsx("option",{value:"",children:"Seleccionar tipo..."}),Object.entries(bn).map(([M,S])=>{const U=Jo[S];return r.jsxs("option",{value:S,children:[U.icon," ",U.name," (",U.unit,")"]},M)})]}),m.fuelType&&r.jsx("span",{className:"error-text",children:m.fuelType})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"location",children:"Ubicación / Tanque *"}),r.jsx("input",{type:"text",id:"location",name:"location",value:c.location,onChange:T,placeholder:"ej. Tanque Principal, Depósito A, Bodega Norte",className:m.location?"error":"",required:!0}),m.location&&r.jsx("span",{className:"error-text",children:m.location})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"currentStock",children:["Stock Actual ",N&&`(${N.unit})`]}),r.jsx("input",{type:"number",id:"currentStock",name:"currentStock",value:c.currentStock,onChange:T,placeholder:"0",min:"0",step:"0.01",className:m.currentStock?"error":""}),m.currentStock&&r.jsx("span",{className:"error-text",children:m.currentStock})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"maxCapacity",children:["Capacidad Máxima * ",N&&`(${N.unit})`]}),r.jsx("input",{type:"number",id:"maxCapacity",name:"maxCapacity",value:c.maxCapacity,onChange:T,placeholder:"1000",min:"1",step:"0.01",className:m.maxCapacity?"error":"",required:!0}),m.maxCapacity&&r.jsx("span",{className:"error-text",children:m.maxCapacity})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"minThreshold",children:["Umbral Mínimo ",N&&`(${N.unit})`,r.jsx("span",{className:"field-hint",children:"Para alertas de stock bajo"})]}),r.jsx("input",{type:"number",id:"minThreshold",name:"minThreshold",value:c.minThreshold,onChange:T,placeholder:"Auto: 15% de capacidad máxima",min:"0",step:"0.01",className:m.minThreshold?"error":""}),m.minThreshold&&r.jsx("span",{className:"error-text",children:m.minThreshold}),c.maxCapacity&&r.jsxs("span",{className:"field-hint",children:["Sugerido: ",Math.round(Number(c.maxCapacity)*.15)," ",N?.unit||"unidades"]})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"pricePerUnit",children:["Precio por ",N?.unit||"Unidad"]}),r.jsx("input",{type:"number",id:"pricePerUnit",name:"pricePerUnit",value:c.pricePerUnit,onChange:T,placeholder:"12000",min:"0",step:"0.01",className:m.pricePerUnit?"error":""}),m.pricePerUnit&&r.jsx("span",{className:"error-text",children:m.pricePerUnit})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"supplier",children:"Proveedor Principal"}),r.jsx("input",{type:"text",id:"supplier",name:"supplier",value:c.supplier,onChange:T,placeholder:"ej. Petrobras, Terpel, Mobil"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"status",children:"Estado"}),r.jsxs("select",{id:"status",name:"status",value:c.status,onChange:T,children:[r.jsx("option",{value:"active",children:"Activo"}),r.jsx("option",{value:"inactive",children:"Inactivo"}),r.jsx("option",{value:"maintenance",children:"Mantenimiento"})]})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{htmlFor:"description",children:"Descripción / Notas"}),r.jsx("textarea",{id:"description",name:"description",value:c.description,onChange:T,placeholder:"Información adicional sobre este combustible...",rows:"3"})]})]}),N&&c.maxCapacity&&r.jsxs("div",{className:"form-preview",children:[r.jsx("h4",{children:"📊 Vista Previa"}),r.jsxs("div",{className:"preview-card",children:[r.jsxs("div",{className:"preview-header",children:[r.jsxs("span",{style:{color:N.color},children:[N.icon," ",N.name]}),r.jsx("span",{children:c.location})]}),r.jsxs("div",{className:"preview-capacity",children:[c.currentStock||0," / ",c.maxCapacity," ",N.unit,c.currentStock&&c.maxCapacity&&r.jsxs("span",{className:"preview-percentage",children:["(",Math.round(Number(c.currentStock)/Number(c.maxCapacity)*100),"%)"]})]}),c.pricePerUnit&&r.jsxs("div",{className:"preview-value",children:["Valor total: ",new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format((Number(c.currentStock)||0)*Number(c.pricePerUnit))]})]})]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:e,className:"btn btn-secondary",children:"Cancelar"}),r.jsx("button",{type:"submit",className:"btn btn-primary",disabled:v,children:v?"Guardando...":o?"Actualizar":"Crear"})]})]})]})})},fN=(s,e=[])=>{if(!s||!s.fuelType||!s.quantity)return{isValid:!1,error:"Datos de movimiento incompletos",availableStock:0,requiredStock:0};const{fuelType:t,quantity:i,type:o,sourceLocation:c}=s,d=parseFloat(i)||0;if(o!=="outbound"&&o!=="transfer")return{isValid:!0,message:"Movimiento no requiere validación de stock",availableStock:0,requiredStock:d};const m=e.filter(_=>_.fuelType===t&&_.location===c&&_.status==="active").reduce((_,T)=>_+(parseFloat(T.quantity)||0),0),p=m>=d,v=m-d;return{isValid:p,availableStock:m,requiredStock:d,remainingStock:v,fuelType:t,location:c,error:p?null:`Stock insuficiente. Disponible: ${m}, Requerido: ${d}`,warning:v<m*.2&&v>=0?"Stock quedará bajo después del movimiento":null}},Hs=s=>typeof s!="number"||isNaN(s)?"$0":new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(s),ct=(s,e=2)=>typeof s!="number"||isNaN(s)?"0":new Intl.NumberFormat("es-CO",{minimumFractionDigits:e,maximumFractionDigits:e}).format(s),_r=(s,e=1)=>typeof s!="number"||isNaN(s)?"0%":`${(s*100).toFixed(e)}%`,O2=({stats:s})=>r.jsxs("div",{className:"inventory-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:"💰"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Valor Total"}),r.jsx("div",{className:"stat-value",children:Hs(s.totalValue)}),r.jsxs("div",{className:"stat-subtitle",children:[ct(s.totalItems)," tipos de combustible"]})]})]}),r.jsxs("div",{className:"stat-card success",children:[r.jsx("div",{className:"stat-icon",children:"✅"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Items Activos"}),r.jsx("div",{className:"stat-value",children:s.activeItems}),r.jsxs("div",{className:"stat-subtitle",children:[Math.round(s.activeItems/s.totalItems*100),"% del total"]})]})]}),r.jsxs("div",{className:`stat-card ${s.lowStockItems>0?"warning":"info"}`,children:[r.jsx("div",{className:"stat-icon",children:s.lowStockItems>0?"⚠️":"📊"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Stock Bajo"}),r.jsx("div",{className:"stat-value",children:s.lowStockItems}),r.jsx("div",{className:"stat-subtitle",children:s.lowStockItems>0?"Requieren atención":"Niveles normales"})]})]}),r.jsxs("div",{className:"stat-card info",children:[r.jsx("div",{className:"stat-icon",children:"📈"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("h3",{children:"Nivel Promedio"}),r.jsxs("div",{className:"stat-value",children:[s.averageStockLevel,"%"]}),r.jsx("div",{className:"stat-subtitle",children:"Capacidad promedio utilizada"})]})]})]}),r.jsxs("div",{className:"fuel-type-summary",children:[r.jsx("h4",{children:"📊 Resumen por Tipo de Combustible"}),r.jsx("div",{className:"fuel-types-grid",children:Object.entries(s.byFuelType).map(([e,t])=>{const i=Jo[e],o=t.totalCapacity>0?Math.round(t.totalStock/t.totalCapacity*100):0;return r.jsxs("div",{className:"fuel-type-card",children:[r.jsxs("div",{className:"fuel-header",children:[r.jsx("span",{className:"fuel-icon",style:{color:i?.color||"#6b7280"},children:i?.icon||"⛽"}),r.jsxs("div",{className:"fuel-info",children:[r.jsx("h5",{children:i?.name||e}),r.jsxs("span",{className:"fuel-count",children:[t.count," ubicaciones"]})]})]}),r.jsxs("div",{className:"fuel-metrics",children:[r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Stock Total:"}),r.jsxs("span",{className:"metric-value",children:[ct(t.totalStock)," ",i?.unit||"unidades"]})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Capacidad:"}),r.jsxs("span",{className:"metric-value",children:[ct(t.totalCapacity)," ",i?.unit||"unidades"]})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Utilización:"}),r.jsxs("span",{className:`metric-value ${o<25?"low":o>75?"high":"normal"}`,children:[o,"%"]})]}),r.jsxs("div",{className:"metric",children:[r.jsx("span",{className:"metric-label",children:"Valor:"}),r.jsx("span",{className:"metric-value",children:Hs(t.totalValue)})]})]}),r.jsx("div",{className:"progress-bar",children:r.jsx("div",{className:"progress-fill",style:{width:`${o}%`,backgroundColor:i?.color||"#6b7280"}})})]},e)})}),Object.keys(s.byFuelType).length===0&&r.jsx("div",{className:"empty-fuel-types",children:r.jsx("p",{children:"No hay tipos de combustible registrados en el inventario."})})]})]}),M2=()=>{const{hasPermission:s}=Da(),[e,t]=W.useState([]),[i,o]=W.useState(null),[c,d]=W.useState(!0),[m,p]=W.useState(null),[v,_]=W.useState("cards"),[T,x]=W.useState(!1),[C,N]=W.useState(null),[M,S]=W.useState("all"),[U,$]=W.useState("");W.useEffect(()=>{let A=null;return(()=>{A=WA((I,k)=>{if(k){console.error("Error in inventory subscription:",k),p("Error cargando inventario en tiempo real");return}t(I||[]),d(!1)})})(),()=>{A&&A()}},[]),W.useEffect(()=>{(async()=>{const R=await _2();R.success&&o(R.data)})()},[e]);const F=e.filter(A=>{if(M==="active"&&A.status!=="active"||M==="low-stock"&&!A.needsRestock)return!1;if(U){const R=U.toLowerCase();return A.name.toLowerCase().includes(R)||A.location.toLowerCase().includes(R)||A.fuelType.toLowerCase().includes(R)}return!0}),V=A=>{if(!s("canManageInventory")){alert("No tienes permisos para editar items de inventario");return}N(A),x(!0)},B=async A=>{if(!s("canManageInventory")){alert("No tienes permisos para eliminar items de inventario");return}if(!window.confirm(`¿Estás seguro de eliminar ${A.name} de ${A.location}?

Esta acción no se puede deshacer.`))return;d(!0);const I=await y2(A.id);I.success?alert("Item eliminado exitosamente"):(p(I.error),alert(`Error al eliminar: ${I.error}`)),d(!1)},ee=()=>{x(!1),N(null)},D=()=>{ee()};return c&&e.length===0?r.jsxs("div",{className:"inventory-loading",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando inventario..."})]}):r.jsxs("div",{className:"inventory-main",children:[r.jsxs("div",{className:"inventory-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h2",{children:"🛢️ Gestión de Inventario"}),r.jsx("p",{children:"Control de stock de combustibles en tiempo real"})]}),r.jsx("div",{className:"inventory-info",children:r.jsxs("span",{className:"info-text",children:["💡 Los combustibles se agregan automáticamente desde la pestaña ",r.jsx("strong",{children:"Movimientos"})]})})]}),i&&r.jsx(O2,{stats:i}),r.jsxs("div",{className:"inventory-controls",children:[r.jsxs("div",{className:"search-filters",children:[r.jsx("input",{type:"text",placeholder:"Buscar por nombre, ubicación o tipo...",value:U,onChange:A=>$(A.target.value),className:"search-input"}),r.jsxs("select",{value:M,onChange:A=>S(A.target.value),className:"filter-select",children:[r.jsx("option",{value:"all",children:"Todos los items"}),r.jsx("option",{value:"active",children:"Solo activos"}),r.jsx("option",{value:"low-stock",children:"Stock bajo"})]})]}),r.jsxs("div",{className:"view-toggle",children:[r.jsx("button",{className:`toggle-btn ${v==="cards"?"active":""}`,onClick:()=>_("cards"),children:"📱 Cards"}),r.jsx("button",{className:`toggle-btn ${v==="table"?"active":""}`,onClick:()=>_("table"),children:"📊 Tabla"})]})]}),m&&r.jsxs("div",{className:"error-banner",children:[r.jsxs("span",{children:["⚠️ ",m]}),r.jsx("button",{onClick:()=>p(null),children:"✕"})]}),r.jsx("div",{className:"inventory-content",children:F.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"📦"}),r.jsx("h3",{children:"No hay items de inventario"}),r.jsx("p",{children:U||M!=="all"?"No se encontraron items con los filtros aplicados":"Ve a la pestaña Movimientos para crear una ENTRADA de combustible"})]}):r.jsx(r.Fragment,{children:v==="cards"?r.jsx(R2,{items:F,onEdit:V,onDelete:B,canManage:s("canManageInventory")}):r.jsx(I2,{items:F,onEdit:V,onDelete:B,canManage:s("canManageInventory")})})}),F.length>0&&r.jsx("div",{className:"results-footer",children:r.jsxs("p",{children:["Mostrando ",F.length," de ",e.length," items",U&&` · Filtro: "${U}"`,M!=="all"&&` · Estado: ${M}`]})}),T&&r.jsx(D2,{item:C,onClose:ee,onSuccess:D})]})},P2=({stats:s,filters:e})=>{if(!s)return null;const t=(d,m)=>m===0?d>0?100:0:((d-m)/m*100).toFixed(1),i=d=>{switch(d){case _e.ENTRADA:return"#10b981";case _e.SALIDA:return"#ef4444";case _e.TRANSFERENCIA:return"#3b82f6";case _e.AJUSTE:return"#f59e0b";default:return"#6b7280"}},o=d=>{switch(d){case _e.ENTRADA:return"📥";case _e.SALIDA:return"📤";case _e.TRANSFERENCIA:return"🔄";case _e.AJUSTE:return"⚖️";default:return"📋"}},c=t(s.thisMonth,s.lastMonth);return r.jsxs("div",{className:"movements-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:"📊"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:ct(s.totalMovements)}),r.jsx("div",{className:"stat-label",children:"Total Movimientos"}),r.jsxs("div",{className:"stat-trend",children:[r.jsxs("span",{className:`trend ${c>=0?"positive":"negative"}`,children:[c>=0?"📈":"📉"," ",Math.abs(c),"%"]}),r.jsx("span",{className:"trend-label",children:"vs mes anterior"})]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"💰"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:Hs(s.totalValue)}),r.jsx("div",{className:"stat-label",children:"Valor Total"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",Hs(s.averageValue)]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"⛽"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:ct(s.totalQuantity)}),r.jsx("div",{className:"stat-label",children:"Galones Total"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",ct(s.totalQuantity/(s.totalMovements||1))," gal/mov"]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"📅"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:ct(s.thisWeek)}),r.jsx("div",{className:"stat-label",children:"Esta Semana"}),r.jsxs("div",{className:"stat-secondary",children:[ct(s.thisMonth)," este mes"]})]})]})]}),r.jsxs("div",{className:"stats-breakdown",children:[r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"📋 Por Tipo de Movimiento"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byType).map(([d,m])=>{const p=(m/s.totalMovements*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:o(d)}),r.jsx("span",{className:"breakdown-label",children:d.charAt(0).toUpperCase()+d.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:m}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:i(d)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"⚡ Por Estado"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byStatus).map(([d,m])=>{const p=(m/s.totalMovements*100).toFixed(1),v=T=>{switch(T){case qe.COMPLETADO:return"#10b981";case qe.PENDIENTE:return"#f59e0b";case qe.CANCELADO:return"#ef4444";default:return"#6b7280"}},_=T=>{switch(T){case qe.COMPLETADO:return"✅";case qe.PENDIENTE:return"⏳";case qe.CANCELADO:return"❌";default:return"❓"}};return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:_(d)}),r.jsx("span",{className:"breakdown-label",children:d.charAt(0).toUpperCase()+d.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:m}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:v(d)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"⛽ Por Tipo de Combustible"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byFuelType).map(([d,m])=>{const p=(m/s.totalMovements*100).toFixed(1),v=_=>{switch(_?.toLowerCase()){case"diesel":return"🚛";case"gasolina":return"🚗";case"acpm":return"🚚";case"lubricante":return"🛢️";default:return"⛽"}};return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:v(d)}),r.jsx("span",{className:"breakdown-label",children:d})]}),r.jsx("div",{className:"breakdown-value",children:m}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${p}%`,backgroundColor:"#059669"}})}),r.jsxs("div",{className:"breakdown-percentage",children:[p,"%"]})]},d)})})]})]}),(e.type||e.status||e.fuelType||e.vehicleId)&&r.jsxs("div",{className:"active-filters",children:[r.jsx("h4",{children:"🔍 Filtros Activos"}),r.jsxs("div",{className:"filters-list",children:[e.type&&r.jsxs("span",{className:"filter-tag",children:["Tipo: ",e.type]}),e.status&&r.jsxs("span",{className:"filter-tag",children:["Estado: ",e.status]}),e.fuelType&&r.jsxs("span",{className:"filter-tag",children:["Combustible: ",e.fuelType]}),e.vehicleId&&r.jsxs("span",{className:"filter-tag",children:["Vehículo: ",e.vehicleId]})]})]})]})},k2=({filters:s,onFilterChange:e,onClearFilters:t,searchTerm:i,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:m})=>{const[p,v]=W.useState(!1),_=[{value:"Diesel",label:"Diesel 🚛"},{value:"Gasolina",label:"Gasolina 🚗"},{value:"ACPM",label:"ACPM 🚚"},{value:"Lubricante",label:"Lubricante 🛢️"}],T=[{value:"all",label:"Todos los períodos"},{value:"today",label:"Hoy"},{value:"week",label:"Esta semana"},{value:"month",label:"Este mes"},{value:"quarter",label:"Este trimestre"},{value:"year",label:"Este año"}],x=Object.values(s).filter(M=>M&&M!==""&&M!=="all").length,C=(M,S)=>{e({[M]:S})},N=M=>{e(M)};return r.jsxs("div",{className:"movements-filters",children:[r.jsxs("div",{className:"filters-main",children:[r.jsx("div",{className:"search-section",children:r.jsxs("div",{className:"search-box",children:[r.jsx("span",{className:"search-icon",children:"🔍"}),r.jsx("input",{type:"text",placeholder:"Buscar por combustible, vehículo, referencia...",value:i,onChange:M=>o(M.target.value),className:"search-input"}),i&&r.jsx("button",{className:"search-clear",onClick:()=>o(""),title:"Limpiar búsqueda",children:"✕"})]})}),r.jsxs("div",{className:"filters-controls",children:[r.jsxs("div",{className:"quick-filters",children:[r.jsx("button",{className:`quick-filter ${s.type===_e.ENTRADA?"active":""}`,onClick:()=>N({type:_e.ENTRADA}),children:"📥 Entradas"}),r.jsx("button",{className:`quick-filter ${s.type===_e.SALIDA?"active":""}`,onClick:()=>N({type:_e.SALIDA}),children:"📤 Salidas"}),r.jsx("button",{className:`quick-filter ${s.status===qe.PENDIENTE?"active":""}`,onClick:()=>N({status:qe.PENDIENTE}),children:"⏳ Pendientes"})]}),r.jsxs("button",{className:`btn-advanced-filters ${p?"active":""}`,onClick:()=>v(!p),children:["🎛️ Filtros",x>0&&r.jsx("span",{className:"filters-count",children:x})]}),r.jsxs("div",{className:"view-modes",children:[r.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),title:"Vista en tarjetas",children:"🎴"}),r.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),title:"Vista en tabla",children:"📋"})]})]})]}),p&&r.jsxs("div",{className:"filters-advanced",children:[r.jsxs("div",{className:"filters-grid",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Movimiento"}),r.jsxs("select",{value:s.type,onChange:M=>C("type",M.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los tipos"}),r.jsx("option",{value:_e.ENTRADA,children:"📥 Entrada"}),r.jsx("option",{value:_e.SALIDA,children:"📤 Salida"}),r.jsx("option",{value:_e.TRANSFERENCIA,children:"🔄 Transferencia"}),r.jsx("option",{value:_e.AJUSTE,children:"⚖️ Ajuste"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:s.status,onChange:M=>C("status",M.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los estados"}),r.jsx("option",{value:qe.PENDIENTE,children:"⏳ Pendiente"}),r.jsx("option",{value:qe.COMPLETADO,children:"✅ Completado"}),r.jsx("option",{value:qe.CANCELADO,children:"❌ Cancelado"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Combustible"}),r.jsxs("select",{value:s.fuelType,onChange:M=>C("fuelType",M.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los combustibles"}),_.map(M=>r.jsx("option",{value:M.value,children:M.label},M.value))]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Período"}),r.jsx("select",{value:s.dateRange,onChange:M=>C("dateRange",M.target.value),className:"filter-select",children:T.map(M=>r.jsx("option",{value:M.value,children:M.label},M.value))})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Vehículo/Equipo"}),r.jsx("input",{type:"text",placeholder:"ID del vehículo...",value:s.vehicleId,onChange:M=>C("vehicleId",M.target.value),className:"filter-input"})]})]}),r.jsxs("div",{className:"filters-actions",children:[r.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:x===0,children:"🗑️ Limpiar Filtros"}),r.jsxs("div",{className:"filters-info",children:[r.jsxs("span",{className:"results-count",children:[m," resultado",m!==1?"s":""]}),x>0&&r.jsxs("span",{className:"active-filters-text",children:["(",x," filtro",x!==1?"s":""," activo",x!==1?"s":"",")"]})]})]})]}),r.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:r.jsx("small",{children:"💡 Atajos: Ctrl+F (buscar), Ctrl+1 (entradas), Ctrl+2 (salidas), Ctrl+3 (pendientes)"})})]})},V2=({movements:s,onEdit:e,onView:t,onApprove:i,onReject:o,userRole:c})=>{const d=N=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(N),m=N=>N?(N instanceof Date?N:new Date(N)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Sin fecha",p=N=>{if(!N)return"";const M=new Date,S=N instanceof Date?N:new Date(N),U=Math.abs(M-S),$=Math.ceil(U/(1e3*60*60*24));return $===1?"hace 1 día":$<7?`hace ${$} días`:$<30?`hace ${Math.ceil($/7)} semanas`:$<365?`hace ${Math.ceil($/30)} meses`:`hace ${Math.ceil($/365)} años`},v=N=>{switch(N){case _e.ENTRADA:return"movement-entrada";case _e.SALIDA:return"movement-salida";case _e.TRANSFERENCIA:return"movement-transferencia";case _e.AJUSTE:return"movement-ajuste";default:return"movement-default"}},_=N=>{switch(N){case qe.COMPLETADO:return"status-completado";case qe.PENDIENTE:return"status-pendiente";case qe.CANCELADO:return"status-cancelado";default:return"status-default"}},T=N=>{switch(N){case _e.ENTRADA:return"📥";case _e.SALIDA:return"📤";case _e.TRANSFERENCIA:return"🔄";case _e.AJUSTE:return"⚖️";default:return"📋"}},x=N=>{switch(N?.toLowerCase()){case"diesel":return"🚛";case"gasolina":return"🚗";case"acpm":return"🚚";case"lubricante":return"🛢️";default:return"⛽"}},C=N=>{switch(N){case qe.COMPLETADO:return"✅";case qe.PENDIENTE:return"⏳";case qe.CANCELADO:return"❌";default:return"❓"}};return r.jsx("div",{className:"movements-cards",children:s.map(N=>r.jsxs("div",{className:`movement-card ${v(N.type)}`,children:[r.jsxs("div",{className:"card-header",children:[r.jsxs("div",{className:"movement-type",children:[r.jsx("span",{className:"type-icon",children:T(N.type)}),r.jsx("span",{className:"type-label",children:N.type.charAt(0).toUpperCase()+N.type.slice(1)})]}),r.jsxs("div",{className:`status-badge ${_(N.status)}`,children:[r.jsx("span",{className:"status-icon",children:C(N.status)}),r.jsx("span",{className:"status-label",children:N.status.charAt(0).toUpperCase()+N.status.slice(1)})]})]}),r.jsxs("div",{className:"card-content",children:[r.jsxs("div",{className:"fuel-info",children:[r.jsx("span",{className:"fuel-icon",children:x(N.fuelType)}),r.jsx("span",{className:"fuel-type",children:N.fuelType}),r.jsxs("span",{className:"quantity",children:[N.quantity," galones"]})]}),r.jsxs("div",{className:"value-info",children:[r.jsx("div",{className:"total-value",children:d(N.totalValue)}),r.jsxs("div",{className:"unit-price",children:[d(N.unitPrice),"/galón"]})]}),N.vehicleId&&r.jsxs("div",{className:"vehicle-info",children:[r.jsx("span",{className:"vehicle-icon",children:"🚜"}),r.jsxs("span",{className:"vehicle-id",children:["Vehículo: ",N.vehicleId]})]}),N.location&&r.jsxs("div",{className:"location-info",children:[r.jsx("span",{className:"location-icon",children:"📍"}),r.jsx("span",{className:"location",children:N.location})]}),N.description&&r.jsx("div",{className:"description",children:r.jsx("p",{children:N.description})}),N.reference&&r.jsxs("div",{className:"reference",children:[r.jsx("span",{className:"reference-label",children:"Ref:"}),r.jsx("span",{className:"reference-value",children:N.reference})]})]}),r.jsxs("div",{className:"card-footer",children:[r.jsxs("div",{className:"date-info",children:[r.jsx("div",{className:"created-date",children:m(N.createdAt)}),r.jsx("div",{className:"relative-time",children:p(N.createdAt)})]}),r.jsxs("div",{className:"card-actions",children:[c==="admin"&&N.status===qe.PENDIENTE&&r.jsxs("div",{className:"admin-actions",children:[r.jsx("button",{className:"btn-approve",onClick:()=>i(N.id),title:"Aprobar movimiento",children:"✓ Aprobar"}),r.jsx("button",{className:"btn-reject",onClick:()=>o(N.id),title:"Rechazar movimiento",children:"✗ Rechazar"})]}),r.jsxs("div",{className:"user-actions",children:[r.jsx("button",{className:"btn-view",onClick:()=>t(N),title:"Ver detalles",children:"👁️ Ver"}),e&&N.status===qe.PENDIENTE&&r.jsx("button",{className:"btn-edit",onClick:()=>e(N),title:"Editar movimiento",children:"✏️ Editar"})]})]})]}),N.status===qe.PENDIENTE&&r.jsx("div",{className:"urgency-indicator",children:r.jsx("div",{className:"urgency-pulse"})}),N.type===_e.AJUSTE&&r.jsx("div",{className:"adjustment-badge",children:r.jsx("span",{children:"Ajuste"})}),N.type===_e.TRANSFERENCIA&&N.destinationLocation&&r.jsxs("div",{className:"transfer-info",children:[r.jsx("span",{className:"transfer-arrow",children:"→"}),r.jsx("span",{className:"destination",children:N.destinationLocation})]})]},N.id))})},L2=({movements:s,onEdit:e,onView:t,onApprove:i,onReject:o,userRole:c})=>{const[d,m]=W.useState("createdAt"),[p,v]=W.useState("desc"),_=F=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(F),T=F=>F?(F instanceof Date?F:new Date(F)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):"Sin fecha",x=F=>{switch(F){case _e.ENTRADA:return"📥";case _e.SALIDA:return"📤";case _e.TRANSFERENCIA:return"🔄";case _e.AJUSTE:return"⚖️";default:return"📋"}},C=F=>{switch(F?.toLowerCase()){case"diesel":return"🚛";case"gasolina":return"🚗";case"acpm":return"🚚";case"lubricante":return"🛢️";default:return"⛽"}},N=F=>{switch(F){case qe.COMPLETADO:return"✅";case qe.PENDIENTE:return"⏳";case qe.CANCELADO:return"❌";default:return"❓"}},M=F=>{switch(F){case qe.COMPLETADO:return"status-completado";case qe.PENDIENTE:return"status-pendiente";case qe.CANCELADO:return"status-cancelado";default:return"status-default"}},S=F=>{d===F?v(p==="asc"?"desc":"asc"):(m(F),v("asc"))},U=[...s].sort((F,V)=>{let B=F[d],ee=V[d];return(d.includes("Date")||d.includes("At"))&&(B=new Date(B),ee=new Date(ee)),typeof B=="number"&&typeof ee=="number"?p==="asc"?B-ee:ee-B:typeof B=="string"&&typeof ee=="string"?p==="asc"?B.localeCompare(ee):ee.localeCompare(B):B instanceof Date&&ee instanceof Date?p==="asc"?B-ee:ee-B:0}),$=F=>d!==F?"↕️":p==="asc"?"↑":"↓";return r.jsxs("div",{className:"movements-table-container",children:[r.jsx("div",{className:"table-wrapper",children:r.jsxs("table",{className:"movements-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{className:"sortable",onClick:()=>S("type"),children:["Tipo ",$("type")]}),r.jsxs("th",{className:"sortable",onClick:()=>S("fuelType"),children:["Combustible ",$("fuelType")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>S("quantity"),children:["Cantidad ",$("quantity")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>S("unitPrice"),children:["Precio/Gal ",$("unitPrice")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>S("totalValue"),children:["Valor Total ",$("totalValue")]}),r.jsx("th",{children:"Vehículo"}),r.jsx("th",{children:"Ubicación"}),r.jsxs("th",{className:"sortable",onClick:()=>S("status"),children:["Estado ",$("status")]}),r.jsxs("th",{className:"sortable",onClick:()=>S("createdAt"),children:["Fecha ",$("createdAt")]}),r.jsx("th",{className:"actions-column",children:"Acciones"})]})}),r.jsx("tbody",{children:U.map(F=>r.jsxs("tr",{className:`movement-row ${F.status===qe.PENDIENTE?"pending-row":""}`,children:[r.jsx("td",{className:"type-cell",children:r.jsxs("div",{className:"type-content",children:[r.jsx("span",{className:"type-icon",children:x(F.type)}),r.jsx("span",{className:"type-text",children:F.type.charAt(0).toUpperCase()+F.type.slice(1)})]})}),r.jsx("td",{className:"fuel-cell",children:r.jsxs("div",{className:"fuel-content",children:[r.jsx("span",{className:"fuel-icon",children:C(F.fuelType)}),r.jsx("span",{className:"fuel-text",children:F.fuelType})]})}),r.jsxs("td",{className:"quantity-cell text-right",children:[r.jsx("span",{className:"quantity-value",children:F.quantity}),r.jsx("span",{className:"quantity-unit",children:"gal"})]}),r.jsx("td",{className:"price-cell text-right",children:_(F.unitPrice)}),r.jsx("td",{className:"value-cell text-right",children:r.jsx("strong",{children:_(F.totalValue)})}),r.jsx("td",{className:"vehicle-cell",children:F.vehicleId?r.jsxs("span",{className:"vehicle-id",children:["🚜 ",F.vehicleId]}):r.jsx("span",{className:"no-vehicle",children:"-"})}),r.jsx("td",{className:"location-cell",children:r.jsxs("span",{className:"location-text",children:["📍 ",F.location||"Principal"]})}),r.jsx("td",{className:"status-cell",children:r.jsxs("div",{className:`status-badge ${M(F.status)}`,children:[r.jsx("span",{className:"status-icon",children:N(F.status)}),r.jsx("span",{className:"status-text",children:F.status.charAt(0).toUpperCase()+F.status.slice(1)})]})}),r.jsx("td",{className:"date-cell",children:r.jsxs("div",{className:"date-content",children:[r.jsx("span",{className:"date-value",children:T(F.createdAt)}),F.reference&&r.jsxs("span",{className:"reference-small",children:["#",F.reference]})]})}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn-action btn-view",onClick:()=>t(F),title:"Ver detalles",children:"👁️"}),c==="admin"&&F.status===qe.PENDIENTE&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"btn-action btn-approve",onClick:()=>i(F.id),title:"Aprobar movimiento",children:"✓"}),r.jsx("button",{className:"btn-action btn-reject",onClick:()=>o(F.id),title:"Rechazar movimiento",children:"✗"})]}),e&&F.status===qe.PENDIENTE&&r.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(F),title:"Editar movimiento",children:"✏️"})]})})]},F.id))})]})}),r.jsxs("div",{className:"table-info",children:[r.jsxs("div",{className:"table-summary",children:[r.jsxs("span",{className:"total-rows",children:[s.length," movimiento",s.length!==1?"s":""]}),d&&r.jsxs("span",{className:"sort-info",children:["Ordenado por ",d," (",p==="asc"?"ascendente":"descendente",")"]})]}),r.jsxs("div",{className:"table-legend",children:[r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"⏳"})," Pendiente"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"✅"})," Completado"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"❌"})," Cancelado"]})]})]})]})},U2=({movements:s,viewMode:e,onEdit:t,onView:i,userRole:o})=>e==="table"?r.jsx(L2,{movements:s,onEdit:t,onView:i,userRole:o}):r.jsx(V2,{movements:s,onEdit:t,onView:i,userRole:o}),Fs="combustibles_suppliers",F2=async(s,e)=>{try{const t=Xe(pt(Re,Fs),mt("name","==",s.name.trim()));if(!(await Rn(t)).empty)return{success:!1,error:`Ya existe un proveedor con el nombre "${s.name}"`};if(s.taxId){const d=Xe(pt(Re,Fs),mt("taxId","==",s.taxId.trim()));if(!(await Rn(d)).empty)return{success:!1,error:`Ya existe un proveedor con el NIT/Documento "${s.taxId}"`}}const o={name:s.name.trim(),taxId:s.taxId?.trim()||"",type:s.type||"proveedor",category:s.category||"combustibles",contactPerson:s.contactPerson?.trim()||"",phone:s.phone?.trim()||"",email:s.email?.trim()||"",address:s.address?.trim()||"",city:s.city?.trim()||"",state:s.state?.trim()||"Colombia",fuelTypes:s.fuelTypes||[],paymentTerms:s.paymentTerms||"contado",creditLimit:Number(s.creditLimit)||0,priceList:s.priceList||{},rating:Number(s.rating)||5,evaluationNotes:s.evaluationNotes||"",status:s.status||"active",isPreferred:s.isPreferred||!1,totalOrders:0,totalPurchased:0,lastOrderDate:null,averageDeliveryTime:0,createdAt:new Date,createdBy:e,lastUpdated:new Date,updatedBy:e};return{success:!0,data:{id:(await yv(pt(Re,Fs),o)).id,...o},message:`Proveedor "${o.name}" creado exitosamente`}}catch(t){return console.error("Error creating supplier:",t),{success:!1,error:t.message}}},iS=async()=>{try{const s=Xe(pt(Re,Fs),Ys("name","asc"));return{success:!0,data:(await Rn(s)).docs.map(i=>({id:i.id,...i.data()}))}}catch(s){return console.error("Error getting suppliers:",s),{success:!1,error:s.message}}},q2=s=>{const e=Xe(pt(Re,Fs),Ys("name","asc"));return du(e,t=>{const i=t.docs.map(o=>({id:o.id,...o.data()}));s(i)})},B2=async(s,e,t)=>{try{const i=await kr(Ft(Re,Fs,s));if(!i.exists())return{success:!1,error:"Proveedor no encontrado"};if(e.name&&e.name.trim()!==i.data().name){const c=Xe(pt(Re,Fs),mt("name","==",e.name.trim()));if(!(await Rn(c)).empty)return{success:!1,error:`Ya existe un proveedor con el nombre "${e.name}"`}}if(e.taxId&&e.taxId.trim()!==i.data().taxId){const c=Xe(pt(Re,Fs),mt("taxId","==",e.taxId.trim()));if(!(await Rn(c)).empty)return{success:!1,error:`Ya existe un proveedor con el NIT/Documento "${e.taxId}"`}}const o={...e,lastUpdated:new Date,updatedBy:t};return o.name&&(o.name=o.name.trim()),o.taxId&&(o.taxId=o.taxId.trim()),o.contactPerson&&(o.contactPerson=o.contactPerson.trim()),o.phone&&(o.phone=o.phone.trim()),o.email&&(o.email=o.email.trim()),await Vr(Ft(Re,Fs,s),o),{success:!0,message:"Proveedor actualizado exitosamente"}}catch(i){return console.error("Error updating supplier:",i),{success:!1,error:i.message}}},z2=async(s,e)=>{try{return await Vr(Ft(Re,Fs,s),{status:"inactive",lastUpdated:new Date,updatedBy:e}),{success:!0,message:"Proveedor desactivado exitosamente"}}catch(t){return console.error("Error deleting supplier:",t),{success:!1,error:t.message}}},H2=async()=>{try{const s=await iS();if(!s.success)return s;const e=s.data,t={total:e.length,active:e.filter(i=>i.status==="active").length,inactive:e.filter(i=>i.status==="inactive").length,suspended:e.filter(i=>i.status==="suspended").length,preferred:e.filter(i=>i.isPreferred).length,averageRating:e.length>0?e.reduce((i,o)=>i+(o.rating||0),0)/e.length:0,byCategory:{},byType:{}};return e.forEach(i=>{const o=i.category||"sin_categoria";t.byCategory[o]=(t.byCategory[o]||0)+1}),e.forEach(i=>{const o=i.type||"sin_tipo";t.byType[o]=(t.byType[o]||0)+1}),{success:!0,data:t}}catch(s){return console.error("Error getting suppliers stats:",s),{success:!1,error:s.message}}},G2=({isOpen:s,onClose:e,movement:t,mode:i,onSuccess:o})=>{const[c,d]=W.useState({type:"",fuelType:"",quantity:"",unitPrice:"",location:"Principal",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16)}),[m,p]=W.useState(!1),[v,_]=W.useState(""),[T,x]=W.useState({}),[C,N]=W.useState([]),[M,S]=W.useState(!1),[U,$]=W.useState([]),[F,V]=W.useState(""),[B,ee]=W.useState([]),[D,A]=W.useState([]),R=["Principal","Bodega Norte","Bodega Sur","Campo Operativo","Estación Móvil"];W.useEffect(()=>{(async()=>{if(s){S(!0);try{const[H,te,ce,ge]=await Promise.all([nS(),XA(),iS(),j2()]);N(H),$(te.success?te.data:[]),ee(ce.success?ce.data:[]),A(ge)}catch(H){console.error("Error al cargar datos:",H)}finally{S(!1)}}})()},[s]),W.useEffect(()=>{t&&(i==="edit"||i==="view")?d({type:t.type||"",fuelType:t.fuelType||"",quantity:t.quantity?.toString()||"",unitPrice:t.unitPrice?.toString()||"",location:t.location||"Principal",vehicleId:t.vehicleId||"",destinationLocation:t.destinationLocation||"",description:t.description||"",reference:t.reference||"",effectiveDate:t.effectiveDate?new Date(t.effectiveDate).toISOString().slice(0,16):new Date().toISOString().slice(0,16)}):i==="create"&&d({type:"",fuelType:"",quantity:"",unitPrice:"",location:"Principal",vehicleId:"",destinationLocation:"",description:"",reference:"",effectiveDate:new Date().toISOString().slice(0,16)}),_(""),x({})},[t,i,s]),W.useEffect(()=>{if(c.fuelType&&!c.unitPrice&&D.length>0){const ae=D.find(H=>H.name===c.fuelType||H.displayName===c.fuelType);ae&&ae.defaultPrice&&d(H=>({...H,unitPrice:ae.defaultPrice.toString()}))}},[c.fuelType,D]),W.useEffect(()=>{if(V(""),(c.type===_e.SALIDA||c.type===_e.TRANSFERENCIA)&&c.fuelType&&c.location&&c.quantity&&U.length>0){const ae={type:c.type===_e.SALIDA?"outbound":"transfer",fuelType:c.fuelType,quantity:c.quantity,sourceLocation:c.location},H=fN(ae,U);H.isValid?H.warning&&V(`⚠️ ${H.warning}`):V(`🚫 ${H.error}`)}},[c.type,c.fuelType,c.location,c.quantity,U]);const I=(ae,H)=>{d(ae==="type"?te=>({...te,[ae]:H,location:H===_e.ENTRADA?"":"Principal"}):te=>({...te,[ae]:H})),T[ae]&&x(te=>({...te,[ae]:""}))},k=()=>{const ae={};if(c.type||(ae.type="Tipo de movimiento requerido"),c.fuelType||(ae.fuelType="Tipo de combustible requerido"),c.quantity?parseFloat(c.quantity)<=0&&(ae.quantity="La cantidad debe ser mayor a cero"):ae.quantity="Cantidad requerida",c.unitPrice?parseFloat(c.unitPrice)<0&&(ae.unitPrice="El precio no puede ser negativo"):ae.unitPrice="Precio unitario requerido",c.type===_e.ENTRADA&&!c.location&&(ae.location="Las entradas requieren un proveedor"),c.type===_e.SALIDA&&!c.vehicleId&&(ae.vehicleId="Las salidas requieren un vehículo"),c.type===_e.TRANSFERENCIA&&!c.destinationLocation&&(ae.destinationLocation="Las transferencias requieren una ubicación destino"),(c.type===_e.SALIDA||c.type===_e.TRANSFERENCIA)&&c.fuelType&&c.location&&c.quantity&&U.length>0){const H={type:c.type===_e.SALIDA?"outbound":"transfer",fuelType:c.fuelType,quantity:c.quantity,sourceLocation:c.location},te=fN(H,U);te.isValid||(ae.quantity=te.error)}return x(ae),Object.keys(ae).length===0},P=async ae=>{if(ae.preventDefault(),!k()){_("Por favor corrige los errores en el formulario");return}p(!0),_("");try{const H={...c,quantity:parseFloat(c.quantity),unitPrice:parseFloat(c.unitPrice),effectiveDate:new Date(c.effectiveDate)};i==="create"?await E2(H):i==="edit"&&await ZA(t.id,H),o()}catch(H){console.error("Error al guardar movimiento:",H),_(H.message||"Error al guardar el movimiento")}finally{p(!1)}},O=(parseFloat(c.quantity)||0)*(parseFloat(c.unitPrice)||0),Ve=()=>{switch(i){case"create":return"➕ Nuevo Movimiento";case"edit":return"✏️ Editar Movimiento";case"view":return"👁️ Detalles del Movimiento";default:return"Movimiento"}};return s?r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-content movement-modal",onClick:ae=>ae.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:Ve()}),r.jsx("button",{className:"modal-close",onClick:e,children:"✕"})]}),r.jsxs("div",{className:"modal-body",children:[v&&r.jsxs("div",{className:"error-message",children:[r.jsx("span",{className:"error-icon",children:"⚠️"}),v]}),r.jsxs("form",{onSubmit:P,className:"movement-form",children:[r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Tipo de Movimiento *"}),r.jsxs("select",{value:c.type,onChange:ae=>I("type",ae.target.value),disabled:i==="view",className:T.type?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar tipo..."}),r.jsx("option",{value:_e.ENTRADA,children:"📥 Entrada"}),r.jsx("option",{value:_e.SALIDA,children:"📤 Salida"}),r.jsx("option",{value:_e.TRANSFERENCIA,children:"🔄 Transferencia"}),r.jsx("option",{value:_e.AJUSTE,children:"⚖️ Ajuste"})]}),T.type&&r.jsx("span",{className:"field-error",children:T.type})]}),i==="view"&&t&&r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado"}),r.jsx("div",{className:"status-display",children:r.jsxs("span",{className:`status-badge status-${t.status}`,children:[t.status===qe.COMPLETADO&&"✅",t.status===qe.PENDIENTE&&"⏳",t.status===qe.CANCELADO&&"❌",t.status.charAt(0).toUpperCase()+t.status.slice(1)]})})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Tipo de Combustible *"}),r.jsxs("select",{value:c.fuelType,onChange:ae=>I("fuelType",ae.target.value),disabled:i==="view",className:T.fuelType?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar producto/combustible..."}),D.map(ae=>r.jsxs("option",{value:ae.name,children:[ae.icon," ",ae.displayName]},ae.id))]}),T.fuelType&&r.jsx("span",{className:"field-error",children:T.fuelType})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Cantidad (galones) *"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:c.quantity,onChange:ae=>I("quantity",ae.target.value),disabled:i==="view",placeholder:"0.00",className:T.quantity?"error":""}),T.quantity&&r.jsx("span",{className:"field-error",children:T.quantity}),F&&!T.quantity&&r.jsx("div",{className:"stock-warning",children:F})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Precio Unitario (COP) *"}),r.jsx("input",{type:"number",step:"1",min:"0",value:c.unitPrice,onChange:ae=>I("unitPrice",ae.target.value),disabled:i==="view",placeholder:"0",className:T.unitPrice?"error":""}),T.unitPrice&&r.jsx("span",{className:"field-error",children:T.unitPrice})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Valor Total"}),r.jsx("div",{className:"total-value-display",children:Hs(O)})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:c.type===_e.ENTRADA?"Proveedor *":"Ubicación"}),c.type===_e.ENTRADA?r.jsxs("select",{value:c.location,onChange:ae=>I("location",ae.target.value),disabled:i==="view",className:T.location?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar proveedor..."}),B.filter(ae=>ae.status==="active").map(ae=>r.jsxs("option",{value:ae.name,children:["🏪 ",ae.name," - ",ae.city]},ae.id))]}):r.jsx("select",{value:c.location,onChange:ae=>I("location",ae.target.value),disabled:i==="view",children:R.map(ae=>r.jsxs("option",{value:ae,children:["📍 ",ae]},ae))}),T.location&&r.jsx("span",{className:"field-error",children:T.location})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{children:["Vehículo/Equipo ",c.type===_e.SALIDA&&"*"]}),c.type===_e.SALIDA?M?r.jsxs("div",{className:"loading-vehicles",children:[r.jsx("span",{className:"loading-spinner small"}),"Cargando vehículos..."]}):r.jsxs("select",{value:c.vehicleId,onChange:ae=>I("vehicleId",ae.target.value),disabled:i==="view",className:T.vehicleId?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar vehículo destino..."}),C.map(ae=>r.jsxs("option",{value:ae.vehicleId,children:["🚜 ",ae.vehicleId," - ",ae.name," (",ae.type,")"]},ae.id))]}):r.jsx("input",{type:"text",value:c.vehicleId,onChange:ae=>I("vehicleId",ae.target.value),disabled:i==="view",placeholder:"ID del vehículo o equipo",className:T.vehicleId?"error":""}),T.vehicleId&&r.jsx("span",{className:"field-error",children:T.vehicleId})]})]}),c.type===_e.TRANSFERENCIA&&r.jsx("div",{className:"form-row",children:r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Ubicación Destino *"}),r.jsxs("select",{value:c.destinationLocation,onChange:ae=>I("destinationLocation",ae.target.value),disabled:i==="view",className:T.destinationLocation?"error":"",children:[r.jsx("option",{value:"",children:"Seleccionar destino..."}),R.filter(ae=>ae!==c.location).map(ae=>r.jsxs("option",{value:ae,children:["📍 ",ae]},ae))]}),T.destinationLocation&&r.jsx("span",{className:"field-error",children:T.destinationLocation})]})}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Fecha Efectiva"}),r.jsx("input",{type:"datetime-local",value:c.effectiveDate,onChange:ae=>I("effectiveDate",ae.target.value),disabled:i==="view"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Referencia"}),r.jsx("input",{type:"text",value:c.reference,onChange:ae=>I("reference",ae.target.value),disabled:i==="view",placeholder:"Factura, orden, etc."})]})]}),r.jsx("div",{className:"form-row",children:r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{children:"Descripción"}),r.jsx("textarea",{value:c.description,onChange:ae=>I("description",ae.target.value),disabled:i==="view",placeholder:"Detalles adicionales del movimiento...",rows:"3"})]})}),i==="view"&&t&&r.jsx("div",{className:"movement-details",children:r.jsxs("div",{className:"details-section",children:[r.jsx("h4",{children:"📋 Información del Sistema"}),r.jsxs("div",{className:"details-grid",children:[r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"ID:"}),r.jsx("span",{children:t.id})]}),r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"Creado:"}),r.jsx("span",{children:new Date(t.createdAt).toLocaleString("es-CO")})]}),t.updatedAt&&r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"Actualizado:"}),r.jsx("span",{children:new Date(t.updatedAt).toLocaleString("es-CO")})]}),t.approvedAt&&r.jsxs("div",{className:"detail-item",children:[r.jsx("label",{children:"Aprobado:"}),r.jsx("span",{children:new Date(t.approvedAt).toLocaleString("es-CO")})]})]})]})})]})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-cancel",onClick:e,children:i==="view"?"Cerrar":"Cancelar"}),i!=="view"&&r.jsx("button",{type:"submit",className:"btn-primary",onClick:P,disabled:m,children:m?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"loading-spinner small"}),"Guardando..."]}):i==="create"?"Crear Movimiento":"Actualizar Movimiento"})]})]})}):null},$2=()=>{const{user:s,userProfile:e}=Da(),[t,i]=W.useState([]),[o,c]=W.useState(null),[d,m]=W.useState(!0),[p,v]=W.useState(null),[_,T]=W.useState({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),[x,C]=W.useState("cards"),[N,M]=W.useState(""),[S,U]=W.useState(!1),[$,F]=W.useState(null),[V,B]=W.useState("create");W.useEffect(()=>{if(!s)return;m(!0);const te=Mv((ce,ge)=>{if(ge){console.error("Error en suscripción de movimientos:",ge),v("Error al cargar movimientos"),m(!1);return}i(ce),v(null),m(!1)},_);return()=>te()},[s,_]),W.useEffect(()=>{s&&(async()=>{try{const ce=await x2(_);c(ce)}catch(ce){console.error("Error al cargar estadísticas:",ce)}})()},[s,t,_]);const ee=t.filter(te=>{if(!N)return!0;const ce=N.toLowerCase();return te.fuelType?.toLowerCase().includes(ce)||te.type?.toLowerCase().includes(ce)||te.location?.toLowerCase().includes(ce)||te.vehicleId?.toLowerCase().includes(ce)||te.description?.toLowerCase().includes(ce)||te.reference?.toLowerCase().includes(ce)}),D=()=>{F(null),B("create"),U(!0)},A=te=>{F(te),B("edit"),U(!0)},R=te=>{F(te),B("view"),U(!0)},I=()=>{U(!1),F(null)},k=te=>{T(ce=>({...ce,...te}))},P=()=>{T({type:"",status:"",fuelType:"",vehicleId:"",dateRange:"all"}),M("")},O=async te=>{if(window.confirm("¿Estás seguro de que quieres aprobar este movimiento? Esta acción actualizará el inventario."))try{await N2(te),alert("Movimiento aprobado y stock actualizado.")}catch(ce){console.error("Error al aprobar movimiento:",ce),alert(`Error al aprobar movimiento: ${ce.message}`)}},Ve=async te=>{if(window.confirm("¿Estás seguro de que quieres rechazar este movimiento?"))try{await ZA(te,{status:qe.CANCELADO}),alert("Movimiento rechazado.")}catch(ce){console.error("Error al rechazar movimiento:",ce),alert(`Error al rechazar movimiento: ${ce.message}`)}},ae=e?.role==="admin"||e?.role==="contador"||e?.role==="cliente",H=e?.role==="admin";return d?r.jsx("div",{className:"movements-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando movimientos..."})]})}):p?r.jsx("div",{className:"movements-main",children:r.jsxs("div",{className:"error-container",children:[r.jsx("div",{className:"error-icon",children:"⚠️"}),r.jsx("h3",{children:"Error al cargar movimientos"}),r.jsx("p",{children:p}),r.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):r.jsxs("div",{className:"movements-main",children:[r.jsxs("div",{className:"movements-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h2",{children:"📊 Movimientos de Combustibles"}),r.jsx("p",{children:"Gestiona entradas, salidas, transferencias y ajustes de inventario"})]}),ae&&r.jsx("button",{className:"btn-create-movement",onClick:D,children:"➕ Nuevo Movimiento"})]}),o&&r.jsx(P2,{stats:o,filters:_}),r.jsx(k2,{filters:_,onFilterChange:k,onClearFilters:P,searchTerm:N,onSearchChange:M,viewMode:x,onViewModeChange:C,totalResults:ee.length}),ee.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"📋"}),r.jsx("h3",{children:t.length===0?"No hay movimientos registrados":"No se encontraron movimientos"}),r.jsx("p",{children:t.length===0?"Comienza creando tu primer movimiento de combustible":"Intenta ajustar los filtros de búsqueda"}),t.length===0&&ae&&r.jsx("button",{className:"btn-create-first",onClick:D,children:"➕ Crear Primer Movimiento"})]}):r.jsx(U2,{movements:ee,viewMode:x,onEdit:H?A:null,onView:R,onApprove:O,onReject:Ve,userRole:s?.role}),S&&r.jsx(G2,{isOpen:S,onClose:I,movement:$,mode:V,onSuccess:()=>{I()}})]})},K2=({stats:s,filters:e})=>{if(!s)return null;const t=T=>`${ct(T)} gal`,i=T=>`${ct(T)} hrs`,o=T=>`${T.toFixed(2)} gal/hr`,c=T=>{switch(T){case pe.EXCAVADORA:return"#059669";case pe.BULLDOZER:return"#dc2626";case pe.CARGADOR:return"#2563eb";case pe.CAMION:return"#7c3aed";case pe.GRUA:return"#ea580c";case pe.MOTOSIERRA:return"#16a34a";case pe.TRACTOR:return"#ca8a04";case pe.VOLQUETA:return"#9333ea";default:return"#6b7280"}},d=T=>{switch(T){case pe.EXCAVADORA:return"🚚";case pe.BULLDOZER:return"🚜";case pe.CARGADOR:return"🏗️";case pe.CAMION:return"🚛";case pe.GRUA:return"🏗️";case pe.MOTOSIERRA:return"🪚";case pe.TRACTOR:return"🚜";case pe.VOLQUETA:return"🚛";default:return"🚗"}},m=T=>{switch(T){case Ie.ACTIVO:return"#10b981";case Ie.MANTENIMIENTO:return"#f59e0b";case Ie.INACTIVO:return"#6b7280";case Ie.REPARACION:return"#ef4444";default:return"#6b7280"}},p=T=>{switch(T){case Ie.ACTIVO:return"✅";case Ie.MANTENIMIENTO:return"🔧";case Ie.INACTIVO:return"⏸️";case Ie.REPARACION:return"🔴";default:return"❓"}},v=T=>{switch(T){case bt.DIESEL:return"🚛";case bt.GASOLINA:return"🚗";case bt.ACPM:return"🚚";case bt.MIXTO:return"⛽";default:return"⛽"}},_=s.totalVehicles>0?((s.byStatus[Ie.ACTIVO]||0)/s.totalVehicles*100).toFixed(1):0;return r.jsxs("div",{className:"vehicles-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:"🚜"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:ct(s.totalVehicles)}),r.jsx("div",{className:"stat-label",children:"Total Vehículos"}),r.jsx("div",{className:"stat-trend",children:r.jsxs("span",{className:`trend ${_>=80?"positive":"warning"}`,children:[_>=80?"📈":"⚠️"," ",_,"% activos"]})})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"⛽"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:t(s.totalFuelConsumed)}),r.jsx("div",{className:"stat-label",children:"Combustible Consumido"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",o(s.averageConsumption||0)]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"⏰"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:i(s.totalHoursWorked)}),r.jsx("div",{className:"stat-label",children:"Horas Trabajadas"}),r.jsxs("div",{className:"stat-secondary",children:["Promedio: ",i(s.totalHoursWorked/(s.totalVehicles||1))]})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"🏆"}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:s.mostActiveVehicle?s.mostActiveVehicle.vehicleId:"N/A"}),r.jsx("div",{className:"stat-label",children:"Más Activo"}),r.jsx("div",{className:"stat-secondary",children:s.mostActiveVehicle?`${s.mostActiveVehicle.totalMovements||0} movimientos`:"Sin datos"})]})]})]}),r.jsxs("div",{className:"stats-breakdown",children:[r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"🚜 Por Tipo de Vehículo"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byType).map(([T,x])=>{const C=(x/s.totalVehicles*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:d(T)}),r.jsx("span",{className:"breakdown-label",children:T.charAt(0).toUpperCase()+T.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:x}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${C}%`,backgroundColor:c(T)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[C,"%"]})]},T)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"⚡ Por Estado"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byStatus).map(([T,x])=>{const C=(x/s.totalVehicles*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:p(T)}),r.jsx("span",{className:"breakdown-label",children:T.charAt(0).toUpperCase()+T.slice(1)})]}),r.jsx("div",{className:"breakdown-value",children:x}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${C}%`,backgroundColor:m(T)}})}),r.jsxs("div",{className:"breakdown-percentage",children:[C,"%"]})]},T)})})]}),r.jsxs("div",{className:"breakdown-section",children:[r.jsx("h4",{children:"⛽ Por Tipo de Combustible"}),r.jsx("div",{className:"breakdown-grid",children:Object.entries(s.byFuelType).map(([T,x])=>{const C=(x/s.totalVehicles*100).toFixed(1);return r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-header",children:[r.jsx("span",{className:"breakdown-icon",children:v(T)}),r.jsx("span",{className:"breakdown-label",children:T})]}),r.jsx("div",{className:"breakdown-value",children:x}),r.jsx("div",{className:"breakdown-bar",children:r.jsx("div",{className:"breakdown-fill",style:{width:`${C}%`,backgroundColor:"#059669"}})}),r.jsxs("div",{className:"breakdown-percentage",children:[C,"%"]})]},T)})})]})]}),(s.totalFuelConsumed>0||s.totalHoursWorked>0)&&r.jsxs("div",{className:"performance-metrics",children:[r.jsx("h4",{children:"📊 Métricas de Rendimiento"}),r.jsxs("div",{className:"metrics-grid",children:[r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:"⚡"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Eficiencia de Flota"}),r.jsxs("div",{className:"metric-value",children:[_,"%"]}),r.jsxs("div",{className:"metric-description",children:[s.byStatus[Ie.ACTIVO]||0," de ",s.totalVehicles," activos"]})]})]}),s.averageConsumption>0&&r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:"📈"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Consumo Promedio"}),r.jsx("div",{className:"metric-value",children:o(s.averageConsumption)}),r.jsx("div",{className:"metric-description",children:"Por vehículo por hora trabajada"})]})]}),s.mostActiveVehicle&&r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:"🏆"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Mayor Utilización"}),r.jsx("div",{className:"metric-value",children:s.mostActiveVehicle.vehicleId}),r.jsxs("div",{className:"metric-description",children:[t(s.mostActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]}),s.leastActiveVehicle&&r.jsxs("div",{className:"metric-card",children:[r.jsx("div",{className:"metric-icon",children:"📉"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-label",children:"Menor Utilización"}),r.jsx("div",{className:"metric-value",children:s.leastActiveVehicle.vehicleId}),r.jsxs("div",{className:"metric-description",children:[t(s.leastActiveVehicle.totalFuelConsumed||0)," consumidos"]})]})]})]})]}),(e.type||e.status||e.fuelType||e.location)&&r.jsxs("div",{className:"active-filters",children:[r.jsx("h4",{children:"🔍 Filtros Activos"}),r.jsxs("div",{className:"filters-list",children:[e.type&&r.jsxs("span",{className:"filter-tag",children:["Tipo: ",e.type]}),e.status&&r.jsxs("span",{className:"filter-tag",children:["Estado: ",e.status]}),e.fuelType&&r.jsxs("span",{className:"filter-tag",children:["Combustible: ",e.fuelType]}),e.location&&r.jsxs("span",{className:"filter-tag",children:["Ubicación: ",e.location]})]})]})]})},Y2=({filters:s,onFilterChange:e,onClearFilters:t,searchTerm:i,onSearchChange:o,viewMode:c,onViewModeChange:d,totalResults:m})=>{const[p,v]=W.useState(!1),_=["Oficina Principal","Bodega Norte","Bodega Sur","Campo Operativo","Taller Mecánico","Proyecto A","Proyecto B","En Reparación","Otros"],T=Object.values(s).filter(N=>N&&N!==""&&N!=="all").length,x=(N,M)=>{e({[N]:M})},C=N=>{e(N)};return r.jsxs("div",{className:"vehicles-filters",children:[r.jsxs("div",{className:"filters-main",children:[r.jsx("div",{className:"search-section",children:r.jsxs("div",{className:"search-box",children:[r.jsx("span",{className:"search-icon",children:"🔍"}),r.jsx("input",{type:"text",placeholder:"Buscar por ID, nombre, marca, modelo, ubicación...",value:i,onChange:N=>o(N.target.value),className:"search-input"}),i&&r.jsx("button",{className:"search-clear",onClick:()=>o(""),title:"Limpiar búsqueda",children:"✕"})]})}),r.jsxs("div",{className:"filters-controls",children:[r.jsxs("div",{className:"quick-filters",children:[r.jsx("button",{className:`quick-filter ${s.status===Ie.ACTIVO?"active":""}`,onClick:()=>C({status:Ie.ACTIVO}),children:"✅ Activos"}),r.jsx("button",{className:`quick-filter ${s.status===Ie.MANTENIMIENTO?"active":""}`,onClick:()=>C({status:Ie.MANTENIMIENTO}),children:"🔧 Mantenimiento"}),r.jsx("button",{className:`quick-filter ${s.type===pe.EXCAVADORA?"active":""}`,onClick:()=>C({type:pe.EXCAVADORA}),children:"🚚 Excavadoras"}),r.jsx("button",{className:`quick-filter ${s.type===pe.TRACTOR?"active":""}`,onClick:()=>C({type:pe.TRACTOR}),children:"🚜 Tractores"})]}),r.jsxs("button",{className:`btn-advanced-filters ${p?"active":""}`,onClick:()=>v(!p),children:["🎛️ Filtros",T>0&&r.jsx("span",{className:"filters-count",children:T})]}),r.jsxs("div",{className:"view-modes",children:[r.jsx("button",{className:`view-mode ${c==="cards"?"active":""}`,onClick:()=>d("cards"),title:"Vista en tarjetas",children:"🎴"}),r.jsx("button",{className:`view-mode ${c==="table"?"active":""}`,onClick:()=>d("table"),title:"Vista en tabla",children:"📋"})]})]})]}),p&&r.jsxs("div",{className:"filters-advanced",children:[r.jsxs("div",{className:"filters-grid",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Vehículo"}),r.jsxs("select",{value:s.type,onChange:N=>x("type",N.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los tipos"}),r.jsx("option",{value:pe.EXCAVADORA,children:"🚚 Excavadora"}),r.jsx("option",{value:pe.BULLDOZER,children:"🚜 Bulldozer"}),r.jsx("option",{value:pe.CARGADOR,children:"🏗️ Cargador"}),r.jsx("option",{value:pe.CAMION,children:"🚛 Camión"}),r.jsx("option",{value:pe.GRUA,children:"🏗️ Grúa"}),r.jsx("option",{value:pe.MOTOSIERRA,children:"🪚 Motosierra"}),r.jsx("option",{value:pe.TRACTOR,children:"🚜 Tractor"}),r.jsx("option",{value:pe.VOLQUETA,children:"🚛 Volqueta"}),r.jsx("option",{value:pe.OTROS,children:"🚗 Otros"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:s.status,onChange:N=>x("status",N.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los estados"}),r.jsx("option",{value:Ie.ACTIVO,children:"✅ Activo"}),r.jsx("option",{value:Ie.MANTENIMIENTO,children:"🔧 Mantenimiento"}),r.jsx("option",{value:Ie.INACTIVO,children:"⏸️ Inactivo"}),r.jsx("option",{value:Ie.REPARACION,children:"🔴 Reparación"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Tipo de Combustible"}),r.jsxs("select",{value:s.fuelType,onChange:N=>x("fuelType",N.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todos los combustibles"}),r.jsx("option",{value:bt.DIESEL,children:"🚛 Diesel"}),r.jsx("option",{value:bt.GASOLINA,children:"🚗 Gasolina"}),r.jsx("option",{value:bt.ACPM,children:"🚚 ACPM"}),r.jsx("option",{value:bt.MIXTO,children:"⛽ Mixto"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Ubicación Actual"}),r.jsxs("select",{value:s.location,onChange:N=>x("location",N.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Todas las ubicaciones"}),_.map(N=>r.jsxs("option",{value:N,children:["📍 ",N]},N))]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{children:"Mantenimiento"}),r.jsxs("select",{value:s.maintenance,onChange:N=>x("maintenance",N.target.value),className:"filter-select",children:[r.jsx("option",{value:"all",children:"Todos"}),r.jsx("option",{value:"due",children:"Mantenimiento debido"}),r.jsx("option",{value:"overdue",children:"Mantenimiento vencido"}),r.jsx("option",{value:"recent",children:"Mantenimiento reciente"})]})]})]}),r.jsxs("div",{className:"filters-actions",children:[r.jsx("button",{className:"btn-clear-filters",onClick:t,disabled:T===0,children:"🗑️ Limpiar Filtros"}),r.jsxs("div",{className:"filters-info",children:[r.jsxs("span",{className:"results-count",children:[m," resultado",m!==1?"s":""]}),T>0&&r.jsxs("span",{className:"active-filters-text",children:["(",T," filtro",T!==1?"s":""," activo",T!==1?"s":"",")"]})]})]})]}),T>0&&r.jsx("div",{className:"active-filters-summary",children:r.jsxs("div",{className:"summary-content",children:[r.jsx("span",{className:"summary-label",children:"Filtros activos:"}),r.jsxs("div",{className:"summary-tags",children:[s.type&&r.jsxs("span",{className:"summary-tag",onClick:()=>x("type",""),children:["Tipo: ",s.type," ✕"]}),s.status&&r.jsxs("span",{className:"summary-tag",onClick:()=>x("status",""),children:["Estado: ",s.status," ✕"]}),s.fuelType&&r.jsxs("span",{className:"summary-tag",onClick:()=>x("fuelType",""),children:["Combustible: ",s.fuelType," ✕"]}),s.location&&r.jsxs("span",{className:"summary-tag",onClick:()=>x("location",""),children:["Ubicación: ",s.location," ✕"]}),s.maintenance!=="all"&&r.jsxs("span",{className:"summary-tag",onClick:()=>x("maintenance","all"),children:["Mantenimiento: ",s.maintenance," ✕"]})]})]})}),r.jsx("div",{className:"keyboard-shortcuts",style:{display:"none"},children:r.jsx("small",{children:"💡 Atajos: Ctrl+F (buscar), Ctrl+1 (activos), Ctrl+2 (mantenimiento), Ctrl+T (tractores)"})})]})},Q2=({vehicles:s,onEdit:e,onView:t,onMaintenance:i})=>{const o=S=>new Intl.NumberFormat("es-CO").format(S),c=S=>`${o(S)} gal`,d=S=>`${o(S)} hrs`,m=S=>S?(S instanceof Date?S:new Date(S)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric"}):"Sin fecha",p=S=>{if(!S)return"";const U=new Date,$=S instanceof Date?S:new Date(S),F=Math.abs(U-$),V=Math.ceil(F/(1e3*60*60*24));return V===1?"hace 1 día":V<7?`hace ${V} días`:V<30?`hace ${Math.ceil(V/7)} semanas`:V<365?`hace ${Math.ceil(V/30)} meses`:`hace ${Math.ceil(V/365)} años`},v=S=>{switch(S){case pe.EXCAVADORA:return"vehicle-excavadora";case pe.BULLDOZER:return"vehicle-bulldozer";case pe.CARGADOR:return"vehicle-cargador";case pe.CAMION:return"vehicle-camion";case pe.GRUA:return"vehicle-grua";case pe.MOTOSIERRA:return"vehicle-motosierra";case pe.TRACTOR:return"vehicle-tractor";case pe.VOLQUETA:return"vehicle-volqueta";default:return"vehicle-default"}},_=S=>{switch(S){case Ie.ACTIVO:return"status-activo";case Ie.MANTENIMIENTO:return"status-mantenimiento";case Ie.INACTIVO:return"status-inactivo";case Ie.REPARACION:return"status-reparacion";default:return"status-default"}},T=S=>{switch(S){case pe.EXCAVADORA:return"🚚";case pe.BULLDOZER:return"🚜";case pe.CARGADOR:return"🏗️";case pe.CAMION:return"🚛";case pe.GRUA:return"🏗️";case pe.MOTOSIERRA:return"🪚";case pe.TRACTOR:return"🚜";case pe.VOLQUETA:return"🚛";default:return"🚗"}},x=S=>{switch(S){case bt.DIESEL:return"🚛";case bt.GASOLINA:return"🚗";case bt.ACPM:return"🚚";case bt.MIXTO:return"⛽";default:return"⛽"}},C=S=>{switch(S){case Ie.ACTIVO:return"✅";case Ie.MANTENIMIENTO:return"🔧";case Ie.INACTIVO:return"⏸️";case Ie.REPARACION:return"🔴";default:return"❓"}},N=S=>!S.totalHoursWorked||S.totalHoursWorked===0?S.estimatedConsumptionPerHour||0:S.totalFuelConsumed/S.totalHoursWorked,M=S=>S.lastMaintenanceDate?Math.floor((new Date-new Date(S.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return r.jsx("div",{className:"vehicles-cards",children:s.map(S=>r.jsxs("div",{className:`vehicle-card ${v(S.type)}`,children:[r.jsx("div",{className:"card-header",children:r.jsxs("div",{className:"vehicle-info",children:[r.jsxs("div",{className:"vehicle-id-section",children:[r.jsx("span",{className:"vehicle-icon",children:T(S.type)}),r.jsxs("div",{className:"vehicle-details",children:[r.jsx("span",{className:"vehicle-id",children:S.vehicleId}),r.jsx("span",{className:"vehicle-name",children:S.name})]})]}),r.jsxs("div",{className:`status-badge ${_(S.status)}`,children:[r.jsx("span",{className:"status-icon",children:C(S.status)}),r.jsx("span",{className:"status-label",children:S.status.charAt(0).toUpperCase()+S.status.slice(1)})]})]})}),r.jsxs("div",{className:"card-content",children:[r.jsxs("div",{className:"basic-info",children:[r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Tipo:"}),r.jsxs("span",{className:"info-value",children:[T(S.type)," ",S.type.charAt(0).toUpperCase()+S.type.slice(1)]})]}),S.brand&&S.model&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Marca/Modelo:"}),r.jsxs("span",{className:"info-value",children:[S.brand," ",S.model]})]}),r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Combustible:"}),r.jsxs("span",{className:"info-value",children:[x(S.fuelType)," ",S.fuelType]})]}),S.currentLocation&&r.jsxs("div",{className:"info-row",children:[r.jsx("span",{className:"info-label",children:"Ubicación:"}),r.jsxs("span",{className:"info-value",children:["📍 ",S.currentLocation]})]})]}),r.jsxs("div",{className:"consumption-metrics",children:[r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:"⛽"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-value",children:c(S.totalFuelConsumed||0)}),r.jsx("div",{className:"metric-label",children:"Consumido"})]})]}),r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:"⏰"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-value",children:d(S.totalHoursWorked||0)}),r.jsx("div",{className:"metric-label",children:"Trabajadas"})]})]}),r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:"📊"}),r.jsxs("div",{className:"metric-content",children:[r.jsxs("div",{className:"metric-value",children:[N(S).toFixed(1)," gal/hr"]}),r.jsx("div",{className:"metric-label",children:"Consumo"})]})]}),r.jsxs("div",{className:"metric-item",children:[r.jsx("div",{className:"metric-icon",children:"🔄"}),r.jsxs("div",{className:"metric-content",children:[r.jsx("div",{className:"metric-value",children:S.totalMovements||0}),r.jsx("div",{className:"metric-label",children:"Movimientos"})]})]})]}),(S.enginePower||S.fuelCapacity||S.year)&&r.jsxs("div",{className:"technical-specs",children:[S.enginePower&&r.jsxs("div",{className:"spec-item",children:[r.jsx("span",{className:"spec-icon",children:"⚡"}),r.jsxs("span",{className:"spec-value",children:[S.enginePower," HP"]})]}),S.fuelCapacity&&r.jsxs("div",{className:"spec-item",children:[r.jsx("span",{className:"spec-icon",children:"🛢️"}),r.jsxs("span",{className:"spec-value",children:[S.fuelCapacity," gal"]})]}),S.year&&r.jsxs("div",{className:"spec-item",children:[r.jsx("span",{className:"spec-icon",children:"📅"}),r.jsx("span",{className:"spec-value",children:S.year})]})]}),S.description&&r.jsx("div",{className:"description",children:r.jsx("p",{children:S.description})})]}),r.jsxs("div",{className:"card-footer",children:[r.jsxs("div",{className:"date-info",children:[S.lastMovementDate&&r.jsxs("div",{className:"date-item",children:[r.jsx("span",{className:"date-label",children:"Último movimiento:"}),r.jsx("span",{className:"date-value",children:m(S.lastMovementDate)}),r.jsx("span",{className:"date-relative",children:p(S.lastMovementDate)})]}),S.lastMaintenanceDate&&r.jsxs("div",{className:"date-item",children:[r.jsx("span",{className:"date-label",children:"Último mantenimiento:"}),r.jsx("span",{className:"date-value",children:m(S.lastMaintenanceDate)}),r.jsx("span",{className:"date-relative",children:p(S.lastMaintenanceDate)})]})]}),r.jsxs("div",{className:"card-actions",children:[r.jsx("button",{className:"btn-view",onClick:()=>t(S),title:"Ver detalles",children:"👁️"}),e&&S.status!==Ie.REPARACION&&r.jsx("button",{className:"btn-edit",onClick:()=>e(S),title:"Editar vehículo",children:"✏️"}),i&&r.jsx("button",{className:"btn-maintenance",onClick:()=>i(S),title:"Registrar mantenimiento",children:"🔧"})]})]}),S.status===Ie.MANTENIMIENTO&&r.jsx("div",{className:"maintenance-indicator",children:r.jsx("div",{className:"maintenance-pulse"})}),M(S)&&S.status===Ie.ACTIVO&&r.jsx("div",{className:"maintenance-due-badge",children:r.jsx("span",{children:"Mantenimiento Debido"})}),S.status===Ie.REPARACION&&r.jsx("div",{className:"repair-badge",children:r.jsx("span",{children:"En Reparación"})}),S.totalHoursWorked>0&&r.jsxs("div",{className:"efficiency-indicator",children:[r.jsx("div",{className:"efficiency-bar",children:r.jsx("div",{className:"efficiency-fill",style:{width:`${Math.min(S.totalHoursWorked/2e3*100,100)}%`}})}),r.jsxs("span",{className:"efficiency-label",children:[(S.totalHoursWorked/2e3*100).toFixed(1),"% utilización anual"]})]})]},S.id))})},X2=({vehicles:s,onEdit:e,onView:t,onMaintenance:i})=>{const[o,c]=W.useState("vehicleId"),[d,m]=W.useState("asc"),p=B=>new Intl.NumberFormat("es-CO").format(B),v=B=>`${p(B)} gal`,_=B=>`${p(B)} hrs`,T=B=>B?(B instanceof Date?B:new Date(B)).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-",x=B=>{switch(B){case pe.EXCAVADORA:return"🚚";case pe.BULLDOZER:return"🚜";case pe.CARGADOR:return"🏗️";case pe.CAMION:return"🚛";case pe.GRUA:return"🏗️";case pe.MOTOSIERRA:return"🪚";case pe.TRACTOR:return"🚜";case pe.VOLQUETA:return"🚛";default:return"🚗"}},C=B=>{switch(B){case bt.DIESEL:return"🚛";case bt.GASOLINA:return"🚗";case bt.ACPM:return"🚚";case bt.MIXTO:return"⛽";default:return"⛽"}},N=B=>{switch(B){case Ie.ACTIVO:return"✅";case Ie.MANTENIMIENTO:return"🔧";case Ie.INACTIVO:return"⏸️";case Ie.REPARACION:return"🔴";default:return"❓"}},M=B=>{switch(B){case Ie.ACTIVO:return"status-activo";case Ie.MANTENIMIENTO:return"status-mantenimiento";case Ie.INACTIVO:return"status-inactivo";case Ie.REPARACION:return"status-reparacion";default:return"status-default"}},S=B=>{o===B?m(d==="asc"?"desc":"asc"):(c(B),m("asc"))},U=[...s].sort((B,ee)=>{let D=B[o],A=ee[o];return(o.includes("Date")||o.includes("At"))&&(D=new Date(D||0),A=new Date(A||0)),typeof D=="number"&&typeof A=="number"?d==="asc"?D-A:A-D:typeof D=="string"&&typeof A=="string"?d==="asc"?D.localeCompare(A):A.localeCompare(D):D instanceof Date&&A instanceof Date?d==="asc"?D-A:A-D:!D&&!A?0:D?A?0:d==="asc"?-1:1:d==="asc"?1:-1}),$=B=>o!==B?"↕️":d==="asc"?"↑":"↓",F=B=>!B.totalHoursWorked||B.totalHoursWorked===0?B.estimatedConsumptionPerHour||0:B.totalFuelConsumed/B.totalHoursWorked,V=B=>B.lastMaintenanceDate?Math.floor((new Date-new Date(B.lastMaintenanceDate))/(1e3*60*60*24))>90:!0;return r.jsxs("div",{className:"vehicles-table-container",children:[r.jsx("div",{className:"table-wrapper",children:r.jsxs("table",{className:"vehicles-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{className:"sortable",onClick:()=>S("vehicleId"),children:["ID Vehículo ",$("vehicleId")]}),r.jsxs("th",{className:"sortable",onClick:()=>S("name"),children:["Nombre ",$("name")]}),r.jsxs("th",{className:"sortable",onClick:()=>S("type"),children:["Tipo ",$("type")]}),r.jsx("th",{children:"Marca/Modelo"}),r.jsxs("th",{className:"sortable",onClick:()=>S("fuelType"),children:["Combustible ",$("fuelType")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>S("totalFuelConsumed"),children:["Consumido ",$("totalFuelConsumed")]}),r.jsxs("th",{className:"sortable text-right",onClick:()=>S("totalHoursWorked"),children:["Horas ",$("totalHoursWorked")]}),r.jsx("th",{className:"text-right",children:"Consumo/Hr"}),r.jsx("th",{children:"Ubicación"}),r.jsxs("th",{className:"sortable",onClick:()=>S("status"),children:["Estado ",$("status")]}),r.jsxs("th",{className:"sortable",onClick:()=>S("lastMovementDate"),children:["Último Mov. ",$("lastMovementDate")]}),r.jsx("th",{className:"actions-column",children:"Acciones"})]})}),r.jsx("tbody",{children:U.map(B=>r.jsxs("tr",{className:`vehicle-row ${B.status===Ie.MANTENIMIENTO?"maintenance-row":""} ${V(B)?"needs-maintenance":""}`,children:[r.jsx("td",{className:"vehicle-id-cell",children:r.jsxs("div",{className:"id-content",children:[r.jsx("span",{className:"vehicle-icon",children:x(B.type)}),r.jsx("span",{className:"vehicle-id",children:B.vehicleId})]})}),r.jsx("td",{className:"name-cell",children:r.jsx("span",{className:"vehicle-name",children:B.name})}),r.jsx("td",{className:"type-cell",children:r.jsx("span",{className:"type-text",children:B.type.charAt(0).toUpperCase()+B.type.slice(1)})}),r.jsx("td",{className:"brand-model-cell",children:B.brand&&B.model?r.jsxs("span",{className:"brand-model",children:[B.brand," ",B.model]}):r.jsx("span",{className:"no-data",children:"-"})}),r.jsx("td",{className:"fuel-cell",children:r.jsxs("div",{className:"fuel-content",children:[r.jsx("span",{className:"fuel-icon",children:C(B.fuelType)}),r.jsx("span",{className:"fuel-text",children:B.fuelType})]})}),r.jsx("td",{className:"consumption-cell text-right",children:r.jsx("span",{className:"consumption-value",children:v(B.totalFuelConsumed||0)})}),r.jsx("td",{className:"hours-cell text-right",children:r.jsx("span",{className:"hours-value",children:_(B.totalHoursWorked||0)})}),r.jsx("td",{className:"rate-cell text-right",children:r.jsxs("span",{className:"rate-value",children:[F(B).toFixed(1)," gal/hr"]})}),r.jsx("td",{className:"location-cell",children:r.jsxs("span",{className:"location-text",children:["📍 ",B.currentLocation||"Sin ubicación"]})}),r.jsx("td",{className:"status-cell",children:r.jsxs("div",{className:`status-badge ${M(B.status)}`,children:[r.jsx("span",{className:"status-icon",children:N(B.status)}),r.jsx("span",{className:"status-text",children:B.status.charAt(0).toUpperCase()+B.status.slice(1)})]})}),r.jsx("td",{className:"date-cell",children:r.jsxs("div",{className:"date-content",children:[r.jsx("span",{className:"date-value",children:T(B.lastMovementDate)}),V(B)&&r.jsx("span",{className:"maintenance-warning",children:"⚠️"})]})}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[r.jsx("button",{className:"btn-action btn-view",onClick:()=>t(B),title:"Ver detalles",children:"👁️"}),e&&B.status!==Ie.REPARACION&&r.jsx("button",{className:"btn-action btn-edit",onClick:()=>e(B),title:"Editar vehículo",children:"✏️"}),i&&r.jsx("button",{className:"btn-action btn-maintenance",onClick:()=>i(B),title:"Registrar mantenimiento",children:"🔧"})]})})]},B.id))})]})}),r.jsxs("div",{className:"table-info",children:[r.jsxs("div",{className:"table-summary",children:[r.jsxs("span",{className:"total-rows",children:[s.length," vehículo",s.length!==1?"s":""]}),o&&r.jsxs("span",{className:"sort-info",children:["Ordenado por ",o," (",d==="asc"?"ascendente":"descendente",")"]})]}),r.jsxs("div",{className:"table-legend",children:[r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"✅"})," Activo"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"🔧"})," Mantenimiento"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"⏸️"})," Inactivo"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"🔴"})," Reparación"]}),r.jsxs("span",{className:"legend-item",children:[r.jsx("span",{className:"legend-icon",children:"⚠️"})," Mantto. Debido"]})]})]})]})},W2=({vehicles:s,viewMode:e,onEdit:t,onView:i,onMaintenance:o})=>e==="table"?r.jsx(X2,{vehicles:s,onEdit:t,onView:i,onMaintenance:o}):r.jsx(Q2,{vehicles:s,onEdit:t,onView:i,onMaintenance:o}),en={HARVESTING:"harvesting",TRANSPORT:"transport",MAINTENANCE:"maintenance",SUPPORT:"support"},tn={CHAINSAW:"chainsaw",HARVESTER:"harvester",FORWARDER:"forwarder",SKIDDER:"skidder",LOG_TRUCK:"log_truck",PICKUP_TRUCK:"pickup_truck",CAR:"car",MOTORCYCLE:"motorcycle",ATV:"atv",BULLDOZER:"bulldozer",EXCAVATOR:"excavator",GRADER:"grader",LOADER:"loader",WATER_PUMP:"water_pump",FIRE_PUMP:"fire_pump",GENERATOR:"generator",COMPRESSOR:"compressor"},Z2={[tn.CHAINSAW]:{name:"Motosierra",category:en.HARVESTING,fuelType:"two_stroke",avgConsumption:2.5,icon:"🪚",color:"#dc2626",description:"Herramienta para corte de árboles"},[tn.HARVESTER]:{name:"Cosechadora Forestal",category:en.HARVESTING,fuelType:"diesel",avgConsumption:25,icon:"🚜",color:"#059669",description:"Máquina para corte y procesamiento de árboles"},[tn.FORWARDER]:{name:"Forwarder",category:en.HARVESTING,fuelType:"diesel",avgConsumption:20,icon:"🚚",color:"#0891b2",description:"Transporte de troncos dentro del bosque"},[tn.LOG_TRUCK]:{name:"Camión Maderero",category:en.TRANSPORT,fuelType:"acpm",avgConsumption:3.5,icon:"🚚",color:"#ea580c",description:"Transporte de madera a destino"},[tn.PICKUP_TRUCK]:{name:"Camioneta",category:en.TRANSPORT,fuelType:"gasoline",avgConsumption:8,icon:"🚐",color:"#2563eb",description:"Transporte de personal y herramientas"},[tn.CAR]:{name:"Automóvil",category:en.TRANSPORT,fuelType:"gasoline",avgConsumption:12,icon:"🚗",color:"#3b82f6",description:"Vehículo liviano para transporte ejecutivo"},[tn.MOTORCYCLE]:{name:"Motocicleta",category:en.TRANSPORT,fuelType:"gasoline",avgConsumption:25,icon:"🏍️",color:"#6366f1",description:"Transporte ágil para terrenos difíciles"},[tn.ATV]:{name:"Cuatrimoto",category:en.TRANSPORT,fuelType:"gasoline",avgConsumption:15,icon:"🏍️",color:"#84cc16",description:"Vehículo todo terreno para supervisión"},[tn.SKIDDER]:{name:"Skidder",category:en.HARVESTING,fuelType:"diesel",avgConsumption:22,icon:"🚜",color:"#f59e0b",description:"Arrastre de troncos desde el lugar de corte"},[tn.BULLDOZER]:{name:"Bulldozer",category:en.MAINTENANCE,fuelType:"diesel",avgConsumption:30,icon:"🚜",color:"#f97316",description:"Construcción y mantenimiento de caminos"},[tn.EXCAVATOR]:{name:"Excavadora",category:en.MAINTENANCE,fuelType:"diesel",avgConsumption:28,icon:"🏗️",color:"#eab308",description:"Excavación y movimiento de tierra"},[tn.GRADER]:{name:"Motoniveladora",category:en.MAINTENANCE,fuelType:"diesel",avgConsumption:25,icon:"🚜",color:"#a3a3a3",description:"Nivelación y mantenimiento de vías"},[tn.LOADER]:{name:"Cargador Frontal",category:en.MAINTENANCE,fuelType:"diesel",avgConsumption:24,icon:"🚜",color:"#71717a",description:"Carga y descarga de materiales"},[tn.WATER_PUMP]:{name:"Motobomba de Agua",category:en.SUPPORT,fuelType:"gasoline",avgConsumption:3.5,icon:"💧",color:"#0891b2",description:"Bombeo de agua para operaciones"},[tn.FIRE_PUMP]:{name:"Motobomba Contra Incendios",category:en.SUPPORT,fuelType:"gasoline",avgConsumption:4.2,icon:"🔥",color:"#dc2626",description:"Equipo de emergencia contra incendios"},[tn.GENERATOR]:{name:"Generador Eléctrico",category:en.SUPPORT,fuelType:"gasoline",avgConsumption:2.8,icon:"⚡",color:"#7c3aed",description:"Suministro de energía eléctrica"},[tn.COMPRESSOR]:{name:"Compresor de Aire",category:en.SUPPORT,fuelType:"gasoline",avgConsumption:2.5,icon:"💨",color:"#64748b",description:"Suministro de aire comprimido"}},J2=({isOpen:s,onClose:e,vehicle:t,onSave:i,mode:o="create",userRole:c})=>{const d=()=>({vehicleId:t?.vehicleId||"",name:t?.name||"",type:t?.type||pe.EXCAVADORA,brand:t?.brand||"",model:t?.model||"",year:t?.year||new Date().getFullYear(),fuelType:t?.fuelType||bt.DIESEL,fuelCapacity:t?.fuelCapacity||0,enginePower:t?.enginePower||0,status:t?.status||Ie.ACTIVO,currentLocation:t?.currentLocation||"",description:t?.description||"",estimatedConsumptionPerHour:t?.estimatedConsumptionPerHour||0,serialNumber:t?.serialNumber||"",plateNumber:t?.plateNumber||"",hasHourMeter:t?.hasHourMeter||!1,currentHours:t?.currentHours||0,lastMaintenanceDate:t?.lastMaintenanceDate?new Date(t.lastMaintenanceDate).toISOString().split("T")[0]:"",nextMaintenanceDate:t?.nextMaintenanceDate?new Date(t.nextMaintenanceDate).toISOString().split("T")[0]:"",purchaseDate:t?.purchaseDate?new Date(t.purchaseDate).toISOString().split("T")[0]:"",warrantyExpiration:t?.warrantyExpiration?new Date(t.warrantyExpiration).toISOString().split("T")[0]:""}),[m,p]=W.useState(d()),[v,_]=W.useState({}),[T,x]=W.useState(!1),[C,N]=W.useState(""),[M,S]=W.useState(!1);W.useEffect(()=>{s&&(p(d()),_({}))},[s,t]);const U=A=>{const{name:R,value:I,type:k}=A.target,P=k==="number"?parseFloat(I)||0:I;p(O=>({...O,[R]:P})),v[R]&&_(O=>({...O,[R]:null}))},$=()=>{const A={};m.vehicleId.trim()?m.vehicleId.length<3&&(A.vehicleId="El ID debe tener al menos 3 caracteres"):A.vehicleId="El ID del vehículo es obligatorio",m.name.trim()?m.name.length<2&&(A.name="El nombre debe tener al menos 2 caracteres"):A.name="El nombre del vehículo es obligatorio",m.fuelCapacity<=0?A.fuelCapacity="La capacidad de combustible debe ser mayor a 0":m.fuelCapacity>1e3&&(A.fuelCapacity="La capacidad no puede ser mayor a 1000 galones"),m.enginePower<0?A.enginePower="La potencia no puede ser negativa":m.enginePower>1e3&&(A.enginePower="La potencia no puede ser mayor a 1000 HP"),m.estimatedConsumptionPerHour<0?A.estimatedConsumptionPerHour="El consumo no puede ser negativo":m.estimatedConsumptionPerHour>50&&(A.estimatedConsumptionPerHour="El consumo no puede ser mayor a 50 gal/hr");const R=new Date().getFullYear();if(m.year<1990?A.year="El año no puede ser anterior a 1990":m.year>R+1&&(A.year=`El año no puede ser mayor a ${R+1}`),m.lastMaintenanceDate&&m.nextMaintenanceDate){const I=new Date(m.lastMaintenanceDate);new Date(m.nextMaintenanceDate)<=I&&(A.nextMaintenanceDate="La próxima fecha debe ser posterior al último mantenimiento")}return m.purchaseDate&&new Date(m.purchaseDate)>new Date&&(A.purchaseDate="La fecha de compra no puede ser futura"),_(A),Object.keys(A).length===0},F=async A=>{if(A.preventDefault(),!!$()){x(!0);try{const R={...m,lastMaintenanceDate:m.lastMaintenanceDate||null,nextMaintenanceDate:m.nextMaintenanceDate||null,purchaseDate:m.purchaseDate||null,warrantyExpiration:m.warrantyExpiration||null};await i(R),e()}catch(R){console.error("Error guardando vehículo:",R),_({general:"Error al guardar el vehículo. Intenta nuevamente."})}finally{x(!1)}}},V=A=>{switch(A){case pe.EXCAVADORA:return"🚚";case pe.BULLDOZER:return"🚜";case pe.CARGADOR:return"🏗️";case pe.CAMION:return"🚛";case pe.GRUA:return"🏗️";case pe.MOTOSIERRA:return"🪚";case pe.TRACTOR:return"🚜";case pe.VOLQUETA:return"🚛";default:return"🚗"}},B=A=>{switch(A){case bt.DIESEL:return"🚛";case bt.GASOLINA:return"🚗";case bt.ACPM:return"🚚";case bt.MIXTO:return"⛽";default:return"⛽"}},ee=o==="view",D=c==="admin"||c==="supervisor";return s?r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-content vehicle-modal",onClick:A=>A.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("div",{className:"modal-title",children:[r.jsx("span",{className:"title-icon",children:o==="create"?"➕":o==="edit"?"✏️":"👁️"}),r.jsxs("div",{className:"title-text",children:[r.jsxs("h3",{children:[o==="create"&&"Crear Nuevo Vehículo",o==="edit"&&"Editar Vehículo",o==="view"&&"Detalles del Vehículo"]}),r.jsxs("p",{children:[o==="create"&&"Registra un nuevo vehículo en la flota",o==="edit"&&"Modifica la información del vehículo",o==="view"&&"Información completa del vehículo"]})]})]}),r.jsx("button",{className:"btn-close",onClick:e,type:"button",children:"✕"})]}),r.jsxs("form",{onSubmit:F,className:"modal-form",children:[r.jsxs("div",{className:"form-content",children:[r.jsxs("div",{className:"vehicle-preview",children:[r.jsxs("div",{className:"preview-header",children:[r.jsx("span",{className:"preview-icon",children:V(m.type)}),r.jsxs("div",{className:"preview-info",children:[r.jsx("span",{className:"preview-id",children:m.vehicleId||"ID-000"}),r.jsx("span",{className:"preview-name",children:m.name||"Nombre del vehículo"})]}),r.jsxs("div",{className:"preview-fuel",children:[r.jsx("span",{className:"fuel-icon",children:B(m.fuelType)}),r.jsx("span",{className:"fuel-text",children:m.fuelType})]})]}),r.jsxs("div",{className:"preview-specs",children:[m.enginePower>0&&r.jsxs("span",{className:"spec",children:["⚡ ",m.enginePower," HP"]}),m.fuelCapacity>0&&r.jsxs("span",{className:"spec",children:["🛢️ ",m.fuelCapacity," gal"]}),m.year&&r.jsxs("span",{className:"spec",children:["📅 ",m.year]})]})]}),v.general&&r.jsxs("div",{className:"error-message general-error",children:["⚠️ ",v.general]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📋 Información Básica"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"vehicleId",children:"ID del Vehículo *"}),r.jsx("input",{type:"text",id:"vehicleId",name:"vehicleId",value:m.vehicleId,onChange:U,placeholder:"Ej: EXC-001",className:v.vehicleId?"error":"",disabled:ee||o==="edit"&&!D,maxLength:20}),v.vehicleId&&r.jsx("span",{className:"error-text",children:v.vehicleId})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"name",children:"Nombre del Vehículo *"}),r.jsx("input",{type:"text",id:"name",name:"name",value:m.name,onChange:U,placeholder:"Ej: Excavadora Principal",className:v.name?"error":"",disabled:ee||o==="edit"&&!D,maxLength:100}),v.name&&r.jsx("span",{className:"error-text",children:v.name})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"type",children:"Tipo de Vehículo"}),M?r.jsxs("div",{className:"custom-type-input",children:[r.jsx("input",{type:"text",placeholder:"Ej: Montacargas, Grúa Torre, etc.",value:C,onChange:A=>N(A.target.value),onKeyDown:A=>{A.key==="Enter"?(A.preventDefault(),C.trim()&&(p(R=>({...R,type:C.trim()})),S(!1),N(""))):A.key==="Escape"&&(S(!1),N(""))},autoFocus:!0}),r.jsx("button",{type:"button",className:"btn-confirm-custom",onClick:()=>{C.trim()&&(p(A=>({...A,type:C.trim()})),S(!1),N(""))},title:"Confirmar tipo personalizado",children:"✓"}),r.jsx("button",{type:"button",className:"btn-cancel-custom",onClick:()=>{S(!1),N("")},title:"Cancelar",children:"✕"})]}):r.jsxs("div",{className:"select-with-button",children:[r.jsx("select",{id:"type",name:"type",value:m.type,onChange:U,disabled:ee||o==="edit"&&!D,children:Object.entries(Z2).map(([A,R])=>r.jsxs("option",{value:A,children:[R.icon," ",R.name]},A))}),r.jsx("button",{type:"button",className:"btn-add-custom",onClick:()=>S(!0),disabled:ee||o==="edit"&&!D,title:"Agregar tipo personalizado",children:"➕"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"status",children:"Estado"}),r.jsx("select",{id:"status",name:"status",value:m.status,onChange:U,disabled:ee||o==="edit"&&!D,children:Object.values(Ie).map(A=>r.jsx("option",{value:A,children:A.charAt(0).toUpperCase()+A.slice(1)},A))})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"🔧 Especificaciones Técnicas"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"brand",children:"Marca"}),r.jsx("input",{type:"text",id:"brand",name:"brand",value:m.brand,onChange:U,placeholder:"Ej: Caterpillar",disabled:ee||o==="edit"&&!D,maxLength:50})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"model",children:"Modelo"}),r.jsx("input",{type:"text",id:"model",name:"model",value:m.model,onChange:U,placeholder:"Ej: 320D",disabled:ee||o==="edit"&&!D,maxLength:50})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"year",children:"Año"}),r.jsx("input",{type:"number",id:"year",name:"year",value:m.year,onChange:U,min:"1990",max:new Date().getFullYear()+1,className:v.year?"error":"",disabled:ee||o==="edit"&&!D}),v.year&&r.jsx("span",{className:"error-text",children:v.year})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"serialNumber",children:"Número de Serie"}),r.jsx("input",{type:"text",id:"serialNumber",name:"serialNumber",value:m.serialNumber,onChange:U,placeholder:"Ej: ABC123456789",disabled:ee||o==="edit"&&!D,maxLength:50})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"plateNumber",children:"Placa"}),r.jsx("input",{type:"text",id:"plateNumber",name:"plateNumber",value:m.plateNumber,onChange:U,placeholder:"Ej: ABC123",disabled:ee||o==="edit"&&!D,maxLength:10})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"enginePower",children:"Potencia del Motor (HP)"}),r.jsx("input",{type:"number",id:"enginePower",name:"enginePower",value:m.enginePower,onChange:U,min:"0",max:"1000",step:"0.1",className:v.enginePower?"error":"",disabled:ee||o==="edit"&&!D}),v.enginePower&&r.jsx("span",{className:"error-text",children:v.enginePower})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"⛽ Información de Combustible"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"fuelType",children:"Tipo de Combustible"}),r.jsx("select",{id:"fuelType",name:"fuelType",value:m.fuelType,onChange:U,disabled:ee||o==="edit"&&!D,children:Object.values(bt).map(A=>r.jsxs("option",{value:A,children:[B(A)," ",A.charAt(0).toUpperCase()+A.slice(1)]},A))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"fuelCapacity",children:"Capacidad de Combustible (gal) *"}),r.jsx("input",{type:"number",id:"fuelCapacity",name:"fuelCapacity",value:m.fuelCapacity,onChange:U,min:"0",max:"1000",step:"0.1",className:v.fuelCapacity?"error":"",disabled:ee||o==="edit"&&!D}),v.fuelCapacity&&r.jsx("span",{className:"error-text",children:v.fuelCapacity})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"estimatedConsumptionPerHour",children:"Consumo Estimado (gal/hr)"}),r.jsx("input",{type:"number",id:"estimatedConsumptionPerHour",name:"estimatedConsumptionPerHour",value:m.estimatedConsumptionPerHour,onChange:U,min:"0",max:"50",step:"0.1",className:v.estimatedConsumptionPerHour?"error":"",disabled:ee||o==="edit"&&!D}),v.estimatedConsumptionPerHour&&r.jsx("span",{className:"error-text",children:v.estimatedConsumptionPerHour})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"currentLocation",children:"Ubicación Actual"}),r.jsx("input",{type:"text",id:"currentLocation",name:"currentLocation",value:m.currentLocation,onChange:U,placeholder:"Ej: Sector Norte - Lote 15",disabled:ee||o==="edit"&&!D,maxLength:100})]})]})]}),(m.type===pe.TRACTOR||m.hasHourMeter)&&r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"⏰ Sistema de Horómetro"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"hasHourMeter",children:[r.jsx("input",{type:"checkbox",id:"hasHourMeter",name:"hasHourMeter",checked:m.hasHourMeter,onChange:A=>p(R=>({...R,hasHourMeter:A.target.checked,...m.type===pe.TRACTOR?{hasHourMeter:!0}:{}})),disabled:ee||o==="edit"&&!D||m.type===pe.TRACTOR})," ","Tiene Sistema de Horómetro",m.type===pe.TRACTOR&&r.jsx("span",{className:"auto-enabled",children:" (Automático para tractores)"})]}),r.jsx("small",{className:"field-help",children:"Los tractores TR1, TR2, TR3 requieren control de horómetro para reportes de consumo"})]}),m.hasHourMeter&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"currentHours",children:"Lectura Actual del Horómetro (horas)"}),r.jsx("input",{type:"number",id:"currentHours",name:"currentHours",value:m.currentHours,onChange:U,min:"0",max:"50000",step:"0.1",placeholder:"Ej: 1250.5",disabled:ee||o==="edit"&&!D}),r.jsx("small",{className:"field-help",children:"Ingrese la lectura actual mostrada en el horómetro del vehículo"})]}),m.currentHours>0&&r.jsx("div",{className:"form-group",children:r.jsxs("div",{className:"hour-meter-info",children:[r.jsx("h5",{children:"📊 Información del Horómetro"}),r.jsxs("div",{className:"info-grid",children:[r.jsxs("div",{className:"info-item",children:[r.jsx("span",{className:"info-label",children:"Lectura actual:"}),r.jsxs("span",{className:"info-value",children:[m.currentHours," horas"]})]}),o==="edit"&&t?.totalHoursWorked&&r.jsxs("div",{className:"info-item",children:[r.jsx("span",{className:"info-label",children:"Horas trabajadas totales:"}),r.jsxs("span",{className:"info-value",children:[t.totalHoursWorked," horas"]})]}),r.jsxs("div",{className:"info-item",children:[r.jsx("span",{className:"info-label",children:"Próximo mantenimiento:"}),r.jsxs("span",{className:"info-value",children:[250-m.currentHours%250," horas (",(m.currentHours+(250-m.currentHours%250)).toFixed(1),"h)"]})]})]})]})})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📅 Fechas Importantes"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"purchaseDate",children:"Fecha de Compra"}),r.jsx("input",{type:"date",id:"purchaseDate",name:"purchaseDate",value:m.purchaseDate,onChange:U,max:new Date().toISOString().split("T")[0],className:v.purchaseDate?"error":"",disabled:ee||o==="edit"&&!D}),v.purchaseDate&&r.jsx("span",{className:"error-text",children:v.purchaseDate})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"warrantyExpiration",children:"Vencimiento de Garantía"}),r.jsx("input",{type:"date",id:"warrantyExpiration",name:"warrantyExpiration",value:m.warrantyExpiration,onChange:U,disabled:ee||o==="edit"&&!D})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"lastMaintenanceDate",children:"Último Mantenimiento"}),r.jsx("input",{type:"date",id:"lastMaintenanceDate",name:"lastMaintenanceDate",value:m.lastMaintenanceDate,onChange:U,disabled:ee||o==="edit"&&!D})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nextMaintenanceDate",children:"Próximo Mantenimiento"}),r.jsx("input",{type:"date",id:"nextMaintenanceDate",name:"nextMaintenanceDate",value:m.nextMaintenanceDate,onChange:U,className:v.nextMaintenanceDate?"error":"",disabled:ee||o==="edit"&&!D}),v.nextMaintenanceDate&&r.jsx("span",{className:"error-text",children:v.nextMaintenanceDate})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📝 Descripción y Notas"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"description",children:"Descripción"}),r.jsx("textarea",{id:"description",name:"description",value:m.description,onChange:U,placeholder:"Información adicional sobre el vehículo...",rows:"3",maxLength:"500",disabled:ee||o==="edit"&&!D}),r.jsxs("span",{className:"char-count",children:[m.description.length,"/500 caracteres"]})]})]})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:T,children:o==="view"?"Cerrar":"Cancelar"}),!ee&&D&&r.jsx("button",{type:"submit",className:"btn-primary",disabled:T,children:T?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"loading-spinner"}),"Guardando..."]}):r.jsx(r.Fragment,{children:o==="create"?"➕ Crear Vehículo":"💾 Guardar Cambios"})})]})]})]})}):null},Ro={PREVENTIVO:"preventivo",CORRECTIVO:"correctivo",PREDICTIVO:"predictivo",EMERGENCIA:"emergencia"},ci={PROGRAMADO:"programado",EN_PROCESO:"en_proceso",COMPLETADO:"completado",CANCELADO:"cancelado"},Do={BAJA:"baja",MEDIA:"media",ALTA:"alta",CRITICA:"critica"},eV=({isOpen:s,onClose:e,vehicle:t,maintenance:i,onSave:o,mode:c="create",userRole:d})=>{const m=()=>({vehicleId:t?.vehicleId||"",vehicleName:t?.name||"",type:i?.type||Ro.PREVENTIVO,title:i?.title||"",description:i?.description||"",priority:i?.priority||Do.MEDIA,status:i?.status||ci.PROGRAMADO,scheduledDate:i?.scheduledDate?new Date(i.scheduledDate).toISOString().split("T")[0]:"",startDate:i?.startDate?new Date(i.startDate).toISOString().split("T")[0]:"",completedDate:i?.completedDate?new Date(i.completedDate).toISOString().split("T")[0]:"",estimatedHours:i?.estimatedHours||0,actualHours:i?.actualHours||0,estimatedCost:i?.estimatedCost||0,actualCost:i?.actualCost||0,technician:i?.technician||"",workshop:i?.workshop||"",parts:i?.parts||[],notes:i?.notes||"",nextMaintenanceKm:i?.nextMaintenanceKm||0,nextMaintenanceHours:i?.nextMaintenanceHours||0,nextMaintenanceDate:i?.nextMaintenanceDate?new Date(i.nextMaintenanceDate).toISOString().split("T")[0]:""}),[p,v]=W.useState(m()),[_,T]=W.useState({}),[x,C]=W.useState(!1),[N,M]=W.useState({name:"",quantity:1,cost:0});W.useEffect(()=>{s&&(v(m()),T({}))},[s,i,t]);const S=P=>{const{name:O,value:Ve,type:ae}=P.target,H=ae==="number"?parseFloat(Ve)||0:Ve;v(te=>({...te,[O]:H})),_[O]&&T(te=>({...te,[O]:null}))},U=P=>{const{name:O,value:Ve,type:ae}=P.target,H=ae==="number"?parseFloat(Ve)||0:Ve;M(te=>({...te,[O]:H}))},$=()=>{if(!N.name.trim())return;const P={id:Date.now().toString(),name:N.name.trim(),quantity:N.quantity,cost:N.cost,total:N.quantity*N.cost};v(O=>({...O,parts:[...O.parts,P]})),M({name:"",quantity:1,cost:0})},F=P=>{v(O=>({...O,parts:O.parts.filter(Ve=>Ve.id!==P)}))},V=()=>{const P={};if(p.title.trim()||(P.title="El título del mantenimiento es obligatorio"),p.description.trim()||(P.description="La descripción es obligatoria"),p.scheduledDate||(P.scheduledDate="La fecha programada es obligatoria"),p.startDate&&p.completedDate){const O=new Date(p.startDate);new Date(p.completedDate)<O&&(P.completedDate="La fecha de finalización debe ser posterior al inicio")}return p.scheduledDate&&p.startDate&&(new Date(p.scheduledDate),new Date(p.startDate)),p.estimatedHours<0&&(P.estimatedHours="Las horas estimadas no pueden ser negativas"),p.actualHours<0&&(P.actualHours="Las horas reales no pueden ser negativas"),p.estimatedCost<0&&(P.estimatedCost="El costo estimado no puede ser negativo"),p.actualCost<0&&(P.actualCost="El costo real no puede ser negativo"),p.status===ci.COMPLETADO&&!p.completedDate&&(P.completedDate="La fecha de finalización es obligatoria para mantenimientos completados"),p.status===ci.EN_PROCESO&&!p.startDate&&(P.startDate="La fecha de inicio es obligatoria para mantenimientos en proceso"),T(P),Object.keys(P).length===0},B=async P=>{if(P.preventDefault(),!!V()){C(!0);try{const O=p.parts.reduce((te,ce)=>te+ce.total,0),Ve=p.estimatedCost+O,ae=p.actualCost+O,H={...p,vehicleId:t.id,vehicleName:t.name,totalPartsCost:O,totalEstimatedCost:Ve,totalActualCost:ae,scheduledDate:p.scheduledDate||null,startDate:p.startDate||null,completedDate:p.completedDate||null,nextMaintenanceDate:p.nextMaintenanceDate||null,createdAt:i?.createdAt||new Date,updatedAt:new Date};await o(H),e()}catch(O){console.error("Error guardando mantenimiento:",O),T({general:"Error al guardar el mantenimiento. Intenta nuevamente."})}finally{C(!1)}}},ee=P=>{switch(P){case Ro.PREVENTIVO:return"🔧";case Ro.CORRECTIVO:return"🛠️";case Ro.PREDICTIVO:return"📊";case Ro.EMERGENCIA:return"🚨";default:return"⚙️"}},D=P=>{switch(P){case Do.BAJA:return"priority-low";case Do.MEDIA:return"priority-medium";case Do.ALTA:return"priority-high";case Do.CRITICA:return"priority-critical";default:return"priority-medium"}},A=P=>{switch(P){case ci.PROGRAMADO:return"status-scheduled";case ci.EN_PROCESO:return"status-in-progress";case ci.COMPLETADO:return"status-completed";case ci.CANCELADO:return"status-cancelled";default:return"status-scheduled"}},R=()=>p.parts.reduce((P,O)=>P+O.total,0),I=c==="view",k=d==="admin"||d==="supervisor";return s?r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-content maintenance-modal",onClick:P=>P.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("div",{className:"modal-title",children:[r.jsx("span",{className:"title-icon",children:c==="create"?"➕":c==="edit"?"✏️":"👁️"}),r.jsxs("div",{className:"title-text",children:[r.jsxs("h3",{children:[c==="create"&&"Registrar Mantenimiento",c==="edit"&&"Editar Mantenimiento",c==="view"&&"Detalles del Mantenimiento"]}),r.jsxs("p",{children:["Vehículo: ",t?.vehicleId," - ",t?.name]})]})]}),r.jsx("button",{className:"btn-close",onClick:e,type:"button",children:"✕"})]}),r.jsxs("form",{onSubmit:B,className:"modal-form",children:[r.jsxs("div",{className:"form-content",children:[_.general&&r.jsxs("div",{className:"error-message general-error",children:["⚠️ ",_.general]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📋 Información del Mantenimiento"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"type",children:"Tipo de Mantenimiento"}),r.jsx("select",{id:"type",name:"type",value:p.type,onChange:S,disabled:I||c==="edit"&&!k,children:Object.values(Ro).map(P=>r.jsxs("option",{value:P,children:[ee(P)," ",P.charAt(0).toUpperCase()+P.slice(1)]},P))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"priority",children:"Prioridad"}),r.jsx("select",{id:"priority",name:"priority",value:p.priority,onChange:S,className:D(p.priority),disabled:I||c==="edit"&&!k,children:Object.values(Do).map(P=>r.jsx("option",{value:P,children:P.charAt(0).toUpperCase()+P.slice(1)},P))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"status",children:"Estado"}),r.jsx("select",{id:"status",name:"status",value:p.status,onChange:S,className:A(p.status),disabled:I||c==="edit"&&!k,children:Object.values(ci).map(P=>r.jsx("option",{value:P,children:P.charAt(0).toUpperCase()+P.slice(1).replace("_"," ")},P))})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{htmlFor:"title",children:"Título del Mantenimiento *"}),r.jsx("input",{type:"text",id:"title",name:"title",value:p.title,onChange:S,placeholder:"Ej: Cambio de aceite y filtros",className:_.title?"error":"",disabled:I||c==="edit"&&!k,maxLength:100}),_.title&&r.jsx("span",{className:"error-text",children:_.title})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📅 Programación"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"scheduledDate",children:"Fecha Programada *"}),r.jsx("input",{type:"date",id:"scheduledDate",name:"scheduledDate",value:p.scheduledDate,onChange:S,className:_.scheduledDate?"error":"",disabled:I||c==="edit"&&!k}),_.scheduledDate&&r.jsx("span",{className:"error-text",children:_.scheduledDate})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"startDate",children:"Fecha de Inicio"}),r.jsx("input",{type:"date",id:"startDate",name:"startDate",value:p.startDate,onChange:S,className:_.startDate?"error":"",disabled:I||c==="edit"&&!k}),_.startDate&&r.jsx("span",{className:"error-text",children:_.startDate})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"completedDate",children:"Fecha de Finalización"}),r.jsx("input",{type:"date",id:"completedDate",name:"completedDate",value:p.completedDate,onChange:S,className:_.completedDate?"error":"",disabled:I||c==="edit"&&!k}),_.completedDate&&r.jsx("span",{className:"error-text",children:_.completedDate})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nextMaintenanceDate",children:"Próximo Mantenimiento"}),r.jsx("input",{type:"date",id:"nextMaintenanceDate",name:"nextMaintenanceDate",value:p.nextMaintenanceDate,onChange:S,disabled:I||c==="edit"&&!k})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"💰 Recursos y Costos"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"technician",children:"Técnico Responsable"}),r.jsx("input",{type:"text",id:"technician",name:"technician",value:p.technician,onChange:S,placeholder:"Nombre del técnico",disabled:I||c==="edit"&&!k,maxLength:100})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"workshop",children:"Taller/Ubicación"}),r.jsx("input",{type:"text",id:"workshop",name:"workshop",value:p.workshop,onChange:S,placeholder:"Taller donde se realiza",disabled:I||c==="edit"&&!k,maxLength:100})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"estimatedHours",children:"Horas Estimadas"}),r.jsx("input",{type:"number",id:"estimatedHours",name:"estimatedHours",value:p.estimatedHours,onChange:S,min:"0",step:"0.5",className:_.estimatedHours?"error":"",disabled:I||c==="edit"&&!k}),_.estimatedHours&&r.jsx("span",{className:"error-text",children:_.estimatedHours})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"actualHours",children:"Horas Reales"}),r.jsx("input",{type:"number",id:"actualHours",name:"actualHours",value:p.actualHours,onChange:S,min:"0",step:"0.5",className:_.actualHours?"error":"",disabled:I||c==="edit"&&!k}),_.actualHours&&r.jsx("span",{className:"error-text",children:_.actualHours})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"estimatedCost",children:"Costo Estimado (COP)"}),r.jsx("input",{type:"number",id:"estimatedCost",name:"estimatedCost",value:p.estimatedCost,onChange:S,min:"0",step:"1000",className:_.estimatedCost?"error":"",disabled:I||c==="edit"&&!k}),_.estimatedCost&&r.jsx("span",{className:"error-text",children:_.estimatedCost})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"actualCost",children:"Costo Real (COP)"}),r.jsx("input",{type:"number",id:"actualCost",name:"actualCost",value:p.actualCost,onChange:S,min:"0",step:"1000",className:_.actualCost?"error":"",disabled:I||c==="edit"&&!k}),_.actualCost&&r.jsx("span",{className:"error-text",children:_.actualCost})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"🔧 Partes y Repuestos"}),!I&&k&&r.jsx("div",{className:"parts-form",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"partName",children:"Nombre de la Parte"}),r.jsx("input",{type:"text",id:"partName",name:"name",value:N.name,onChange:U,placeholder:"Ej: Filtro de aceite",maxLength:100})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"partQuantity",children:"Cantidad"}),r.jsx("input",{type:"number",id:"partQuantity",name:"quantity",value:N.quantity,onChange:U,min:"1",step:"1"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"partCost",children:"Costo Unitario (COP)"}),r.jsx("input",{type:"number",id:"partCost",name:"cost",value:N.cost,onChange:U,min:"0",step:"1000"})]}),r.jsx("div",{className:"form-group",children:r.jsx("button",{type:"button",className:"btn-add-part",onClick:$,disabled:!N.name.trim(),children:"➕ Agregar"})})]})}),p.parts.length>0&&r.jsx("div",{className:"parts-list",children:r.jsxs("table",{className:"parts-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Parte"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Costo Unit."}),r.jsx("th",{children:"Total"}),!I&&k&&r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:p.parts.map(P=>r.jsxs("tr",{children:[r.jsx("td",{children:P.name}),r.jsx("td",{children:P.quantity}),r.jsxs("td",{children:["$",P.cost.toLocaleString("es-CO")]}),r.jsxs("td",{children:["$",P.total.toLocaleString("es-CO")]}),!I&&k&&r.jsx("td",{children:r.jsx("button",{type:"button",className:"btn-remove-part",onClick:()=>F(P.id),title:"Eliminar parte",children:"🗑️"})})]},P.id))}),r.jsx("tfoot",{children:r.jsxs("tr",{className:"total-row",children:[r.jsx("td",{colSpan:"3",children:r.jsx("strong",{children:"Total Partes:"})}),r.jsx("td",{children:r.jsxs("strong",{children:["$",R().toLocaleString("es-CO")]})}),!I&&k&&r.jsx("td",{})]})})]})})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"🔄 Próximo Mantenimiento"}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nextMaintenanceKm",children:"Próximo Mantenimiento (Km)"}),r.jsx("input",{type:"number",id:"nextMaintenanceKm",name:"nextMaintenanceKm",value:p.nextMaintenanceKm,onChange:S,min:"0",step:"1000",placeholder:"0 = No aplica",disabled:I||c==="edit"&&!k})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nextMaintenanceHours",children:"Próximo Mantenimiento (Horas)"}),r.jsx("input",{type:"number",id:"nextMaintenanceHours",name:"nextMaintenanceHours",value:p.nextMaintenanceHours,onChange:S,min:"0",step:"100",placeholder:"0 = No aplica",disabled:I||c==="edit"&&!k})]})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h4",{className:"section-title",children:"📝 Descripción y Notas"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"description",children:"Descripción del Trabajo *"}),r.jsx("textarea",{id:"description",name:"description",value:p.description,onChange:S,placeholder:"Describe el trabajo a realizar o realizado...",rows:"3",maxLength:"500",className:_.description?"error":"",disabled:I||c==="edit"&&!k}),_.description&&r.jsx("span",{className:"error-text",children:_.description})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"notes",children:"Notas Adicionales"}),r.jsx("textarea",{id:"notes",name:"notes",value:p.notes,onChange:S,placeholder:"Observaciones, recomendaciones, problemas encontrados...",rows:"3",maxLength:"500",disabled:I||c==="edit"&&!k}),r.jsxs("span",{className:"char-count",children:[p.notes.length,"/500 caracteres"]})]})]}),r.jsxs("div",{className:"cost-summary",children:[r.jsx("h4",{children:"💰 Resumen de Costos"}),r.jsxs("div",{className:"cost-grid",children:[r.jsxs("div",{className:"cost-item",children:[r.jsx("span",{className:"cost-label",children:"Mano de Obra:"}),r.jsxs("span",{className:"cost-value",children:["$",p.actualCost.toLocaleString("es-CO")]})]}),r.jsxs("div",{className:"cost-item",children:[r.jsx("span",{className:"cost-label",children:"Partes:"}),r.jsxs("span",{className:"cost-value",children:["$",R().toLocaleString("es-CO")]})]}),r.jsxs("div",{className:"cost-item total-cost",children:[r.jsx("span",{className:"cost-label",children:"Total:"}),r.jsxs("span",{className:"cost-value",children:["$",(p.actualCost+R()).toLocaleString("es-CO")]})]})]})]})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:x,children:c==="view"?"Cerrar":"Cancelar"}),!I&&k&&r.jsx("button",{type:"submit",className:"btn-primary",disabled:x,children:x?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"loading-spinner"}),"Guardando..."]}):r.jsx(r.Fragment,{children:c==="create"?"➕ Registrar Mantenimiento":"💾 Guardar Cambios"})})]})]})]})}):null},tV=()=>{const{user:s,userProfile:e}=Da(),[t,i]=W.useState([]),[o,c]=W.useState(null),[d,m]=W.useState(!0),[p,v]=W.useState(null),[_,T]=W.useState({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),[x,C]=W.useState("cards"),[N,M]=W.useState(""),[S,U]=W.useState(!1),[$,F]=W.useState(!1),[V,B]=W.useState(null),[ee,D]=W.useState("create");W.useEffect(()=>{if(!s)return;m(!0);const ge=sS((q,ne)=>{if(ne){console.error("Error en suscripción de vehículos:",ne),v("Error al cargar vehículos"),m(!1);return}i(q),v(null),m(!1)},_);return()=>ge()},[s,_]),W.useEffect(()=>{s&&(async()=>{try{const q=await S2(_);c(q)}catch(q){console.error("Error al cargar estadísticas:",q)}})()},[s,t,_]);const A=t.filter(ge=>{if(!N)return!0;const q=N.toLowerCase();return ge.vehicleId?.toLowerCase().includes(q)||ge.name?.toLowerCase().includes(q)||ge.type?.toLowerCase().includes(q)||ge.brand?.toLowerCase().includes(q)||ge.model?.toLowerCase().includes(q)||ge.currentLocation?.toLowerCase().includes(q)||ge.description?.toLowerCase().includes(q)}),R=()=>{B(null),D("create"),U(!0)},I=ge=>{B(ge),D("edit"),U(!0)},k=ge=>{B(ge),D("view"),U(!0)},P=ge=>{B(ge),F(!0)},O=()=>{U(!1),F(!1),B(null)},Ve=ge=>{T(q=>({...q,...ge}))},ae=()=>{T({type:"",status:"",fuelType:"",location:"",maintenance:"all"}),M("")},H=e?.role==="admin"||e?.role==="contador"||e?.role==="cliente",te=e?.role==="admin",ce=e?.role==="admin"||e?.role==="contador";return d?r.jsx("div",{className:"vehicles-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando vehículos..."})]})}):p?r.jsx("div",{className:"vehicles-main",children:r.jsxs("div",{className:"error-container",children:[r.jsx("div",{className:"error-icon",children:"⚠️"}),r.jsx("h3",{children:"Error al cargar vehículos"}),r.jsx("p",{children:p}),r.jsx("button",{className:"btn-retry",onClick:()=>window.location.reload(),children:"Reintentar"})]})}):r.jsxs("div",{className:"vehicles-main",children:[r.jsxs("div",{className:"vehicles-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h2",{children:"🚜 Gestión de Vehículos"}),r.jsx("p",{children:"Administra la maquinaria y vehículos forestales"})]}),H&&r.jsx("button",{className:"btn-create-vehicle",onClick:R,children:"➕ Nuevo Vehículo"})]}),o&&r.jsx(K2,{stats:o,filters:_}),r.jsx(Y2,{filters:_,onFilterChange:Ve,onClearFilters:ae,searchTerm:N,onSearchChange:M,viewMode:x,onViewModeChange:C,totalResults:A.length}),A.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"🚜"}),r.jsx("h3",{children:t.length===0?"No hay vehículos registrados":"No se encontraron vehículos"}),r.jsx("p",{children:t.length===0?"Comienza registrando tu primer vehículo o maquinaria forestal":"Intenta ajustar los filtros de búsqueda"}),t.length===0&&H&&r.jsx("button",{className:"btn-create-first",onClick:R,children:"➕ Registrar Primer Vehículo"})]}):r.jsx(W2,{vehicles:A,viewMode:x,onEdit:te?I:null,onView:k,onMaintenance:ce?P:null,userRole:s?.role}),S&&r.jsx(J2,{isOpen:S,onClose:O,vehicle:V,mode:ee,onSuccess:()=>{O()}}),$&&r.jsx(eV,{isOpen:$,onClose:O,vehicle:V,onSuccess:()=>{O()}})]})},Ta={ACPM:"ACPM",GASOLINA:"GASOLINA",ACEITE_HIDRAULICO:"ACEITE_HIDRAULICO",ACEITE_MOTOR_20W50:"ACEITE_MOTOR_20W50",GRASA_ROJA:"GRASA_ROJA",VALVULINA:"VALVULINA",LIQUIDO_FRENOS:"LIQUIDO_FRENOS",MISTURA_LIGA:"MISTURA_LIGA",ACEITE_TRACTORES_15W40:"ACEITE_TRACTORES_15W40"},nV={[Ta.ACPM]:{name:"ACPM",displayName:"ACPM 🚛",category:"Combustible",unit:"gal",defaultPrice:12500,color:"#FF6B35",icon:"🚛",description:"Combustible diesel para vehículos pesados"},[Ta.GASOLINA]:{name:"GASOLINA",displayName:"Gasolina 🚗",category:"Combustible",unit:"gal",defaultPrice:14200,color:"#4CAF50",icon:"🚗",description:"Gasolina corriente para vehículos livianos"},[Ta.ACEITE_HIDRAULICO]:{name:"ACEITE_HIDRAULICO",displayName:"Aceite Hidráulico 🔧",category:"Aceite",unit:"L",defaultPrice:28e3,color:"#2196F3",icon:"🔧",description:"Aceite hidráulico para sistemas de maquinaria"},[Ta.ACEITE_MOTOR_20W50]:{name:"ACEITE_MOTOR_20W50",displayName:"Aceite Motor 20W50 🛢️",category:"Aceite",unit:"L",defaultPrice:35e3,color:"#FF9800",icon:"🛢️",description:"Aceite multigrado para motores"},[Ta.GRASA_ROJA]:{name:"GRASA_ROJA",displayName:"Grasa Roja 🟥",category:"Lubricante",unit:"kg",defaultPrice:12e3,color:"#F44336",icon:"🟥",description:"Grasa lubricante multipropósito"},[Ta.VALVULINA]:{name:"VALVULINA",displayName:"Valvulina ⚙️",category:"Aceite",unit:"L",defaultPrice:25e3,color:"#9C27B0",icon:"⚙️",description:"Aceite para transmisiones y diferenciales"},[Ta.LIQUIDO_FRENOS]:{name:"LIQUIDO_FRENOS",displayName:"Líquido para Frenos 🛑",category:"Fluido",unit:"L",defaultPrice:18e3,color:"#E91E63",icon:"🛑",description:"Líquido de frenos DOT 3/4"},[Ta.MISTURA_LIGA]:{name:"MISTURA_LIGA",displayName:"Mistura o Liga 🌿",category:"Combustible",unit:"L",defaultPrice:8500,color:"#4CAF50",icon:"🌿",description:"Mezcla de combustible para equipos menores"},[Ta.ACEITE_TRACTORES_15W40]:{name:"ACEITE_TRACTORES_15W40",displayName:"Aceite Tractores 15W40 🚜",category:"Aceite",unit:"L",defaultPrice:32e3,color:"#795548",icon:"🚜",description:"Aceite especializado para tractores"}},Ls={COMBUSTIBLE:"Combustible",ACEITE:"Aceite",LUBRICANTE:"Lubricante",FLUIDO:"Fluido"},sV=()=>Object.values(nV),aV=({isOpen:s,onClose:e,product:t,mode:i="create",onSave:o,userRole:c})=>{const[d,m]=W.useState({name:"",displayName:"",category:Ls.COMBUSTIBLE,unit:"gal",defaultPrice:0,color:"#FF6B35",icon:"🛢️",description:"",isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3}),[p,v]=W.useState({}),[_,T]=W.useState(!1),x=[{value:"gal",label:"Galones (gal)"},{value:"L",label:"Litros (L)"},{value:"kg",label:"Kilogramos (kg)"},{value:"und",label:"Unidades (und)"}],C={[Ls.COMBUSTIBLE]:["🛢️","🚛","🚗","⛽","🌿"],[Ls.ACEITE]:["🛢️","⚙️","🔧","🚜","🏭"],[Ls.LUBRICANTE]:["🟥","🟡","🔵","⚫","🟤"],[Ls.FLUIDO]:["🛑","💧","🔴","🟢","🔵"]},N=["#FF6B35","#4CAF50","#2196F3","#FF9800","#F44336","#9C27B0","#E91E63","#795548","#607D8B","#3F51B5"];W.useEffect(()=>{m(t&&(i==="edit"||i==="view")?{name:t.name||"",displayName:t.displayName||"",category:t.category||Ls.COMBUSTIBLE,unit:t.unit||"gal",defaultPrice:t.defaultPrice||0,color:t.color||"#FF6B35",icon:t.icon||"🛢️",description:t.description||"",isActive:t.isActive!==void 0?t.isActive:!0,currentStock:t.currentStock||0,minThreshold:t.minThreshold||10,maxCapacity:t.maxCapacity||1e3}:{name:"",displayName:"",category:Ls.COMBUSTIBLE,unit:"gal",defaultPrice:0,color:"#FF6B35",icon:"🛢️",description:"",isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3}),v({})},[t,i,s]);const M=F=>{const{name:V,value:B,type:ee,checked:D}=F.target;m(A=>({...A,[V]:ee==="checkbox"?D:B})),p[V]&&v(A=>({...A,[V]:""}))},S=()=>{const F={};return d.name.trim()||(F.name="El nombre es requerido"),d.displayName.trim()||(F.displayName="El nombre de visualización es requerido"),d.category||(F.category="La categoría es requerida"),d.unit||(F.unit="La unidad es requerida"),d.defaultPrice<0&&(F.defaultPrice="El precio debe ser mayor o igual a 0"),d.currentStock<0&&(F.currentStock="El stock debe ser mayor o igual a 0"),d.minThreshold<0&&(F.minThreshold="El umbral mínimo debe ser mayor o igual a 0"),d.maxCapacity<=0&&(F.maxCapacity="La capacidad máxima debe ser mayor a 0"),d.minThreshold>=d.maxCapacity&&(F.minThreshold="El umbral mínimo debe ser menor que la capacidad máxima"),v(F),Object.keys(F).length===0},U=async F=>{if(F.preventDefault(),!!S()){T(!0);try{await o({...d,defaultPrice:parseFloat(d.defaultPrice),currentStock:parseFloat(d.currentStock),minThreshold:parseFloat(d.minThreshold),maxCapacity:parseFloat(d.maxCapacity)}),e()}catch(V){console.error("Error saving product:",V),v({submit:"Error al guardar el producto"})}finally{T(!1)}}};if(!s)return null;const $=["admin","supervisor"].includes(c)&&i!=="view";return r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content product-modal",children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("h2",{children:[i==="create"&&"➕ Crear Producto",i==="edit"&&"✏️ Editar Producto",i==="view"&&"👁️ Ver Producto"]}),r.jsx("button",{className:"modal-close",onClick:e,children:"✕"})]}),r.jsxs("form",{onSubmit:U,className:"modal-body",children:[r.jsx("div",{className:"product-preview",children:r.jsxs("div",{className:"preview-card",children:[r.jsx("div",{className:"preview-icon",style:{color:d.color},children:d.icon}),r.jsxs("div",{className:"preview-info",children:[r.jsx("h3",{children:d.displayName||"Nombre del producto"}),r.jsx("p",{className:"preview-category",children:d.category}),r.jsx("p",{className:"preview-description",children:d.description}),r.jsxs("div",{className:"preview-price",children:["$",new Intl.NumberFormat("es-CO").format(d.defaultPrice)," / ",d.unit]})]})]})}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"📝 Información Básica"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Nombre Interno *"}),r.jsx("input",{type:"text",name:"name",value:d.name,onChange:M,disabled:!$,placeholder:"Ej: ACPM, GASOLINA"}),p.name&&r.jsx("span",{className:"error",children:p.name})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Nombre de Visualización *"}),r.jsx("input",{type:"text",name:"displayName",value:d.displayName,onChange:M,disabled:!$,placeholder:"Ej: ACPM 🚛, Gasolina 🚗"}),p.displayName&&r.jsx("span",{className:"error",children:p.displayName})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Categoría *"}),r.jsx("select",{name:"category",value:d.category,onChange:M,disabled:!$,children:Object.values(Ls).map(F=>r.jsx("option",{value:F,children:F},F))}),p.category&&r.jsx("span",{className:"error",children:p.category})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Descripción"}),r.jsx("textarea",{name:"description",value:d.description,onChange:M,disabled:!$,placeholder:"Descripción del producto...",rows:"3"})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"⚙️ Configuración"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Unidad de Medida *"}),r.jsx("select",{name:"unit",value:d.unit,onChange:M,disabled:!$,children:x.map(F=>r.jsx("option",{value:F.value,children:F.label},F.value))}),p.unit&&r.jsx("span",{className:"error",children:p.unit})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Precio por Defecto"}),r.jsx("input",{type:"number",name:"defaultPrice",value:d.defaultPrice,onChange:M,disabled:!$,min:"0",step:"0.01"}),p.defaultPrice&&r.jsx("span",{className:"error",children:p.defaultPrice})]}),r.jsx("div",{className:"form-group",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",name:"isActive",checked:d.isActive,onChange:M,disabled:!$}),"Producto Activo"]})})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"📊 Stock y Umbrales"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Stock Actual"}),r.jsx("input",{type:"number",name:"currentStock",value:d.currentStock,onChange:M,disabled:!$,min:"0",step:"0.01"}),p.currentStock&&r.jsx("span",{className:"error",children:p.currentStock})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Umbral Mínimo"}),r.jsx("input",{type:"number",name:"minThreshold",value:d.minThreshold,onChange:M,disabled:!$,min:"0",step:"0.01"}),p.minThreshold&&r.jsx("span",{className:"error",children:p.minThreshold})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Capacidad Máxima"}),r.jsx("input",{type:"number",name:"maxCapacity",value:d.maxCapacity,onChange:M,disabled:!$,min:"1",step:"0.01"}),p.maxCapacity&&r.jsx("span",{className:"error",children:p.maxCapacity})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("h3",{children:"🎨 Apariencia"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Icono"}),r.jsx("div",{className:"icon-selector",children:C[d.category]?.map(F=>r.jsx("button",{type:"button",className:`icon-option ${d.icon===F?"selected":""}`,onClick:()=>m(V=>({...V,icon:F})),disabled:!$,children:F},F))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Color"}),r.jsx("div",{className:"color-selector",children:N.map(F=>r.jsx("button",{type:"button",className:`color-option ${d.color===F?"selected":""}`,style:{backgroundColor:F},onClick:()=>m(V=>({...V,color:F})),disabled:!$},F))})]})]})]}),p.submit&&r.jsx("div",{className:"error-message",children:p.submit})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:e,disabled:_,children:i==="view"?"Cerrar":"Cancelar"}),$&&r.jsx("button",{type:"submit",className:"btn-primary",onClick:U,disabled:_,children:_?"Guardando...":"Guardar"})]})]})})},iV=({products:s})=>{const[e,t]=W.useState([]),[i,o]=W.useState(!0);W.useEffect(()=>{const N=Mv(M=>{t(M),o(!1)},M=>{console.error("Error loading movements for stats:",M),o(!1)});return()=>N()},[]);const c=()=>s.map(M=>{const S=e.filter(ee=>ee.fuelType===M.name||ee.fuelType===M.displayName),U=S.filter(ee=>ee.type==="entrada"),$=S.filter(ee=>ee.type==="salida"),F=U.reduce((ee,D)=>ee+(D.quantity||0),0),V=$.reduce((ee,D)=>ee+(D.quantity||0),0),B=(M.currentStock||0)*(M.defaultPrice||0);return{...M,totalEntries:F,totalExits:V,totalValue:B,entriesCount:U.length,exitsCount:$.length,stockStatus:d(M)}}),d=N=>{const M=N.currentStock||0,S=N.minThreshold||0,U=N.maxCapacity||1e3;return M===0?"empty":M<=S?"low":M>=U*.9?"high":"normal"},m=N=>{const M={};return Object.values(Ls).forEach(S=>{const U=N.filter($=>$.category===S);M[S]={totalProducts:U.length,totalStock:U.reduce(($,F)=>$+(F.currentStock||0),0),totalValue:U.reduce(($,F)=>$+F.totalValue,0),totalEntries:U.reduce(($,F)=>$+F.totalEntries,0),totalExits:U.reduce(($,F)=>$+F.totalExits,0),lowStockCount:U.filter($=>$.stockStatus==="low"||$.stockStatus==="empty").length}}),M};if(i)return r.jsxs("div",{className:"products-stats loading",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando estadísticas..."})]});const p=c(),v=m(p),_=s.length,T=s.filter(N=>N.isActive).length,x=p.reduce((N,M)=>N+M.totalValue,0),C=p.filter(N=>N.stockStatus==="low"||N.stockStatus==="empty").length;return r.jsxs("div",{className:"products-stats",children:[r.jsx("h2",{children:"📊 Estadísticas de Productos"}),r.jsxs("div",{className:"stats-general",children:[r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"📦"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:ct(_)}),r.jsx("p",{children:"Total Productos"})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"✅"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:ct(T)}),r.jsx("p",{children:"Productos Activos"})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-icon",children:"💰"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:Hs(x)}),r.jsx("p",{children:"Valor Total Stock"})]})]}),r.jsxs("div",{className:`stat-card ${C>0?"alert":""}`,children:[r.jsx("div",{className:"stat-icon",children:"⚠️"}),r.jsxs("div",{className:"stat-info",children:[r.jsx("h3",{children:ct(C)}),r.jsx("p",{children:"Stock Bajo"})]})]})]}),r.jsxs("div",{className:"stats-categories",children:[r.jsx("h3",{children:"📈 Por Categoría"}),r.jsx("div",{className:"categories-grid",children:Object.entries(v).map(([N,M])=>r.jsxs("div",{className:"category-card",children:[r.jsx("h4",{children:N}),r.jsxs("div",{className:"category-stats",children:[r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Productos:"}),r.jsx("span",{children:ct(M.totalProducts)})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Stock Total:"}),r.jsxs("span",{children:[ct(M.totalStock)," unidades"]})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Valor:"}),r.jsx("span",{children:Hs(M.totalValue)})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Entradas:"}),r.jsx("span",{className:"positive",children:ct(M.totalEntries)})]}),r.jsxs("div",{className:"stat-row",children:[r.jsx("span",{children:"Salidas:"}),r.jsx("span",{className:"negative",children:ct(M.totalExits)})]}),M.lowStockCount>0&&r.jsxs("div",{className:"stat-row alert",children:[r.jsx("span",{children:"Stock Bajo:"}),r.jsx("span",{children:ct(M.lowStockCount)})]})]})]},N))})]}),r.jsxs("div",{className:"stats-top-products",children:[r.jsx("h3",{children:"🏆 Top Productos por Stock"}),r.jsx("div",{className:"top-products-list",children:p.sort((N,M)=>(M.currentStock||0)-(N.currentStock||0)).slice(0,5).map((N,M)=>r.jsxs("div",{className:"top-product-item",children:[r.jsxs("div",{className:"rank",children:["#",M+1]}),r.jsx("div",{className:"product-icon",style:{color:N.color},children:N.icon}),r.jsxs("div",{className:"product-info",children:[r.jsx("span",{className:"product-name",children:N.displayName}),r.jsxs("span",{className:"product-stock",children:[ct(N.currentStock||0)," ",N.unit]})]}),r.jsx("div",{className:"product-value",children:Hs(N.totalValue)})]},N.id))})]}),C>0&&r.jsxs("div",{className:"stats-alerts",children:[r.jsx("h3",{children:"⚠️ Alertas de Stock"}),r.jsx("div",{className:"alerts-list",children:p.filter(N=>N.stockStatus==="low"||N.stockStatus==="empty").map(N=>r.jsxs("div",{className:`alert-item ${N.stockStatus}`,children:[r.jsx("div",{className:"alert-icon",children:N.stockStatus==="empty"?"🔴":"🟡"}),r.jsxs("div",{className:"alert-info",children:[r.jsx("span",{className:"alert-product",children:N.displayName}),r.jsxs("span",{className:"alert-stock",children:["Stock: ",ct(N.currentStock||0)," ",N.unit,N.stockStatus==="empty"&&" - ¡SIN STOCK!",N.stockStatus==="low"&&` - Mínimo: ${N.minThreshold}`]})]})]},N.id))})]})]})},rV=({userProfile:s})=>{const[e,t]=W.useState([]),[i,o]=W.useState(!0),[c,d]=W.useState(null),[m,p]=W.useState(!1),[v,_]=W.useState(null),[T,x]=W.useState("create"),[C,N]=W.useState(""),[M,S]=W.useState(""),[U,$]=W.useState(!0),F=["admin","supervisor"].includes(s?.role);W.useEffect(()=>{o(!0);const I=aS(k=>{t(k),o(!1),d(null)},k=>{console.error("Error loading products:",k),d("Error cargando productos"),o(!1)});return()=>I()},[]),W.useEffect(()=>{(async()=>{if(e.length===0&&!i&&F)try{const k=sV();for(const P of k)await dN({name:P.name,displayName:P.displayName,category:P.category,unit:P.unit,defaultPrice:P.defaultPrice,color:P.color,icon:P.icon,description:P.description,isActive:!0,currentStock:0,minThreshold:10,maxCapacity:1e3})}catch(k){console.error("Error inicializando productos:",k)}})()},[e.length,i,F]);const V=()=>{_(null),x("create"),p(!0)},B=I=>{_(I),x("edit"),p(!0)},ee=I=>{_(I),x("view"),p(!0)},D=async I=>{if(window.confirm("¿Estás seguro de que deseas eliminar este producto?"))try{await C2(I)}catch(k){console.error("Error deleting product:",k),alert("Error al eliminar el producto")}},A=async I=>{try{T==="create"?await dN(I):T==="edit"&&await w2(v.id,I),p(!1)}catch(k){throw console.error("Error saving product:",k),k}},R=e.filter(I=>{const k=I.displayName?.toLowerCase().includes(C.toLowerCase())||I.name?.toLowerCase().includes(C.toLowerCase()),P=!M||I.category===M;return k&&P});return i?r.jsx("div",{className:"products-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando productos..."})]})}):c?r.jsx("div",{className:"products-main",children:r.jsxs("div",{className:"error-container",children:[r.jsxs("p",{children:["⚠️ ",c]}),r.jsx("button",{onClick:()=>window.location.reload(),children:"Reintentar"})]})}):r.jsxs("div",{className:"products-main",children:[r.jsxs("div",{className:"products-header",children:[r.jsxs("div",{className:"header-title",children:[r.jsx("h1",{children:"🛢️ Gestión de Productos"}),r.jsx("p",{children:"Administra los tipos de combustibles y productos disponibles"})]}),F&&r.jsx("div",{className:"header-actions",children:r.jsx("button",{className:"btn-primary",onClick:V,children:"➕ Agregar Producto"})})]}),U&&r.jsx(iV,{products:e}),r.jsxs("div",{className:"products-filters",children:[r.jsx("div",{className:"filter-group",children:r.jsx("input",{type:"text",placeholder:"🔍 Buscar productos...",value:C,onChange:I=>N(I.target.value),className:"search-input"})}),r.jsx("div",{className:"filter-group",children:r.jsxs("select",{value:M,onChange:I=>S(I.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"🏷️ Todas las categorías"}),Object.values(Ls).map(I=>r.jsx("option",{value:I,children:I},I))]})}),r.jsx("div",{className:"filter-group",children:r.jsx("button",{className:`toggle-btn ${U?"active":""}`,onClick:()=>$(!U),children:"📊 Estadísticas"})})]}),r.jsx("div",{className:"products-grid",children:R.map(I=>r.jsxs("div",{className:"product-card",children:[r.jsx("div",{className:"product-icon",style:{color:I.color},children:I.icon}),r.jsxs("div",{className:"product-info",children:[r.jsx("h3",{children:I.displayName}),r.jsx("p",{className:"product-category",children:I.category}),r.jsx("p",{className:"product-description",children:I.description}),r.jsxs("div",{className:"product-stats",children:[r.jsxs("div",{className:"stat",children:[r.jsx("span",{className:"stat-label",children:"Stock:"}),r.jsxs("span",{className:"stat-value",children:[I.currentStock||0," ",I.unit]})]}),r.jsxs("div",{className:"stat",children:[r.jsx("span",{className:"stat-label",children:"Precio:"}),r.jsxs("span",{className:"stat-value",children:["$",new Intl.NumberFormat("es-CO").format(I.defaultPrice||0)]})]})]}),r.jsx("div",{className:`product-status ${I.isActive?"active":"inactive"}`,children:I.isActive?"✅ Activo":"❌ Inactivo"})]}),r.jsxs("div",{className:"product-actions",children:[r.jsx("button",{className:"btn-secondary",onClick:()=>ee(I),children:"👁️ Ver"}),F&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"btn-primary",onClick:()=>B(I),children:"✏️ Editar"}),r.jsx("button",{className:"btn-danger",onClick:()=>D(I.id),children:"🗑️ Eliminar"})]})]})]},I.id))}),R.length===0&&r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:"📦"}),r.jsx("h3",{children:"No hay productos"}),r.jsx("p",{children:C||M?"No se encontraron productos con los filtros aplicados.":"Aún no hay productos registrados."}),F&&!C&&!M&&r.jsx("button",{className:"btn-primary",onClick:V,children:"➕ Crear primer producto"})]}),r.jsx(aV,{isOpen:m,onClose:()=>p(!1),product:v,mode:T,onSave:A,userRole:s?.role})]})},oV=({suppliers:s,onEdit:e,onDelete:t,hasEditPermission:i,hasDeletePermission:o})=>{const[c,d]=W.useState("name"),[m,p]=W.useState("asc"),v=U=>{c===U?p(m==="asc"?"desc":"asc"):(d(U),p("asc"))},_=[...s].sort((U,$)=>{let F=U[c],V=$[c];switch(c){case"rating":F=F||0,V=V||0;break;case"totalOrders":case"totalPurchased":F=F||0,V=V||0;break;case"createdAt":case"lastOrderDate":F=F?F.toDate?F.toDate():new Date(F):new Date(0),V=V?V.toDate?V.toDate():new Date(V):new Date(0);break;default:F=(F||"").toString().toLowerCase(),V=(V||"").toString().toLowerCase()}return F<V?m==="asc"?-1:1:F>V?m==="asc"?1:-1:0}),T=U=>{switch(U){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},x=U=>{switch(U){case"active":return"Activo";case"inactive":return"Inactivo";case"suspended":return"Suspendido";default:return"Desconocido"}},C=U=>U?(U.toDate?U.toDate():new Date(U)).toLocaleDateString("es-CO"):"-",N=U=>{const $=[];for(let F=1;F<=5;F++)$.push(r.jsx("span",{className:`star ${F<=U?"filled":""}`,children:"★"},F));return r.jsx("div",{className:"rating-stars",children:$})},M=U=>!U||U.length===0?r.jsx("span",{className:"no-data",children:"-"}):r.jsxs("div",{className:"fuel-types-cell",children:[U.slice(0,2).map($=>r.jsx("span",{className:"fuel-badge-sm",children:bn[$]||$},$)),U.length>2&&r.jsxs("span",{className:"fuel-badge-sm more",title:U.slice(2).map($=>bn[$]||$).join(", "),children:["+",U.length-2]})]}),S=U=>c!==U?"icon-chevrons-up-down":m==="asc"?"icon-chevron-up":"icon-chevron-down";return r.jsxs("div",{className:"suppliers-table-container",children:[r.jsxs("div",{className:"table-wrapper",children:[r.jsxs("table",{className:"suppliers-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsxs("th",{className:`sortable ${c==="name"?"active":""}`,onClick:()=>v("name"),children:[r.jsx("span",{children:"Proveedor"}),r.jsx("i",{className:S("name")})]}),r.jsxs("th",{className:`sortable ${c==="status"?"active":""}`,onClick:()=>v("status"),children:[r.jsx("span",{children:"Estado"}),r.jsx("i",{className:S("status")})]}),r.jsxs("th",{className:`sortable ${c==="category"?"active":""}`,onClick:()=>v("category"),children:[r.jsx("span",{children:"Categoría"}),r.jsx("i",{className:S("category")})]}),r.jsx("th",{children:r.jsx("span",{children:"Combustibles"})}),r.jsx("th",{children:r.jsx("span",{children:"Contacto"})}),r.jsxs("th",{className:`sortable ${c==="rating"?"active":""}`,onClick:()=>v("rating"),children:[r.jsx("span",{children:"Rating"}),r.jsx("i",{className:S("rating")})]}),r.jsxs("th",{className:`sortable ${c==="totalOrders"?"active":""}`,onClick:()=>v("totalOrders"),children:[r.jsx("span",{children:"Órdenes"}),r.jsx("i",{className:S("totalOrders")})]}),r.jsxs("th",{className:`sortable ${c==="totalPurchased"?"active":""}`,onClick:()=>v("totalPurchased"),children:[r.jsx("span",{children:"Total Comprado"}),r.jsx("i",{className:S("totalPurchased")})]}),r.jsxs("th",{className:`sortable ${c==="createdAt"?"active":""}`,onClick:()=>v("createdAt"),children:[r.jsx("span",{children:"Creado"}),r.jsx("i",{className:S("createdAt")})]}),r.jsx("th",{className:"actions-column",children:r.jsx("span",{children:"Acciones"})})]})}),r.jsx("tbody",{children:_.map(U=>r.jsxs("tr",{className:`supplier-row ${U.status}`,children:[r.jsx("td",{className:"supplier-info-cell",children:r.jsxs("div",{className:"supplier-main-info",children:[r.jsxs("div",{className:"supplier-name",children:[U.name,U.isPreferred&&r.jsx("span",{className:"preferred-badge",title:"Proveedor Preferido",children:r.jsx("i",{className:"icon-star"})})]}),U.taxId&&r.jsxs("div",{className:"supplier-tax-id",children:["NIT: ",U.taxId]}),U.type&&r.jsx("div",{className:"supplier-type",children:U.type.charAt(0).toUpperCase()+U.type.slice(1)})]})}),r.jsx("td",{className:"status-cell",children:r.jsxs("div",{className:"status-display",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:T(U.status)}}),r.jsx("span",{className:"status-label",children:x(U.status)})]})}),r.jsx("td",{className:"category-cell",children:r.jsx("span",{className:"category-label",children:U.category?.charAt(0).toUpperCase()+U.category?.slice(1)||"-"})}),r.jsx("td",{className:"fuel-types-cell",children:M(U.fuelTypes)}),r.jsx("td",{className:"contact-cell",children:r.jsxs("div",{className:"contact-info",children:[U.contactPerson&&r.jsxs("div",{className:"contact-person",children:[r.jsx("i",{className:"icon-user"}),r.jsx("span",{children:U.contactPerson})]}),U.phone&&r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-phone"}),r.jsx("a",{href:`tel:${U.phone}`,children:U.phone})]}),U.email&&r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-mail"}),r.jsx("a",{href:`mailto:${U.email}`,children:U.email})]}),U.city&&r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-map-pin"}),r.jsx("span",{children:U.city})]})]})}),r.jsx("td",{className:"rating-cell",children:r.jsxs("div",{className:"rating-display",children:[N(U.rating||0),r.jsx("span",{className:"rating-value",children:(U.rating||0).toFixed(1)})]})}),r.jsx("td",{className:"orders-cell",children:r.jsx("span",{className:"orders-count",children:U.totalOrders||0})}),r.jsx("td",{className:"purchased-cell",children:r.jsx("span",{className:"purchased-amount",children:Hs(U.totalPurchased||0)})}),r.jsx("td",{className:"date-cell",children:r.jsx("span",{className:"date-value",children:C(U.createdAt)})}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"action-buttons",children:[i&&r.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(U),title:"Editar proveedor",children:r.jsx("i",{className:"icon-edit"})}),o&&U.status==="active"&&r.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>t(U.id,U.name),title:"Desactivar proveedor",children:r.jsx("i",{className:"icon-x-circle"})}),r.jsxs("div",{className:"quick-actions",children:[U.phone&&r.jsx("a",{href:`tel:${U.phone}`,className:"quick-action-btn",title:"Llamar",children:r.jsx("i",{className:"icon-phone"})}),U.email&&r.jsx("a",{href:`mailto:${U.email}`,className:"quick-action-btn",title:"Enviar email",children:r.jsx("i",{className:"icon-mail"})})]})]})})]},U.id))})]}),_.length===0&&r.jsxs("div",{className:"table-empty-state",children:[r.jsx("i",{className:"icon-truck"}),r.jsx("p",{children:"No hay proveedores para mostrar"})]})]}),r.jsxs("div",{className:"table-footer",children:[r.jsx("div",{className:"table-info",children:r.jsxs("span",{children:["Mostrando ",_.length," proveedor",_.length!==1?"es":""]})}),r.jsx("div",{className:"table-actions",children:r.jsxs("span",{className:"sort-info",children:["Ordenado por: ",c==="name"?"Nombre":c==="status"?"Estado":c==="category"?"Categoría":c==="rating"?"Rating":c==="totalOrders"?"Órdenes":c==="totalPurchased"?"Total Comprado":c==="createdAt"?"Fecha de Creación":c," (",m==="asc"?"Ascendente":"Descendente",")"]})})]})]})},lV=({suppliers:s,onEdit:e,onDelete:t,hasEditPermission:i,hasDeletePermission:o})=>{const c=C=>{switch(C){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},d=C=>{switch(C){case"active":return"Activo";case"inactive":return"Inactivo";case"suspended":return"Suspendido";default:return"Desconocido"}},m=C=>{switch(C){case"combustibles":return"⛽";case"lubricantes":return"🛢️";case"aditivos":return"🧪";default:return"📦"}},p=C=>{switch(C){case"proveedor":return"Proveedor";case"distribuidor":return"Distribuidor";case"mayorista":return"Mayorista";default:return"Sin especificar"}},v=C=>C?(C.toDate?C.toDate():new Date(C)).toLocaleDateString("es-CO"):"No disponible",_=C=>{const N=[];for(let M=1;M<=5;M++)N.push(r.jsx("span",{className:`star ${M<=C?"filled":""}`,children:"★"},M));return r.jsx("div",{className:"rating-stars",children:N})},T=C=>!C||C.length===0?r.jsx("span",{className:"no-fuels",children:"Sin combustibles especificados"}):r.jsxs("div",{className:"fuel-types",children:[C.slice(0,3).map(N=>r.jsx("span",{className:"fuel-badge",title:bn[N],children:bn[N]||N},N)),C.length>3&&r.jsxs("span",{className:"fuel-badge more",title:`+${C.length-3} más`,children:["+",C.length-3]})]}),x=C=>{const N=[];return C.phone&&N.push(r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-phone"}),r.jsx("span",{children:C.phone})]},"phone")),C.email&&N.push(r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-mail"}),r.jsx("span",{children:C.email})]},"email")),C.city&&N.push(r.jsxs("div",{className:"contact-item",children:[r.jsx("i",{className:"icon-map-pin"}),r.jsx("span",{children:C.city})]},"city")),N.length>0?N:r.jsxs("div",{className:"contact-item no-contact",children:[r.jsx("i",{className:"icon-info-circle"}),r.jsx("span",{children:"Sin información de contacto"})]})};return r.jsx("div",{className:"suppliers-cards",children:s.map(C=>r.jsxs("div",{className:`supplier-card ${C.status}`,children:[r.jsxs("div",{className:"card-header",children:[r.jsx("div",{className:"header-left",children:r.jsxs("div",{className:"supplier-info",children:[r.jsxs("h3",{className:"supplier-name",children:[C.name,C.isPreferred&&r.jsx("span",{className:"preferred-badge",title:"Proveedor Preferido",children:r.jsx("i",{className:"icon-star"})})]}),C.taxId&&r.jsxs("div",{className:"supplier-tax-id",children:["NIT: ",C.taxId]})]})}),r.jsx("div",{className:"header-right",children:r.jsxs("div",{className:"supplier-status",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:c(C.status)}}),r.jsx("span",{className:"status-label",children:d(C.status)})]})})]}),r.jsxs("div",{className:"card-content",children:[r.jsxs("div",{className:"supplier-meta",children:[r.jsxs("div",{className:"meta-item",children:[r.jsx("span",{className:"meta-icon",children:m(C.category)}),r.jsx("span",{className:"meta-label",children:C.category?.charAt(0).toUpperCase()+C.category?.slice(1)||"Sin categoría"})]}),r.jsxs("div",{className:"meta-item",children:[r.jsx("i",{className:"icon-building meta-icon"}),r.jsx("span",{className:"meta-label",children:p(C.type)})]})]}),C.contactPerson&&r.jsxs("div",{className:"contact-person",children:[r.jsx("i",{className:"icon-user"}),r.jsx("span",{children:C.contactPerson})]}),r.jsx("div",{className:"contact-info",children:x(C)}),r.jsxs("div",{className:"fuel-types-section",children:[r.jsx("div",{className:"section-label",children:"Combustibles Suministrados:"}),T(C.fuelTypes)]}),r.jsxs("div",{className:"rating-section",children:[r.jsxs("div",{className:"rating-display",children:[_(C.rating||0),r.jsxs("span",{className:"rating-value",children:[(C.rating||0).toFixed(1),"/5"]})]}),C.evaluationNotes&&r.jsxs("div",{className:"evaluation-notes",title:C.evaluationNotes,children:[r.jsx("i",{className:"icon-message-square"}),r.jsx("span",{children:"Con evaluación"})]})]}),C.paymentTerms&&r.jsxs("div",{className:"payment-terms",children:[r.jsx("i",{className:"icon-credit-card"}),r.jsxs("span",{children:["Términos: ",C.paymentTerms==="contado"?"Contado":C.paymentTerms==="30dias"?"30 días":C.paymentTerms==="60dias"?"60 días":C.paymentTerms==="90dias"?"90 días":C.paymentTerms]})]}),r.jsxs("div",{className:"supplier-stats",children:[r.jsxs("div",{className:"stat-item",children:[r.jsx("span",{className:"stat-label",children:"Órdenes:"}),r.jsx("span",{className:"stat-value",children:C.totalOrders||0})]}),r.jsxs("div",{className:"stat-item",children:[r.jsx("span",{className:"stat-label",children:"Total Comprado:"}),r.jsx("span",{className:"stat-value",children:Hs(C.totalPurchased||0)})]}),C.lastOrderDate&&r.jsxs("div",{className:"stat-item",children:[r.jsx("span",{className:"stat-label",children:"Última Orden:"}),r.jsx("span",{className:"stat-value",children:v(C.lastOrderDate)})]})]})]}),r.jsxs("div",{className:"card-footer",children:[r.jsx("div",{className:"footer-info",children:r.jsxs("span",{className:"created-date",children:["Creado: ",v(C.createdAt)]})}),r.jsxs("div",{className:"card-actions",children:[i&&r.jsxs("button",{className:"btn btn-sm btn-secondary",onClick:()=>e(C),title:"Editar proveedor",children:[r.jsx("i",{className:"icon-edit"}),"Editar"]}),o&&C.status==="active"&&r.jsxs("button",{className:"btn btn-sm btn-danger",onClick:()=>t(C.id,C.name),title:"Desactivar proveedor",children:[r.jsx("i",{className:"icon-x-circle"}),"Desactivar"]}),r.jsxs("div",{className:"quick-actions",children:[C.phone&&r.jsx("a",{href:`tel:${C.phone}`,className:"quick-action-btn",title:"Llamar",children:r.jsx("i",{className:"icon-phone"})}),C.email&&r.jsx("a",{href:`mailto:${C.email}`,className:"quick-action-btn",title:"Enviar email",children:r.jsx("i",{className:"icon-mail"})})]})]})]})]},C.id))})},cV=({supplier:s,onClose:e,onSuccess:t,onError:i})=>{const{userProfile:o}=Da(),c=!!s,[d,m]=W.useState({name:"",taxId:"",type:"proveedor",category:"combustibles",contactPerson:"",phone:"",email:"",address:"",city:"",state:"Colombia",fuelTypes:[],paymentTerms:"contado",creditLimit:"",priceList:{},rating:5,evaluationNotes:"",status:"active",isPreferred:!1}),[p,v]=W.useState(!1),[_,T]=W.useState({}),[x,C]=W.useState("basic");W.useEffect(()=>{c&&s&&m({name:s.name||"",taxId:s.taxId||"",type:s.type||"proveedor",category:s.category||"combustibles",contactPerson:s.contactPerson||"",phone:s.phone||"",email:s.email||"",address:s.address||"",city:s.city||"",state:s.state||"Colombia",fuelTypes:s.fuelTypes||[],paymentTerms:s.paymentTerms||"contado",creditLimit:s.creditLimit||"",priceList:s.priceList||{},rating:s.rating||5,evaluationNotes:s.evaluationNotes||"",status:s.status||"active",isPreferred:s.isPreferred||!1})},[c,s]);const N=(V,B)=>{m(ee=>({...ee,[V]:B})),_[V]&&T(ee=>({...ee,[V]:null}))},M=V=>{m(B=>({...B,fuelTypes:B.fuelTypes.includes(V)?B.fuelTypes.filter(ee=>ee!==V):[...B.fuelTypes,V]}))},S=(V,B)=>{m(ee=>({...ee,priceList:{...ee.priceList,[V]:parseFloat(B)||0}}))},U=()=>{const V={};return d.name.trim()||(V.name="El nombre del proveedor es requerido"),d.category||(V.category="La categoría es requerida"),d.type||(V.type="El tipo de proveedor es requerido"),d.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.email)&&(V.email="El formato del email no es válido"),d.phone&&!/^[\d\s\-+()]+$/.test(d.phone)&&(V.phone="El formato del teléfono no es válido"),d.creditLimit&&(isNaN(d.creditLimit)||parseFloat(d.creditLimit)<0)&&(V.creditLimit="El límite de crédito debe ser un número positivo"),(d.rating<1||d.rating>5)&&(V.rating="El rating debe estar entre 1 y 5"),d.fuelTypes.forEach(B=>{d.priceList[B]&&(isNaN(d.priceList[B])||parseFloat(d.priceList[B])<0)&&(V[`price_${B}`]=`El precio de ${bn[B]} debe ser un número positivo`)}),T(V),Object.keys(V).length===0},$=async V=>{if(V.preventDefault(),!!U()){v(!0);try{const B={...d,creditLimit:parseFloat(d.creditLimit)||0,rating:parseFloat(d.rating)||5,priceList:Object.fromEntries(Object.entries(d.priceList).filter(([D,A])=>d.fuelTypes.includes(D)&&A>0))};let ee;c?ee=await B2(s.id,B,o?.email):ee=await F2(B,o?.email),ee.success?t():i(ee.error||"Error al guardar proveedor")}catch(B){console.error("Error saving supplier:",B),i("Error inesperado al guardar proveedor")}finally{v(!1)}}},F=[{id:"basic",label:"Información Básica",icon:"icon-info"},{id:"contact",label:"Contacto",icon:"icon-phone"},{id:"products",label:"Productos",icon:"icon-package"},{id:"commercial",label:"Comercial",icon:"icon-credit-card"}];return r.jsx("div",{className:"modal-overlay",onClick:e,children:r.jsxs("div",{className:"modal-container large",onClick:V=>V.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("h2",{children:[r.jsx("i",{className:"icon-truck"}),c?"Editar Proveedor":"Nuevo Proveedor"]}),r.jsx("button",{className:"modal-close",onClick:e,children:r.jsx("i",{className:"icon-x"})})]}),r.jsxs("form",{onSubmit:$,children:[r.jsx("div",{className:"modal-tabs",children:F.map(V=>r.jsxs("button",{type:"button",className:`tab-button ${x===V.id?"active":""}`,onClick:()=>C(V.id),children:[r.jsx("i",{className:V.icon}),V.label]},V.id))}),r.jsxs("div",{className:"modal-body",children:[x==="basic"&&r.jsx("div",{className:"tab-content",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"required",children:"Nombre del Proveedor"}),r.jsx("input",{type:"text",value:d.name,onChange:V=>N("name",V.target.value),placeholder:"Ingresa el nombre del proveedor",className:_.name?"error":""}),_.name&&r.jsx("span",{className:"error-message",children:_.name})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"NIT / Documento"}),r.jsx("input",{type:"text",value:d.taxId,onChange:V=>N("taxId",V.target.value),placeholder:"123456789-0",className:_.taxId?"error":""}),_.taxId&&r.jsx("span",{className:"error-message",children:_.taxId})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"required",children:"Tipo de Proveedor"}),r.jsxs("select",{value:d.type,onChange:V=>N("type",V.target.value),className:_.type?"error":"",children:[r.jsx("option",{value:"proveedor",children:"Proveedor"}),r.jsx("option",{value:"distribuidor",children:"Distribuidor"}),r.jsx("option",{value:"mayorista",children:"Mayorista"})]}),_.type&&r.jsx("span",{className:"error-message",children:_.type})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"required",children:"Categoría"}),r.jsxs("select",{value:d.category,onChange:V=>N("category",V.target.value),className:_.category?"error":"",children:[r.jsx("option",{value:"combustibles",children:"Combustibles"}),r.jsx("option",{value:"lubricantes",children:"Lubricantes"}),r.jsx("option",{value:"aditivos",children:"Aditivos"})]}),_.category&&r.jsx("span",{className:"error-message",children:_.category})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado"}),r.jsxs("select",{value:d.status,onChange:V=>N("status",V.target.value),children:[r.jsx("option",{value:"active",children:"Activo"}),r.jsx("option",{value:"inactive",children:"Inactivo"}),r.jsx("option",{value:"suspended",children:"Suspendido"})]})]}),r.jsx("div",{className:"form-group checkbox",children:r.jsxs("label",{className:"checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:d.isPreferred,onChange:V=>N("isPreferred",V.target.checked)}),r.jsx("span",{className:"checkbox-mark"}),"Proveedor Preferido"]})})]})}),x==="contact"&&r.jsx("div",{className:"tab-content",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Persona de Contacto"}),r.jsx("input",{type:"text",value:d.contactPerson,onChange:V=>N("contactPerson",V.target.value),placeholder:"Nombre del contacto principal"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Teléfono"}),r.jsx("input",{type:"tel",value:d.phone,onChange:V=>N("phone",V.target.value),placeholder:"+57 300 123 4567",className:_.phone?"error":""}),_.phone&&r.jsx("span",{className:"error-message",children:_.phone})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Email"}),r.jsx("input",{type:"email",value:d.email,onChange:V=>N("email",V.target.value),placeholder:"contacto@proveedor.com",className:_.email?"error":""}),_.email&&r.jsx("span",{className:"error-message",children:_.email})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Ciudad"}),r.jsx("input",{type:"text",value:d.city,onChange:V=>N("city",V.target.value),placeholder:"Bogotá"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Estado/País"}),r.jsx("input",{type:"text",value:d.state,onChange:V=>N("state",V.target.value),placeholder:"Colombia"})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{children:"Dirección"}),r.jsx("textarea",{value:d.address,onChange:V=>N("address",V.target.value),placeholder:"Dirección completa del proveedor",rows:"3"})]})]})}),x==="products"&&r.jsxs("div",{className:"tab-content",children:[r.jsxs("div",{className:"section",children:[r.jsx("h3",{children:"Tipos de Combustible que Suministra"}),r.jsx("div",{className:"fuel-types-grid",children:Object.entries(bn).map(([V,B])=>r.jsx("div",{className:"fuel-type-item",children:r.jsxs("label",{className:"checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:d.fuelTypes.includes(V),onChange:()=>M(V)}),r.jsx("span",{className:"checkbox-mark"}),B]})},V))})]}),d.fuelTypes.length>0&&r.jsxs("div",{className:"section",children:[r.jsx("h3",{children:"Precios por Litro (Opcional)"}),r.jsx("div",{className:"prices-grid",children:d.fuelTypes.map(V=>r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:bn[V]}),r.jsxs("div",{className:"input-with-currency",children:[r.jsx("span",{className:"currency-symbol",children:"$"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:d.priceList[V]||"",onChange:B=>S(V,B.target.value),placeholder:"0.00",className:_[`price_${V}`]?"error":""})]}),_[`price_${V}`]&&r.jsx("span",{className:"error-message",children:_[`price_${V}`]})]},V))})]})]}),x==="commercial"&&r.jsx("div",{className:"tab-content",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Términos de Pago"}),r.jsxs("select",{value:d.paymentTerms,onChange:V=>N("paymentTerms",V.target.value),children:[r.jsx("option",{value:"contado",children:"Contado"}),r.jsx("option",{value:"30dias",children:"30 días"}),r.jsx("option",{value:"60dias",children:"60 días"}),r.jsx("option",{value:"90dias",children:"90 días"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Límite de Crédito"}),r.jsxs("div",{className:"input-with-currency",children:[r.jsx("span",{className:"currency-symbol",children:"$"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:d.creditLimit,onChange:V=>N("creditLimit",V.target.value),placeholder:"0.00",className:_.creditLimit?"error":""})]}),_.creditLimit&&r.jsx("span",{className:"error-message",children:_.creditLimit})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Rating"}),r.jsxs("div",{className:"rating-input",children:[r.jsx("input",{type:"range",min:"1",max:"5",step:"0.1",value:d.rating,onChange:V=>N("rating",parseFloat(V.target.value)),className:_.rating?"error":""}),r.jsxs("div",{className:"rating-display",children:[r.jsx("span",{className:"rating-value",children:d.rating.toFixed(1)}),r.jsx("div",{className:"rating-stars",children:[1,2,3,4,5].map(V=>r.jsx("span",{className:`star ${V<=Math.round(d.rating)?"filled":""}`,children:"★"},V))})]})]}),_.rating&&r.jsx("span",{className:"error-message",children:_.rating})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{children:"Notas de Evaluación"}),r.jsx("textarea",{value:d.evaluationNotes,onChange:V=>N("evaluationNotes",V.target.value),placeholder:"Comentarios sobre el desempeño del proveedor...",rows:"4"})]})]})})]}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn btn-secondary",onClick:e,disabled:p,children:"Cancelar"}),r.jsx("button",{type:"submit",className:"btn btn-primary",disabled:p,children:p?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"loading-spinner small"}),c?"Actualizando...":"Creando..."]}):r.jsxs(r.Fragment,{children:[r.jsx("i",{className:"icon-save"}),c?"Actualizar Proveedor":"Crear Proveedor"]})})]})]})]})})},uV=({stats:s,suppliersCount:e,totalSuppliers:t})=>{if(!s)return null;const i=d=>{switch(d){case"active":return"#22c55e";case"inactive":return"#ef4444";case"suspended":return"#f59e0b";default:return"#6b7280"}},o=d=>{switch(d){case"combustibles":return"⛽";case"lubricantes":return"🛢️";case"aditivos":return"🧪";default:return"📦"}},c=d=>{switch(d){case"proveedor":return"🏪";case"distribuidor":return"🚛";case"mayorista":return"🏭";default:return"🏢"}};return r.jsxs("div",{className:"suppliers-stats",children:[r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card primary",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-truck"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:ct(s.total)}),r.jsx("div",{className:"stat-label",children:"Total Proveedores"}),t!==e&&r.jsxs("div",{className:"stat-sublabel",children:[ct(e)," mostrados"]})]})]}),r.jsxs("div",{className:"stat-card success",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-check-circle"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:ct(s.active)}),r.jsx("div",{className:"stat-label",children:"Activos"}),r.jsx("div",{className:"stat-sublabel",children:_r(s.total>0?s.active/s.total:0)})]})]}),r.jsxs("div",{className:"stat-card warning",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-star"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:ct(s.preferred)}),r.jsx("div",{className:"stat-label",children:"Preferidos"}),r.jsx("div",{className:"stat-sublabel",children:_r(s.active>0?s.preferred/s.active:0)})]})]}),r.jsxs("div",{className:"stat-card info",children:[r.jsx("div",{className:"stat-icon",children:r.jsx("i",{className:"icon-award"})}),r.jsxs("div",{className:"stat-content",children:[r.jsx("div",{className:"stat-value",children:s.averageRating.toFixed(1)}),r.jsx("div",{className:"stat-label",children:"Rating Promedio"}),r.jsx("div",{className:"stat-sublabel",children:r.jsx("div",{className:"rating-stars",children:[1,2,3,4,5].map(d=>r.jsx("span",{className:`star ${d<=Math.round(s.averageRating)?"filled":""}`,children:"★"},d))})})]})]})]}),r.jsxs("div",{className:"stats-details",children:[r.jsxs("div",{className:"stats-section",children:[r.jsx("h3",{children:"Estado de Proveedores"}),r.jsxs("div",{className:"stats-breakdown",children:[r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:i("active")}}),"Activos"]}),r.jsx("div",{className:"breakdown-value",children:s.active}),r.jsx("div",{className:"breakdown-percentage",children:_r(s.total>0?s.active/s.total:0)})]}),s.inactive>0&&r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:i("inactive")}}),"Inactivos"]}),r.jsx("div",{className:"breakdown-value",children:s.inactive}),r.jsx("div",{className:"breakdown-percentage",children:_r(s.total>0?s.inactive/s.total:0)})]}),s.suspended>0&&r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"status-dot",style:{backgroundColor:i("suspended")}}),"Suspendidos"]}),r.jsx("div",{className:"breakdown-value",children:s.suspended}),r.jsx("div",{className:"breakdown-percentage",children:_r(s.total>0?s.suspended/s.total:0)})]})]})]}),Object.keys(s.byCategory).length>0&&r.jsxs("div",{className:"stats-section",children:[r.jsx("h3",{children:"Por Categoría"}),r.jsx("div",{className:"stats-breakdown",children:Object.entries(s.byCategory).sort(([,d],[,m])=>m-d).map(([d,m])=>r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"category-icon",children:o(d)}),d.charAt(0).toUpperCase()+d.slice(1).replace("_"," ")]}),r.jsx("div",{className:"breakdown-value",children:m}),r.jsx("div",{className:"breakdown-percentage",children:_r(s.total>0?m/s.total:0)})]},d))})]}),Object.keys(s.byType).length>0&&r.jsxs("div",{className:"stats-section",children:[r.jsx("h3",{children:"Por Tipo"}),r.jsx("div",{className:"stats-breakdown",children:Object.entries(s.byType).sort(([,d],[,m])=>m-d).map(([d,m])=>r.jsxs("div",{className:"breakdown-item",children:[r.jsxs("div",{className:"breakdown-label",children:[r.jsx("span",{className:"type-icon",children:c(d)}),d.charAt(0).toUpperCase()+d.slice(1)]}),r.jsx("div",{className:"breakdown-value",children:m}),r.jsx("div",{className:"breakdown-percentage",children:_r(s.total>0?m/s.total:0)})]},d))})]})]}),r.jsxs("div",{className:"stats-insights",children:[r.jsx("h3",{children:"Información Rápida"}),r.jsxs("div",{className:"insights-grid",children:[r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Nivel de Satisfacción"}),r.jsx("div",{className:"insight-value",children:s.averageRating>=4.5?"Excelente":s.averageRating>=4?"Muy Bueno":s.averageRating>=3.5?"Bueno":s.averageRating>=3?"Regular":"Necesita Mejora"})]}),r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Estado General"}),r.jsx("div",{className:"insight-value",children:s.active/s.total>=.9?"Excelente":s.active/s.total>=.8?"Bueno":s.active/s.total>=.7?"Regular":"Revisar"})]}),r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Proveedores Preferidos"}),r.jsx("div",{className:"insight-value",children:s.preferred===0?"Ninguno":s.preferred/s.active>=.3?"Suficientes":s.preferred/s.active>=.2?"Buenos":"Pocos"})]}),r.jsxs("div",{className:"insight-item",children:[r.jsx("div",{className:"insight-label",children:"Diversificación"}),r.jsx("div",{className:"insight-value",children:Object.keys(s.byCategory).length>=3?"Alta":Object.keys(s.byCategory).length>=2?"Media":"Baja"})]})]})]})]})},dV=({searchTerm:s,setSearchTerm:e,filterStatus:t,setFilterStatus:i,filterCategory:o,setFilterCategory:c,filterFuelType:d,setFilterFuelType:m,viewMode:p,setViewMode:v,onClearFilters:_,resultsCount:T})=>{const x=[{value:"all",label:"Todos los Estados",icon:"list"},{value:"active",label:"Activos",icon:"check-circle"},{value:"inactive",label:"Inactivos",icon:"x-circle"},{value:"suspended",label:"Suspendidos",icon:"alert-circle"},{value:"preferred",label:"Preferidos",icon:"star"}],C=[{value:"all",label:"Todas las Categorías",icon:"grid"},{value:"combustibles",label:"Combustibles",icon:"fuel"},{value:"lubricantes",label:"Lubricantes",icon:"droplets"},{value:"aditivos",label:"Aditivos",icon:"flask"}],N=[{value:"all",label:"Todos los Combustibles",icon:"fuel"},...Object.entries(bn).map(([S,U])=>({value:S,label:U,icon:"droplet"}))],M=s||t!=="all"||o!=="all"||d!=="all";return r.jsxs("div",{className:"suppliers-filters",children:[r.jsxs("div",{className:"filters-top",children:[r.jsx("div",{className:"search-container",children:r.jsxs("div",{className:"search-input-wrapper",children:[r.jsx("i",{className:"icon-search search-icon"}),r.jsx("input",{type:"text",placeholder:"Buscar por nombre, NIT, contacto, ciudad...",value:s,onChange:S=>e(S.target.value),className:"search-input"}),s&&r.jsx("button",{className:"search-clear",onClick:()=>e(""),title:"Limpiar búsqueda",children:r.jsx("i",{className:"icon-x"})})]})}),r.jsxs("div",{className:"view-controls",children:[r.jsxs("div",{className:"view-mode-toggle",children:[r.jsx("button",{className:`view-btn ${p==="cards"?"active":""}`,onClick:()=>v("cards"),title:"Vista de tarjetas",children:r.jsx("i",{className:"icon-grid"})}),r.jsx("button",{className:`view-btn ${p==="table"?"active":""}`,onClick:()=>v("table"),title:"Vista de tabla",children:r.jsx("i",{className:"icon-list"})})]}),M&&r.jsxs("button",{className:"btn btn-secondary clear-filters",onClick:_,title:"Limpiar todos los filtros",children:[r.jsx("i",{className:"icon-filter-x"}),"Limpiar"]})]})]}),r.jsxs("div",{className:"filters-dropdowns",children:[r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{className:"filter-label",children:"Estado"}),r.jsxs("div",{className:"select-wrapper",children:[r.jsx("select",{value:t,onChange:S=>i(S.target.value),className:"filter-select",children:x.map(S=>r.jsx("option",{value:S.value,children:S.label},S.value))}),r.jsx("i",{className:"icon-chevron-down select-arrow"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{className:"filter-label",children:"Categoría"}),r.jsxs("div",{className:"select-wrapper",children:[r.jsx("select",{value:o,onChange:S=>c(S.target.value),className:"filter-select",children:C.map(S=>r.jsx("option",{value:S.value,children:S.label},S.value))}),r.jsx("i",{className:"icon-chevron-down select-arrow"})]})]}),r.jsxs("div",{className:"filter-group",children:[r.jsx("label",{className:"filter-label",children:"Tipo de Combustible"}),r.jsxs("div",{className:"select-wrapper",children:[r.jsx("select",{value:d,onChange:S=>m(S.target.value),className:"filter-select",children:N.map(S=>r.jsx("option",{value:S.value,children:S.label},S.value))}),r.jsx("i",{className:"icon-chevron-down select-arrow"})]})]})]}),r.jsxs("div",{className:"filters-summary",children:[r.jsxs("div",{className:"results-count",children:[r.jsx("i",{className:"icon-info-circle"}),r.jsx("span",{children:T===0?"No se encontraron proveedores":`Mostrando ${T} proveedor${T!==1?"es":""}`})]}),M&&r.jsxs("div",{className:"active-filters",children:[r.jsx("span",{className:"filters-label",children:"Filtros activos:"}),r.jsxs("div",{className:"filter-tags",children:[s&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-search"}),s,r.jsx("button",{onClick:()=>e(""),children:r.jsx("i",{className:"icon-x"})})]}),t!=="all"&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-filter"}),x.find(S=>S.value===t)?.label,r.jsx("button",{onClick:()=>i("all"),children:r.jsx("i",{className:"icon-x"})})]}),o!=="all"&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-tag"}),C.find(S=>S.value===o)?.label,r.jsx("button",{onClick:()=>c("all"),children:r.jsx("i",{className:"icon-x"})})]}),d!=="all"&&r.jsxs("span",{className:"filter-tag",children:[r.jsx("i",{className:"icon-droplet"}),N.find(S=>S.value===d)?.label,r.jsx("button",{onClick:()=>m("all"),children:r.jsx("i",{className:"icon-x"})})]})]})]})]}),r.jsxs("div",{className:"quick-filters",children:[r.jsx("span",{className:"quick-filters-label",children:"Acceso rápido:"}),r.jsxs("div",{className:"quick-filter-buttons",children:[r.jsxs("button",{className:`quick-filter-btn ${t==="preferred"?"active":""}`,onClick:()=>i(t==="preferred"?"all":"preferred"),children:[r.jsx("i",{className:"icon-star"}),"Preferidos"]}),r.jsxs("button",{className:`quick-filter-btn ${t==="active"?"active":""}`,onClick:()=>i(t==="active"?"all":"active"),children:[r.jsx("i",{className:"icon-check-circle"}),"Activos"]}),r.jsxs("button",{className:`quick-filter-btn ${o==="combustibles"?"active":""}`,onClick:()=>c(o==="combustibles"?"all":"combustibles"),children:[r.jsx("i",{className:"icon-fuel"}),"Combustibles"]}),r.jsxs("button",{className:`quick-filter-btn ${d==="diesel"?"active":""}`,onClick:()=>m(d==="diesel"?"all":"diesel"),children:[r.jsx("i",{className:"icon-droplet"}),"Diésel"]})]})]})]})},hV=()=>{const{hasPermission:s,userProfile:e}=Da(),[t,i]=W.useState([]),[o,c]=W.useState(null),[d,m]=W.useState(!0),[p,v]=W.useState(null),[_,T]=W.useState("cards"),[x,C]=W.useState(!1),[N,M]=W.useState(null),[S,U]=W.useState("all"),[$,F]=W.useState("all"),[V,B]=W.useState("all"),[ee,D]=W.useState("");W.useEffect(()=>{let H=null;return(()=>{H=q2(ce=>{i(ce||[]),m(!1)})})(),()=>{H&&H()}},[]),W.useEffect(()=>{const H=async()=>{const te=await H2();te.success&&c(te.data)};t.length>0&&H()},[t]);const A=t.filter(H=>{const te=!ee||H.name?.toLowerCase().includes(ee.toLowerCase())||H.taxId?.toLowerCase().includes(ee.toLowerCase())||H.contactPerson?.toLowerCase().includes(ee.toLowerCase())||H.city?.toLowerCase().includes(ee.toLowerCase()),ce=S==="all"||(S==="preferred"?H.isPreferred:H.status===S),ge=$==="all"||H.category===$,q=V==="all"||H.fuelTypes&&H.fuelTypes.includes(V);return te&&ce&&ge&&q}),R=()=>{if(!s("canManageSuppliers")){v("No tienes permisos para agregar proveedores");return}M(null),C(!0)},I=H=>{if(!s("canManageSuppliers")){v("No tienes permisos para editar proveedores");return}M(H),C(!0)},k=async(H,te)=>{if(!s("canManageSuppliers")){v("No tienes permisos para eliminar proveedores");return}if(window.confirm(`¿Estás seguro de que deseas desactivar el proveedor "${te}"?

Esta acción se puede revertir cambiando su estado a activo.`))try{const ce=await z2(H,e?.email);ce.success?v(null):v(ce.error||"Error al desactivar proveedor")}catch(ce){console.error("Error deleting supplier:",ce),v("Error inesperado al eliminar proveedor")}},P=()=>{C(!1),M(null),v(null)},O=()=>{C(!1),M(null),v(null)},Ve=()=>{U("all"),F("all"),B("all"),D("")},ae=()=>{if(!s("canExportReports")){v("No tienes permisos para exportar datos");return}try{const H=A.map(ne=>({Nombre:ne.name,"NIT/Documento":ne.taxId,Tipo:ne.type,Categoría:ne.category,"Persona de Contacto":ne.contactPerson,Teléfono:ne.phone,Email:ne.email,Ciudad:ne.city,Combustibles:ne.fuelTypes?.join(", "),Rating:ne.rating,Estado:ne.status,Preferido:ne.isPreferred?"Sí":"No","Fecha Creación":ne.createdAt?.toDate?.()?.toLocaleDateString()||"N/A"})),te=[Object.keys(H[0]).join(","),...H.map(ne=>Object.values(ne).map(he=>`"${he||""}"`).join(","))].join(`
`),ce=new Blob([te],{type:"text/csv;charset=utf-8;"}),ge=document.createElement("a"),q=URL.createObjectURL(ce);ge.setAttribute("href",q),ge.setAttribute("download",`proveedores_${new Date().toISOString().split("T")[0]}.csv`),ge.style.visibility="hidden",document.body.appendChild(ge),ge.click(),document.body.removeChild(ge)}catch(H){console.error("Error exporting suppliers:",H),v("Error al exportar proveedores")}};return d?r.jsx("div",{className:"suppliers-main",children:r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Cargando proveedores..."})]})}):r.jsxs("div",{className:"suppliers-main",children:[r.jsxs("div",{className:"suppliers-header",children:[r.jsxs("div",{className:"header-content",children:[r.jsx("h1",{children:"Gestión de Proveedores"}),r.jsx("p",{className:"header-subtitle",children:"Administra los proveedores de combustibles y materiales"})]}),r.jsxs("div",{className:"header-actions",children:[s("canManageSuppliers")&&r.jsxs("button",{className:"btn btn-primary",onClick:R,children:[r.jsx("i",{className:"icon-plus"}),"Agregar Proveedor"]}),s("canExportReports")&&r.jsxs("button",{className:"btn btn-secondary",onClick:ae,disabled:A.length===0,children:[r.jsx("i",{className:"icon-download"}),"Exportar"]})]})]}),p&&r.jsxs("div",{className:"alert alert-error",children:[r.jsx("i",{className:"icon-alert-circle"}),r.jsx("span",{children:p}),r.jsx("button",{onClick:()=>v(null),className:"alert-close",children:r.jsx("i",{className:"icon-x"})})]}),o&&r.jsx(uV,{stats:o,suppliersCount:A.length,totalSuppliers:t.length}),r.jsx(dV,{searchTerm:ee,setSearchTerm:D,filterStatus:S,setFilterStatus:U,filterCategory:$,setFilterCategory:F,filterFuelType:V,setFilterFuelType:B,viewMode:_,setViewMode:T,onClearFilters:Ve,resultsCount:A.length}),A.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-icon",children:r.jsx("i",{className:"icon-truck"})}),r.jsx("h3",{children:"No hay proveedores"}),r.jsx("p",{children:t.length===0?"Comienza agregando tu primer proveedor de combustibles.":"No se encontraron proveedores que coincidan con los filtros aplicados."}),t.length===0&&s("canManageSuppliers")&&r.jsxs("button",{className:"btn btn-primary",onClick:R,children:[r.jsx("i",{className:"icon-plus"}),"Agregar Primer Proveedor"]}),t.length>0&&r.jsxs("button",{className:"btn btn-secondary",onClick:Ve,children:[r.jsx("i",{className:"icon-filter-x"}),"Limpiar Filtros"]})]}):r.jsx("div",{className:"suppliers-content",children:_==="cards"?r.jsx(lV,{suppliers:A,onEdit:I,onDelete:k,hasEditPermission:s("canManageSuppliers"),hasDeletePermission:s("canManageSuppliers")}):r.jsx(oV,{suppliers:A,onEdit:I,onDelete:k,hasEditPermission:s("canManageSuppliers"),hasDeletePermission:s("canManageSuppliers")})}),x&&r.jsx(cV,{supplier:N,onClose:P,onSuccess:O,onError:v})]})},fV=()=>{const{user:s,userProfile:e}=Da(),[t,i]=W.useState("invitations"),[o,c]=W.useState([]),[d,m]=W.useState(!1),[p,v]=W.useState(!1),[_,T]=W.useState(!1),[x,C]=W.useState({email:"",name:"",role:gs.CLIENTE});W.useEffect(()=>{s&&e?.role==="admin"&&N()},[s,e]);const N=async()=>{m(!0);try{const V=await d2(s.uid);V.success?c(V.invitations):console.error("Error loading invitations:",V.error)}catch(V){console.error("Error loading invitations:",V)}finally{m(!1)}},M=async V=>{V.preventDefault(),T(!0);try{const B=await c2(x,s.uid);B.success?(C({email:"",name:"",role:gs.CLIENTE}),v(!1),await N(),alert(`Invitación creada exitosamente!
Código: ${B.invitation.code}`)):alert(`Error: ${B.error}`)}catch(B){console.error("Error creating invitation:",B),alert("Error creando invitación")}finally{T(!1)}},S=async V=>{if(confirm("¿Estás seguro de cancelar esta invitación?"))try{const B=await h2(V,s.uid);B.success?(await N(),alert("Invitación cancelada exitosamente")):alert(`Error: ${B.error}`)}catch(B){console.error("Error cancelling invitation:",B),alert("Error cancelando invitación")}},U=V=>({pending:{text:"Pendiente",class:"status-pending"},used:{text:"Usada",class:"status-used"},cancelled:{text:"Cancelada",class:"status-cancelled"},expired:{text:"Expirada",class:"status-expired"}})[V]||{text:V,class:"status-unknown"},$=V=>({admin:"Administrador",contador:"Contador",cliente:"Cliente"})[V]||V,F=V=>V?(V.toDate?V.toDate():new Date(V)).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return e?.role!=="admin"?r.jsxs("div",{className:"admin-unauthorized",children:[r.jsx("h2",{children:"⛔ Acceso Denegado"}),r.jsx("p",{children:"Solo los administradores pueden acceder a esta sección."})]}):r.jsxs("div",{className:"admin-main",children:[r.jsxs("div",{className:"admin-header",children:[r.jsx("h1",{children:"⚙️ Administración del Sistema"}),r.jsx("p",{children:"Gestión de usuarios y configuraciones"})]}),r.jsxs("div",{className:"admin-tabs",children:[r.jsx("button",{className:`tab-button ${t==="invitations"?"active":""}`,onClick:()=>i("invitations"),children:"🎫 Invitaciones"}),r.jsx("button",{className:`tab-button ${t==="users"?"active":""}`,onClick:()=>i("users"),children:"👥 Usuarios"}),r.jsx("button",{className:`tab-button ${t==="settings"?"active":""}`,onClick:()=>i("settings"),children:"⚙️ Configuración"})]}),r.jsxs("div",{className:"admin-content",children:[t==="invitations"&&r.jsxs("div",{className:"invitations-section",children:[r.jsxs("div",{className:"section-header",children:[r.jsx("h2",{children:"Gestión de Invitaciones"}),r.jsx("button",{className:"create-button",onClick:()=>v(!0),children:"+ Crear Invitación"})]}),d?r.jsx("div",{className:"loading",children:"Cargando invitaciones..."}):r.jsxs("div",{className:"invitations-table",children:[r.jsxs("table",{children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Código"}),r.jsx("th",{children:"Email"}),r.jsx("th",{children:"Nombre"}),r.jsx("th",{children:"Rol"}),r.jsx("th",{children:"Estado"}),r.jsx("th",{children:"Creada"}),r.jsx("th",{children:"Expira"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(V=>{const B=U(V.status);return r.jsxs("tr",{children:[r.jsx("td",{children:r.jsx("code",{className:"invitation-code",children:V.code})}),r.jsx("td",{children:V.targetEmail}),r.jsx("td",{children:V.targetName||"-"}),r.jsx("td",{children:$(V.targetRole)}),r.jsx("td",{children:r.jsx("span",{className:`status-badge ${B.class}`,children:B.text})}),r.jsx("td",{children:F(V.createdAt)}),r.jsx("td",{children:F(V.expiresAt)}),r.jsx("td",{children:V.status==="pending"&&r.jsx("button",{className:"cancel-button",onClick:()=>S(V.id),children:"Cancelar"})})]},V.id)})})]}),o.length===0&&r.jsx("div",{className:"empty-state",children:r.jsx("p",{children:"No hay invitaciones creadas"})})]})]}),t==="users"&&r.jsxs("div",{className:"users-section",children:[r.jsx("h2",{children:"👥 Usuarios del Sistema"}),r.jsxs("div",{className:"coming-soon",children:[r.jsx("span",{children:"🚧 En desarrollo"}),r.jsx("p",{children:"Próximamente: Lista de usuarios registrados, edición de permisos, y estadísticas."})]})]}),t==="settings"&&r.jsxs("div",{className:"settings-section",children:[r.jsx("h2",{children:"⚙️ Configuración del Sistema"}),r.jsxs("div",{className:"coming-soon",children:[r.jsx("span",{children:"🚧 En desarrollo"}),r.jsx("p",{children:"Próximamente: Configuraciones generales, notificaciones, y parámetros del sistema."})]})]})]}),p&&r.jsx("div",{className:"modal-overlay",onClick:()=>v(!1),children:r.jsxs("div",{className:"modal-content",onClick:V=>V.stopPropagation(),children:[r.jsxs("div",{className:"modal-header",children:[r.jsx("h3",{children:"Crear Nueva Invitación"}),r.jsx("button",{className:"modal-close",onClick:()=>v(!1),children:"×"})]}),r.jsxs("form",{onSubmit:M,className:"invitation-form",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email del usuario:"}),r.jsx("input",{id:"email",type:"email",required:!0,value:x.email,onChange:V=>C({...x,email:V.target.value}),placeholder:"usuario@ejemplo.com"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"name",children:"Nombre (opcional):"}),r.jsx("input",{id:"name",type:"text",value:x.name,onChange:V=>C({...x,name:V.target.value}),placeholder:"Nombre del usuario"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"role",children:"Rol:"}),r.jsxs("select",{id:"role",value:x.role,onChange:V=>C({...x,role:V.target.value}),children:[r.jsx("option",{value:gs.CLIENTE,children:"Cliente"}),r.jsx("option",{value:gs.CONTADOR,children:"Contador"}),r.jsx("option",{value:gs.ADMIN,children:"Administrador"})]})]}),r.jsxs("div",{className:"form-actions",children:[r.jsx("button",{type:"button",className:"cancel-button",onClick:()=>v(!1),children:"Cancelar"}),r.jsx("button",{type:"submit",className:"create-button",disabled:_,children:_?"Creando...":"Crear Invitación"})]})]})]})})]})},mV=()=>r.jsxs("div",{className:"module-placeholder",children:[r.jsx("h2",{children:"📋 Módulo de Reportes"}),r.jsx("p",{children:"Análisis y reportes de combustibles"}),r.jsxs("div",{className:"coming-soon",children:[r.jsx("span",{children:"🚧 En desarrollo"}),r.jsx("p",{children:"Próximamente: Reportes personalizables, gráficos interactivos, y exportación."})]})]}),pV=()=>{const[s,e]=W.useState("dashboard"),t=()=>{switch(s){case"dashboard":return r.jsx(hN,{});case"inventory":return r.jsx(M2,{});case"movements":return r.jsx($2,{});case"vehicles":return r.jsx(tV,{});case"products":return r.jsx(rV,{});case"suppliers":return r.jsx(hV,{});case"reports":return r.jsx(mV,{});case"admin":return r.jsx(fV,{});default:return r.jsx(hN,{})}};return r.jsx(p2,{currentView:s,onViewChange:e,children:t()})},gV=()=>{const[s,e]=W.useState("login"),[t,i]=W.useState(!1),[o,c]=W.useState(""),[d,m]=W.useState(""),[p,v]=W.useState(""),[_,T]=W.useState(""),[x,C]=W.useState({email:"",password:"",confirmPassword:"",invitationCode:""}),[N,M]=W.useState(""),[S,U]=W.useState(null),$=async R=>{R.preventDefault(),i(!0),c("");try{await EI(kc,p,_)}catch(I){console.error("Error en login:",I),c(ee(I.code))}finally{i(!1)}},F=async()=>{i(!0),c("");try{const R=new Na,I=await HI(kc,R);S?await cN(I.user,S.code):await KA(I.user)}catch(R){console.error("Error en login con Google:",R),c("Error al iniciar sesión con Google")}finally{i(!1)}},V=async R=>{R.preventDefault(),i(!0),c(""),m("");try{const I=await $A(N);I.success?(U(I.invitation),m(`Invitación válida para: ${I.invitation.targetEmail}`),e("register"),C({...x,email:I.invitation.targetEmail,invitationCode:N})):c(I.error)}catch(I){console.error("Error validando invitación:",I),c("Error validando código de invitación")}finally{i(!1)}},B=async R=>{if(R.preventDefault(),i(!0),c(""),x.password!==x.confirmPassword){c("Las contraseñas no coinciden"),i(!1);return}if(x.password.length<6){c("La contraseña debe tener al menos 6 caracteres"),i(!1);return}try{const I=await _I(kc,x.email,x.password),k=await cN(I.user,x.invitationCode);k.success?m("¡Registro exitoso! Bienvenido al sistema."):c(k.error)}catch(I){console.error("Error en registro:",I),c(ee(I.code))}finally{i(!1)}},ee=R=>{switch(R){case"auth/invalid-email":return"El formato del email es inválido";case"auth/user-not-found":return"Usuario no encontrado";case"auth/wrong-password":return"Contraseña incorrecta";case"auth/invalid-credential":return"Email o contraseña incorrectos";case"auth/email-already-in-use":return"Este email ya está registrado";case"auth/weak-password":return"La contraseña es muy débil";default:return"Error de autenticación. Inténtalo de nuevo."}},D=()=>{c(""),m(""),v(""),T(""),M(""),U(null),C({email:"",password:"",confirmPassword:"",invitationCode:""})},A=()=>{switch(s){case"login":return r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:$,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email:"}),r.jsx("input",{id:"email",type:"email",value:p,onChange:R=>v(R.target.value),required:!0,disabled:t,placeholder:"tu-email@ejemplo.com"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"Contraseña:"}),r.jsx("input",{id:"password",type:"password",value:_,onChange:R=>T(R.target.value),required:!0,disabled:t,placeholder:"Tu contraseña"})]}),r.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Iniciando sesión...":"Iniciar Sesión"})]}),r.jsx("div",{className:"auth-divider",children:r.jsx("span",{children:"o"})}),r.jsxs("button",{onClick:F,className:"auth-button google",disabled:t,children:[r.jsx("span",{children:"🔗"}),"Continuar con Google"]}),r.jsx("div",{className:"auth-actions",children:r.jsx("button",{className:"link-button",onClick:()=>{D(),e("invite")},children:"¿Tienes un código de invitación? Regístrate aquí"})})]});case"invite":return r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:V,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"inviteCode",children:"Código de invitación:"}),r.jsx("input",{id:"inviteCode",type:"text",value:N,onChange:R=>M(R.target.value.toUpperCase()),required:!0,disabled:t,placeholder:"XXXXXXXX",maxLength:8,style:{textTransform:"uppercase",fontFamily:"monospace"}}),r.jsx("small",{children:"Ingresa el código de 8 caracteres que recibiste"})]}),r.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Validando...":"Validar Código"})]}),r.jsx("div",{className:"auth-actions",children:r.jsx("button",{className:"link-button",onClick:()=>{D(),e("login")},children:"Volver al inicio de sesión"})})]});case"register":return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"invitation-info",children:r.jsxs("div",{className:"success-message",children:["✅ Código válido para: ",S?.targetEmail]})}),r.jsxs("form",{onSubmit:B,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"registerEmail",children:"Email:"}),r.jsx("input",{id:"registerEmail",type:"email",value:x.email,disabled:!0,className:"disabled-input"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"registerPassword",children:"Contraseña:"}),r.jsx("input",{id:"registerPassword",type:"password",value:x.password,onChange:R=>C({...x,password:R.target.value}),required:!0,disabled:t,placeholder:"Mínimo 6 caracteres",minLength:6})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"confirmPassword",children:"Confirmar contraseña:"}),r.jsx("input",{id:"confirmPassword",type:"password",value:x.confirmPassword,onChange:R=>C({...x,confirmPassword:R.target.value}),required:!0,disabled:t,placeholder:"Repite tu contraseña"})]}),r.jsx("button",{type:"submit",className:"auth-button primary",disabled:t,children:t?"Registrando...":"Crear Cuenta"})]}),r.jsx("div",{className:"auth-divider",children:r.jsx("span",{children:"o"})}),r.jsxs("button",{onClick:F,className:"auth-button google",disabled:t,children:[r.jsx("span",{children:"🔗"}),"Registrarse con Google"]}),r.jsx("div",{className:"auth-actions",children:r.jsx("button",{className:"link-button",onClick:()=>{D(),e("invite")},children:"Usar otro código de invitación"})})]});default:return null}};return r.jsx("div",{className:"auth-container",children:r.jsxs("div",{className:"auth-card",children:[r.jsxs("div",{className:"auth-header",children:[r.jsx("h1",{children:"⛽ Combustibles"}),r.jsx("h2",{children:"Forestech Colombia"}),r.jsxs("p",{children:[s==="login"&&"Sistema de gestión de combustibles",s==="invite"&&"Validar código de invitación",s==="register"&&"Crear nueva cuenta"]})]}),r.jsxs("div",{className:"auth-form",children:[o&&r.jsx("div",{className:"error-message",children:o}),d&&r.jsx("div",{className:"success-message",children:d}),A(),r.jsx("div",{className:"auth-footer",children:r.jsx("p",{children:r.jsxs("small",{children:["Solo usuarios autorizados pueden acceder al sistema.",r.jsx("br",{}),s==="login"?"Contacta al administrador para obtener un código de invitación.":"Si no tienes código, contacta al administrador."]})})})]})]})})};function vV(){return r.jsx(m2,{children:r.jsx(yV,{})})}function yV(){const{user:s,loading:e}=Da();return e?r.jsx("div",{className:"loading-container",children:r.jsxs("div",{className:"loader",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Cargando..."})]})}):r.jsxs("div",{className:"App",children:[!s&&r.jsx(gV,{}),s&&r.jsx(pV,{})]})}Uw.createRoot(document.getElementById("root")).render(r.jsx(W.StrictMode,{children:r.jsx(vV,{})}));
