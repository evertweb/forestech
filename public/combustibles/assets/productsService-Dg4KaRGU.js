import{L as l,k as n,b as a,a4 as u,a5 as O,i as A,d as E,c as T,N as m,P as C,s as p,W as R,Q as _,e as S}from"./index-BQoCA6St.js";const c={DIESEL:"DIESEL",GASOLINA:"GASOLINA",ACEITE_HIDRAULICO:"ACEITE_HIDRAULICO",ACEITE_MOTOR_20W50:"ACEITE_MOTOR_20W50",GRASA_ROJA:"GRASA_ROJA",VALVULINA:"VALVULINA",LIQUIDO_FRENOS:"LIQUIDO_FRENOS",MISTURA_LIGA:"MISTURA_LIGA",ACEITE_TRACTORES_15W40:"ACEITE_TRACTORES_15W40"},L={[c.DIESEL]:{name:"DIESEL",displayName:"Diesel 🚛",category:"Combustible",unit:"gal",defaultPrice:12500,color:"#FF6B35",icon:"🚛",description:"Combustible diesel para vehículos pesados"},[c.GASOLINA]:{name:"GASOLINA",displayName:"Gasolina 🚗",category:"Combustible",unit:"gal",defaultPrice:14200,color:"#4CAF50",icon:"🚗",description:"Gasolina corriente para vehículos livianos"},[c.ACEITE_HIDRAULICO]:{name:"ACEITE_HIDRAULICO",displayName:"Aceite Hidráulico 🔧",category:"Aceite",unit:"L",defaultPrice:28e3,color:"#2196F3",icon:"🔧",description:"Aceite hidráulico para sistemas de maquinaria"},[c.ACEITE_MOTOR_20W50]:{name:"ACEITE_MOTOR_20W50",displayName:"Aceite Motor 20W50 🛢️",category:"Aceite",unit:"L",defaultPrice:35e3,color:"#FF9800",icon:"🛢️",description:"Aceite multigrado para motores"},[c.GRASA_ROJA]:{name:"GRASA_ROJA",displayName:"Grasa Roja 🟥",category:"Lubricante",unit:"kg",defaultPrice:12e3,color:"#F44336",icon:"🟥",description:"Grasa lubricante multipropósito"},[c.VALVULINA]:{name:"VALVULINA",displayName:"Valvulina ⚙️",category:"Aceite",unit:"L",defaultPrice:25e3,color:"#9C27B0",icon:"⚙️",description:"Aceite para transmisiones y diferenciales"},[c.LIQUIDO_FRENOS]:{name:"LIQUIDO_FRENOS",displayName:"Líquido para Frenos 🛑",category:"Fluido",unit:"L",defaultPrice:18e3,color:"#E91E63",icon:"🛑",description:"Líquido de frenos DOT 3/4"},[c.MISTURA_LIGA]:{name:"MISTURA_LIGA",displayName:"Mistura o Liga 🌿",category:"Combustible",unit:"L",defaultPrice:8500,color:"#4CAF50",icon:"🌿",description:"Mezcla de combustible para equipos menores"},[c.ACEITE_TRACTORES_15W40]:{name:"ACEITE_TRACTORES_15W40",displayName:"Aceite Tractores 15W40 🚜",category:"Aceite",unit:"L",defaultPrice:32e3,color:"#795548",icon:"🚜",description:"Aceite especializado para tractores"}},P={COMBUSTIBLE:"Combustible",ACEITE:"Aceite",LUBRICANTE:"Lubricante",FLUIDO:"Fluido"},N=()=>Object.values(L),I="combustibles_products",g=async()=>{try{console.log("🔄 Verificando productos existentes...");const o=l(n(a,I),u("name","==","DIESEL"),O(1));if(!(await A(o)).empty){console.log("✅ Producto DIESEL ya existe en Firebase");return}console.log("📦 Creando producto DIESEL faltante...");const e=L.DIESEL,r={name:e.name,displayName:e.displayName,category:e.category,unit:e.unit,defaultPrice:e.defaultPrice,color:e.color,icon:e.icon,description:e.description,isActive:!0,createdAt:new Date,updatedAt:new Date,createdBy:"manual-fix"},i=E(n(a,I));return await T(i,r),console.log(`✅ Producto DIESEL creado: ${e.displayName}`),[{id:i.id,...r}]}catch(o){throw console.error("❌ Error inicializando productos:",o),o}},b=async()=>{try{await g()}catch(o){console.error("❌ Error en inicialización automática:",o)}},d="combustibles_products",f=async o=>{try{const t={...o,createdAt:p(),updatedAt:p()},e=await R(n(a,d),t);return console.log("Product created with ID:",e.id),e.id}catch(t){throw console.error("Error creating product:",t),t}},h=async(o,t)=>{try{const e=E(a,d,o);await S(e,{...t,updatedAt:p()}),console.log("Product updated successfully")}catch(e){throw console.error("Error updating product:",e),e}},U=async o=>{try{await _(E(a,d,o)),console.log("Product deleted successfully")}catch(t){throw console.error("Error deleting product:",t),t}},w=async()=>{try{await b(),console.log("🔍 Obteniendo productos activos...");const o=l(n(a,d),u("isActive","==",!0),m("name")),e=(await A(o)).docs.map(r=>({id:r.id,...r.data()}));return console.log(`✅ Productos activos obtenidos: ${e.length}`),e}catch(o){if(console.error("❌ Error obteniendo productos activos:",o),o.code==="failed-precondition"||o.message.includes("index")){console.warn("⚠️ Índice no disponible, usando consulta alternativa...");try{const t=l(n(a,d),u("isActive","==",!0)),i=(await A(t)).docs.map(s=>({id:s.id,...s.data()})).sort((s,y)=>(s.name||"").localeCompare(y.name||""));return console.log(`✅ Productos activos obtenidos (ordenamiento en cliente): ${i.length}`),i}catch(t){throw console.error("❌ Error en consulta alternativa:",t),t}}throw o}},F=(o,t)=>{try{const e=l(n(a,d),m("name"));return C(e,r=>{const i=r.docs.map(s=>({id:s.id,...s.data()}));o(i)},r=>{console.error("Error in products subscription:",r),t(r)})}catch(e){return console.error("Error setting up products subscription:",e),t(e),()=>{}}};export{c as P,P as a,N as b,f as c,U as d,w as g,F as s,h as u};
