import{I as u,i as n,b as s,a1 as C,h as A,d as m,c as L,J as I,K as g,s as p,Q as T,L as P,e as R,a0 as E}from"./index-CSyJsO2R.js";const i={ACPM:"ACPM",GASOLINA:"GASOLINA",ACEITE_HIDRAULICO:"ACEITE_HIDRAULICO",ACEITE_MOTOR_20W50:"ACEITE_MOTOR_20W50",GRASA_ROJA:"GRASA_ROJA",VALVULINA:"VALVULINA",LIQUIDO_FRENOS:"LIQUIDO_FRENOS",MISTURA_LIGA:"MISTURA_LIGA",ACEITE_TRACTORES_15W40:"ACEITE_TRACTORES_15W40"},O={[i.ACPM]:{name:"ACPM",displayName:"ACPM 🚛",category:"Combustible",unit:"gal",defaultPrice:12500,color:"#FF6B35",icon:"🚛",description:"Combustible diesel para vehículos pesados"},[i.GASOLINA]:{name:"GASOLINA",displayName:"Gasolina 🚗",category:"Combustible",unit:"gal",defaultPrice:14200,color:"#4CAF50",icon:"🚗",description:"Gasolina corriente para vehículos livianos"},[i.ACEITE_HIDRAULICO]:{name:"ACEITE_HIDRAULICO",displayName:"Aceite Hidráulico 🔧",category:"Aceite",unit:"L",defaultPrice:28e3,color:"#2196F3",icon:"🔧",description:"Aceite hidráulico para sistemas de maquinaria"},[i.ACEITE_MOTOR_20W50]:{name:"ACEITE_MOTOR_20W50",displayName:"Aceite Motor 20W50 🛢️",category:"Aceite",unit:"L",defaultPrice:35e3,color:"#FF9800",icon:"🛢️",description:"Aceite multigrado para motores"},[i.GRASA_ROJA]:{name:"GRASA_ROJA",displayName:"Grasa Roja 🟥",category:"Lubricante",unit:"kg",defaultPrice:12e3,color:"#F44336",icon:"🟥",description:"Grasa lubricante multipropósito"},[i.VALVULINA]:{name:"VALVULINA",displayName:"Valvulina ⚙️",category:"Aceite",unit:"L",defaultPrice:25e3,color:"#9C27B0",icon:"⚙️",description:"Aceite para transmisiones y diferenciales"},[i.LIQUIDO_FRENOS]:{name:"LIQUIDO_FRENOS",displayName:"Líquido para Frenos 🛑",category:"Fluido",unit:"L",defaultPrice:18e3,color:"#E91E63",icon:"🛑",description:"Líquido de frenos DOT 3/4"},[i.MISTURA_LIGA]:{name:"MISTURA_LIGA",displayName:"Mistura o Liga 🌿",category:"Combustible",unit:"L",defaultPrice:8500,color:"#4CAF50",icon:"🌿",description:"Mezcla de combustible para equipos menores"},[i.ACEITE_TRACTORES_15W40]:{name:"ACEITE_TRACTORES_15W40",displayName:"Aceite Tractores 15W40 🚜",category:"Aceite",unit:"L",defaultPrice:32e3,color:"#795548",icon:"🚜",description:"Aceite especializado para tractores"}},h={COMBUSTIBLE:"Combustible",ACEITE:"Aceite",LUBRICANTE:"Lubricante",FLUIDO:"Fluido"},S=()=>Object.values(O),y="combustibles_products",_=async()=>{try{console.log("🔄 Verificando productos existentes...");const e=u(n(s,y),C(1));if(!(await A(e)).empty){console.log("✅ Productos ya existen en Firebase");return}console.log("📦 Creando productos predefinidos...");const t=Object.values(O).map(async r=>{const c={name:r.name,displayName:r.displayName,category:r.category,unit:r.unit,defaultPrice:r.defaultPrice,color:r.color,icon:r.icon,description:r.description,isActive:!0,createdAt:new Date,updatedAt:new Date,createdBy:"system-initialization"},l=m(n(s,y));return await L(l,c),console.log(`✅ Producto creado: ${r.displayName}`),{id:l.id,...c}}),a=await Promise.all(t);return console.log(`🎉 ${a.length} productos inicializados correctamente`),a}catch(e){throw console.error("❌ Error inicializando productos:",e),e}},b=async()=>{try{await _()}catch(e){console.error("❌ Error en inicialización automática:",e)}},d="combustibles_products",D=async e=>{try{const o={...e,createdAt:p(),updatedAt:p()},t=await T(n(s,d),o);return console.log("Product created with ID:",t.id),t.id}catch(o){throw console.error("Error creating product:",o),o}},U=async(e,o)=>{try{const t=m(s,d,e);await R(t,{...o,updatedAt:p()}),console.log("Product updated successfully")}catch(t){throw console.error("Error updating product:",t),t}},w=async e=>{try{await P(m(s,d,e)),console.log("Product deleted successfully")}catch(o){throw console.error("Error deleting product:",o),o}},M=async()=>{try{await b(),console.log("🔍 Obteniendo productos activos...");const e=u(n(s,d),E("isActive","==",!0),I("name")),t=(await A(e)).docs.map(a=>({id:a.id,...a.data()}));return console.log(`✅ Productos activos obtenidos: ${t.length}`),t}catch(e){if(console.error("❌ Error obteniendo productos activos:",e),e.code==="failed-precondition"||e.message.includes("index")){console.warn("⚠️ Índice no disponible, usando consulta alternativa...");try{const o=u(n(s,d),E("isActive","==",!0)),r=(await A(o)).docs.map(c=>({id:c.id,...c.data()})).sort((c,l)=>(c.name||"").localeCompare(l.name||""));return console.log(`✅ Productos activos obtenidos (ordenamiento en cliente): ${r.length}`),r}catch(o){throw console.error("❌ Error en consulta alternativa:",o),o}}throw e}},f=(e,o)=>{try{const t=u(n(s,d),I("name"));return g(t,a=>{const r=a.docs.map(c=>({id:c.id,...c.data()}));e(r)},a=>{console.error("Error in products subscription:",a),o(a)})}catch(t){return console.error("Error setting up products subscription:",t),o(t),()=>{}}};export{i as P,h as a,S as b,D as c,w as d,M as g,f as s,U as u};
